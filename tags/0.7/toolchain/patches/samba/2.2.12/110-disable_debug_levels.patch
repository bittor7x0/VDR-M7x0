diff -Naur samba-2.2.12-orig/source/aparser/parser.c samba-2.2.12/source/aparser/parser.c
--- samba-2.2.12-orig/source/aparser/parser.c	2004-08-12 20:24:23.000000000 +0200
+++ samba-2.2.12/source/aparser/parser.c	2009-03-11 09:59:29.000000000 +0100
@@ -21,7 +21,7 @@
 	 */
 
 	if(UNMARSHALLING(ps) || !ps->is_dynamic) {
-		DEBUG(0,("io_grow: Buffer overflow - unable to expand buffer by %u bytes.\n",
+		ZERODEBUG(0,("io_grow: Buffer overflow - unable to expand buffer by %u bytes.\n",
 				(unsigned int)extra_space));
 		return False;
 	}
@@ -35,7 +35,7 @@
 		new_size = extra_space;
 
 		if((new_data = malloc(new_size)) == NULL) {
-			DEBUG(0,("io_grow: Malloc failure for size %u.\n", (unsigned int)new_size));
+			ZERODEBUG(0,("io_grow: Malloc failure for size %u.\n", (unsigned int)new_size));
 			return False;
 		}
 		memset(new_data, '\0', new_size );
@@ -47,7 +47,7 @@
 		new_size = MAX(ps->buffer_size*2, ps->buffer_size + extra_space);		
 
 		if ((new_data = Realloc(ps->data_p, new_size)) == NULL) {
-			DEBUG(0,("io_grow: Realloc failure for size %u.\n",
+			ZERODEBUG(0,("io_grow: Realloc failure for size %u.\n",
 				(unsigned int)new_size));
 			return False;
 		}
@@ -70,7 +70,7 @@
 		 * If reading, ensure that we can read the requested size item.
 		 */
 		if (ps->data_offset + extra_size > ps->buffer_size) {
-			DEBUG(0,("io_mem_get: reading data of size %u would overrun buffer.\n",
+			ZERODEBUG(0,("io_mem_get: reading data of size %u would overrun buffer.\n",
 					(unsigned int)extra_size ));
 			return NULL;
 		}
@@ -101,7 +101,7 @@
 	if (size != 0) {
 		ps->buffer_size = size;
 		if((ps->data_p = (char *)malloc((size_t)size)) == NULL) {
-			DEBUG(0,("io_init: malloc fail for %u bytes.\n", (unsigned int)size));
+			ZERODEBUG(0,("io_init: malloc fail for %u bytes.\n", (unsigned int)size));
 			return False;
 		}
 		ps->is_dynamic = True; /* We own this memory. */
diff -Naur samba-2.2.12-orig/source/aparser/util.c samba-2.2.12/source/aparser/util.c
--- samba-2.2.12-orig/source/aparser/util.c	2004-08-12 20:24:22.000000000 +0200
+++ samba-2.2.12/source/aparser/util.c	2009-03-11 09:59:29.000000000 +0100
@@ -32,7 +32,7 @@
     ret = (void *)realloc(p,size);
 
   if (!ret)
-    DEBUG(0,("Memory allocation error: failed to expand to %d bytes\n",(int)size));
+    ZERODEBUG(0,("Memory allocation error: failed to expand to %d bytes\n",(int)size));
 
   return(ret);
 }
diff -Naur samba-2.2.12-orig/source/auth/pampass.c samba-2.2.12/source/auth/pampass.c
--- samba-2.2.12-orig/source/auth/pampass.c	2004-08-12 20:24:23.000000000 +0200
+++ samba-2.2.12/source/auth/pampass.c	2009-03-11 09:59:29.000000000 +0100
@@ -89,7 +89,7 @@
 
 	if (NT_STATUS_IS_OK(*nt_status)) {
 		/* Complain LOUDLY */
-		DEBUG(0, ("smb_pam_nt_status_error_handler: PAM: BUG: PAM and NT_STATUS \
+		ZERODEBUG(0, ("smb_pam_nt_status_error_handler: PAM: BUG: PAM and NT_STATUS \
 error MISMATCH, forcing to NT_STATUS_LOGON_FAILURE"));
 		*nt_status = NT_STATUS_LOGON_FAILURE;
 	}
@@ -122,7 +122,7 @@
 	 */
 
 	if (udp == NULL) {
-		DEBUG(0,("smb_pam_conv: PAM on this system is broken - appdata_ptr == NULL !\n"));
+		ZERODEBUG(0,("smb_pam_conv: PAM on this system is broken - appdata_ptr == NULL !\n"));
 		return PAM_CONV_ERR;
 	}
 
@@ -209,7 +209,7 @@
 	while (1) {
 		t = (struct chat_struct *)malloc(sizeof(*t));
 		if (!t) {
-			DEBUG(0,("make_pw_chat: malloc failed!\n"));
+			ZERODEBUG(0,("make_pw_chat: malloc failed!\n"));
 			return NULL;
 		}
 
@@ -281,14 +281,14 @@
 	 */
 
 	if (udp == NULL) {
-		DEBUG(0,("smb_pam_passchange_conv: PAM on this system is broken - appdata_ptr == NULL !\n"));
+		ZERODEBUG(0,("smb_pam_passchange_conv: PAM on this system is broken - appdata_ptr == NULL !\n"));
 		free_pw_chat(pw_chat);
 		return PAM_CONV_ERR;
 	}
 
 	reply = malloc(sizeof(struct pam_response) * num_msg);
 	if (!reply) {
-		DEBUG(0,("smb_pam_passchange_conv: malloc for reply failed!\n"));
+		ZERODEBUG(0,("smb_pam_passchange_conv: malloc for reply failed!\n"));
 		free_pw_chat(pw_chat);
 		return PAM_CONV_ERR;
 	}
@@ -527,7 +527,7 @@
 			nt_status = NT_STATUS_REMOTE_SESSION_LIMIT;
 			break;
 		case PAM_ABORT:
-			DEBUG(0, ("smb_pam_auth: PAM: One or more PAM modules failed to load for user %s\n", user));
+			ZERODEBUG(0, ("smb_pam_auth: PAM: One or more PAM modules failed to load for user %s\n", user));
 			nt_status = NT_STATUS_LOGON_FAILURE;
 			break;
 		case PAM_SUCCESS:
@@ -535,7 +535,7 @@
 			nt_status = NT_STATUS_OK;
 			break;
 		default:
-			DEBUG(0, ("smb_pam_auth: PAM: UNKNOWN ERROR while authenticating user %s\n", user));
+			ZERODEBUG(0, ("smb_pam_auth: PAM: UNKNOWN ERROR while authenticating user %s\n", user));
 			nt_status = NT_STATUS_LOGON_FAILURE;
 			break;
 	}
@@ -568,11 +568,11 @@
 			nt_status = NT_STATUS_LOGON_FAILURE;
 			break;
 		case PAM_PERM_DENIED:
-			DEBUG(0, ("smb_pam_account: PAM: User %s is NOT permitted to access system at this time\n", user));
+			ZERODEBUG(0, ("smb_pam_account: PAM: User %s is NOT permitted to access system at this time\n", user));
 			nt_status = NT_STATUS_ACCOUNT_RESTRICTION;
 			break;
 		case PAM_USER_UNKNOWN:
-			DEBUG(0, ("smb_pam_account: PAM: User \"%s\" is NOT known to account management\n", user));
+			ZERODEBUG(0, ("smb_pam_account: PAM: User \"%s\" is NOT known to account management\n", user));
 			nt_status = NT_STATUS_NO_SUCH_USER;
 			break;
 		case PAM_SUCCESS:
@@ -581,7 +581,7 @@
 			break;
 		default:
 			nt_status = NT_STATUS_ACCOUNT_DISABLED;
-			DEBUG(0, ("smb_pam_account: PAM: UNKNOWN PAM ERROR (%d) during Account Management for User: %s\n", pam_error, user));
+			ZERODEBUG(0, ("smb_pam_account: PAM: UNKNOWN PAM ERROR (%d) during Account Management for User: %s\n", pam_error, user));
 			break;
 	}
 
@@ -607,19 +607,19 @@
 	pam_error = pam_setcred(pamh, (PAM_ESTABLISH_CRED|PAM_SILENT)); 
 	switch( pam_error ) {
 		case PAM_CRED_UNAVAIL:
-			DEBUG(0, ("smb_pam_setcred: PAM: Credentials not found for user:%s\n", user ));
+			ZERODEBUG(0, ("smb_pam_setcred: PAM: Credentials not found for user:%s\n", user ));
 			 nt_status = NT_STATUS_NO_TOKEN;
 			break;
 		case PAM_CRED_EXPIRED:
-			DEBUG(0, ("smb_pam_setcred: PAM: Credentials for user: \"%s\" EXPIRED!\n", user ));
+			ZERODEBUG(0, ("smb_pam_setcred: PAM: Credentials for user: \"%s\" EXPIRED!\n", user ));
 			nt_status = NT_STATUS_PASSWORD_EXPIRED;
 			break;
 		case PAM_USER_UNKNOWN:
-			DEBUG(0, ("smb_pam_setcred: PAM: User: \"%s\" is NOT known so can not set credentials!\n", user ));
+			ZERODEBUG(0, ("smb_pam_setcred: PAM: User: \"%s\" is NOT known so can not set credentials!\n", user ));
 			nt_status = NT_STATUS_NO_SUCH_USER;
 			break;
 		case PAM_CRED_ERR:
-			DEBUG(0, ("smb_pam_setcred: PAM: Unknown setcredentials error - unable to set credentials for %s\n", user ));
+			ZERODEBUG(0, ("smb_pam_setcred: PAM: Unknown setcredentials error - unable to set credentials for %s\n", user ));
 			nt_status = NT_STATUS_LOGON_FAILURE;
 			break;
 		case PAM_SUCCESS:
@@ -627,7 +627,7 @@
 			nt_status = NT_STATUS_OK;
 			break;
 		default:
-			DEBUG(0, ("smb_pam_setcred: PAM: UNKNOWN PAM ERROR (%d) during SetCredentials for User: %s\n", pam_error, user));
+			ZERODEBUG(0, ("smb_pam_setcred: PAM: UNKNOWN PAM ERROR (%d) during SetCredentials for User: %s\n", pam_error, user));
 			nt_status = NT_STATUS_NO_TOKEN;
 			break;
 	}
@@ -694,19 +694,19 @@
 		DEBUG(2, ("PAM: Authentication token aging has been disabled.\n"));
 		break;
 	case PAM_PERM_DENIED:
-		DEBUG(0, ("PAM: Permission denied.\n"));
+		ZERODEBUG(0, ("PAM: Permission denied.\n"));
 		break;
 	case PAM_TRY_AGAIN:
-		DEBUG(0, ("PAM: Could not update all authentication token(s). No authentication tokens were updated.\n"));
+		ZERODEBUG(0, ("PAM: Could not update all authentication token(s). No authentication tokens were updated.\n"));
 		break;
 	case PAM_USER_UNKNOWN:
-		DEBUG(0, ("PAM: User not known to PAM\n"));
+		ZERODEBUG(0, ("PAM: User not known to PAM\n"));
 		break;
 	case PAM_SUCCESS:
 		DEBUG(4, ("PAM: Account OK for User: %s\n", user));
 		break;
 	default:
-		DEBUG(0, ("PAM: UNKNOWN PAM ERROR (%d) for User: %s\n", pam_error, user));
+		ZERODEBUG(0, ("PAM: UNKNOWN PAM ERROR (%d) for User: %s\n", pam_error, user));
 	}
  
 	if(!smb_pam_error_handler(pamh, pam_error, "Password Change Failed", 2)) {
@@ -795,7 +795,7 @@
 		return NT_STATUS_ACCOUNT_DISABLED;
 
 	if (!NT_STATUS_IS_OK(nt_status = smb_pam_account(pamh, user)))
-		DEBUG(0, ("smb_pam_accountcheck: PAM: Account Validation Failed - Rejecting User %s!\n", user));
+		ZERODEBUG(0, ("smb_pam_accountcheck: PAM: Account Validation Failed - Rejecting User %s!\n", user));
 
 	smb_pam_end(pamh, pconv);
 	return nt_status;
@@ -824,19 +824,19 @@
 		return NT_STATUS_LOGON_FAILURE;
 
 	if (!NT_STATUS_IS_OK(nt_status = smb_pam_auth(pamh, user))) {
-		DEBUG(0, ("smb_pam_passcheck: PAM: smb_pam_auth failed - Rejecting User %s !\n", user));
+		ZERODEBUG(0, ("smb_pam_passcheck: PAM: smb_pam_auth failed - Rejecting User %s !\n", user));
 		smb_pam_end(pamh, pconv);
 		return nt_status;
 	}
 
 	if (!NT_STATUS_IS_OK(nt_status = smb_pam_account(pamh, user))) {
-		DEBUG(0, ("smb_pam_passcheck: PAM: smb_pam_account failed - Rejecting User %s !\n", user));
+		ZERODEBUG(0, ("smb_pam_passcheck: PAM: smb_pam_account failed - Rejecting User %s !\n", user));
 		smb_pam_end(pamh, pconv);
 		return nt_status;
 	}
 
 	if (!NT_STATUS_IS_OK(nt_status = smb_pam_setcred(pamh, user))) {
-		DEBUG(0, ("smb_pam_passcheck: PAM: smb_pam_setcred failed - Rejecting User %s !\n", user));
+		ZERODEBUG(0, ("smb_pam_passcheck: PAM: smb_pam_setcred failed - Rejecting User %s !\n", user));
 		smb_pam_end(pamh, pconv);
 		return nt_status;
 	}
@@ -862,7 +862,7 @@
 		return False;
 
 	if (!smb_pam_chauthtok(pamh, user)) {
-		DEBUG(0, ("smb_pam_passchange: PAM: Password Change Failed for user %s!\n", user));
+		ZERODEBUG(0, ("smb_pam_passchange: PAM: Password Change Failed for user %s!\n", user));
 		smb_pam_end(pamh, pconv);
 		return False;
 	}
diff -Naur samba-2.2.12-orig/source/auth/pass_check.c samba-2.2.12/source/auth/pass_check.c
--- samba-2.2.12-orig/source/auth/pass_check.c	2004-08-12 20:24:23.000000000 +0200
+++ samba-2.2.12/source/auth/pass_check.c	2009-03-11 09:59:29.000000000 +0100
@@ -119,7 +119,7 @@
 	if (err != error_status_ok)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0, ("DCE can't get current context. %s\n", dce_errstr));
+		ZERODEBUG(0, ("DCE can't get current context. %s\n", dce_errstr));
 
 		return (False);
 	}
@@ -128,7 +128,7 @@
 	if (err != error_status_ok)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0, ("DCE can't get current context. %s\n", dce_errstr));
+		ZERODEBUG(0, ("DCE can't get current context. %s\n", dce_errstr));
 
 		return (False);
 	}
@@ -137,7 +137,7 @@
 	if (err != error_status_ok)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0, ("DCE can't get expiration. %s\n", dce_errstr));
+		ZERODEBUG(0, ("DCE can't get expiration. %s\n", dce_errstr));
 
 		return (False);
 	}
@@ -154,7 +154,7 @@
 		if (err != error_status_ok)
 		{
 			dce_error_inq_text(err, dce_errstr, &err2);
-			DEBUG(0, ("DCE can't get pwent. %s\n", dce_errstr));
+			ZERODEBUG(0, ("DCE can't get pwent. %s\n", dce_errstr));
 
 			return (False);
 		}
@@ -163,7 +163,7 @@
 		if (err != error_status_ok)
 		{
 			dce_error_inq_text(err, dce_errstr, &err2);
-			DEBUG(0, ("DCE can't refresh identity. %s\n",
+			ZERODEBUG(0, ("DCE can't refresh identity. %s\n",
 				  dce_errstr));
 
 			return (False);
@@ -176,7 +176,7 @@
 		if (err != error_status_ok)
 		{
 			dce_error_inq_text(err, dce_errstr, &err2);
-			DEBUG(0, ("DCE can't get key for %s. %s\n",
+			ZERODEBUG(0, ("DCE can't get key for %s. %s\n",
 				  pw->pw_name, dce_errstr));
 
 			return (False);
@@ -188,7 +188,7 @@
 		if (err != error_status_ok)
 		{
 			dce_error_inq_text(err, dce_errstr, &err2);
-			DEBUG(0,
+			ZERODEBUG(0,
 			      ("DCE can't validate and certify identity for %s. %s\n",
 			       pw->pw_name, dce_errstr));
 		}
@@ -197,7 +197,7 @@
 		if (err != error_status_ok)
 		{
 			dce_error_inq_text(err, dce_errstr, &err2);
-			DEBUG(0, ("DCE can't free key.\n", dce_errstr));
+			ZERODEBUG(0, ("DCE can't free key.\n", dce_errstr));
 		}
 	}
 
@@ -206,7 +206,7 @@
 				     &my_dce_sec_context, &err) == 0)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0, ("DCE Setup Identity for %s failed: %s\n",
+		ZERODEBUG(0, ("DCE Setup Identity for %s failed: %s\n",
 			  user, dce_errstr));
 		return (False);
 	}
@@ -216,7 +216,7 @@
 	if (err != error_status_ok)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0, ("DCE can't get pwent. %s\n", dce_errstr));
+		ZERODEBUG(0, ("DCE can't get pwent. %s\n", dce_errstr));
 
 		return (False);
 	}
@@ -225,7 +225,7 @@
 	if (err != error_status_ok)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0, ("DCE can't purge context. %s\n", dce_errstr));
+		ZERODEBUG(0, ("DCE can't purge context. %s\n", dce_errstr));
 
 		return (False);
 	}
@@ -249,7 +249,7 @@
 				     &my_dce_sec_context, &err) == 0)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0, ("DCE Setup Identity for %s failed: %s\n",
+		ZERODEBUG(0, ("DCE Setup Identity for %s failed: %s\n",
 			  user, dce_errstr));
 		goto err;
 	}
@@ -259,7 +259,7 @@
 	if (err != error_status_ok)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0, ("DCE can't get pwent. %s\n", dce_errstr));
+		ZERODEBUG(0, ("DCE can't get pwent. %s\n", dce_errstr));
 		goto err;
 	}
 
@@ -274,7 +274,7 @@
 	if (err != error_status_ok)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0,
+		ZERODEBUG(0,
 		      ("DCE Identity Validation failed for principal %s: %s\n",
 		       user, dce_errstr));
 		goto err;
@@ -284,20 +284,20 @@
 	if (err != error_status_ok)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0, ("DCE certify identity failed: %s\n", dce_errstr));
+		ZERODEBUG(0, ("DCE certify identity failed: %s\n", dce_errstr));
 		goto err;
 	}
 
 	if (auth_src != sec_login_auth_src_network)
 	{
-		DEBUG(0, ("DCE context has no network credentials.\n"));
+		ZERODEBUG(0, ("DCE context has no network credentials.\n"));
 	}
 
 	sec_login_set_context(my_dce_sec_context, &err);
 	if (err != error_status_ok)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0,
+		ZERODEBUG(0,
 		      ("DCE login failed for principal %s, cant set context: %s\n",
 		       user, dce_errstr));
 
@@ -310,11 +310,11 @@
 	if (err != error_status_ok)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0, ("DCE can't get pwent. %s\n", dce_errstr));
+		ZERODEBUG(0, ("DCE can't get pwent. %s\n", dce_errstr));
 		goto err;
 	}
 
-	DEBUG(0, ("DCE login succeeded for principal %s on pid %d\n",
+	ZERODEBUG(0, ("DCE login succeeded for principal %s on pid %d\n",
 		  user, sys_getpid()));
 
 	DEBUG(3, ("DCE principal: %s\n"
@@ -330,14 +330,14 @@
 	if (err != error_status_ok)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0, ("DCE can't get expiration. %s\n", dce_errstr));
+		ZERODEBUG(0, ("DCE can't get expiration. %s\n", dce_errstr));
 		goto err;
 	}
 
 	set_effective_uid(0);
 	set_effective_gid(0);
 
-	DEBUG(0,
+	ZERODEBUG(0,
 	      ("DCE context expires: %s", asctime(localtime(&expire_time))));
 
 	dcelogin_atmost_once = 1;
@@ -361,7 +361,7 @@
 	if (err != error_status_ok)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0,
+		ZERODEBUG(0,
 		      ("DCE purge login context failed for server instance %d: %s\n",
 		       sys_getpid(), dce_errstr));
 	}
diff -Naur samba-2.2.12-orig/source/client/client.c samba-2.2.12/source/client/client.c
--- samba-2.2.12-orig/source/client/client.c	2004-08-12 20:24:36.000000000 +0200
+++ samba-2.2.12/source/client/client.c	2009-03-11 13:51:50.000000000 +0100
@@ -166,7 +166,7 @@
 	int grp_id;
 
 	if (!cli_message_start(cli, desthost, username, &grp_id)) {
-		DEBUG(0,("message start: %s\n", cli_errstr(cli)));
+		ZERODEBUG(0,("message start: %s\n", cli_errstr(cli)));
 		return;
 	}
 
@@ -223,11 +223,11 @@
 	int total, bsize, avail;
 
 	if (!cli_dskattr(cli, &bsize, &total, &avail)) {
-		DEBUG(0,("Error in dskattr: %s\n",cli_errstr(cli))); 
+		ZERODEBUG(0,("Error in dskattr: %s\n",cli_errstr(cli))); 
 		return;
 	}
 
-	DEBUG(0,("\n\t\t%d blocks of size %d. %d blocks available\n",
+	ZERODEBUG(0,("\n\t\t%d blocks of size %d. %d blocks available\n",
 		 total, bsize, avail));
 }
 
@@ -236,8 +236,8 @@
 ****************************************************************************/
 static void cmd_pwd(void)
 {
-	DEBUG(0,("Current directory is %s",service));
-	DEBUG(0,("%s\n",cur_dir));
+	ZERODEBUG(0,("Current directory is %s",service));
+	ZERODEBUG(0,("%s\n",cur_dir));
 }
 
 
@@ -269,7 +269,7 @@
 	
 	if (!strequal(cur_dir,"\\")) {
 		if (!cli_chkpath(cli, dname)) {
-			DEBUG(0,("cd %s: %s\n", dname, cli_errstr(cli)));
+			ZERODEBUG(0,("cd %s: %s\n", dname, cli_errstr(cli)));
 			pstrcpy(cur_dir,saved_dir);
 		}
 	}
@@ -287,7 +287,7 @@
 	if (next_token(NULL,buf,NULL,sizeof(buf)))
 		do_cd(buf);
 	else
-		DEBUG(0,("Current directory is %s\n",cur_dir));
+		ZERODEBUG(0,("Current directory is %s\n",cur_dir));
 }
 
 
@@ -324,7 +324,7 @@
 {
 	if (do_this_one(finfo)) {
 		time_t t = finfo->mtime; /* the time is assumed to be passed as GMT */
-		DEBUG(0,("  %-30s%7.7s %8.0f  %s",
+		ZERODEBUG(0,("  %-30s%7.7s %8.0f  %s",
 			 finfo->name,
 			 attrib_string(finfo->mode),
 			 (double)finfo->size,
@@ -382,7 +382,7 @@
 	do_list_queue_size = 1024;
 	do_list_queue = malloc(do_list_queue_size);
 	if (do_list_queue == 0) { 
-		DEBUG(0,("malloc fail for size %d\n",
+		ZERODEBUG(0,("malloc fail for size %d\n",
 			 (int)do_list_queue_size));
 		reset_do_list_queue();
 	} else {
@@ -426,7 +426,7 @@
 			 (int)do_list_queue_size));
 		dlq = Realloc(do_list_queue, do_list_queue_size);
 		if (!dlq) {
-			DEBUG(0,("failure enlarging do_list_queue to %d bytes\n",
+			ZERODEBUG(0,("failure enlarging do_list_queue to %d bytes\n",
 				(int)do_list_queue_size));
 			reset_do_list_queue();
 		} else {
@@ -546,7 +546,7 @@
 						strlen(next_file) - 2;
 					*save_ch = '\0';
 				}
-				DEBUG(0,("\n%s\n",next_file));
+				ZERODEBUG(0,("\n%s\n",next_file));
 				if (save_ch)
 				{
 					*save_ch = '\\';
@@ -558,7 +558,7 @@
 	{
 		if (cli_list(cli, mask, attribute, do_list_helper, NULL) == -1)
 		{
-			DEBUG(0, ("%s listing %s\n", cli_errstr(cli), mask));
+			ZERODEBUG(0, ("%s listing %s\n", cli_errstr(cli), mask));
 		}
 	}
 
@@ -629,7 +629,7 @@
 
 	do_dskattr();
 
-	DEBUG(0, ("Total number of bytes: %.0f\n", dir_total));
+	ZERODEBUG(0, ("Total number of bytes: %.0f\n", dir_total));
 }
 
 
@@ -657,7 +657,7 @@
 	fnum = cli_open(cli, rname, O_RDONLY, DENY_NONE);
 
 	if (fnum == -1) {
-		DEBUG(0,("%s opening remote file %s\n",cli_errstr(cli),rname));
+		ZERODEBUG(0,("%s opening remote file %s\n",cli_errstr(cli),rname));
 		return;
 	}
 
@@ -668,7 +668,7 @@
 		newhandle = True;
 	}
 	if (handle < 0) {
-		DEBUG(0,("Error opening local file %s\n",lname));
+		ZERODEBUG(0,("Error opening local file %s\n",lname));
 		return;
 	}
 
@@ -676,7 +676,7 @@
 			   &attr, &old_size, NULL, NULL, NULL, NULL, NULL) &&
 	    !cli_getattrE(cli, fnum, 
 			  &attr, &size, NULL, NULL, NULL)) {
-		DEBUG(0,("getattrib: %s\n",cli_errstr(cli)));
+		ZERODEBUG(0,("getattrib: %s\n",cli_errstr(cli)));
 		return;
 	}
 
@@ -684,7 +684,7 @@
 		 rname, (double)size, lname));
 
 	if(!(data = (char *)malloc(read_size))) { 
-		DEBUG(0,("malloc fail for size %d\n", read_size));
+		ZERODEBUG(0,("malloc fail for size %d\n", read_size));
 		cli_close(cli, fnum);
 		return;
 	}
@@ -695,7 +695,7 @@
 		if (n <= 0) break;
  
 		if (writefile(handle,data, n) != n) {
-			DEBUG(0,("Error writing local file\n"));
+			ZERODEBUG(0,("Error writing local file\n"));
 			break;
 		}
       
@@ -703,14 +703,14 @@
 	}
 
 	if (nread < size) {
-		DEBUG (0, ("Short read when getting file %s. Only got %ld bytes.\n",
+		ZERODEBUG (0, ("Short read when getting file %s. Only got %ld bytes.\n",
                rname, (long)nread));
 	}
 
 	SAFE_FREE(data);
 	
 	if (!cli_close(cli, fnum)) {
-		DEBUG(0,("Error %s closing remote file\n",cli_errstr(cli)));
+		ZERODEBUG(0,("Error %s closing remote file\n",cli_errstr(cli)));
 	}
 
 	if (newhandle) {
@@ -754,7 +754,7 @@
 	p = rname + strlen(rname);
 	
 	if (!next_token(NULL,p,NULL,sizeof(rname)-strlen(rname))) {
-		DEBUG(0,("get <filename>\n"));
+		ZERODEBUG(0,("get <filename>\n"));
 		return;
 	}
 	pstrcpy(lname,p);
@@ -780,7 +780,7 @@
 		return;
 
 	if (abort_mget)	{
-		DEBUG(0,("mget aborted\n"));
+		ZERODEBUG(0,("mget aborted\n"));
 		return;
 	}
 
@@ -812,13 +812,13 @@
 	
 	if (!directory_exist(finfo->name,NULL) && 
 	    mkdir(finfo->name,0777) != 0) {
-		DEBUG(0,("failed to create directory %s\n",finfo->name));
+		ZERODEBUG(0,("failed to create directory %s\n",finfo->name));
 		pstrcpy(cur_dir,saved_curdir);
 		return;
 	}
 	
 	if (chdir(finfo->name) != 0) {
-		DEBUG(0,("failed to chdir to directory %s\n",finfo->name));
+		ZERODEBUG(0,("failed to chdir to directory %s\n",finfo->name));
 		pstrcpy(cur_dir,saved_curdir);
 		return;
 	}
@@ -847,13 +847,13 @@
 	slprintf(lname,sizeof(lname)-1, "%s/smbmore.XXXXXX",tmpdir());
 	fd = smb_mkstemp(lname);
 	if (fd == -1) {
-		DEBUG(0,("failed to create temporary file for more\n"));
+		ZERODEBUG(0,("failed to create temporary file for more\n"));
 		return;
 	}
 	close(fd);
 
 	if (!next_token(NULL,rname+strlen(rname),NULL,sizeof(rname)-strlen(rname))) {
-		DEBUG(0,("more <filename>\n"));
+		ZERODEBUG(0,("more <filename>\n"));
 		unlink(lname);
 		return;
 	}
@@ -916,7 +916,7 @@
 static BOOL do_mkdir(char *name)
 {
 	if (!cli_mkdir(cli, name)) {
-		DEBUG(0,("%s making remote directory %s\n",
+		ZERODEBUG(0,("%s making remote directory %s\n",
 			 cli_errstr(cli),name));
 		return(False);
 	}
@@ -932,10 +932,10 @@
 {
 	fstring altname;
 	if (!NT_STATUS_IS_OK(cli_qpathinfo_alt_name(cli, name, altname))) {
-		DEBUG(0,("%s getting alt name for %s\n", cli_errstr(cli),name));
+		ZERODEBUG(0,("%s getting alt name for %s\n", cli_errstr(cli),name));
 		return(False);
 	}
-	DEBUG(0,("%s\n", altname));
+	ZERODEBUG(0,("%s\n", altname));
 
 	return(True);
 }
@@ -963,7 +963,7 @@
 
 	if (!next_token(NULL,p,NULL,sizeof(buf))) {
 		if (!recurse)
-			DEBUG(0,("mkdir <dirname>\n"));
+			ZERODEBUG(0,("mkdir <dirname>\n"));
 		return;
 	}
 	pstrcat(mask,p);
@@ -1002,7 +1002,7 @@
 	pstrcpy(name,cur_dir);
 
 	if (!next_token(NULL,p,NULL,sizeof(buf))) {
-		DEBUG(0,("altname <file>\n"));
+		ZERODEBUG(0,("altname <file>\n"));
 		return;
 	}
 	pstrcat(name,p);
@@ -1027,7 +1027,7 @@
 	fnum = cli_open(cli, rname, O_RDWR|O_CREAT|O_TRUNC, DENY_NONE);
   
 	if (fnum == -1) {
-		DEBUG(0,("%s opening remote file %s\n",cli_errstr(cli),rname));
+		ZERODEBUG(0,("%s opening remote file %s\n",cli_errstr(cli),rname));
 		return;
 	}
 
@@ -1041,7 +1041,7 @@
 	}
 
 	if (!f) {
-		DEBUG(0,("Error opening local file %s\n",lname));
+		ZERODEBUG(0,("Error opening local file %s\n",lname));
 		return;
 	}
 
@@ -1051,7 +1051,7 @@
   
 	buf = (char *)malloc(maxwrite);
 	if (!buf) {
-		DEBUG(0, ("ERROR: Not enough memory!\n"));
+		ZERODEBUG(0, ("ERROR: Not enough memory!\n"));
 		return;
 	}
 	while (!feof(f)) {
@@ -1062,14 +1062,14 @@
 			if((n == 0) && feof(f))
 				break; /* Empty local file. */
 
-			DEBUG(0,("Error reading local file: %s\n", strerror(errno) ));
+			ZERODEBUG(0,("Error reading local file: %s\n", strerror(errno) ));
 			break;
 		}
 
 		ret = cli_write(cli, fnum, 0, buf, nread, n);
 
 		if (n != ret) {
-			DEBUG(0,("Error writing file: %s\n", cli_errstr(cli)));
+			ZERODEBUG(0,("Error writing file: %s\n", cli_errstr(cli)));
 			break;
 		} 
 
@@ -1077,7 +1077,7 @@
 	}
 
 	if (!cli_close(cli, fnum)) {
-		DEBUG(0,("%s closing remote file %s\n",cli_errstr(cli),rname));
+		ZERODEBUG(0,("%s closing remote file %s\n",cli_errstr(cli),rname));
 		fclose(f);
 		SAFE_FREE(buf);
 		return;
@@ -1125,7 +1125,7 @@
 	pstrcat(rname,"\\");
   
 	if (!next_token(NULL,p,NULL,sizeof(buf))) {
-		DEBUG(0,("put <filename>\n"));
+		ZERODEBUG(0,("put <filename>\n"));
 		return;
 	}
 	pstrcpy(lname,p);
@@ -1143,7 +1143,7 @@
 		   jdblair, 24.jun.98 */
 		if (!file_exist(lname,&st) &&
 		    (strcmp(lname,"-"))) {
-			DEBUG(0,("%s does not exist\n",lname));
+			ZERODEBUG(0,("%s does not exist\n",lname));
 			return;
 		}
 	}
@@ -1240,7 +1240,7 @@
 						ret = file_find(list, path, expression, False);
 					}
 				} else {
-					DEBUG(0,("file_find: cannot stat file %s\n", path));
+					ZERODEBUG(0,("file_find: cannot stat file %s\n", path));
 				}
 				
 				if (ret == -1) {
@@ -1251,7 +1251,7 @@
 			}
 			entry = (struct file_list *) malloc(sizeof (struct file_list));
 			if (!entry) {
-				DEBUG(0,("Out of memory in file_find\n"));
+				ZERODEBUG(0,("Out of memory in file_find\n"));
 				closedir(dir);
 				return -1;
 			}
@@ -1317,7 +1317,7 @@
 					dos_format(rname);
 					if (!cli_chkpath(cli, rname) && 
 					    !do_mkdir(rname)) {
-						DEBUG (0, ("Unable to make dir, skipping..."));
+						ZERODEBUG (0, ("Unable to make dir, skipping..."));
 						/* Skip the directory */
 						lname[strlen(lname)-1] = '/';
 						if (!seek_list(temp_list, lname))
@@ -1390,7 +1390,7 @@
 	char *p;
 
 	if (!next_token(NULL,lname,NULL, sizeof(lname))) {
-		DEBUG(0,("print <filename>\n"));
+		ZERODEBUG(0,("print <filename>\n"));
 		return;
 	}
 
@@ -1413,7 +1413,7 @@
 ****************************************************************************/
 static void queue_fn(struct print_job_info *p)
 {
-	DEBUG(0,("%-6d   %-9d    %s\n", (int)p->id, (int)p->size, p->name));
+	ZERODEBUG(0,("%-6d   %-9d    %s\n", (int)p->id, (int)p->size, p->name));
 }
 
 /****************************************************************************
@@ -1438,7 +1438,7 @@
 		return;
 
 	if (!cli_unlink(cli, mask)) {
-		DEBUG(0,("%s deleting remote file %s\n",cli_errstr(cli),mask));
+		ZERODEBUG(0,("%s deleting remote file %s\n",cli_errstr(cli),mask));
 	}
 }
 
@@ -1457,7 +1457,7 @@
 	pstrcpy(mask,cur_dir);
 	
 	if (!next_token(NULL,buf,NULL,sizeof(buf))) {
-		DEBUG(0,("del <filename>\n"));
+		ZERODEBUG(0,("del <filename>\n"));
 		return;
 	}
 	pstrcat(mask,buf);
@@ -1475,7 +1475,7 @@
 	pstrcpy(mask,cur_dir);
 	
 	if (!next_token(NULL,buf,NULL,sizeof(buf))) {
-		DEBUG(0,("open <filename>\n"));
+		ZERODEBUG(0,("open <filename>\n"));
 		return;
 	}
 	pstrcat(mask,buf);
@@ -1495,13 +1495,13 @@
 	pstrcpy(mask,cur_dir);
 	
 	if (!next_token(NULL,buf,NULL,sizeof(buf))) {
-		DEBUG(0,("rmdir <dirname>\n"));
+		ZERODEBUG(0,("rmdir <dirname>\n"));
 		return;
 	}
 	pstrcat(mask,buf);
 
 	if (!cli_rmdir(cli, mask)) {
-		DEBUG(0,("%s removing remote directory file %s\n",
+		ZERODEBUG(0,("%s removing remote directory file %s\n",
 			 cli_errstr(cli),mask));
 	}  
 }
@@ -1516,7 +1516,7 @@
 	fstring buf,buf2;
   
 	if (!SERVER_HAS_UNIX_CIFS(cli)) {
-		DEBUG(0,("Server doesn't support UNIX CIFS calls.\n"));
+		ZERODEBUG(0,("Server doesn't support UNIX CIFS calls.\n"));
 		return;
 	}
 
@@ -1525,7 +1525,7 @@
   
 	if (!next_token(NULL,buf,NULL,sizeof(buf)) || 
 	    !next_token(NULL,buf2,NULL, sizeof(buf2))) {
-		DEBUG(0,("link <src> <dest>\n"));
+		ZERODEBUG(0,("link <src> <dest>\n"));
 		return;
 	}
 
@@ -1533,7 +1533,7 @@
 	pstrcat(dest,buf2);
 
 	if (!cli_unix_hardlink(cli, src, dest)) {
-		DEBUG(0,("%s linking files (%s -> %s)\n",
+		ZERODEBUG(0,("%s linking files (%s -> %s)\n",
 			cli_errstr(cli), src, dest));
 		return;
 	}  
@@ -1549,7 +1549,7 @@
 	fstring buf,buf2;
   
 	if (!SERVER_HAS_UNIX_CIFS(cli)) {
-		DEBUG(0,("Server doesn't support UNIX CIFS calls.\n"));
+		ZERODEBUG(0,("Server doesn't support UNIX CIFS calls.\n"));
 		return;
 	}
 
@@ -1558,7 +1558,7 @@
 	
 	if (!next_token(NULL,buf,NULL,sizeof(buf)) || 
 	    !next_token(NULL,buf2,NULL, sizeof(buf2))) {
-		DEBUG(0,("symlink <src> <dest>\n"));
+		ZERODEBUG(0,("symlink <src> <dest>\n"));
 		return;
 	}
 
@@ -1566,7 +1566,7 @@
 	pstrcat(dest,buf2);
 
 	if (!cli_unix_symlink(cli, src, dest)) {
-		DEBUG(0,("%s symlinking files (%s -> %s)\n",
+		ZERODEBUG(0,("%s symlinking files (%s -> %s)\n",
 			cli_errstr(cli), src, dest));
 		return;
 	}  
@@ -1583,7 +1583,7 @@
 	fstring buf, buf2;
   
 	if (!SERVER_HAS_UNIX_CIFS(cli)) {
-		DEBUG(0,("Server doesn't support UNIX CIFS calls.\n"));
+		ZERODEBUG(0,("Server doesn't support UNIX CIFS calls.\n"));
 		return;
 	}
 
@@ -1591,7 +1591,7 @@
 	
 	if (!next_token(NULL,buf,NULL,sizeof(buf)) || 
 	    !next_token(NULL,buf2,NULL, sizeof(buf2))) {
-		DEBUG(0,("chmod mode file\n"));
+		ZERODEBUG(0,("chmod mode file\n"));
 		return;
 	}
 
@@ -1599,7 +1599,7 @@
 	pstrcat(src,buf2);
 
 	if (!cli_unix_chmod(cli, src, mode)) {
-		DEBUG(0,("%s chmod file %s 0%o\n",
+		ZERODEBUG(0,("%s chmod file %s 0%o\n",
 			cli_errstr(cli), src, (unsigned int)mode));
 		return;
 	}  
@@ -1617,7 +1617,7 @@
 	fstring buf, buf2, buf3;
   
 	if (!SERVER_HAS_UNIX_CIFS(cli)) {
-		DEBUG(0,("Server doesn't support UNIX CIFS calls.\n"));
+		ZERODEBUG(0,("Server doesn't support UNIX CIFS calls.\n"));
 		return;
 	}
 
@@ -1626,7 +1626,7 @@
 	if (!next_token(NULL,buf,NULL,sizeof(buf)) || 
 	    !next_token(NULL,buf2,NULL, sizeof(buf2)) ||
 	    !next_token(NULL,buf3,NULL, sizeof(buf3))) {
-		DEBUG(0,("chown uid gid file\n"));
+		ZERODEBUG(0,("chown uid gid file\n"));
 		return;
 	}
 
@@ -1635,7 +1635,7 @@
 	pstrcat(src,buf3);
 
 	if (!cli_unix_chown(cli, src, uid, gid)) {
-		DEBUG(0,("%s chown file %s uid=%d, gid=%d\n",
+		ZERODEBUG(0,("%s chown file %s uid=%d, gid=%d\n",
 			cli_errstr(cli), src, (int)uid, (int)gid));
 		return;
 	} 
@@ -1654,7 +1654,7 @@
 	
 	if (!next_token(NULL,buf,NULL,sizeof(buf)) || 
 	    !next_token(NULL,buf2,NULL, sizeof(buf2))) {
-		DEBUG(0,("rename <src> <dest>\n"));
+		ZERODEBUG(0,("rename <src> <dest>\n"));
 		return;
 	}
 
@@ -1662,7 +1662,7 @@
 	pstrcat(dest,buf2);
 
 	if (!cli_rename(cli, src, dest)) {
-		DEBUG(0,("%s renaming files\n",cli_errstr(cli)));
+		ZERODEBUG(0,("%s renaming files\n",cli_errstr(cli)));
 		return;
 	}  
 }
@@ -1697,7 +1697,7 @@
 	}
 
 	if (ok && newer_than == 0)
-		DEBUG(0,("Error setting newer-than time\n"));
+		ZERODEBUG(0,("Error setting newer-than time\n"));
 }
 
 /****************************************************************************
@@ -1710,7 +1710,7 @@
 	if (next_token(NULL,buf,NULL,sizeof(buf))) {
 		archive_level = atoi(buf);
 	} else
-		DEBUG(0,("Archive level is %d\n",archive_level));
+		ZERODEBUG(0,("Archive level is %d\n",archive_level));
 }
 
 /****************************************************************************
@@ -1975,14 +1975,14 @@
 	
 	if (next_token(NULL,buf,NULL,sizeof(buf))) {
 		if ((i = process_tok(buf)) >= 0)
-			DEBUG(0,("HELP %s:\n\t%s\n\n",commands[i].name,commands[i].description));		    
+			ZERODEBUG(0,("HELP %s:\n\t%s\n\n",commands[i].name,commands[i].description));		    
 	} else {
 		while (commands[i].description) {
 			for (j=0; commands[i].description && (j<5); j++) {
-				DEBUG(0,("%-15s",commands[i].name));
+				ZERODEBUG(0,("%-15s",commands[i].name));
 				i++;
 			}
-			DEBUG(0,("\n"));
+			ZERODEBUG(0,("\n"));
 		}
 	}
 }
@@ -2026,9 +2026,9 @@
 		if ((i = process_tok(tok)) >= 0) {
 			commands[i].fn();
 		} else if (i == -2) {
-			DEBUG(0,("%s: command abbreviation ambiguous\n",tok));
+			ZERODEBUG(0,("%s: command abbreviation ambiguous\n",tok));
 		} else {
-			DEBUG(0,("%s: command not found\n",tok));
+			ZERODEBUG(0,("%s: command not found\n",tok));
 		}
 	}
 }	
@@ -2137,9 +2137,9 @@
 		if ((i = process_tok(tok)) >= 0) {
 			commands[i].fn();
 		} else if (i == -2) {
-			DEBUG(0,("%s: command abbreviation ambiguous\n",tok));
+			ZERODEBUG(0,("%s: command abbreviation ambiguous\n",tok));
 		} else {
-			DEBUG(0,("%s: command not found\n",tok));
+			ZERODEBUG(0,("%s: command not found\n",tok));
 		}
 	}
 }
@@ -2182,7 +2182,7 @@
 	/* have to open a new connection */
 	if (!(c=cli_initialise(NULL)) || (cli_set_port(c, port) == 0) ||
 	    !cli_connect(c, server_n, &ip)) {
-		DEBUG(0,("Connection to %s failed\n", server_n));
+		ZERODEBUG(0,("Connection to %s failed\n", server_n));
 		return NULL;
 	}
 
@@ -2192,7 +2192,7 @@
 
 	if (!cli_session_request(c, &calling, &called)) {
 		char *p;
-		DEBUG(0,("session request to %s failed (%s)\n", 
+		ZERODEBUG(0,("session request to %s failed (%s)\n", 
 			 called.name, cli_errstr(c)));
 		cli_shutdown(c);
 		if ((p=strchr(called.name, '.'))) {
@@ -2209,7 +2209,7 @@
 	DEBUG(4,(" session request ok\n"));
 
 	if (!cli_negprot(c)) {
-		DEBUG(0,("protocol negotiation failed\n"));
+		ZERODEBUG(0,("protocol negotiation failed\n"));
 		cli_shutdown(c);
 		return NULL;
 	}
@@ -2228,11 +2228,11 @@
 		/* if a password was not supplied then try again with a null username */
 		if (password[0] || !username[0] || 
 		    !cli_session_setup(c, "", "", 0, "", 0, workgroup)) { 
-			DEBUG(0,("session setup failed: %s\n", cli_errstr(c)));
+			ZERODEBUG(0,("session setup failed: %s\n", cli_errstr(c)));
 			cli_shutdown(c);
 			return NULL;
 		}
-		DEBUG(0,("Anonymous login successful\n"));
+		ZERODEBUG(0,("Anonymous login successful\n"));
 	}
 
 	/*
@@ -2251,7 +2251,7 @@
 
 	if (!cli_send_tconX(c, sharename, "?????",
 			    password, strlen(password)+1)) {
-		DEBUG(0,("tree connect failed: %s\n", cli_errstr(c)));
+		ZERODEBUG(0,("tree connect failed: %s\n", cli_errstr(c)));
 		cli_shutdown(c);
 		return NULL;
 	}
@@ -2289,34 +2289,33 @@
 ****************************************************************************/
 static void usage(char *pname)
 {
-  DEBUG(0,("Usage: %s service <password> [options]", pname));
+  ZERODEBUG(0,("Usage: %s service <password> [options]", pname));
 
-  DEBUG(0,("\nVersion %s\n",VERSION));
-  DEBUG(0,("\t-s smb.conf           pathname to smb.conf file\n"));
-  DEBUG(0,("\t-O socket_options     socket options to use\n"));
-  DEBUG(0,("\t-R name resolve order use these name resolution services only\n"));
-  DEBUG(0,("\t-M host               send a winpopup message to the host\n"));
-  DEBUG(0,("\t-i scope              use this NetBIOS scope\n"));
-  DEBUG(0,("\t-N                    don't ask for a password\n"));
-  DEBUG(0,("\t-n netbios name.      Use this name as my netbios name\n"));
-  DEBUG(0,("\t-d debuglevel         set the debuglevel\n"));
-  DEBUG(0,("\t-P                    connect to service as a printer\n"));
-  DEBUG(0,("\t-p port               connect to the specified port\n"));
-  DEBUG(0,("\t-l log basename.      Basename for log/debug files\n"));
-  DEBUG(0,("\t-h                    Print this help message.\n"));
-  DEBUG(0,("\t-I dest IP            use this IP to connect to\n"));
-  DEBUG(0,("\t-E                    write messages to stderr instead of stdout\n"));
-  DEBUG(0,("\t-U username           set the network username\n"));
-  DEBUG(0,("\t-L host               get a list of shares available on a host\n"));
-  DEBUG(0,("\t-t terminal code      terminal i/o code {sjis|euc|jis7|jis8|junet|hex}\n"));
-  DEBUG(0,("\t-m max protocol       set the max protocol level\n"));
-  DEBUG(0,("\t-A filename           get the credentials from a file\n"));
-  DEBUG(0,("\t-W workgroup          set the workgroup name\n"));
-  DEBUG(0,("\t-T<c|x>IXFqgbNan      command line tar\n"));
-  DEBUG(0,("\t-D directory          start from directory\n"));
-  DEBUG(0,("\t-c command string     execute semicolon separated commands\n"));
-  DEBUG(0,("\t-b xmit/send buffer   changes the transmit/send buffer (default: 65520)\n"));
-  DEBUG(0,("\n"));
+  ZERODEBUG(0,("\nVersion %s\n",VERSION));
+  ZERODEBUG(0,("\t-s smb.conf           pathname to smb.conf file\n"));
+  ZERODEBUG(0,("\t-O socket_options     socket options to use\n"));
+  ZERODEBUG(0,("\t-R name resolve order use these name resolution services only\n"));
+  ZERODEBUG(0,("\t-M host               send a winpopup message to the host\n"));
+  ZERODEBUG(0,("\t-i scope              use this NetBIOS scope\n"));
+  ZERODEBUG(0,("\t-N                    don't ask for a password\n"));
+  ZERODEBUG(0,("\t-n netbios name.      Use this name as my netbios name\n"));
+  ZERODEBUG(0,("\t-P                    connect to service as a printer\n"));
+  ZERODEBUG(0,("\t-p port               connect to the specified port\n"));
+  ZERODEBUG(0,("\t-l log basename.      Basename for log/debug files\n"));
+  ZERODEBUG(0,("\t-h                    Print this help message.\n"));
+  ZERODEBUG(0,("\t-I dest IP            use this IP to connect to\n"));
+  ZERODEBUG(0,("\t-E                    write messages to stderr instead of stdout\n"));
+  ZERODEBUG(0,("\t-U username           set the network username\n"));
+  ZERODEBUG(0,("\t-L host               get a list of shares available on a host\n"));
+  ZERODEBUG(0,("\t-t terminal code      terminal i/o code {sjis|euc|jis7|jis8|junet|hex}\n"));
+  ZERODEBUG(0,("\t-m max protocol       set the max protocol level\n"));
+  ZERODEBUG(0,("\t-A filename           get the credentials from a file\n"));
+  ZERODEBUG(0,("\t-W workgroup          set the workgroup name\n"));
+  ZERODEBUG(0,("\t-T<c|x>IXFqgbNan      command line tar\n"));
+  ZERODEBUG(0,("\t-D directory          start from directory\n"));
+  ZERODEBUG(0,("\t-c command string     execute semicolon separated commands\n"));
+  ZERODEBUG(0,("\t-b xmit/send buffer   changes the transmit/send buffer (default: 65520)\n"));
+  ZERODEBUG(0,("\n"));
 }
 
 
@@ -2443,18 +2442,18 @@
 	else if (name_type != 0x20) {
 		/* We must do our own resolve name here as the nametype is #0x3, not #0x20. */
 		if (!resolve_name(desthost, &ip, name_type)) {
-			DEBUG(0,("Cannot resolve name %s#0x%x\n", desthost, name_type));
+			ZERODEBUG(0,("Cannot resolve name %s#0x%x\n", desthost, name_type));
 			return 1;
 		}
 	}
 
 	if (!(cli=cli_initialise(NULL)) || (cli_set_port(cli, port) == 0) || !cli_connect(cli, desthost, &ip)) {
-		DEBUG(0,("Connection to %s failed\n", desthost));
+		ZERODEBUG(0,("Connection to %s failed\n", desthost));
 		return 1;
 	}
 
 	if (!cli_session_request(cli, &calling, &called)) {
-		DEBUG(0,("session request failed\n"));
+		ZERODEBUG(0,("session request failed\n"));
 		cli_shutdown(cli);
 		return 1;
 	}
@@ -2497,7 +2496,7 @@
 
 	*new_name_resolve_order = 0;
 
-	DEBUGLEVEL = 2;
+	DEBUGLEVEL = 0;
 	AllowDebugChange = False;
  
 	setup_logging(pname,True);
@@ -2527,17 +2526,17 @@
 		else if(strncmp(argv[opt], "-d", 2) == 0) {
 			if(argv[opt][2] != '\0') {
 				if (argv[opt][2] == 'A')
-					DEBUGLEVEL = 10000;
+					DEBUGLEVEL = 0;
 				else
-					DEBUGLEVEL = atoi(&argv[opt][2]);
+					DEBUGLEVEL = 0;
 			} else if(argv[opt+1] != NULL) {
 				/*
 				 * At least one more arg left.
 				 */
 				if (argv[opt+1][0] == 'A')
-					DEBUGLEVEL = 10000;
+					DEBUGLEVEL = 0;
 				else
-					DEBUGLEVEL = atoi(argv[opt+1]);
+					DEBUGLEVEL = 0;
 			} else {
 				usage(pname);
 				exit(1);
@@ -2628,7 +2627,7 @@
 	}
 
 	while ((opt = 
-		getopt(argc, argv,"s:O:R:M:i:Nn:d:Pp:l:hI:EU:L:t:m:W:T:D:c:b:A:z:")) != EOF) {
+		getopt(argc, argv,"s:O:R:M:i:Nn:Pp:l:hI:EU:L:t:m:W:T:D:c:b:A:z:")) != EOF) {
 		switch (opt) {
 		case 'z':
 			timeout_msec = atoi(optarg);
@@ -2662,9 +2661,9 @@
 			break;
 		case 'd':
 			if (*optarg == 'A')
-				DEBUGLEVEL = 10000;
+				DEBUGLEVEL = 0;
 			else
-				DEBUGLEVEL = atoi(optarg);
+				DEBUGLEVEL = 0;
 			break;
 		case 'P':
 			/* not needed anymore */
@@ -2714,7 +2713,7 @@
 	                        if ((auth=sys_fopen(optarg, "r")) == NULL)
 				{
 					/* fail if we can't open the credentials file */
-					DEBUG(0,("ERROR: Unable to open credentials file!\n"));
+					ZERODEBUG(0,("ERROR: Unable to open credentials file!\n"));
 					exit (-1);
 				}
                                 
diff -Naur samba-2.2.12-orig/source/client/clitar.c samba-2.2.12/source/client/clitar.c
--- samba-2.2.12-orig/source/client/clitar.c	2004-08-12 20:24:36.000000000 +0200
+++ samba-2.2.12/source/client/clitar.c	2009-03-11 09:59:30.000000000 +0100
@@ -157,7 +157,7 @@
 
   if (tmp == NULL) {
 
-    DEBUG(0, ("Out of memory in string_create_s\n"));
+    ZERODEBUG(0, ("Out of memory in string_create_s\n"));
 
   }
 
@@ -185,7 +185,7 @@
 	  char *b;
 	  b = (char *)malloc(l+TBLOCK+100);
 	  if (!b) {
-		  DEBUG(0,("out of memory\n"));
+		  ZERODEBUG(0,("out of memory\n"));
 		  exit(1);
 	  }
 	  writetarheader(f, "/./@LongLink", l+2, 0, "     0 \0", 'L');
@@ -256,14 +256,14 @@
 
   if (fchk != chk)
     {
-      DEBUG(0, ("checksums don't match %ld %ld\n", fchk, chk));
+      ZERODEBUG(0, ("checksums don't match %ld %ld\n", fchk, chk));
       dump_data(5, (char *)hb - TBLOCK, TBLOCK *3);
       return -1;
     }
 
   if ((finfo->name = string_create_s(strlen(prefix) + strlen(hb -> dbuf.name) + 3)) == NULL) {
 
-    DEBUG(0, ("Out of space creating file_info2 for %s\n", hb -> dbuf.name));
+    ZERODEBUG(0, ("Out of space creating file_info2 for %s\n", hb -> dbuf.name));
     return(-1);
 
   }
@@ -286,7 +286,7 @@
             the buffer pointer, etc */
 
       } else {
-        DEBUG(0, ("this tar file appears to contain some kind of link other than a GNUtar Longlink - ignoring\n"));
+        ZERODEBUG(0, ("this tar file appears to contain some kind of link other than a GNUtar Longlink - ignoring\n"));
         return -2;
       }
     }
@@ -406,7 +406,7 @@
 
   if (sys_fstat(f, &stbuf) == -1)
     {
-      DEBUG(0, ("Couldn't stat file handle\n"));
+      ZERODEBUG(0, ("Couldn't stat file handle\n"));
       return;
     }
 
@@ -539,7 +539,7 @@
 
   if ((partpath == NULL) || (ffname == NULL)){
 
-    DEBUG(0, ("Out of memory in ensurepath: %s\n", fname));
+    ZERODEBUG(0, ("Out of memory in ensurepath: %s\n", fname));
     return(False);
 
   }
@@ -565,7 +565,7 @@
       if (!cli_chkpath(cli, partpath)) {
 	if (!cli_mkdir(cli, partpath))
 	  {
-	    DEBUG(0, ("Error mkdirhiering\n"));
+	    ZERODEBUG(0, ("Error mkdirhiering\n"));
 	    return False;
 	  }
 	else
@@ -672,21 +672,21 @@
   dos_clean_name(rname);
 
   if (fnum == -1) {
-	  DEBUG(0,("%s opening remote file %s (%s)\n",
+	  ZERODEBUG(0,("%s opening remote file %s (%s)\n",
 		   cli_errstr(cli),rname, cur_dir));
 	  return;
   }
 
   finfo.name = string_create_s(strlen(rname));
   if (finfo.name == NULL) {
-	  DEBUG(0, ("Unable to allocate space for finfo.name in do_atar\n"));
+	  ZERODEBUG(0, ("Unable to allocate space for finfo.name in do_atar\n"));
 	  return;
   }
 
   safe_strcpy(finfo.name,rname, strlen(rname));
   if (!finfo1) {
 	  if (!cli_getattrE(cli, fnum, &finfo.mode, &finfo.size, NULL, &finfo.atime, &finfo.mtime)) {
-		  DEBUG(0, ("getattrE: %s\n", cli_errstr(cli)));
+		  ZERODEBUG(0, ("getattrE: %s\n", cli_errstr(cli)));
 		  return;
 	  }
 	  finfo.ctime = finfo.mtime;
@@ -726,7 +726,7 @@
 	      datalen = cli_read(cli, fnum, data, nread, read_size);
 	      
 	      if (datalen == -1) {
-		      DEBUG(0,("Error reading file %s : %s\n", rname, cli_errstr(cli)));
+		      ZERODEBUG(0,("Error reading file %s : %s\n", rname, cli_errstr(cli)));
 		      break;
 	      }
 	      
@@ -738,18 +738,18 @@
 
 		  if (nread > finfo.size) {
 			datalen -= nread - finfo.size;
-			DEBUG(0,("File size change - truncating %s to %.0f bytes\n", finfo.name, (double)finfo.size));
+			ZERODEBUG(0,("File size change - truncating %s to %.0f bytes\n", finfo.name, (double)finfo.size));
 		  }
 
 	      /* add received bits of file to buffer - dotarbuf will
 	       * write out in 512 byte intervals */
 	      if (dotarbuf(tarhandle,data,datalen) != datalen) {
-		      DEBUG(0,("Error writing to tar file - %s\n", strerror(errno)));
+		      ZERODEBUG(0,("Error writing to tar file - %s\n", strerror(errno)));
 		      break;
 	      }
 	      
 	      if (datalen == 0) {
-		      DEBUG(0,("Error reading file %s. Got 0 bytes\n", rname));
+		      ZERODEBUG(0,("Error reading file %s. Got 0 bytes\n", rname));
 		      break;
 	      }
 
@@ -758,9 +758,9 @@
 
       /* pad tar file with zero's if we couldn't get entire file */
       if (nread < finfo.size) {
-	      DEBUG(0, ("Didn't get entire file. size=%.0f, nread=%.0f\n", (double)finfo.size, (double)nread));
+	      ZERODEBUG(0, ("Didn't get entire file. size=%.0f, nread=%.0f\n", (double)finfo.size, (double)nread));
 	      if (padit(data, sizeof(data), finfo.size - nread))
-		      DEBUG(0,("Error writing tar file - %s\n", strerror(errno)));
+		      ZERODEBUG(0,("Error writing tar file - %s\n", strerror(errno)));
       }
 
       /* round tar file to nearest block */
@@ -791,7 +791,7 @@
 
       if (tar_noisy)
 	{
-	  DEBUG(0, ("%12.0f (%7.1f kb/s) %s\n",
+	  ZERODEBUG(0, ("%12.0f (%7.1f kb/s) %s\n",
 	       (double)finfo.size, finfo.size / MAX(0.001, (1.024*this_time)),
                finfo.name));
 	}
@@ -856,7 +856,7 @@
        * 40755 */
       writetarheader(tarhandle, cur_dir, 0, finfo->mtime, "040755 \0", '5');
       if (tar_noisy) {
-          DEBUG(0,("                directory %s\n", cur_dir));
+          ZERODEBUG(0,("                directory %s\n", cur_dir));
       }
       ntarf++;  /* Make sure we have a file on there */
       safe_strcpy(mtar_mask,cur_dir, sizeof(pstring));
@@ -980,7 +980,7 @@
 
     if (next_block(tarbuf, &buffer_p, tbufsiz) <= 0) {
 
-	DEBUG(0, ("Empty file, short tar file, or read error: %s\n", strerror(errno)));
+	ZERODEBUG(0, ("Empty file, short tar file, or read error: %s\n", strerror(errno)));
 	return(False);
 
     }
@@ -1007,7 +1007,7 @@
 
   if (ensurepath(finfo.name) && 
       (fnum=cli_open(cli, finfo.name, O_RDWR|O_CREAT|O_TRUNC, DENY_NONE)) == -1) {
-      DEBUG(0, ("abandoning restore\n"));
+      ZERODEBUG(0, ("abandoning restore\n"));
       return(False);
   }
 
@@ -1024,7 +1024,7 @@
     DEBUG(5, ("writing %i bytes, bpos = %i ...\n", dsize, bpos));
 
     if (cli_write(cli, fnum, 0, buffer_p + bpos, pos, dsize) != dsize) {
-	    DEBUG(0, ("Error writing remote file\n"));
+	    ZERODEBUG(0, ("Error writing remote file\n"));
 	    return 0;
     }
 
@@ -1044,7 +1044,7 @@
       bpos = 0;
 
       if (next_block(tarbuf, &buffer_p, tbufsiz) <=0) {  /* and skip the block */
-	DEBUG(0, ("Empty file, short tar file, or read error: %s\n", strerror(errno)));
+	ZERODEBUG(0, ("Empty file, short tar file, or read error: %s\n", strerror(errno)));
 	return False;
 
       }
@@ -1063,7 +1063,7 @@
          ((rsize == 0) && (dsize > TBLOCK))) {
 
       if (next_block(tarbuf, &buffer_p, tbufsiz) <=0) {
-	DEBUG(0, ("Empty file, short tar file, or read error: %s\n", strerror(errno)));
+	ZERODEBUG(0, ("Empty file, short tar file, or read error: %s\n", strerror(errno)));
 	return False;
       }
 
@@ -1077,7 +1077,7 @@
   /* Now close the file ... */
 
   if (!cli_close(cli, fnum)) {
-	  DEBUG(0, ("Error closing remote file\n"));
+	  ZERODEBUG(0, ("Error closing remote file\n"));
 	  return(False);
   }
 
@@ -1087,14 +1087,14 @@
 
   if (!cli_setatr(cli, finfo.name, finfo.mode, finfo.mtime)) {
 	  if (tar_real_noisy) {
-		  DEBUG(0, ("Could not set time on file: %s\n", finfo.name));
+		  ZERODEBUG(0, ("Could not set time on file: %s\n", finfo.name));
 		  /*return(False); */ /* Ignore, as Win95 does not allow changes */
 	  }
   }
 
   ntarf++;
 
-  DEBUG(0, ("restore tar file %s of size %.0f bytes\n", finfo.name, (double)finfo.size));
+  ZERODEBUG(0, ("restore tar file %s of size %.0f bytes\n", finfo.name, (double)finfo.size));
   
   return(True);
 }
@@ -1105,11 +1105,11 @@
 static int get_dir(file_info2 finfo)
 {
 
-  DEBUG(0, ("restore directory %s\n", finfo.name));
+  ZERODEBUG(0, ("restore directory %s\n", finfo.name));
 
   if (!ensurepath(finfo.name)) {
 
-    DEBUG(0, ("Problems creating directory\n"));
+    ZERODEBUG(0, ("Problems creating directory\n"));
     return(False);
 
   }
@@ -1134,7 +1134,7 @@
 
   if (longname == NULL) {
 
-    DEBUG(0, ("could not allocate buffer of size %d for longname\n", 
+    ZERODEBUG(0, ("could not allocate buffer of size %d for longname\n", 
 	      namesize));
     return(NULL);
   }
@@ -1152,7 +1152,7 @@
 
     if (next_block(tarbuf, &buffer_p, tbufsiz) <= 0) {
 
-      DEBUG(0, ("Empty file, short tar file, or read error: %s\n", strerror(errno)));
+      ZERODEBUG(0, ("Empty file, short tar file, or read error: %s\n", strerror(errno)));
       return(NULL);
 
     }
@@ -1190,7 +1190,7 @@
 
     if (next_block(tarbuf, &buffer_p, tbufsiz) <= 0) {
 
-      DEBUG(0, ("Empty file, short tar file, or read error: %s\n", strerror(errno)));
+      ZERODEBUG(0, ("Empty file, short tar file, or read error: %s\n", strerror(errno)));
 
       return;
 
@@ -1201,11 +1201,11 @@
     switch (readtarheader((union hblock *) buffer_p, &finfo, cur_dir)) {
 
     case -2:    /* Hmm, not good, but not fatal */
-      DEBUG(0, ("Skipping %s...\n", finfo.name));
+      ZERODEBUG(0, ("Skipping %s...\n", finfo.name));
       if ((next_block(tarbuf, &buffer_p, tbufsiz) <= 0) &&
           !skip_file(finfo.size)) {
 
-	DEBUG(0, ("Short file, bailing out...\n"));
+	ZERODEBUG(0, ("Short file, bailing out...\n"));
 	return;
 
       }
@@ -1213,11 +1213,11 @@
       break;
 
     case -1:
-      DEBUG(0, ("abandoning restore, -1 from read tar header\n"));
+      ZERODEBUG(0, ("abandoning restore, -1 from read tar header\n"));
       return;
 
     case 0: /* chksum is zero - looks like an EOF */
-      DEBUG(0, ("tar: restored %d files and directories\n", ntarf));
+      ZERODEBUG(0, ("tar: restored %d files and directories\n", ntarf));
       return;        /* Hmmm, bad here ... */
 
     default: 
@@ -1273,11 +1273,11 @@
        */
 
       if ((finfo.size != 0) && next_block(tarbuf, &buffer_p, tbufsiz) <=0) {
-	DEBUG(0, ("Short file, bailing out...\n"));
+	ZERODEBUG(0, ("Short file, bailing out...\n"));
 	return;
       }
       if (!get_file(finfo)) {
-	DEBUG(0, ("Abandoning restore\n"));
+	ZERODEBUG(0, ("Abandoning restore\n"));
 	return;
 
       }
@@ -1285,7 +1285,7 @@
 
     case '5':
       if (!get_dir(finfo)) {
-	DEBUG(0, ("Abandoning restore \n"));
+	ZERODEBUG(0, ("Abandoning restore \n"));
 	return;
       }
       break;
@@ -1293,7 +1293,7 @@
     case 'L':
       longfilename = get_longfilename(finfo);
       if (!longfilename) {
-	DEBUG(0, ("abandoning restore\n"));
+	ZERODEBUG(0, ("abandoning restore\n"));
 	return;
 
       }
@@ -1326,14 +1326,14 @@
 
   if (!next_token(NULL,buf,NULL,sizeof(buf)))
     {
-      DEBUG(0, ("blocksize <n>\n"));
+      ZERODEBUG(0, ("blocksize <n>\n"));
       return;
     }
 
   block=atoi(buf);
   if (block < 0 || block > 65535)
     {
-      DEBUG(0, ("blocksize out of range"));
+      ZERODEBUG(0, ("blocksize out of range"));
       return;
     }
 
@@ -1369,10 +1369,10 @@
       tar_noisy=True;
     else if (strequal(buf, "quiet") || strequal(buf, "noverbose"))
       tar_noisy=False;
-    else DEBUG(0, ("tarmode: unrecognised option %s\n", buf));
+    else ZERODEBUG(0, ("tarmode: unrecognised option %s\n", buf));
   }
 
-  DEBUG(0, ("tarmode is now %s, %s, %s, %s, %s\n",
+  ZERODEBUG(0, ("tarmode is now %s, %s, %s, %s, %s\n",
 	    tar_inc ? "incremental" : "full",
 	    tar_system ? "system" : "nosystem",
 	    tar_hidden ? "hidden" : "nohidden",
@@ -1396,7 +1396,7 @@
 
   if (!next_token(NULL,buf,NULL,sizeof(buf)))
     {
-      DEBUG(0, ("setmode <filename> <[+|-]rsha>\n"));
+      ZERODEBUG(0, ("setmode <filename> <[+|-]rsha>\n"));
       return;
     }
 
@@ -1420,14 +1420,14 @@
 	break;
       case 'a': attra[direct]|=aARCH;
 	break;
-      default: DEBUG(0, ("setmode <filename> <perm=[+|-]rsha>\n"));
+      default: ZERODEBUG(0, ("setmode <filename> <perm=[+|-]rsha>\n"));
 	return;
       }
   }
 
   if (attra[ATTRSET]==0 && attra[ATTRRESET]==0)
     {
-      DEBUG(0, ("setmode <filename> <[+|-]rsha>\n"));
+      ZERODEBUG(0, ("setmode <filename> <[+|-]rsha>\n"));
       return;
     }
 
@@ -1447,7 +1447,7 @@
 
   if (!next_token(NULL,buf,NULL,sizeof(buf)))
     {
-      DEBUG(0,("tar <c|x>[IXbgan] <filename>\n"));
+      ZERODEBUG(0,("tar <c|x>[IXbgan] <filename>\n"));
       return;
     }
 
@@ -1526,8 +1526,8 @@
     close(tarhandle);
     SAFE_FREE(tarbuf);
     
-    DEBUG(0, ("tar: dumped %d files and directories\n", ntarf));
-    DEBUG(0, ("Total bytes written: %.0f\n", (double)ttarf));
+    ZERODEBUG(0, ("tar: dumped %d files and directories\n", ntarf));
+    ZERODEBUG(0, ("Total bytes written: %.0f\n", (double)ttarf));
     break;
   }
 
@@ -1589,7 +1589,7 @@
     /* XXX It would be better to include a reason for failure, but without
      * autoconf, it's hard to use strerror, sys_errlist, etc.
      */
-    DEBUG(0,("Unable to open inclusion file %s\n", filename));
+    ZERODEBUG(0,("Unable to open inclusion file %s\n", filename));
     return 0;
   }
 
@@ -1597,7 +1597,7 @@
     if (inclusion_buffer == NULL) {
       inclusion_buffer_size = 1024;
       if ((inclusion_buffer = malloc(inclusion_buffer_size)) == NULL) {
-	DEBUG(0,("failure allocating buffer to read inclusion file\n"));
+	ZERODEBUG(0,("failure allocating buffer to read inclusion file\n"));
 	error = 1;
 	break;
       }
@@ -1612,7 +1612,7 @@
       inclusion_buffer_size *= 2;
       ib = Realloc(inclusion_buffer,inclusion_buffer_size);
       if (! ib) {
-        DEBUG(0,("failure enlarging inclusion buffer to %d bytes\n", inclusion_buffer_size));
+        ZERODEBUG(0,("failure enlarging inclusion buffer to %d bytes\n", inclusion_buffer_size));
         error = 1;
         break;
       } else
@@ -1629,7 +1629,7 @@
     /* Allocate an array of clipn + 1 char*'s for cliplist */
     cliplist = malloc((clipn + 1) * sizeof(char *));
     if (cliplist == NULL) {
-      DEBUG(0,("failure allocating memory for cliplist\n"));
+      ZERODEBUG(0,("failure allocating memory for cliplist\n"));
       error = 1;
     } else {
       cliplist[clipn] = NULL;
@@ -1639,13 +1639,13 @@
 	 * malloc fails below. */
 	cliplist[i] = NULL;
 	if ((tmpstr = (char *)malloc(strlen(p)+1)) == NULL) {
-	  DEBUG(0, ("Could not allocate space for a cliplist item, # %i\n", i));
+	  ZERODEBUG(0, ("Could not allocate space for a cliplist item, # %i\n", i));
 	  error = 1;
 	} else {
 	  unfixtarname(tmpstr, p, strlen(p) + 1, True);
 	  cliplist[i] = tmpstr;
 	  if ((p = strchr(p, '\000')) == NULL) {
-	    DEBUG(0,("INTERNAL ERROR: inclusion_buffer is of unexpected contents.\n"));
+	    ZERODEBUG(0,("INTERNAL ERROR: inclusion_buffer is of unexpected contents.\n"));
 	    abort();
 	  }
 	}
@@ -1704,7 +1704,7 @@
       break;
     case 'b':
       if (Optind>=argc || !(blocksize=atoi(argv[Optind]))) {
-	DEBUG(0,("Option b must be followed by valid blocksize\n"));
+	ZERODEBUG(0,("Option b must be followed by valid blocksize\n"));
 	return 0;
       } else {
 	Optind++;
@@ -1715,7 +1715,7 @@
       break;
     case 'N':
       if (Optind>=argc) {
-	DEBUG(0,("Option N must be followed by valid file name\n"));
+	ZERODEBUG(0,("Option N must be followed by valid file name\n"));
 	return 0;
       } else {
 	SMB_STRUCT_STAT stbuf;
@@ -1727,7 +1727,7 @@
 		   asctime(LocalTime(&newer_than))));
 	  Optind++;
 	} else {
-	  DEBUG(0,("Error setting newer-than time\n"));
+	  ZERODEBUG(0,("Error setting newer-than time\n"));
 	  return 0;
 	}
       }
@@ -1740,40 +1740,40 @@
       break;
     case 'I':
       if (tar_clipfl) {
-	DEBUG(0,("Only one of I,X,F must be specified\n"));
+	ZERODEBUG(0,("Only one of I,X,F must be specified\n"));
 	return 0;
       }
       tar_clipfl='I';
       break;
     case 'X':
       if (tar_clipfl) {
-	DEBUG(0,("Only one of I,X,F must be specified\n"));
+	ZERODEBUG(0,("Only one of I,X,F must be specified\n"));
 	return 0;
       }
       tar_clipfl='X';
       break;
     case 'F':
       if (tar_clipfl) {
-	DEBUG(0,("Only one of I,X,F must be specified\n"));
+	ZERODEBUG(0,("Only one of I,X,F must be specified\n"));
 	return 0;
       }
       tar_clipfl='F';
       break;
     case 'r':
-      DEBUG(0, ("tar_re_search set\n"));
+      ZERODEBUG(0, ("tar_re_search set\n"));
       tar_re_search = True;
       break;
     case 'n':
       if (tar_type == 'c') {
-	DEBUG(0, ("dry_run set\n"));
+	ZERODEBUG(0, ("dry_run set\n"));
 	dry_run = True;
       } else {
-	DEBUG(0, ("n is only meaningful when creating a tar-file\n"));
+	ZERODEBUG(0, ("n is only meaningful when creating a tar-file\n"));
 	return 0;
       }
       break;
     default:
-      DEBUG(0,("Unknown tar option\n"));
+      ZERODEBUG(0,("Unknown tar option\n"));
       return 0;
     }
 
@@ -1788,7 +1788,7 @@
 
   if (tar_clipfl=='F') {
     if (argc-Optind-1 != 1) {
-      DEBUG(0,("Option F must be followed by exactly one filename.\n"));
+      ZERODEBUG(0,("Option F must be followed by exactly one filename.\n"));
       return 0;
     }
     if (! read_inclusion_file(argv[Optind+1])) {
@@ -1804,7 +1804,7 @@
     clipcount = clipn;
 
     if ((tmplist=malloc(clipn*sizeof(char *))) == NULL) {
-      DEBUG(0, ("Could not allocate space to process cliplist, count = %i\n", 
+      ZERODEBUG(0, ("Could not allocate space to process cliplist, count = %i\n", 
                clipn)
            );
       return 0;
@@ -1815,7 +1815,7 @@
       DEBUG(5, ("Processing an item, %s\n", cliplist[clipcount]));
 
       if ((tmpstr = (char *)malloc(strlen(cliplist[clipcount])+1)) == NULL) {
-        DEBUG(0, ("Could not allocate space for a cliplist item, # %i\n",
+        ZERODEBUG(0, ("Could not allocate space for a cliplist item, # %i\n",
                  clipcount)
              );
         return 0;
@@ -1836,7 +1836,7 @@
 
     if ((preg = (regex_t *)malloc(65536)) == NULL) {
 
-      DEBUG(0, ("Could not allocate buffer for regular expression search\n"));
+      ZERODEBUG(0, ("Could not allocate buffer for regular expression search\n"));
       return;
 
     }
@@ -1847,7 +1847,7 @@
 
       errlen = regerror(errcode, preg, errstr, sizeof(errstr) - 1);
       
-      DEBUG(0, ("Could not compile pattern buffer for re search: %s\n%s\n", argv[Optind + 1], errstr));
+      ZERODEBUG(0, ("Could not compile pattern buffer for re search: %s\n%s\n", argv[Optind + 1], errstr));
       return;
 
     }
@@ -1871,7 +1871,7 @@
     if (tar_type=='c' && (dry_run || strcmp(argv[Optind], "/dev/null")==0))
       {
 	if (!dry_run) {
-	  DEBUG(0,("Output is /dev/null, assuming dry_run\n"));
+	  ZERODEBUG(0,("Output is /dev/null, assuming dry_run\n"));
 	  dry_run = True;
 	}
 	tarhandle=-1;
@@ -1879,7 +1879,7 @@
     if ((tar_type=='x' && (tarhandle = sys_open(argv[Optind], O_RDONLY, 0)) == -1)
 	|| (tar_type=='c' && (tarhandle=sys_creat(argv[Optind], 0644)) < 0))
       {
-	DEBUG(0,("Error opening local file %s - %s\n",
+	ZERODEBUG(0,("Error opening local file %s - %s\n",
 		 argv[Optind], strerror(errno)));
 	return(0);
       }
diff -Naur samba-2.2.12-orig/source/client/smbmnt.c samba-2.2.12/source/client/smbmnt.c
--- samba-2.2.12-orig/source/client/smbmnt.c	2004-08-12 20:24:36.000000000 +0200
+++ samba-2.2.12/source/client/smbmnt.c	2009-03-11 13:51:50.000000000 +0100
@@ -54,7 +54,7 @@
 {
         int opt;
 
-        while ((opt = getopt (argc, argv, "s:u:g:rf:d:o:")) != EOF)
+        while ((opt = getopt (argc, argv, "s:u:g:rf:o:")) != EOF)
 	{
                 switch (opt)
 		{
diff -Naur samba-2.2.12-orig/source/client/smbmount.c samba-2.2.12/source/client/smbmount.c
--- samba-2.2.12-orig/source/client/smbmount.c	2004-08-12 20:24:36.000000000 +0200
+++ samba-2.2.12/source/client/smbmount.c	2009-03-11 13:48:39.000000000 +0100
@@ -67,7 +67,7 @@
 	signal( SIGTERM, exit_parent );
 
 	if ((child_pid = sys_fork()) < 0) {
-		DEBUG(0,("could not fork\n"));
+		ZERODEBUG(0,("could not fork\n"));
 	}
 
 	if (child_pid > 0) {
@@ -147,7 +147,7 @@
 	/* have to open a new connection */
 	if (!(c=cli_initialise(NULL)) || (cli_set_port(c, smb_port) == 0) ||
 	    !cli_connect(c, server_n, &ip)) {
-		DEBUG(0,("%d: Connection to %s failed\n", getpid(), server_n));
+		ZERODEBUG(0,("%d: Connection to %s failed\n", getpid(), server_n));
 		if (c) {
 			cli_shutdown(c);
 		}
@@ -156,7 +156,7 @@
 
 	if (!cli_session_request(c, &calling, &called)) {
 		char *p;
-		DEBUG(0,("%d: session request to %s failed (%s)\n", 
+		ZERODEBUG(0,("%d: session request to %s failed (%s)\n", 
 			 getpid(), called.name, cli_errstr(c)));
 		cli_shutdown(c);
 		if ((p=strchr(called.name, '.'))) {
@@ -173,7 +173,7 @@
 	DEBUG(4,("%d: session request ok\n", getpid()));
 
 	if (!cli_negprot(c)) {
-		DEBUG(0,("%d: protocol negotiation failed\n", getpid()));
+		ZERODEBUG(0,("%d: protocol negotiation failed\n", getpid()));
 		cli_shutdown(c);
 		return NULL;
 	}
@@ -198,19 +198,19 @@
 		   null username */
 		if (password[0] || !username[0] ||
 		    !cli_session_setup(c, "", "", 0, "", 0, workgroup)) {
-			DEBUG(0,("%d: session setup failed: %s\n",
+			ZERODEBUG(0,("%d: session setup failed: %s\n",
 				 getpid(), cli_errstr(c)));
 			cli_shutdown(c);
 			return NULL;
 		}
-		DEBUG(0,("Anonymous login successful\n"));
+		ZERODEBUG(0,("Anonymous login successful\n"));
 	}
 
 	DEBUG(4,("%d: session setup ok\n", getpid()));
 
 	if (!cli_send_tconX(c, share, "?????",
 			    password, strlen(password)+1)) {
-		DEBUG(0,("%d: tree connect failed: %s\n",
+		ZERODEBUG(0,("%d: tree connect failed: %s\n",
 			 getpid(), cli_errstr(c)));
 		cli_shutdown(c);
 		return NULL;
@@ -245,20 +245,20 @@
 		the lights to exit anyways...
 	*/
         if (umount(mount_point) != 0) {
-                DEBUG(0,("%d: Could not umount %s: %s\n",
+                ZERODEBUG(0,("%d: Could not umount %s: %s\n",
 			 getpid(), mount_point, strerror(errno)));
                 return;
         }
 
         if ((fd = open(MOUNTED"~", O_RDWR|O_CREAT|O_EXCL, 0600)) == -1) {
-                DEBUG(0,("%d: Can't get "MOUNTED"~ lock file", getpid()));
+                ZERODEBUG(0,("%d: Can't get "MOUNTED"~ lock file", getpid()));
                 return;
         }
 
         close(fd);
 	
         if ((mtab = setmntent(MOUNTED, "r")) == NULL) {
-                DEBUG(0,("%d: Can't open " MOUNTED ": %s\n",
+                ZERODEBUG(0,("%d: Can't open " MOUNTED ": %s\n",
 			 getpid(), strerror(errno)));
                 return;
         }
@@ -266,7 +266,7 @@
 #define MOUNTED_TMP MOUNTED".tmp"
 
         if ((new_mtab = setmntent(MOUNTED_TMP, "w")) == NULL) {
-                DEBUG(0,("%d: Can't open " MOUNTED_TMP ": %s\n",
+                ZERODEBUG(0,("%d: Can't open " MOUNTED_TMP ": %s\n",
 			 getpid(), strerror(errno)));
                 endmntent(mtab);
                 return;
@@ -281,7 +281,7 @@
         endmntent(mtab);
 
         if (fchmod (fileno (new_mtab), S_IRUSR|S_IWUSR|S_IRGRP|S_IROTH) < 0) {
-                DEBUG(0,("%d: Error changing mode of %s: %s\n",
+                ZERODEBUG(0,("%d: Error changing mode of %s: %s\n",
 			 getpid(), MOUNTED_TMP, strerror(errno)));
                 return;
         }
@@ -289,13 +289,13 @@
         endmntent(new_mtab);
 
         if (rename(MOUNTED_TMP, MOUNTED) < 0) {
-                DEBUG(0,("%d: Cannot rename %s to %s: %s\n",
+                ZERODEBUG(0,("%d: Cannot rename %s to %s: %s\n",
 			 getpid(), MOUNTED, MOUNTED_TMP, strerror(errno)));
                 return;
         }
 
         if (unlink(MOUNTED"~") == -1) {
-                DEBUG(0,("%d: Can't remove "MOUNTED"~", getpid()));
+                ZERODEBUG(0,("%d: Can't remove "MOUNTED"~", getpid()));
                 return;
         }
 }
@@ -317,7 +317,7 @@
 
 	while (1) {
 		if ((fd = open(mount_point, O_RDONLY)) < 0) {
-			DEBUG(0,("mount.smbfs[%d]: can't open %s\n",
+			ZERODEBUG(0,("mount.smbfs[%d]: can't open %s\n",
 				 getpid(), mount_point));
 			break;
 		}
@@ -337,7 +337,7 @@
 
 		res = ioctl(fd, SMB_IOC_NEWCONN, &conn_options);
 		if (res != 0) {
-			DEBUG(0,("mount.smbfs[%d]: ioctl failed, res=%d\n",
+			ZERODEBUG(0,("mount.smbfs[%d]: ioctl failed, res=%d\n",
 				 getpid(), res));
 			close(fd);
 			break;
@@ -380,7 +380,7 @@
 			setup_logging("mount.smbfs", False);
 			append_log = True;
 			reopen_logs();
-			DEBUG(0, ("mount.smbfs: entering daemon mode for service %s, pid=%d\n", svc_name, getpid()));
+			ZERODEBUG(0, ("mount.smbfs: entering daemon mode for service %s, pid=%d\n", svc_name, getpid()));
 
 			closed = 1;
 		}
@@ -576,7 +576,7 @@
 	if ((auth=sys_fopen(filename, "r")) == NULL)
 	{
 		/* fail if we can't open the credentials file */
-		DEBUG(0,("ERROR: Unable to open credentials file!\n"));
+		ZERODEBUG(0,("ERROR: Unable to open credentials file!\n"));
 		exit (-1);
 	}
 
@@ -742,7 +742,7 @@
 			} else if(!strcmp(opts, "dmask")) {
 				mount_dmask = strtol(opteq+1, NULL, 8);
 			} else if(!strcmp(opts, "debug")) {
-				DEBUGLEVEL = val;
+				DEBUGLEVEL = 0;
 			} else if(!strcmp(opts, "ip")) {
 				dest_ip = *interpret_addr2(opteq+1);
 				if (is_zero_ip(dest_ip)) {
@@ -802,7 +802,7 @@
 	static pstring servicesf = CONFIGFILE;
 	char *p;
 
-	DEBUGLEVEL = 1;
+	DEBUGLEVEL = 0;
 
 	/* here we are interactive, even if run from autofs */
 	setup_logging("mount.smbfs",True);
diff -Naur samba-2.2.12-orig/source/groupdb/aliasdb.c samba-2.2.12/source/groupdb/aliasdb.c
--- samba-2.2.12-orig/source/groupdb/aliasdb.c	2004-08-12 20:24:23.000000000 +0200
+++ samba-2.2.12/source/groupdb/aliasdb.c	2009-03-11 09:59:30.000000000 +0100
@@ -83,7 +83,7 @@
 
 	if (fp == NULL)
 	{
-		DEBUG(0, ("unable to open alias database.\n"));
+		ZERODEBUG(0, ("unable to open alias database.\n"));
 		return NULL;
 	}
 
@@ -116,7 +116,7 @@
 
 	if (fp == NULL)
 	{
-		DEBUG(0, ("unable to open alias database.\n"));
+		ZERODEBUG(0, ("unable to open alias database.\n"));
 		return NULL;
 	}
 
@@ -210,7 +210,7 @@
 
 	if (fp == NULL)
 	{
-		DEBUG(0, ("unable to open alias database.\n"));
+		ZERODEBUG(0, ("unable to open alias database.\n"));
 		return False;
 	}
 
@@ -271,7 +271,7 @@
 
 	if (fp == NULL)
 	{
-		DEBUG(0, ("unable to open alias database.\n"));
+		ZERODEBUG(0, ("unable to open alias database.\n"));
 		return False;
 	}
 
@@ -280,7 +280,7 @@
 	{
 		if (!add_domain_alias(alss, num_alss, als))
 		{
-			DEBUG(0,("unable to add alias while enumerating\n"));
+			ZERODEBUG(0,("unable to add alias while enumerating\n"));
 			return False;
 		}
 	}
diff -Naur samba-2.2.12-orig/source/groupdb/aliasfile.c samba-2.2.12/source/groupdb/aliasfile.c
--- samba-2.2.12-orig/source/groupdb/aliasfile.c	2004-08-12 20:24:23.000000000 +0200
+++ samba-2.2.12/source/groupdb/aliasfile.c	2009-03-11 09:59:30.000000000 +0100
@@ -74,7 +74,7 @@
 
 	if (len == -1)
 	{
-		DEBUG(0,("make_alias_line: cannot create entry\n"));
+		ZERODEBUG(0,("make_alias_line: cannot create entry\n"));
 		return False;
 	}
 
@@ -93,7 +93,7 @@
 
 		if (p == NULL)
 		{
-			DEBUG(0, ("make_alias_line: out of space for aliases!\n"));
+			ZERODEBUG(0, ("make_alias_line: out of space for aliases!\n"));
 			return False;
 		}
 
@@ -132,7 +132,7 @@
 			mbrs = Realloc((*members), ((*num_mem)+1) * sizeof(LOCAL_GRP_MEMBER));
 			(*num_mem)++;
 		} else {
-			DEBUG(0,("alias database: could not resolve alias named %s\n", name));
+			ZERODEBUG(0,("alias database: could not resolve alias named %s\n", name));
 			continue;
 		}
 		if (mbrs == NULL) {
@@ -174,7 +174,7 @@
 		p = strncpyn(al_buf.name, linebuf, sizeof(al_buf.name), ':');
 		if (p == NULL)
 		{
-			DEBUG(0, ("getalsfilepwent: malformed alias entry (no :)\n"));
+			ZERODEBUG(0, ("getalsfilepwent: malformed alias entry (no :)\n"));
 			continue;
 		}
 
@@ -186,7 +186,7 @@
 		p = strncpyn(al_buf.comment, p, sizeof(al_buf.comment), ':');
 		if (p == NULL)
 		{
-			DEBUG(0, ("getalsfilepwent: malformed alias entry (no :)\n"));
+			ZERODEBUG(0, ("getalsfilepwent: malformed alias entry (no :)\n"));
 			continue;
 		}
 
@@ -199,7 +199,7 @@
 
 		if (p == NULL)
 		{
-			DEBUG(0, ("getalsfilepwent: malformed alias entry (no : after uid)\n"));
+			ZERODEBUG(0, ("getalsfilepwent: malformed alias entry (no : after uid)\n"));
 			continue;
 		}
 
@@ -216,7 +216,7 @@
 			p = get_alias_members(p, num_mem, mem);
 			if (p == NULL)
 			{
-				DEBUG(0, ("getalsfilepwent: malformed alias entry (no : after members)\n"));
+				ZERODEBUG(0, ("getalsfilepwent: malformed alias entry (no : after members)\n"));
 			}
 		}
 
@@ -240,7 +240,7 @@
 
 static BOOL add_alsfileals_entry(LOCAL_GRP *newals)
 {
-	DEBUG(0, ("add_alsfileals_entry: NOT IMPLEMENTED\n"));
+	ZERODEBUG(0, ("add_alsfileals_entry: NOT IMPLEMENTED\n"));
 	return False;
 }
 
@@ -255,7 +255,7 @@
 
 static BOOL mod_alsfileals_entry(LOCAL_GRP* als)
 {
-	DEBUG(0, ("mod_alsfileals_entry: NOT IMPLEMENTED\n"));
+	ZERODEBUG(0, ("mod_alsfileals_entry: NOT IMPLEMENTED\n"));
 	return False;
 }
 
diff -Naur samba-2.2.12-orig/source/groupdb/groupdb.c samba-2.2.12/source/groupdb/groupdb.c
--- samba-2.2.12-orig/source/groupdb/groupdb.c	2004-08-12 20:24:23.000000000 +0200
+++ samba-2.2.12/source/groupdb/groupdb.c	2009-03-11 09:59:30.000000000 +0100
@@ -81,7 +81,7 @@
 
 	if (fp == NULL)
 	{
-		DEBUG(0, ("unable to open group database.\n"));
+		ZERODEBUG(0, ("unable to open group database.\n"));
 		return NULL;
 	}
 
@@ -114,7 +114,7 @@
 
 	if (fp == NULL)
 	{
-		DEBUG(0, ("unable to open group database.\n"));
+		ZERODEBUG(0, ("unable to open group database.\n"));
 		return NULL;
 	}
 
@@ -206,7 +206,7 @@
 
 	if (fp == NULL)
 	{
-		DEBUG(0, ("unable to open group database.\n"));
+		ZERODEBUG(0, ("unable to open group database.\n"));
 		return False;
 	}
 
@@ -267,7 +267,7 @@
 
 	if (fp == NULL)
 	{
-		DEBUG(0, ("unable to open group database.\n"));
+		ZERODEBUG(0, ("unable to open group database.\n"));
 		return False;
 	}
 
@@ -276,7 +276,7 @@
 	{
 		if (!add_domain_group(grps, num_grps, grp))
 		{
-			DEBUG(0,("unable to add group while enumerating\n"));
+			ZERODEBUG(0,("unable to add group while enumerating\n"));
 			return False;
 		}
 	}
diff -Naur samba-2.2.12-orig/source/groupdb/groupfile.c samba-2.2.12/source/groupdb/groupfile.c
--- samba-2.2.12-orig/source/groupdb/groupfile.c	2004-08-12 20:24:23.000000000 +0200
+++ samba-2.2.12/source/groupdb/groupfile.c	2009-03-11 09:59:30.000000000 +0100
@@ -74,7 +74,7 @@
 
 	if (len == -1)
 	{
-		DEBUG(0,("make_group_line: cannot create entry\n"));
+		ZERODEBUG(0,("make_group_line: cannot create entry\n"));
 		return False;
 	}
 
@@ -93,7 +93,7 @@
 
 		if (p == NULL)
 		{
-			DEBUG(0, ("make_group_line: out of space for groups!\n"));
+			ZERODEBUG(0, ("make_group_line: out of space for groups!\n"));
 			return False;
 		}
 
@@ -169,7 +169,7 @@
 		p = strncpyn(gp_buf.name, linebuf, sizeof(gp_buf.name), ':');
 		if (p == NULL)
 		{
-			DEBUG(0, ("getgrpfilepwent: malformed group entry (no :)\n"));
+			ZERODEBUG(0, ("getgrpfilepwent: malformed group entry (no :)\n"));
 			continue;
 		}
 
@@ -181,7 +181,7 @@
 		p = strncpyn(gp_buf.comment, p, sizeof(gp_buf.comment), ':');
 		if (p == NULL)
 		{
-			DEBUG(0, ("getgrpfilepwent: malformed group entry (no :)\n"));
+			ZERODEBUG(0, ("getgrpfilepwent: malformed group entry (no :)\n"));
 			continue;
 		}
 
@@ -194,7 +194,7 @@
 
 		if (p == NULL)
 		{
-			DEBUG(0, ("getgrpfilepwent: malformed group entry (no : after uid)\n"));
+			ZERODEBUG(0, ("getgrpfilepwent: malformed group entry (no : after uid)\n"));
 			continue;
 		}
 
@@ -211,7 +211,7 @@
 			p = get_group_members(p, num_mem, mem);
 			if (p == NULL)
 			{
-				DEBUG(0, ("getgrpfilepwent: malformed group entry (no : after members)\n"));
+				ZERODEBUG(0, ("getgrpfilepwent: malformed group entry (no : after members)\n"));
 			}
 		}
 
@@ -236,7 +236,7 @@
 
 static BOOL add_grpfilegrp_entry(DOMAIN_GRP *newgrp)
 {
-	DEBUG(0, ("add_grpfilegrp_entry: NOT IMPLEMENTED\n"));
+	ZERODEBUG(0, ("add_grpfilegrp_entry: NOT IMPLEMENTED\n"));
 	return False;
 }
 
@@ -251,7 +251,7 @@
 
 static BOOL mod_grpfilegrp_entry(DOMAIN_GRP* grp)
 {
-	DEBUG(0, ("mod_grpfilegrp_entry: NOT IMPLEMENTED\n"));
+	ZERODEBUG(0, ("mod_grpfilegrp_entry: NOT IMPLEMENTED\n"));
 	return False;
 }
 
diff -Naur samba-2.2.12-orig/source/include/debug.h samba-2.2.12/source/include/debug.h
--- samba-2.2.12-orig/source/include/debug.h	2004-08-12 20:24:29.000000000 +0200
+++ samba-2.2.12/source/include/debug.h	2009-03-11 10:09:57.000000000 +0100
@@ -140,35 +140,53 @@
  */
 
 #define DEBUGLVL( level ) \
+  (0)
+
+#define ZERODEBUGLVL( level ) \
   ( ((DEBUGLEVEL_CLASS[ DBGC_CLASS ] >= (level))||  \
      (DEBUGLEVEL_CLASS[ DBGC_ALL   ] >= (level))  ) \
    && dbghdr( level, FILE_MACRO, FUNCTION_MACRO, (__LINE__) ) )
 
 
 #define DEBUGLVLC( dbgc_class, level ) \
+  (0)
+
+#define ZERODEBUGLVLC( dbgc_class, level ) \
   ( ((DEBUGLEVEL_CLASS[ dbgc_class ] >= (level))||  \
      (DEBUGLEVEL_CLASS[ DBGC_ALL   ] >= (level))  ) \
    && dbghdr( level, FILE_MACRO, FUNCTION_MACRO, (__LINE__) ) )
 
 
 #define DEBUG( level, body ) \
+  (void)(0)
+
+#define ZERODEBUG( level, body ) \
   (void)( ((DEBUGLEVEL_CLASS[ DBGC_CLASS ] >= (level))||  \
            (DEBUGLEVEL_CLASS[ DBGC_ALL   ] >= (level))  ) \
        && (dbghdr( level, FILE_MACRO, FUNCTION_MACRO, (__LINE__) )) \
        && (dbgtext body) )
 
 #define DEBUGC( dbgc_class, level, body ) \
+  (void)(0)
+
+#define ZERODEBUGC( dbgc_class, level, body ) \
   (void)( ((DEBUGLEVEL_CLASS[ dbgc_class ] >= (level))||  \
            (DEBUGLEVEL_CLASS[ DBGC_ALL   ] >= (level))  ) \
        && (dbghdr( level, FILE_MACRO, FUNCTION_MACRO, (__LINE__) )) \
        && (dbgtext body) )
 
 #define DEBUGADD( level, body ) \
+  (void)(0)
+
+#define ZERODEBUGADD( level, body ) \
   (void)( ((DEBUGLEVEL_CLASS[ DBGC_CLASS ] >= (level))||  \
            (DEBUGLEVEL_CLASS[ DBGC_ALL   ] >= (level))  ) \
        && (dbgtext body) )
 
 #define DEBUGADDC( dbgc_class, level, body ) \
+  (void)(0)
+
+#define ZERODEBUGADDC( dbgc_class, level, body ) \
   (void)( ((DEBUGLEVEL_CLASS[ dbgc_class ] >= (level))||  \
            (DEBUGLEVEL_CLASS[ DBGC_ALL   ] >= (level))  ) \
        && (dbgtext body) )
diff -Naur samba-2.2.12-orig/source/include/smb_macros.h samba-2.2.12/source/include/smb_macros.h
--- samba-2.2.12-orig/source/include/smb_macros.h	2004-08-12 20:24:30.000000000 +0200
+++ samba-2.2.12/source/include/smb_macros.h	2009-03-11 09:59:30.000000000 +0100
@@ -62,7 +62,7 @@
 
 /* assert macros */
 #define SMB_ASSERT(b) ((b)?(void)0: \
-        (DEBUG(0,("PANIC: assert failed at %s(%d)\n", \
+        (ZERODEBUG(0,("PANIC: assert failed at %s(%d)\n", \
 		 __FILE__, __LINE__)), smb_panic("assert failed")))
 #define SMB_ASSERT_ARRAY(a,n) SMB_ASSERT((sizeof(a)/sizeof((a)[0])) >= (n))
 
diff -Naur samba-2.2.12-orig/source/lib/access.c samba-2.2.12/source/lib/access.c
--- samba-2.2.12-orig/source/lib/access.c	2004-08-12 20:24:24.000000000 +0200
+++ samba-2.2.12/source/lib/access.c	2009-03-11 09:59:30.000000000 +0100
@@ -37,7 +37,7 @@
         }
 
 	if (net == INADDR_NONE || mask == INADDR_NONE) {
-		DEBUG(0,("access: bad net/mask access control: %s\n", tok));
+		ZERODEBUG(0,("access: bad net/mask access control: %s\n", tok));
 		return (False);
 	}
 	return ((addr & mask) == net);
@@ -78,7 +78,7 @@
 		if (!mydomain) yp_get_default_domain(&mydomain);
 
 		if (!mydomain) {
-			DEBUG(0,("Unable to get default yp domain.\n"));
+			ZERODEBUG(0,("Unable to get default yp domain.\n"));
 			return False;
 		}
 		if (!(hostname = strdup(s))) {
@@ -98,7 +98,7 @@
       
 		if (netgroup_ok) return(True);
 #else
-		DEBUG(0,("access: netgroup support is not configured\n"));
+		ZERODEBUG(0,("access: netgroup support is not configured\n"));
 		return (False);
 #endif
 	} else if (strcasecmp(tok, "ALL") == 0) {	/* all: match any */
@@ -139,14 +139,14 @@
 
     if ((match = string_match(tok, client[1], &invalid_char)) == 0) {
 		if(invalid_char)
-			DEBUG(0,("client_match: address match failing due to invalid character '%c' found in \
+			ZERODEBUG(0,("client_match: address match failing due to invalid character '%c' found in \
 token '%s' in an allow/deny hosts line.\n", invalid_char, tok ));
 
 		if (client[0][0] != 0)
 			match = string_match(tok, client[0], &invalid_char);
 
 		if(invalid_char)
-			DEBUG(0,("client_match: address match failing due to invalid character '%c' found in \
+			ZERODEBUG(0,("client_match: address match failing due to invalid character '%c' found in \
 token '%s' in an allow/deny hosts line.\n", invalid_char, tok ));
 	}
 
@@ -328,7 +328,7 @@
 				 only_ip ? "" : get_socket_name(sock),
 				 get_socket_addr(sock)));
 		} else {
-			DEBUG(0,("Denied connection from %s (%s)\n",
+			ZERODEBUG(0,("Denied connection from %s (%s)\n",
 				 only_ip ? "" : get_socket_name(sock),
 				 get_socket_addr(sock)));
 		}
diff -Naur samba-2.2.12-orig/source/lib/bitmap.c samba-2.2.12/source/lib/bitmap.c
--- samba-2.2.12-orig/source/lib/bitmap.c	2004-08-12 20:24:25.000000000 +0200
+++ samba-2.2.12/source/lib/bitmap.c	2009-03-11 09:59:30.000000000 +0100
@@ -67,7 +67,7 @@
 BOOL bitmap_set(struct bitmap *bm, unsigned i)
 {
 	if (i >= bm->n) {
-		DEBUG(0,("Setting invalid bitmap entry %d (of %d)\n",
+		ZERODEBUG(0,("Setting invalid bitmap entry %d (of %d)\n",
 		      i, bm->n));
 		return False;
 	}
@@ -81,7 +81,7 @@
 BOOL bitmap_clear(struct bitmap *bm, unsigned i)
 {
 	if (i >= bm->n) {
-		DEBUG(0,("clearing invalid bitmap entry %d (of %d)\n",
+		ZERODEBUG(0,("clearing invalid bitmap entry %d (of %d)\n",
 		      i, bm->n));
 		return False;
 	}
diff -Naur samba-2.2.12-orig/source/lib/charcnv.c samba-2.2.12/source/lib/charcnv.c
--- samba-2.2.12-orig/source/lib/charcnv.c	2004-08-12 20:24:25.000000000 +0200
+++ samba-2.2.12/source/lib/charcnv.c	2009-03-11 09:59:30.000000000 +0100
@@ -498,7 +498,7 @@
     } else if (strequal (str, "roman8")) {
         init_roman8();
     } else {
-        DEBUG(0,("unrecognized character set %s\n", str));
+        ZERODEBUG(0,("unrecognized character set %s\n", str));
     }
 
     load_unix_unicode_map(str, True);
diff -Naur samba-2.2.12-orig/source/lib/charset.c samba-2.2.12/source/lib/charset.c
--- samba-2.2.12-orig/source/lib/charset.c	2004-08-12 20:24:24.000000000 +0200
+++ samba-2.2.12/source/lib/charset.c	2009-03-11 09:59:30.000000000 +0100
@@ -195,7 +195,7 @@
 
   if(strlen(lp_codepagedir()) + 14 > sizeof(codepage_file_name))
   {
-    DEBUG(0,("load_client_codepage: filename too long to load\n"));
+    ZERODEBUG(0,("load_client_codepage: filename too long to load\n"));
     return NULL;
   }
 
@@ -209,7 +209,7 @@
 
   if(sys_stat(codepage_file_name,&st)!=0)
   {
-    DEBUG(0,("load_client_codepage: filename %s does not exist.\n",
+    ZERODEBUG(0,("load_client_codepage: filename %s does not exist.\n",
               codepage_file_name));
     return NULL;
   }
@@ -223,7 +223,7 @@
 
   if( size < CODEPAGE_HEADER_SIZE || size > (CODEPAGE_HEADER_SIZE + 4 * MAXCODEPAGELINES))
   {
-    DEBUG(0,("load_client_codepage: file %s is an incorrect size for a \
+    ZERODEBUG(0,("load_client_codepage: file %s is an incorrect size for a \
 code page file (size=%d).\n", codepage_file_name, (int)size));
     return NULL;
   }
@@ -235,14 +235,14 @@
 
   if((fd = open(codepage_file_name, O_RDONLY)) == -1)
   {
-    DEBUG(0,("load_client_codepage: cannot open file %s. Error was %s\n",
+    ZERODEBUG(0,("load_client_codepage: cannot open file %s. Error was %s\n",
               codepage_file_name, strerror(errno)));
     return NULL;
   }
 
   if (read(fd, buf, CODEPAGE_HEADER_SIZE)!=CODEPAGE_HEADER_SIZE)
   {
-    DEBUG(0,("load_client_codepage: cannot read header from file %s. Error was %s\n",
+    ZERODEBUG(0,("load_client_codepage: cannot read header from file %s. Error was %s\n",
               codepage_file_name, strerror(errno)));
     goto clean_and_exit;
   }
@@ -250,7 +250,7 @@
   /* Check the version value */
   if(SVAL(buf,CODEPAGE_VERSION_OFFSET) != CODEPAGE_FILE_VERSION_ID)
   {
-    DEBUG(0,("load_client_codepage: filename %s has incorrect version id. \
+    ZERODEBUG(0,("load_client_codepage: filename %s has incorrect version id. \
 Needed %hu, got %hu.\n", 
           codepage_file_name, (uint16)CODEPAGE_FILE_VERSION_ID, 
           SVAL(buf,CODEPAGE_VERSION_OFFSET)));
@@ -260,7 +260,7 @@
   /* Check the codepage matches */
   if(SVAL(buf,CODEPAGE_CLIENT_CODEPAGE_OFFSET) != (uint16)client_codepage)
   {
-    DEBUG(0,("load_client_codepage: filename %s has incorrect codepage. \
+    ZERODEBUG(0,("load_client_codepage: filename %s has incorrect codepage. \
 Needed %hu, got %hu.\n", 
            codepage_file_name, (uint16)client_codepage, 
            SVAL(buf,CODEPAGE_CLIENT_CODEPAGE_OFFSET)));
@@ -270,7 +270,7 @@
   /* Check the length is correct. */
   if(IVAL(buf,CODEPAGE_LENGTH_OFFSET) != (size - CODEPAGE_HEADER_SIZE))
   {
-    DEBUG(0,("load_client_codepage: filename %s has incorrect size headers. \
+    ZERODEBUG(0,("load_client_codepage: filename %s has incorrect size headers. \
 Needed %u, got %u.\n", codepage_file_name, (uint32)(size - CODEPAGE_HEADER_SIZE), 
                IVAL(buf,CODEPAGE_LENGTH_OFFSET)));
     goto clean_and_exit;
@@ -281,7 +281,7 @@
   /* Make sure the size is a multiple of 4. */
   if((size % 4 ) != 0)
   {
-    DEBUG(0,("load_client_codepage: filename %s has a codepage size not a \
+    ZERODEBUG(0,("load_client_codepage: filename %s has a codepage size not a \
 multiple of 4.\n", codepage_file_name));
     goto clean_and_exit;
   }
@@ -289,13 +289,13 @@
   /* Allocate space for the code page file and read it all in. */
   if((cp_p = (codepage_p)malloc( size  + 4 )) == NULL)
   {
-    DEBUG(0,("load_client_codepage: malloc fail.\n"));
+    ZERODEBUG(0,("load_client_codepage: malloc fail.\n"));
     goto clean_and_exit;
   }
 
   if(read(fd, (char *)cp_p, size)!=size)
   {
-    DEBUG(0,("load_client_codepage: read fail on file %s. Error was %s.\n",
+    ZERODEBUG(0,("load_client_codepage: read fail on file %s. Error was %s.\n",
               codepage_file_name, strerror(errno)));
     goto clean_and_exit;
   }
diff -Naur samba-2.2.12-orig/source/lib/debug.c samba-2.2.12/source/lib/debug.c
--- samba-2.2.12-orig/source/lib/debug.c	2004-08-12 20:24:24.000000000 +0200
+++ samba-2.2.12/source/lib/debug.c	2009-03-11 09:59:30.000000000 +0100
@@ -195,7 +195,7 @@
             ((ndx = debug_lookup_classname(class_name)) != -1)) {
 				debuglevel_class[ndx] = atoi(class_level);
 		} else {
-			DEBUG(0,("debug_parse_params: unrecognized debug class name or format [%s]\n", params[i]));
+			ZERODEBUG(0,("debug_parse_params: unrecognized debug class name or format [%s]\n", params[i]));
 			return False;
 		}
 	}
@@ -345,7 +345,7 @@
 
 	if (!new_dbf) {
 		log_overflow = True;
-		DEBUG(0, ("Unable to open new log file %s: %s\n", debugf, strerror(errno)));
+		ZERODEBUG(0, ("Unable to open new log file %s: %s\n", debugf, strerror(errno)));
 		log_overflow = False;
 		if (dbf)
 			fflush(dbf);
@@ -447,7 +447,7 @@
 		*/
 		dbf = sys_fopen( "/dev/console", "w" );
 		if(dbf) {
-			DEBUG(0,("check_log_size: open of debug file %s failed - using console.\n",
+			ZERODEBUG(0,("check_log_size: open of debug file %s failed - using console.\n",
 					debugf ));
 		} else {
 			/*
@@ -508,7 +508,7 @@
   if( syslog_level < lp_syslog() )
     {
     /* map debug levels to syslog() priorities
-     * note that not all DEBUG(0, ...) calls are
+     * note that not all ZERODEBUG(0, ...) calls are
      * necessarily errors
      */
     static int priority_map[] = { 
diff -Naur samba-2.2.12-orig/source/lib/domain_namemap.c samba-2.2.12/source/lib/domain_namemap.c
--- samba-2.2.12-orig/source/lib/domain_namemap.c	2004-08-12 20:24:24.000000000 +0200
+++ samba-2.2.12/source/lib/domain_namemap.c	2009-03-11 09:59:30.000000000 +0100
@@ -270,7 +270,7 @@
 
 	if (!map_domain_name_to_sid(&grp->sid, &(grp->nt_domain)))
 	{
-		DEBUG(0,("make_mydomain_sid: unknown domain %s\n",
+		ZERODEBUG(0,("make_mydomain_sid: unknown domain %s\n",
 			  grp->nt_domain));
 		return False;
 	}
@@ -285,7 +285,7 @@
 
 		if (lookup_builtin_alias_name(grp->nt_name, "BUILTIN", &grp->sid, &grp->type) != 0x0)
 		{
-			DEBUG(0,("unix group %s mapped to an unrecognised BUILTIN domain name %s\n",
+			ZERODEBUG(0,("unix group %s mapped to an unrecognised BUILTIN domain name %s\n",
 			          grp->unix_name, grp->nt_name));
 			return False;
 		}
@@ -295,7 +295,7 @@
 	{
 		if (type != DOM_MAP_USER)
 		{
-			DEBUG(0,("well-known NT user %s\\%s listed in wrong map file\n",
+			ZERODEBUG(0,("well-known NT user %s\\%s listed in wrong map file\n",
 			          grp->nt_domain, grp->nt_name));
 			return False;
 		}
@@ -305,7 +305,7 @@
 	{
 		if (type != DOM_MAP_DOMAIN)
 		{
-			DEBUG(0,("well-known NT group %s\\%s listed in wrong map file\n",
+			ZERODEBUG(0,("well-known NT group %s\\%s listed in wrong map file\n",
 			          grp->nt_domain, grp->nt_name));
 			return False;
 		}
@@ -357,7 +357,7 @@
 		const struct passwd *pwptr = Get_Pwnam(map->unix_name, False);
 		if (pwptr == NULL)
 		{
-			DEBUG(0,("unix_name_to_nt_name_info: Get_Pwnam for user %s\
+			ZERODEBUG(0,("unix_name_to_nt_name_info: Get_Pwnam for user %s\
 failed. Error was %s.\n", map->unix_name, strerror(errno) ));
 			return False;
 		}
@@ -369,7 +369,7 @@
 		struct group *gptr = getgrnam(map->unix_name);
 		if (gptr == NULL)
 		{
-			DEBUG(0,("unix_name_to_nt_name_info: getgrnam for group %s\
+			ZERODEBUG(0,("unix_name_to_nt_name_info: getgrnam for group %s\
 failed. Error was %s.\n", map->unix_name, strerror(errno) ));
 			return False;
 		}
@@ -401,7 +401,7 @@
 
 		if (!map_domain_name_to_sid(&map->sid, &(map->nt_domain)))
 		{
-			DEBUG(0,("unix_name_to_nt_name_info: no known sid for %s\n",
+			ZERODEBUG(0,("unix_name_to_nt_name_info: no known sid for %s\n",
 				  map->nt_domain));
 			return False;
 		}
@@ -423,7 +423,7 @@
 	(*new_ep) = (name_map_entry *)malloc(sizeof(name_map_entry));
 	if ((*new_ep) == NULL)
 	{
-		DEBUG(0,("make_name_entry: malloc fail for name_map_entry.\n"));
+		ZERODEBUG(0,("make_name_entry: malloc fail for name_map_entry.\n"));
 		return False;
 	} 
 
@@ -436,7 +436,7 @@
 	if ((*new_ep)->grp.nt_name   == NULL ||
 	    (*new_ep)->grp.unix_name == NULL)
 	{
-		DEBUG(0,("make_name_entry: malloc fail for names in name_map_entry.\n"));
+		ZERODEBUG(0,("make_name_entry: malloc fail for names in name_map_entry.\n"));
 		delete_name_entry((*new_ep));
 		return False;
 	}
diff -Naur samba-2.2.12-orig/source/lib/fault.c samba-2.2.12/source/lib/fault.c
--- samba-2.2.12-orig/source/lib/fault.c	2004-08-12 20:24:24.000000000 +0200
+++ samba-2.2.12/source/lib/fault.c	2009-03-11 09:59:30.000000000 +0100
@@ -35,10 +35,10 @@
 
 	counter++;
 
-	DEBUG(0,("===============================================================\n"));
-	DEBUG(0,("INTERNAL ERROR: Signal %d in pid %d (%s)",sig,(int)sys_getpid(),VERSION));
-	DEBUG(0,("\nPlease read the file BUGS.txt in the distribution\n"));
-	DEBUG(0,("===============================================================\n"));
+	ZERODEBUG(0,("===============================================================\n"));
+	ZERODEBUG(0,("INTERNAL ERROR: Signal %d in pid %d (%s)",sig,(int)sys_getpid(),VERSION));
+	ZERODEBUG(0,("\nPlease read the file BUGS.txt in the distribution\n"));
+	ZERODEBUG(0,("===============================================================\n"));
   
 	smb_panic("internal error");
 
diff -Naur samba-2.2.12-orig/source/lib/hash.c samba-2.2.12/source/lib/hash.c
--- samba-2.2.12-orig/source/lib/hash.c	2004-08-12 20:24:24.000000000 +0200
+++ samba-2.2.12/source/lib/hash.c	2009-03-11 09:59:31.000000000 +0100
@@ -68,7 +68,7 @@
 	DEBUG(5, ("Hash size = %d.\n", table->size));
 
 	if(!(table->buckets = (ubi_dlList *) malloc(sizeof(ubi_dlList) * table->size))) {
-		DEBUG(0,("hash_table_init: malloc fail !\n"));
+		ZERODEBUG(0,("hash_table_init: malloc fail !\n"));
 		return False;
 	}
 	ubi_dlInitList(&(table->lru_chain));
@@ -208,7 +208,7 @@
 
 	string_length = strlen(key);
 	if(!(hash_elem = (hash_element *) malloc(sizeof(hash_element) + string_length))) {
-		DEBUG(0,("hash_insert: malloc fail !\n"));
+		ZERODEBUG(0,("hash_insert: malloc fail !\n"));
 		return (hash_element *)NULL;
 	}
 
diff -Naur samba-2.2.12-orig/source/lib/interface.c samba-2.2.12/source/lib/interface.c
--- samba-2.2.12-orig/source/lib/interface.c	2004-08-12 20:24:24.000000000 +0200
+++ samba-2.2.12/source/lib/interface.c	2009-03-11 09:59:31.000000000 +0100
@@ -195,7 +195,7 @@
 	   interfaces except loopback */
 	if (!ptr || !*ptr) {
 		if (total_probed <= 0) {
-			DEBUG(0,("ERROR: Could not determine network interfaces, you must use a interfaces config line\n"));
+			ZERODEBUG(0,("ERROR: Could not determine network interfaces, you must use a interfaces config line\n"));
 			exit(1);
 		}
 		for (i=0;i<total_probed;i++) {
@@ -213,7 +213,7 @@
 	}
 
 	if (!local_interfaces) {
-		DEBUG(0,("WARNING: no network interfaces found\n"));
+		ZERODEBUG(0,("WARNING: no network interfaces found\n"));
 	}
 }
 
diff -Naur samba-2.2.12-orig/source/lib/messages.c samba-2.2.12/source/lib/messages.c
--- samba-2.2.12-orig/source/lib/messages.c	2004-08-12 20:24:25.000000000 +0200
+++ samba-2.2.12/source/lib/messages.c	2009-03-11 09:59:31.000000000 +0100
@@ -109,7 +109,7 @@
 		       O_RDWR|O_CREAT,0600);
 
 	if (!tdb) {
-		DEBUG(0,("ERROR: Failed to initialise messages database\n"));
+		ZERODEBUG(0,("ERROR: Failed to initialise messages database\n"));
 		return False;
 	}
 
@@ -265,7 +265,7 @@
 	memcpy(&rec, dbuf.dptr, sizeof(rec));
 
 	if (rec.msg_version != MESSAGE_VERSION) {
-		DEBUG(0,("message version %d received (expected %d)\n", rec.msg_version, MESSAGE_VERSION));
+		ZERODEBUG(0,("message version %d received (expected %d)\n", rec.msg_version, MESSAGE_VERSION));
 		goto failed;
 	}
 
@@ -363,7 +363,7 @@
 	}
 	else {
 	
-		DEBUG(0,("message_register: Not enough memory. malloc failed!\n"));
+		ZERODEBUG(0,("message_register: Not enough memory. malloc failed!\n"));
 	}
 }
 
diff -Naur samba-2.2.12-orig/source/lib/pidfile.c samba-2.2.12/source/lib/pidfile.c
--- samba-2.2.12-orig/source/lib/pidfile.c	2004-08-12 20:24:24.000000000 +0200
+++ samba-2.2.12/source/lib/pidfile.c	2009-03-11 09:59:31.000000000 +0100
@@ -82,20 +82,20 @@
 
 	pid = pidfile_pid(name);
 	if (pid != 0) {
-		DEBUG(0,("ERROR: %s is already running. File %s exists and process id %d is running.\n", 
+		ZERODEBUG(0,("ERROR: %s is already running. File %s exists and process id %d is running.\n", 
 			 name, pidFile, (int)pid));
 		exit(1);
 	}
 
 	fd = sys_open(pidFile, O_NONBLOCK | O_CREAT | O_WRONLY | O_EXCL, 0644);
 	if (fd == -1) {
-		DEBUG(0,("ERROR: can't open %s: Error was %s\n", pidFile, 
+		ZERODEBUG(0,("ERROR: can't open %s: Error was %s\n", pidFile, 
 			 strerror(errno)));
 		exit(1);
 	}
 
 	if (fcntl_lock(fd,SMB_F_SETLK,0,1,F_WRLCK)==False) {
-		DEBUG(0,("ERROR: %s : fcntl lock of file %s failed. Error was %s\n",  
+		ZERODEBUG(0,("ERROR: %s : fcntl lock of file %s failed. Error was %s\n",  
               name, pidFile, strerror(errno)));
 		exit(1);
 	}
@@ -103,7 +103,7 @@
 	memset(buf, 0, sizeof(buf));
 	slprintf(buf, sizeof(buf) - 1, "%u\n", (unsigned int) sys_getpid());
 	if (write(fd, buf, sizeof(buf)) != sizeof(buf)) {
-		DEBUG(0,("ERROR: can't write to file %s: %s\n", 
+		ZERODEBUG(0,("ERROR: can't write to file %s: %s\n", 
 			 pidFile, strerror(errno)));
 		exit(1);
 	}
diff -Naur samba-2.2.12-orig/source/lib/readline.c samba-2.2.12/source/lib/readline.c
--- samba-2.2.12-orig/source/lib/readline.c	2004-08-12 20:24:25.000000000 +0200
+++ samba-2.2.12/source/lib/readline.c	2009-03-11 09:59:31.000000000 +0100
@@ -89,9 +89,9 @@
 	hlist = history_list();
 	
 	for (i = 0; hlist && hlist[i]; i++) {
-		DEBUG(0, ("%d: %s\n", i, hlist[i]->line));
+		ZERODEBUG(0, ("%d: %s\n", i, hlist[i]->line));
 	}
 #else
-	DEBUG(0,("no history without readline support\n"));
+	ZERODEBUG(0,("no history without readline support\n"));
 #endif
 }
diff -Naur samba-2.2.12-orig/source/lib/replace.c samba-2.2.12/source/lib/replace.c
--- samba-2.2.12-orig/source/lib/replace.c	2004-08-12 20:24:25.000000000 +0200
+++ samba-2.2.12/source/lib/replace.c	2009-03-11 09:59:31.000000000 +0100
@@ -203,7 +203,7 @@
 	char   *gr;
 	
 	if((grouplst = (gid_t *)malloc(sizeof(gid_t) * max_gr)) == NULL) {
-		DEBUG(0,("initgroups: malloc fail !\n"));
+		ZERODEBUG(0,("initgroups: malloc fail !\n"));
 		return -1;
 	}
 
diff -Naur samba-2.2.12-orig/source/lib/signal.c samba-2.2.12/source/lib/signal.c
--- samba-2.2.12-orig/source/lib/signal.c	2004-08-12 20:24:25.000000000 +0200
+++ samba-2.2.12/source/lib/signal.c	2009-03-11 09:59:31.000000000 +0100
@@ -84,7 +84,7 @@
 	/* yikes! This platform can't block signals? */
 	static int done;
 	if (!done) {
-		DEBUG(0,("WARNING: No signal blocking available\n"));
+		ZERODEBUG(0,("WARNING: No signal blocking available\n"));
 		done=1;
 	}
 #endif
diff -Naur samba-2.2.12-orig/source/lib/smbrun.c samba-2.2.12/source/lib/smbrun.c
--- samba-2.2.12-orig/source/lib/smbrun.c	2004-08-12 20:24:25.000000000 +0200
+++ samba-2.2.12/source/lib/smbrun.c	2009-03-11 09:59:31.000000000 +0100
@@ -39,7 +39,7 @@
 	fd = smb_mkstemp(path);
 
 	if (fd == -1) {
-		DEBUG(0,("setup_out_fd: Failed to create file %s. (%s)\n",
+		ZERODEBUG(0,("setup_out_fd: Failed to create file %s. (%s)\n",
 			path, strerror(errno) ));
 		return -1;
 	}
@@ -84,7 +84,7 @@
 	CatchChildLeaveStatus();
                                    	
 	if ((pid=sys_fork()) < 0) {
-		DEBUG(0,("smbrun: fork failed with error %s\n", strerror(errno) ));
+		ZERODEBUG(0,("smbrun: fork failed with error %s\n", strerror(errno) ));
 		CatchChild(); 
 		if (outfd) {
 			close(*outfd);
diff -Naur samba-2.2.12-orig/source/lib/substitute.c samba-2.2.12/source/lib/substitute.c
--- samba-2.2.12-orig/source/lib/substitute.c	2004-08-12 20:24:24.000000000 +0200
+++ samba-2.2.12/source/lib/substitute.c	2009-03-11 09:59:31.000000000 +0100
@@ -79,7 +79,7 @@
 	 */
 
 	if ((q = strchr(p,')')) == NULL) {
-		DEBUG(0,("expand_env_var: Unterminated environment variable [%s]\n", p));
+		ZERODEBUG(0,("expand_env_var: Unterminated environment variable [%s]\n", p));
 		return 2;
 	}
 
@@ -93,7 +93,7 @@
 	envname[copylen] = '\0';
 
 	if ((envval = getenv(envname)) == NULL) {
-		DEBUG(0,("expand_env_var: Environment variable [%s] not set\n", envname));
+		ZERODEBUG(0,("expand_env_var: Environment variable [%s] not set\n", envname));
 		return 2;
 	}
 
diff -Naur samba-2.2.12-orig/source/lib/sysacls.c samba-2.2.12/source/lib/sysacls.c
--- samba-2.2.12-orig/source/lib/sysacls.c	2004-08-12 20:24:24.000000000 +0200
+++ samba-2.2.12/source/lib/sysacls.c	2009-03-11 09:59:31.000000000 +0100
@@ -1651,7 +1651,7 @@
 	}
 
 	if(aclp == NULL) {
-		DEBUG(0,("Null ACL pointer in hpux_acl_sort. Returning Failure. \n"));
+		ZERODEBUG(0,("Null ACL pointer in hpux_acl_sort. Returning Failure. \n"));
 		return -1;
 	}
 
@@ -1668,7 +1668,7 @@
 		(acl_obj_count.n_class_obj != 1) ||
 		(acl_obj_count.n_other_obj != 1) 
 	) {
-		DEBUG(0,("hpux_acl_sort: More than one entry or no entries for \
+		ZERODEBUG(0,("hpux_acl_sort: More than one entry or no entries for \
 USER OBJ or GROUP_OBJ or OTHER_OBJ or CLASS_OBJ\n"));
 		return -1;
 	}
@@ -1679,7 +1679,7 @@
 
 	if( (acl_obj_count.n_def_user_obj  > 1) || (acl_obj_count.n_def_group_obj > 1) || 
 			(acl_obj_count.n_def_other_obj > 1) || (acl_obj_count.n_def_class_obj > 1) ) {
-		DEBUG(0,("hpux_acl_sort: More than one entry for DEF_CLASS_OBJ \
+		ZERODEBUG(0,("hpux_acl_sort: More than one entry for DEF_CLASS_OBJ \
 or DEF_USER_OBJ or DEF_GROUP_OBJ or DEF_OTHER_OBJ\n"));
 		return -1;
 	}
@@ -1711,7 +1711,7 @@
 				} else if (aclp[i].a_id == aclp[j].a_id) {
 					/* We have a duplicate entry. */
 					if(hpux_prohibited_duplicate_type(aclp[i].a_type)) {
-						DEBUG(0, ("hpux_acl_sort: Duplicate entry: Type(hex): %x Id: %d\n",
+						ZERODEBUG(0, ("hpux_acl_sort: Duplicate entry: Type(hex): %x Id: %d\n",
 							aclp[i].a_type, aclp[i].a_id));
 						return -1;
 					}
@@ -2297,7 +2297,7 @@
  
 	if(file_acl == NULL) {
 		errno=ENOMEM;
-		DEBUG(0,("Error in AIX sys_acl_get_file: %d\n",errno));
+		ZERODEBUG(0,("Error in AIX sys_acl_get_file: %d\n",errno));
 		return(NULL);
 	}
 
@@ -2305,7 +2305,7 @@
 
 	rc = statacl((char *)path_p,0,file_acl,BUFSIZ);
 	if(rc == -1) {
-		DEBUG(0,("statacl returned %d with errno %d\n",rc,errno));
+		ZERODEBUG(0,("statacl returned %d with errno %d\n",rc,errno));
 		SAFE_FREE(file_acl);
 		return(NULL);
 	}
@@ -2328,7 +2328,7 @@
 	if(acl_entry_link->entryp == NULL) {
 		SAFE_FREE(file_acl);
 		errno = ENOMEM;
-		DEBUG(0,("Error in AIX sys_acl_get_file is %d\n",errno));
+		ZERODEBUG(0,("Error in AIX sys_acl_get_file is %d\n",errno));
 		return(NULL);
 	}
 
@@ -2365,7 +2365,7 @@
 				if(acl_entry_link->nextp == NULL) {
 					SAFE_FREE(file_acl);
 					errno = ENOMEM;
-					DEBUG(0,("Error in AIX sys_acl_get_file is %d\n",errno));
+					ZERODEBUG(0,("Error in AIX sys_acl_get_file is %d\n",errno));
 					return(NULL);
 				}
 
@@ -2375,7 +2375,7 @@
 				if(acl_entry_link->entryp == NULL) {
 					SAFE_FREE(file_acl);
 					errno = ENOMEM;
-					DEBUG(0,("Error in AIX sys_acl_get_file is %d\n",errno));
+					ZERODEBUG(0,("Error in AIX sys_acl_get_file is %d\n",errno));
 					return(NULL);
 				}
 				acl_entry_link->nextp = NULL;
@@ -2434,7 +2434,7 @@
 			if(acl_entry_link->nextp == NULL) {
 				SAFE_FREE(file_acl);
 				errno = ENOMEM;
-				DEBUG(0,("Error in AIX sys_acl_get_file is %d\n",errno));
+				ZERODEBUG(0,("Error in AIX sys_acl_get_file is %d\n",errno));
 				return(NULL);
 			}
 
@@ -2444,7 +2444,7 @@
 			if(acl_entry_link->entryp == NULL) {
 				SAFE_FREE(file_acl);
 				errno = ENOMEM;
-				DEBUG(0,("Error in AIX sys_acl_get_file is %d\n",errno));
+				ZERODEBUG(0,("Error in AIX sys_acl_get_file is %d\n",errno));
 				return(NULL);
 			}
 		}
@@ -2511,7 +2511,7 @@
 
 	if(file_acl == NULL) {
 		errno=ENOMEM;
-		DEBUG(0,("Error in sys_acl_get_fd is %d\n",errno));
+		ZERODEBUG(0,("Error in sys_acl_get_fd is %d\n",errno));
 		return(NULL);
 	}
 
@@ -2519,7 +2519,7 @@
 
 	rc = fstatacl(fd,0,file_acl,BUFSIZ);
 	if(rc == -1) {
-		DEBUG(0,("The fstatacl call returned %d with errno %d\n",rc,errno));
+		ZERODEBUG(0,("The fstatacl call returned %d with errno %d\n",rc,errno));
 		SAFE_FREE(file_acl);
 		return(NULL);
 	}
@@ -2544,7 +2544,7 @@
 
 	if(acl_entry_link->entryp == NULL) {
 		errno = ENOMEM;
-		DEBUG(0,("Error in sys_acl_get_fd is %d\n",errno));
+		ZERODEBUG(0,("Error in sys_acl_get_fd is %d\n",errno));
 		SAFE_FREE(file_acl);
 		return(NULL);
 	}
@@ -2580,7 +2580,7 @@
 				acl_entry_link->nextp = (struct acl_entry_link *)malloc(sizeof(struct acl_entry_link));
 				if(acl_entry_link->nextp == NULL) {
 					errno = ENOMEM;
-					DEBUG(0,("Error in sys_acl_get_fd is %d\n",errno));
+					ZERODEBUG(0,("Error in sys_acl_get_fd is %d\n",errno));
 					SAFE_FREE(file_acl);
 					return(NULL);
 				}
@@ -2589,7 +2589,7 @@
 				acl_entry_link->entryp = (struct new_acl_entry *)malloc(sizeof(struct new_acl_entry));
 				if(acl_entry_link->entryp == NULL) {
 					errno = ENOMEM;
-					DEBUG(0,("Error in sys_acl_get_fd is %d\n",errno));
+					ZERODEBUG(0,("Error in sys_acl_get_fd is %d\n",errno));
 					SAFE_FREE(file_acl);
 					return(NULL);
 				}
@@ -2648,7 +2648,7 @@
 			acl_entry_link->nextp = (struct acl_entry_link *)malloc(sizeof(struct acl_entry_link));
 			if(acl_entry_link->nextp == NULL) {
 				errno = ENOMEM;
-				DEBUG(0,("Error in sys_acl_get_fd is %d\n",errno));
+				ZERODEBUG(0,("Error in sys_acl_get_fd is %d\n",errno));
 				SAFE_FREE(file_acl);
 				return(NULL);
 			}
@@ -2660,7 +2660,7 @@
 			if(acl_entry_link->entryp == NULL) {
 				SAFE_FREE(file_acl);
 				errno = ENOMEM;
-				DEBUG(0,("Error in sys_acl_get_fd is %d\n",errno));
+				ZERODEBUG(0,("Error in sys_acl_get_fd is %d\n",errno));
 				return(NULL);
 			}
 		}
@@ -2737,7 +2737,7 @@
 	theacl = (struct acl_entry_link *)malloc(sizeof(struct acl_entry_link));
 	if(theacl == NULL) {
 		errno = ENOMEM;
-		DEBUG(0,("Error in sys_acl_init is %d\n",errno));
+		ZERODEBUG(0,("Error in sys_acl_init is %d\n",errno));
 		return(NULL);
 	}
 
@@ -2772,7 +2772,7 @@
 		temp_entry->nextp = acl_entryp = (struct acl_entry_link *)malloc(sizeof(struct acl_entry_link));
 		if(acl_entryp == NULL) {
 			errno = ENOMEM;
-			DEBUG(0,("Error in sys_acl_create_entry is %d\n",errno));
+			ZERODEBUG(0,("Error in sys_acl_create_entry is %d\n",errno));
 			return(-1);
 		}
 
@@ -2784,7 +2784,7 @@
 	*pentry = acl_entryp->entryp = (struct new_acl_entry *)malloc(sizeof(struct new_acl_entry));
 	if(*pentry == NULL) {
 		errno = ENOMEM;
-		DEBUG(0,("Error in sys_acl_create_entry is %d\n",errno));
+		ZERODEBUG(0,("Error in sys_acl_create_entry is %d\n",errno));
 		return(-1);
 	}
 
@@ -2875,7 +2875,7 @@
 
 	if(file_acl == NULL) {
 		errno = ENOMEM;
-		DEBUG(0,("Error in sys_acl_set_file is %d\n",errno));
+		ZERODEBUG(0,("Error in sys_acl_set_file is %d\n",errno));
 		return(-1);
 	}
 
@@ -2908,7 +2908,7 @@
 			if(file_acl_temp == NULL) {
 				SAFE_FREE(file_acl);
 				errno = ENOMEM;
-				DEBUG(0,("Error in sys_acl_set_file is %d\n",errno));
+				ZERODEBUG(0,("Error in sys_acl_set_file is %d\n",errno));
 				return(-1);
 			}  
 
@@ -2963,7 +2963,7 @@
 
 	if(file_acl == NULL) {
 		errno = ENOMEM;
-		DEBUG(0,("Error in sys_acl_set_fd is %d\n",errno));
+		ZERODEBUG(0,("Error in sys_acl_set_fd is %d\n",errno));
 		return(-1);
 	}
 
@@ -2997,7 +2997,7 @@
 			if(file_acl_temp == NULL) {
 				SAFE_FREE(file_acl);
 				errno = ENOMEM;
-				DEBUG(0,("Error in sys_acl_set_fd is %d\n",errno));
+				ZERODEBUG(0,("Error in sys_acl_set_fd is %d\n",errno));
 				return(-1);
 			}
 
diff -Naur samba-2.2.12-orig/source/lib/system.c samba-2.2.12/source/lib/system.c
--- samba-2.2.12-orig/source/lib/system.c	2004-08-12 20:24:24.000000000 +0200
+++ samba-2.2.12/source/lib/system.c	2009-03-11 09:59:31.000000000 +0100
@@ -526,7 +526,7 @@
 		cap_t cap = cap_get_proc();
 
 		if (cap == NULL) {
-			DEBUG(0,("set_process_capability: cap_get_proc failed. Error was %s\n",
+			ZERODEBUG(0,("set_process_capability: cap_get_proc failed. Error was %s\n",
 				strerror(errno)));
 			return False;
 		}
@@ -537,7 +537,7 @@
 			cap->cap_effective &= ~CAP_NETWORK_MGT;
 
 		if (cap_set_proc(cap) == -1) {
-			DEBUG(0,("set_process_capability: cap_set_proc failed. Error was %s\n",
+			ZERODEBUG(0,("set_process_capability: cap_set_proc failed. Error was %s\n",
 				strerror(errno)));
 			cap_free(cap);
 			return False;
@@ -560,7 +560,7 @@
 		cap_t cap = cap_get_proc();
 
 		if (cap == NULL) {
-			DEBUG(0,("set_inherited_process_capability: cap_get_proc failed. Error was %s\n",
+			ZERODEBUG(0,("set_inherited_process_capability: cap_get_proc failed. Error was %s\n",
 				strerror(errno)));
 			return False;
 		}
@@ -571,7 +571,7 @@
 			cap->cap_inheritable &= ~CAP_NETWORK_MGT;
 
 		if (cap_set_proc(cap) == -1) {
-			DEBUG(0,("set_inherited_process_capability: cap_set_proc failed. Error was %s\n", 
+			ZERODEBUG(0,("set_inherited_process_capability: cap_set_proc failed. Error was %s\n", 
 				strerror(errno)));
 			cap_free(cap);
 			return False;
@@ -608,7 +608,7 @@
 #elif defined(HAVE_RAND)
 	return (long)rand();
 #else
-	DEBUG(0,("Error - no random function available !\n"));
+	ZERODEBUG(0,("Error - no random function available !\n"));
 	exit(1);
 #endif
 }
@@ -624,7 +624,7 @@
 #elif defined(HAVE_SRAND)
 	srand(seed);
 #else
-	DEBUG(0,("Error - no srandom function available !\n"));
+	ZERODEBUG(0,("Error - no srandom function available !\n"));
 	exit(1);
 #endif
 }
@@ -675,7 +675,7 @@
 		setlen = groups_max();
 
 	if((group_list = (GID_T *)malloc(setlen * sizeof(GID_T))) == NULL) {
-		DEBUG(0,("sys_getgroups: Malloc fail.\n"));
+		ZERODEBUG(0,("sys_getgroups: Malloc fail.\n"));
 		return -1;
 	}
 
@@ -724,7 +724,7 @@
 	 */
 
 	if((group_list = (GID_T *)malloc(setlen * sizeof(GID_T))) == NULL) {
-		DEBUG(0,("sys_setgroups: Malloc fail.\n"));
+		ZERODEBUG(0,("sys_setgroups: Malloc fail.\n"));
 		return -1;    
 	}
  
@@ -1327,7 +1327,7 @@
 #if defined(HAVE_SYSLOG)
 	syslog( priority, "%s", *msgbuf );
 #else
-	DEBUG(0,("%s", *msgbuf ));
+	ZERODEBUG(0,("%s", *msgbuf ));
 #endif
 	SAFE_FREE(*msgbuf);
 }
diff -Naur samba-2.2.12-orig/source/lib/time.c samba-2.2.12/source/lib/time.c
--- samba-2.2.12-orig/source/lib/time.c	2004-08-12 20:24:24.000000000 +0200
+++ samba-2.2.12/source/lib/time.c	2009-03-11 09:59:31.000000000 +0100
@@ -185,7 +185,7 @@
     tdt = (struct dst_table *)Realloc(dst_table,
 					      sizeof(dst_table[0])*(i+1));
     if (!tdt) {
-      DEBUG(0,("TimeZoneFaster: out of memory!\n"));
+      ZERODEBUG(0,("TimeZoneFaster: out of memory!\n"));
       SAFE_FREE(dst_table);
       table_size = 0;
     } else {
diff -Naur samba-2.2.12-orig/source/lib/username.c samba-2.2.12/source/lib/username.c
--- samba-2.2.12-orig/source/lib/username.c	2004-08-12 20:24:24.000000000 +0200
+++ samba-2.2.12/source/lib/username.c	2009-03-11 09:59:31.000000000 +0100
@@ -127,7 +127,7 @@
   
 	f = sys_fopen(mapfile,"r");
 	if (!f) {
-		DEBUG(0,("can't open username map %s. Error %s\n",mapfile, strerror(errno) ));
+		ZERODEBUG(0,("can't open username map %s. Error %s\n",mapfile, strerror(errno) ));
 		return False;
 	}
 
@@ -337,12 +337,12 @@
  	}
  
  	if ((groups = (gid_t *)malloc(sizeof(gid_t) * num_groups )) == NULL) {
- 		DEBUG(0,("user_in_winbind_group_list: malloc fail.\n"));
+ 		ZERODEBUG(0,("user_in_winbind_group_list: malloc fail.\n"));
  		goto err;
  	}
  
  	if ((num_groups = winbind_getgroups(user, num_groups, groups)) == -1) {
- 		DEBUG(0,("user_in_winbind_group_list: second winbind_getgroups call \
+ 		ZERODEBUG(0,("user_in_winbind_group_list: second winbind_getgroups call \
 failed with error %s\n", strerror(errno) ));
  		goto err;
 	}
@@ -353,7 +353,7 @@
  	 */
  
 	if ((gid = nametogid(gname)) == (gid_t)-1) {
- 		DEBUG(0,("user_in_winbind_group_list: winbind_lookup_name for group %s failed.\n",
+ 		ZERODEBUG(0,("user_in_winbind_group_list: winbind_lookup_name for group %s failed.\n",
  			gname ));
  		goto err;
  	}
diff -Naur samba-2.2.12-orig/source/lib/util.c samba-2.2.12/source/lib/util.c
--- samba-2.2.12-orig/source/lib/util.c	2004-08-12 20:24:24.000000000 +0200
+++ samba-2.2.12/source/lib/util.c	2009-03-11 09:59:31.000000000 +0100
@@ -467,11 +467,11 @@
     fd = sys_open("/dev/null",O_RDWR,0);
     if (fd < 0) fd = sys_open("/dev/null",O_WRONLY,0);
     if (fd < 0) {
-      DEBUG(0,("Can't open /dev/null\n"));
+      ZERODEBUG(0,("Can't open /dev/null\n"));
       return;
     }
     if (fd != i) {
-      DEBUG(0,("Didn't get file descriptor %d\n",i));
+      ZERODEBUG(0,("Didn't get file descriptor %d\n",i));
       return;
     }
   }
@@ -533,7 +533,7 @@
 
 		read_ret = (*read_fn)(infd, buf, num_to_read_thistime);
 		if (read_ret == -1) {
-			DEBUG(0,("transfer_file_internal: read failure. Error = %s\n", strerror(errno) ));
+			ZERODEBUG(0,("transfer_file_internal: read failure. Error = %s\n", strerror(errno) ));
 			SAFE_FREE(buf);
 			return -1;
 		}
@@ -546,7 +546,7 @@
 			write_ret = (*write_fn)(outfd,buf + num_written, read_ret - num_written);
  
 			if (write_ret == -1) {
-				DEBUG(0,("transfer_file_internal: write failure. Error = %s\n", strerror(errno) ));
+				ZERODEBUG(0,("transfer_file_internal: write failure. Error = %s\n", strerror(errno) ));
 				SAFE_FREE(buf);
 				return -1;
 			}
@@ -670,7 +670,7 @@
 		ret = (void *)realloc(p,size);
 
 	if (!ret)
-		DEBUG(0,("Memory allocation error: failed to expand to %d bytes\n",(int)size));
+		ZERODEBUG(0,("Memory allocation error: failed to expand to %d bytes\n",(int)size));
 
 	return(ret);
 }
@@ -698,7 +698,7 @@
 
 	/* get my host name */
 	if (gethostname(hostname, sizeof(hostname)) == -1) {
-		DEBUG(0,("gethostname failed\n"));
+		ZERODEBUG(0,("gethostname failed\n"));
 		return False;
 	} 
 
@@ -736,7 +736,7 @@
   if (strequal(str,"CORE+"))
     return(PROTOCOL_COREPLUS);
   
-  DEBUG(0,("Unrecognised protocol level %s\n",str));
+  ZERODEBUG(0,("Unrecognised protocol level %s\n",str));
   
   return(def);
 }
@@ -1091,7 +1091,7 @@
 	if (cmd && *cmd) {
 		system(cmd);
 	}
-	DEBUG(0,("PANIC: %s\n", why));
+	ZERODEBUG(0,("PANIC: %s\n", why));
 	dbgflush();
 	abort();
 }
@@ -1236,7 +1236,7 @@
   if(( (*ppname_array) = (name_compare_entry *)malloc( 
            (num_entries + 1) * sizeof(name_compare_entry))) == NULL)
         {
-    DEBUG(0,("set_namearray: malloc fail\n"));
+    ZERODEBUG(0,("set_namearray: malloc fail\n"));
     return;
         }
 
@@ -1264,7 +1264,7 @@
       (*ppname_array)[i].is_wild = ms_has_wild(nameptr);
       if(((*ppname_array)[i].name = strdup(nameptr)) == NULL)
       {
-        DEBUG(0,("set_namearray: malloc fail (1)\n"));
+        ZERODEBUG(0,("set_namearray: malloc fail (1)\n"));
         return;
       }
 
@@ -1620,7 +1620,7 @@
 	int saved_current_limit;
 
 	if(getrlimit(RLIMIT_NOFILE, &rlp)) {
-		DEBUG(0,("set_maxfiles: getrlimit (1) for RLIMIT_NOFILE failed with error %s\n",
+		ZERODEBUG(0,("set_maxfiles: getrlimit (1) for RLIMIT_NOFILE failed with error %s\n",
 			strerror(errno) ));
 		/* just guess... */
 		return requested_max;
@@ -1662,14 +1662,14 @@
 	saved_current_limit = rlp.rlim_cur = MIN(requested_max,rlp.rlim_max);
 
 	if(setrlimit(RLIMIT_NOFILE, &rlp)) {
-		DEBUG(0,("set_maxfiles: setrlimit for RLIMIT_NOFILE for %d files failed with error %s\n", 
+		ZERODEBUG(0,("set_maxfiles: setrlimit for RLIMIT_NOFILE for %d files failed with error %s\n", 
 			(int)rlp.rlim_cur, strerror(errno) ));
 		/* just guess... */
 		return saved_current_limit;
 	}
 
 	if(getrlimit(RLIMIT_NOFILE, &rlp)) {
-		DEBUG(0,("set_maxfiles: getrlimit (2) for RLIMIT_NOFILE failed with error %s\n",
+		ZERODEBUG(0,("set_maxfiles: getrlimit (2) for RLIMIT_NOFILE failed with error %s\n",
 			strerror(errno) ));
 		/* just guess... */
 		return saved_current_limit;
diff -Naur samba-2.2.12-orig/source/lib/util_file.c samba-2.2.12/source/lib/util_file.c
--- samba-2.2.12-orig/source/lib/util_file.c	2004-08-12 20:24:24.000000000 +0200
+++ samba-2.2.12/source/lib/util_file.c	2009-03-11 09:59:31.000000000 +0100
@@ -56,7 +56,7 @@
   CatchSignal(SIGALRM, SIGNAL_CAST SIG_IGN);
 
   if (gotalarm) {
-    DEBUG(0, ("do_file_lock: failed to %s file.\n",
+    ZERODEBUG(0, ("do_file_lock: failed to %s file.\n",
                 type == F_UNLCK ? "unlock" : "lock"));
     return False;
   }
@@ -119,7 +119,7 @@
 
   if (!*pfile)
  {
-    DEBUG(0, ("startfilepwent: No file set\n"));
+    ZERODEBUG(0, ("startfilepwent: No file set\n"));
     return (NULL);
   }
   DEBUG(10, ("startfilepwent: opening file %s\n", pfile));
@@ -127,7 +127,7 @@
   fp = sys_fopen(pfile, update ? "r+b" : "rb");
 
   if (fp == NULL) {
-    DEBUG(0, ("startfilepwent: unable to open file %s\n", pfile));
+    ZERODEBUG(0, ("startfilepwent: unable to open file %s\n", pfile));
     return NULL;
   }
 
@@ -136,7 +136,7 @@
 
   if (!file_lock(fileno(fp), (update ? F_WRLCK : F_RDLCK), 5, file_lock_depth))
   {
-    DEBUG(0, ("startfilepwent: unable to lock file %s\n", pfile));
+    ZERODEBUG(0, ("startfilepwent: unable to lock file %s\n", pfile));
     fclose(fp);
     return NULL;
   }
@@ -193,7 +193,7 @@
 
 	if (fp == NULL)
 	{
-		DEBUG(0,("getfileline: Bad file pointer.\n"));
+		ZERODEBUG(0,("getfileline: Bad file pointer.\n"));
 		return -1;
 	}
 
@@ -257,7 +257,7 @@
 		p = (unsigned char *) strchr(linebuf, ':');
 		if (p == NULL)
 		{
-			DEBUG(0, ("getfileline: malformed line entry (no :)\n"));
+			ZERODEBUG(0, ("getfileline: malformed line entry (no :)\n"));
 			continue;
 		}
 		return linebuf_len;
@@ -290,7 +290,7 @@
       maxlen = MIN(maxlen,8);
       t = (char *)Realloc(s,maxlen);
       if (!t) {
-        DEBUG(0,("fgets_slash: failed to expand buffer!\n"));
+        ZERODEBUG(0,("fgets_slash: failed to expand buffer!\n"));
         SAFE_FREE(s);
         return(NULL);
       } else
@@ -339,7 +339,7 @@
         maxlen *= 2;
         t = (char *)Realloc(s,maxlen);
         if (!t) {
-          DEBUG(0,("fgets_slash: failed to expand buffer!\n"));
+          ZERODEBUG(0,("fgets_slash: failed to expand buffer!\n"));
           SAFE_FREE(s);
           return(NULL);
         } else
@@ -369,7 +369,7 @@
 	while ((n = read(fd, buf, sizeof(buf))) > 0) {
 		tp = Realloc(p, total + n + 1);
 		if (!tp) {
-			DEBUG(0,("file_pload: failed to exand buffer!\n"));
+			ZERODEBUG(0,("file_pload: failed to exand buffer!\n"));
 			close(fd);
 			SAFE_FREE(p);
 			return NULL;
diff -Naur samba-2.2.12-orig/source/lib/util_getent.c samba-2.2.12/source/lib/util_getent.c
--- samba-2.2.12-orig/source/lib/util_getent.c	2004-08-12 20:24:24.000000000 +0200
+++ samba-2.2.12/source/lib/util_getent.c	2009-03-11 10:04:13.000000000 +0100
@@ -57,7 +57,7 @@
 	
 	gent = (struct sys_grent *) malloc(sizeof(struct sys_grent));
 	if (gent == NULL) {
-		DEBUG (0, ("Out of memory in getgrent_list!\n"));
+		ZERODEBUG (0, ("Out of memory in getgrent_list!\n"));
 		return NULL;
 	}
 	memset(gent, '\0', sizeof(struct sys_grent));
@@ -116,7 +116,7 @@
   err:
 
 	endgrent();
-	DEBUG(0, ("Out of memory in getgrent_list!\n"));
+	ZERODEBUG(0, ("Out of memory in getgrent_list!\n"));
 	grent_free(glist);
 	return NULL;
 }
@@ -158,7 +158,7 @@
 	
 	pent = (struct sys_pwent *) malloc(sizeof(struct sys_pwent));
 	if (pent == NULL) {
-		DEBUG (0, ("Out of memory in getpwent_list!\n"));
+		ZERODEBUG (0, ("Out of memory in getpwent_list!\n"));
 		return NULL;
 	}
 	plist = pent;
@@ -205,7 +205,7 @@
   err:
 
 	endpwent();
-	DEBUG(0, ("Out of memory in getpwent_list!\n"));
+	ZERODEBUG(0, ("Out of memory in getpwent_list!\n"));
 	pwent_free(plist);
 	return NULL;
 }
diff -Naur samba-2.2.12-orig/source/lib/util_sec.c samba-2.2.12/source/lib/util_sec.c
--- samba-2.2.12-orig/source/lib/util_sec.c	2004-08-12 20:24:25.000000000 +0200
+++ samba-2.2.12/source/lib/util_sec.c	2009-03-11 09:59:31.000000000 +0100
@@ -91,7 +91,7 @@
 	if ((euid != (uid_t)-1 && geteuid() != euid) ||
 	    (ruid != (uid_t)-1 && getuid() != ruid)) {
 		if (!non_root_mode()) {
-			DEBUG(0,("Failed to set uid privileges to (%d,%d) now set to (%d,%d)\n",
+			ZERODEBUG(0,("Failed to set uid privileges to (%d,%d) now set to (%d,%d)\n",
 				 (int)ruid, (int)euid,
 				 (int)getuid(), (int)geteuid()));
 			smb_panic("failed to set uid\n");
@@ -108,7 +108,7 @@
 	if ((egid != (gid_t)-1 && getegid() != egid) ||
 	    (rgid != (gid_t)-1 && getgid() != rgid)) {
 		if (!non_root_mode()) {
-			DEBUG(0,("Failed to set gid privileges to (%d,%d) now set to (%d,%d) uid=(%d,%d)\n",
+			ZERODEBUG(0,("Failed to set gid privileges to (%d,%d) now set to (%d,%d) uid=(%d,%d)\n",
 				 (int)rgid, (int)egid,
 				 (int)getgid(), (int)getegid(),
 				 (int)getuid(), (int)geteuid()));
diff -Naur samba-2.2.12-orig/source/lib/util_sid.c samba-2.2.12/source/lib/util_sid.c
--- samba-2.2.12-orig/source/lib/util_sid.c	2004-08-12 20:24:25.000000000 +0200
+++ samba-2.2.12/source/lib/util_sid.c	2009-03-11 09:59:31.000000000 +0100
@@ -303,7 +303,7 @@
 		i++;
 	}
 
-	DEBUG(0,("map_domain_name_to_sid: mapping to %s not found.\n", nt_domain));
+	ZERODEBUG(0,("map_domain_name_to_sid: mapping to %s not found.\n", nt_domain));
 	return False;
 }
 
@@ -388,7 +388,7 @@
   uint32 ia;
   
   if (StrnCaseCmp( sidstr, "S-", 2)) {
-    DEBUG(0,("string_to_sid: Sid %s does not start with 'S-'.\n", sidstr));
+    ZERODEBUG(0,("string_to_sid: Sid %s does not start with 'S-'.\n", sidstr));
     return False;
   }
 
@@ -396,12 +396,12 @@
 
   p = q = strdup(sidstr + 2);
   if (p == NULL) {
-    DEBUG(0, ("string_to_sid: out of memory!\n"));
+    ZERODEBUG(0, ("string_to_sid: out of memory!\n"));
     return False;
   }
 
   if (!next_token(&p, tok, "-", sizeof(tok))) {
-    DEBUG(0,("string_to_sid: Sid %s is not in a valid format.\n", sidstr));
+    ZERODEBUG(0,("string_to_sid: Sid %s is not in a valid format.\n", sidstr));
     SAFE_FREE(q);
     return False;
   }
@@ -410,7 +410,7 @@
   sidout->sid_rev_num = (uint8)strtoul(tok, NULL, 10);
 
   if (!next_token(&p, tok, "-", sizeof(tok))) {
-    DEBUG(0,("string_to_sid: Sid %s is not in a valid format.\n", sidstr));
+    ZERODEBUG(0,("string_to_sid: Sid %s is not in a valid format.\n", sidstr));
     SAFE_FREE(q);
     return False;
   }
diff -Naur samba-2.2.12-orig/source/lib/util_sock.c samba-2.2.12/source/lib/util_sock.c
--- samba-2.2.12-orig/source/lib/util_sock.c	2004-08-12 20:24:24.000000000 +0200
+++ samba-2.2.12/source/lib/util_sock.c	2009-03-11 13:30:58.000000000 +0100
@@ -138,7 +138,7 @@
 				break;
 
 		if (!socket_options[i].name) {
-			DEBUG(0,("Unknown socket option %s\n",tok));
+			ZERODEBUG(0,("Unknown socket option %s\n",tok));
 			continue;
 		}
 
@@ -151,7 +151,7 @@
 
 		case OPT_ON:
 			if (got_value)
-				DEBUG(0,("syntax error - %s does not take a value\n",tok));
+				ZERODEBUG(0,("syntax error - %s does not take a value\n",tok));
 
 			{
 				int on = socket_options[i].value;
@@ -162,7 +162,7 @@
 		}
       
 		if (ret != 0)
-			DEBUG(0,("Failed to set socket option %s (Error %s)\n",tok, strerror(errno) ));
+			ZERODEBUG(0,("Failed to set socket option %s (Error %s)\n",tok, strerror(errno) ));
 	}
 
 	print_socket_options(fd);
@@ -238,7 +238,7 @@
       }
 
       if (readret == -1) {
-        DEBUG(0,("read_socket_with_timeout: read error = %s.\n", strerror(errno) ));
+        ZERODEBUG(0,("read_socket_with_timeout: read error = %s.\n", strerror(errno) ));
         smb_read_error = READ_ERROR;
         return -1;
       }
@@ -266,7 +266,7 @@
     /* Check if error */
     if(selrtn == -1) {
       /* something is wrong. Maybe the socket is dead? */
-      DEBUG(0,("read_socket_with_timeout: timeout read. select error = %s.\n", strerror(errno) ));
+      ZERODEBUG(0,("read_socket_with_timeout: timeout read. select error = %s.\n", strerror(errno) ));
       smb_read_error = READ_ERROR;
       return -1;
     }
@@ -297,7 +297,7 @@
 
     if (readret == -1) {
       /* the descriptor is probably dead */
-      DEBUG(0,("read_socket_with_timeout: timeout read. read error = %s.\n", strerror(errno) ));
+      ZERODEBUG(0,("read_socket_with_timeout: timeout read. read error = %s.\n", strerror(errno) ));
       smb_read_error = READ_ERROR;
       return -1;
     }
@@ -433,7 +433,7 @@
 		}
 
 		if (ret == -1) {
-			DEBUG(0,("read_data: read failure for %d. Error = %s\n", (int)(N - total), strerror(errno) ));
+			ZERODEBUG(0,("read_data: read failure for %d. Error = %s\n", (int)(N - total), strerror(errno) ));
 			smb_read_error = READ_ERROR;
 			return -1;
 		}
@@ -463,7 +463,7 @@
 #endif /* WITH_SSL */
 
 		if (ret == -1) {
-			DEBUG(0,("write_data: write failure. Error = %s\n", strerror(errno) ));
+			ZERODEBUG(0,("write_data: write failure. Error = %s\n", strerror(errno) ));
 			return -1;
 		}
 		if (ret == 0)
@@ -496,7 +496,7 @@
 #endif /* WITH_SSL */
 
 		if (ret == -1) {
-			DEBUG(0,("write_socket_data: write failure. Error = %s\n", strerror(errno) ));
+			ZERODEBUG(0,("write_socket_data: write failure. Error = %s\n", strerror(errno) ));
 			return -1;
 		}
 		if (ret == 0)
@@ -520,7 +520,7 @@
       
 	DEBUG(6,("write_socket(%d,%d) wrote %d\n",fd,(int)len,(int)ret));
 	if(ret <= 0)
-		DEBUG(0,("write_socket: Error writing %d bytes to socket %d: ERRNO = %s\n", 
+		ZERODEBUG(0,("write_socket: Error writing %d bytes to socket %d: ERRNO = %s\n", 
 			(int)len, fd, strerror(errno) ));
 
 	return(ret);
@@ -625,7 +625,7 @@
 	 */
 
 	if (len > (BUFFER_SIZE + LARGE_WRITEX_HDR_SIZE)) {
-		DEBUG(0,("Invalid packet length! (%d bytes).\n",len));
+		ZERODEBUG(0,("Invalid packet length! (%d bytes).\n",len));
 		if (len > BUFFER_SIZE + (SAFETY_MARGIN/2)) {
 
 			/*
@@ -700,7 +700,7 @@
 	while (nwritten < len) {
 		ret = write_socket(fd,buffer+nwritten,len - nwritten);
 		if (ret <= 0) {
-			DEBUG(0,("Error writing %d bytes to client. %d. (%s)\n",
+			ZERODEBUG(0,("Error writing %d bytes to client. %d. (%s)\n",
 				(int)len,(int)ret, strerror(errno) ));
 			return False;
 		}
@@ -724,7 +724,7 @@
   out_fd = socket(AF_INET, type, 0);
   if (out_fd == -1) 
     {
-      DEBUG(0,("socket failed"));
+      ZERODEBUG(0,("socket failed"));
       return False;
     }
 
@@ -742,7 +742,7 @@
   ret = (sys_sendto(out_fd,buf,len,0,(struct sockaddr *)&sock_out,sizeof(sock_out)) >= 0);
 
   if (!ret)
-    DEBUG(0,("Packet send to %s(%d) failed ERRNO=%s\n",
+    ZERODEBUG(0,("Packet send to %s(%d) failed ERRNO=%s\n",
 	     inet_ntoa(ip),port,strerror(errno)));
 
   close(out_fd);
@@ -769,7 +769,7 @@
 
 	res = socket( AF_INET, type, 0 );
 	if( res == -1 ) {
-		if( DEBUGLVL(0) ) {
+		if( ZERODEBUGLVL(0) ) {
 			dbgtext( "open_socket_in(): socket() call failed: " );
 			dbgtext( "%s\n", strerror( errno ) );
 		}
@@ -829,7 +829,7 @@
   /* create a socket to write to */
   res = socket(PF_INET, type, 0);
   if (res == -1) 
-    { DEBUG(0,("socket error\n")); return -1; }
+    { ZERODEBUG(0,("socket error\n")); return -1; }
 
   if (type != SOCK_STREAM) return(res);
   
@@ -912,7 +912,7 @@
 	int     i;
 	
 	if ((hp = sys_gethostbyname(remotehost)) == 0) {
-		DEBUG(0,("sys_gethostbyname(%s): lookup failure.\n", remotehost));
+		ZERODEBUG(0,("sys_gethostbyname(%s): lookup failure.\n", remotehost));
 		return False;
 	} 
 
@@ -926,7 +926,7 @@
 	
 	if (strcasecmp(remotehost, hp->h_name)
 	    && strcasecmp(remotehost, "localhost")) {
-		DEBUG(0,("host name/name mismatch: %s != %s\n",
+		ZERODEBUG(0,("host name/name mismatch: %s != %s\n",
 			 remotehost, hp->h_name));
 		return False;
 	}
@@ -943,7 +943,7 @@
 	 * it, but that could be dangerous, too.
 	 */
 	
-	DEBUG(0,("host name/address mismatch: %s != %s\n",
+	ZERODEBUG(0,("host name/address mismatch: %s != %s\n",
 		 inet_ntoa(addr), hp->h_name));
 	return False;
 }
@@ -979,7 +979,7 @@
 	} else {
 		pstrcpy(name_buf,(char *)hp->h_name);
 		if (!matchname(name_buf, addr)) {
-			DEBUG(0,("Matchname failed on %s %s\n",name_buf,p));
+			ZERODEBUG(0,("Matchname failed on %s %s\n",name_buf,p));
 			pstrcpy(name_buf,"UNKNOWN");
 		}
 	}
@@ -1009,7 +1009,7 @@
 	}
 	
 	if (getpeername(fd, &sa, &length) < 0) {
-		DEBUG(0,("getpeername failed. Error was %s\n", strerror(errno) ));
+		ZERODEBUG(0,("getpeername failed. Error was %s\n", strerror(errno) ));
 		return addr_buf;
 	}
 	
@@ -1045,26 +1045,26 @@
 		if (errno == ENOENT) {
 			/* Create directory */
 			if (mkdir(socket_dir, dir_perms) == -1) {
-				DEBUG(0, ("error creating socket directory "
+				ZERODEBUG(0, ("error creating socket directory "
 					"%s: %s\n", socket_dir, 
 					strerror(errno)));
 				goto out_umask;
 			}
 		} else {
-			DEBUG(0, ("lstat failed on socket directory %s: %s\n",
+			ZERODEBUG(0, ("lstat failed on socket directory %s: %s\n",
 				socket_dir, strerror(errno)));
 			goto out_umask;
 		}
 	} else {
 		/* Check ownership and permission on existing directory */
 		if (!S_ISDIR(st.st_mode)) {
-			DEBUG(0, ("socket directory %s isn't a directory\n",
+			ZERODEBUG(0, ("socket directory %s isn't a directory\n",
 				socket_dir));
 			goto out_umask;
 		}
 		if ((st.st_uid != sec_initial_uid()) || 
 				((st.st_mode & 0777) != dir_perms)) {
-			DEBUG(0, ("invalid permissions on socket directory "
+			ZERODEBUG(0, ("invalid permissions on socket directory "
 				"%s\n", socket_dir));
 			goto out_umask;
 		}
@@ -1087,13 +1087,13 @@
 	safe_strcpy(sunaddr.sun_path, path, sizeof(sunaddr.sun_path)-1);
         
 	if (bind(sock, (struct sockaddr *)&sunaddr, sizeof(sunaddr)) == -1) {
-		DEBUG(0, ("bind failed on pipe socket %s: %s\n", path,
+		ZERODEBUG(0, ("bind failed on pipe socket %s: %s\n", path,
 			strerror(errno)));
 		goto out_close;
 	}
         
 	if (listen(sock, 5) == -1) {
-		DEBUG(0, ("listen failed on pipe socket %s: %s\n", path,
+		ZERODEBUG(0, ("listen failed on pipe socket %s: %s\n", path,
 			strerror(errno)));
 		goto out_close;
 	}
@@ -1109,7 +1109,7 @@
 	return -1;
 
 #else
-        DEBUG(0, ("create_pipe_sock: No Unix sockets on this system\n"));
+        ZERODEBUG(0, ("create_pipe_sock: No Unix sockets on this system\n"));
         return -1;
 #endif /* HAVE_UNIXSOCKET */
 }
@@ -1192,7 +1192,7 @@
 {
 	int fd[2];
 	if (socketpair_tcp(fd) != 0) {
-		DEBUG(0,("socketpair_tcp failed (%s)\n", strerror(errno)));
+		ZERODEBUG(0,("socketpair_tcp failed (%s)\n", strerror(errno)));
 		return -1;
 	}
 	if (fork() == 0) {
diff -Naur samba-2.2.12-orig/source/lib/util_str.c samba-2.2.12/source/lib/util_str.c
--- samba-2.2.12-orig/source/lib/util_str.c	2004-08-12 20:24:25.000000000 +0200
+++ samba-2.2.12/source/lib/util_str.c	2009-03-11 09:59:32.000000000 +0100
@@ -891,7 +891,7 @@
 	size_t len;
 
 	if (!dest) {
-		DEBUG(0,("ERROR: NULL dest in safe_strcpy\n"));
+		ZERODEBUG(0,("ERROR: NULL dest in safe_strcpy\n"));
 		return NULL;
 	}
 
@@ -903,7 +903,7 @@
 	len = strlen(src);
 
 	if (len > maxlength) {
-		DEBUG(0,("ERROR: string overflow by %d in safe_strcpy [%.50s]\n",
+		ZERODEBUG(0,("ERROR: string overflow by %d in safe_strcpy [%.50s]\n",
 			(int)(len-maxlength), src));
 		len = maxlength;
 	}
@@ -923,7 +923,7 @@
 	size_t src_len, dest_len;
 
 	if (!dest) {
-		DEBUG(0,("ERROR: NULL dest in safe_strcat\n"));
+		ZERODEBUG(0,("ERROR: NULL dest in safe_strcat\n"));
 		return NULL;
 	}
 
@@ -934,7 +934,7 @@
 	dest_len = strlen(dest);
 
 	if (src_len + dest_len > maxlength) {
-		DEBUG(0,("ERROR: string overflow by %d in safe_strcat [%.50s]\n",
+		ZERODEBUG(0,("ERROR: string overflow by %d in safe_strcat [%.50s]\n",
 			 (int)(src_len + dest_len - maxlength), src));
 		if (maxlength > dest_len) {
 			memcpy(&dest[dest_len], src, maxlength - dest_len);
@@ -962,7 +962,7 @@
 	smb_ucs2_t *str_ucs, *other_ucs;
 
 	if (!dest) {
-		DEBUG(0,("ERROR: NULL dest in alpha_strcpy\n"));
+		ZERODEBUG(0,("ERROR: NULL dest in alpha_strcpy\n"));
 		return NULL;
 	}
 
@@ -1145,7 +1145,7 @@
     {
       if (!null_string) {
         if((null_string = (char *)malloc(1)) == NULL) {
-          DEBUG(0,("string_init: malloc fail for null_string.\n"));
+          ZERODEBUG(0,("string_init: malloc fail for null_string.\n"));
           return False;
         }
         *null_string = 0;
@@ -1156,7 +1156,7 @@
     {
       (*dest) = (char *)malloc(l+1);
       if ((*dest) == NULL) {
-	      DEBUG(0,("Out of memory in string_init\n"));
+	      ZERODEBUG(0,("Out of memory in string_init\n"));
 	      return False;
       }
 
@@ -1216,7 +1216,7 @@
 	
 	while (lp <= ls && (p = strstr(s,pattern))) {
 		if (ls + (li-lp) >= len) {
-			DEBUG(0,("ERROR: string overflow by %d in string_sub(%.50s, %d)\n", 
+			ZERODEBUG(0,("ERROR: string overflow by %d in string_sub(%.50s, %d)\n", 
 				 (int)(ls + (li-lp) - len),
 				 pattern, (int)len));
 			break;
@@ -1278,7 +1278,7 @@
 	
 	while (lp <= ls && (p = strstr(s,pattern))) {
 		if (ls + (li-lp) >= len) {
-			DEBUG(0,("ERROR: string overflow by %d in all_string_sub(%.50s, %d)\n", 
+			ZERODEBUG(0,("ERROR: string overflow by %d in all_string_sub(%.50s, %d)\n", 
 				 (int)(ls + (li-lp) - len),
 				 pattern, (int)len));
 			break;
diff -Naur samba-2.2.12-orig/source/lib/util_unistr.c samba-2.2.12/source/lib/util_unistr.c
--- samba-2.2.12-orig/source/lib/util_unistr.c	2004-08-12 20:24:24.000000000 +0200
+++ samba-2.2.12/source/lib/util_unistr.c	2009-03-11 09:59:32.000000000 +0100
@@ -570,7 +570,7 @@
   free_maps(pp_cp_to_ucs2, pp_ucs2_to_cp);
 
   if ((*pp_ucs2_to_cp = (uint16 *)malloc(2*65536)) == NULL) {
-    DEBUG(0,("default_unicode_map: malloc fail for ucs2_to_cp size %u.\n", 2*65536));
+    ZERODEBUG(0,("default_unicode_map: malloc fail for ucs2_to_cp size %u.\n", 2*65536));
     abort();
   }
 
@@ -603,7 +603,7 @@
 
   if(strlen(lp_codepagedir()) + 13 + strlen(codepage) > 
      sizeof(unicode_map_file_name)) {
-    DEBUG(0,("load_unicode_map: filename too long to load\n"));
+    ZERODEBUG(0,("load_unicode_map: filename too long to load\n"));
     goto clean_and_exit;
   }
 
@@ -613,7 +613,7 @@
   pstrcat(unicode_map_file_name, codepage);
 
   if(sys_stat(unicode_map_file_name,&st)!=0) {
-    DEBUG(0,("load_unicode_map: filename %s does not exist.\n",
+    ZERODEBUG(0,("load_unicode_map: filename %s does not exist.\n",
               unicode_map_file_name));
     goto clean_and_exit;
   }
@@ -621,26 +621,26 @@
   size = st.st_size;
 
   if ((size != UNICODE_MAP_HEADER_SIZE + 4*65536) && (size != UNICODE_MAP_HEADER_SIZE +(2*256 + 2*65536))) {
-    DEBUG(0,("load_unicode_map: file %s is an incorrect size for a \
+    ZERODEBUG(0,("load_unicode_map: file %s is an incorrect size for a \
 unicode map file (size=%d).\n", unicode_map_file_name, (int)size));
     goto clean_and_exit;
   }
 
   if((fp = sys_fopen( unicode_map_file_name, "r")) == NULL) {
-    DEBUG(0,("load_unicode_map: cannot open file %s. Error was %s\n",
+    ZERODEBUG(0,("load_unicode_map: cannot open file %s. Error was %s\n",
               unicode_map_file_name, strerror(errno)));
     goto clean_and_exit;
   }
 
   if(fread( buf, 1, UNICODE_MAP_HEADER_SIZE, fp)!=UNICODE_MAP_HEADER_SIZE) {
-    DEBUG(0,("load_unicode_map: cannot read header from file %s. Error was %s\n",
+    ZERODEBUG(0,("load_unicode_map: cannot read header from file %s. Error was %s\n",
               unicode_map_file_name, strerror(errno)));
     goto clean_and_exit;
   }
 
   /* Check the version value */
   if(SVAL(buf,UNICODE_MAP_VERSION_OFFSET) != UNICODE_MAP_FILE_VERSION_ID) {
-    DEBUG(0,("load_unicode_map: filename %s has incorrect version id. \
+    ZERODEBUG(0,("load_unicode_map: filename %s has incorrect version id. \
 Needed %hu, got %hu.\n",
           unicode_map_file_name, (uint16)UNICODE_MAP_FILE_VERSION_ID,
           SVAL(buf,UNICODE_MAP_VERSION_OFFSET)));
@@ -649,7 +649,7 @@
 
   /* Check the codepage value */
   if(!strequal(&buf[UNICODE_MAP_CLIENT_CODEPAGE_OFFSET], codepage)) {
-    DEBUG(0,("load_unicode_map: codepage %s in file %s is not the same as that \
+    ZERODEBUG(0,("load_unicode_map: codepage %s in file %s is not the same as that \
 requested (%s).\n", &buf[UNICODE_MAP_CLIENT_CODEPAGE_OFFSET], unicode_map_file_name, codepage ));
     goto clean_and_exit;
   }
@@ -674,23 +674,23 @@
   free_maps(pp_cp_to_ucs2, pp_ucs2_to_cp);
 
   if ((cp_to_ucs2 = (smb_ucs2_t *)malloc(cp_to_ucs2_size)) == NULL) {
-    DEBUG(0,("load_unicode_map: malloc fail for cp_to_ucs2 size %u.\n", cp_to_ucs2_size ));
+    ZERODEBUG(0,("load_unicode_map: malloc fail for cp_to_ucs2 size %u.\n", cp_to_ucs2_size ));
     goto clean_and_exit;
   }
 
   if ((ucs2_to_cp = (uint16 *)malloc(ucs2_to_cp_size)) == NULL) {
-    DEBUG(0,("load_unicode_map: malloc fail for ucs2_to_cp size %u.\n", ucs2_to_cp_size ));
+    ZERODEBUG(0,("load_unicode_map: malloc fail for ucs2_to_cp size %u.\n", ucs2_to_cp_size ));
     goto clean_and_exit;
   }
 
   if(fread( (char *)cp_to_ucs2, 1, cp_to_ucs2_size, fp)!=cp_to_ucs2_size) {
-    DEBUG(0,("load_unicode_map: cannot read cp_to_ucs2 from file %s. Error was %s\n",
+    ZERODEBUG(0,("load_unicode_map: cannot read cp_to_ucs2 from file %s. Error was %s\n",
               unicode_map_file_name, strerror(errno)));
     goto clean_and_exit;
   }
 
   if(fread( (char *)ucs2_to_cp, 1, ucs2_to_cp_size, fp)!=ucs2_to_cp_size) {
-    DEBUG(0,("load_unicode_map: cannot read ucs2_to_cp from file %s. Error was %s\n",
+    ZERODEBUG(0,("load_unicode_map: cannot read ucs2_to_cp from file %s. Error was %s\n",
               unicode_map_file_name, strerror(errno)));
     goto clean_and_exit;
   }
@@ -957,7 +957,7 @@
     size_t ucs2_len;
 
     if (!dest) {
-        DEBUG(0,("ERROR: NULL dest in safe_strcpy_w\n"));
+        ZERODEBUG(0,("ERROR: NULL dest in safe_strcpy_w\n"));
         return NULL;
     }
 
@@ -972,7 +972,7 @@
 
     if (ucs2_len >= maxlength) {
 		fstring out;
-        DEBUG(0,("ERROR: string overflow by %u bytes in safe_strcpy_w [%.50s]\n",
+        ZERODEBUG(0,("ERROR: string overflow by %u bytes in safe_strcpy_w [%.50s]\n",
 			(unsigned int)((ucs2_len-maxlength)*sizeof(smb_ucs2_t)),
 			unicode_to_unix(out,src,sizeof(out))) );
 		ucs2_len = maxlength - 1;
@@ -993,7 +993,7 @@
     size_t ucs2_src_len, ucs2_dest_len;
 
     if (!dest) {
-        DEBUG(0,("ERROR: NULL dest in safe_strcat_w\n"));
+        ZERODEBUG(0,("ERROR: NULL dest in safe_strcat_w\n"));
         return NULL;
     }
 
@@ -1006,7 +1006,7 @@
     if (ucs2_src_len + ucs2_dest_len >= maxlength) {
 		fstring out;
 		int new_len = maxlength - ucs2_dest_len - 1;
-        DEBUG(0,("ERROR: string overflow by %u characters in safe_strcat_w [%.50s]\n",
+        ZERODEBUG(0,("ERROR: string overflow by %u characters in safe_strcat_w [%.50s]\n",
 			(unsigned int)(sizeof(smb_ucs2_t)*(ucs2_src_len + ucs2_dest_len - maxlength)),
 			unicode_to_unix(out,src,sizeof(out))) );
         ucs2_src_len = (size_t)(new_len > 0 ? new_len : 0);
@@ -1686,7 +1686,7 @@
 	smb_ucs2_t nullstr_w = (smb_ucs2_t)0;
 
 	if (!dest) {
-		DEBUG(0,("ERROR: NULL dest in alpha_strcpy_w\n"));
+		ZERODEBUG(0,("ERROR: NULL dest in alpha_strcpy_w\n"));
 		return NULL;
 	}
 
@@ -1856,7 +1856,7 @@
 
 	if (!null_string) {
 		if((null_string = (smb_ucs2_t *)malloc(sizeof(smb_ucs2_t))) == NULL) {
-			DEBUG(0,("string_init_w: malloc fail for null_string.\n"));
+			ZERODEBUG(0,("string_init_w: malloc fail for null_string.\n"));
 		return False;
 		}
 		*null_string = 0;
@@ -1872,7 +1872,7 @@
 	else {
 		(*dest) = (smb_ucs2_t *)malloc(sizeof(smb_ucs2_t)*(l+1));
 		if ((*dest) == NULL) {
-			DEBUG(0,("Out of memory in string_init_w\n"));
+			ZERODEBUG(0,("Out of memory in string_init_w\n"));
 			return False;
 		}
 
@@ -1936,7 +1936,7 @@
 	while (lp <= ls && (p = strstr_w(s,pattern))) {
 		if (len && (ls + (li-lp) >= len)) {
 			fstring out;
-			DEBUG(0,("ERROR: string overflow by %d in string_sub_w(%.50s, %d)\n", 
+			ZERODEBUG(0,("ERROR: string overflow by %d in string_sub_w(%.50s, %d)\n", 
 				 (int)(sizeof(smb_ucs2_t)*(ls + (li-lp) - len)),
 				 unicode_to_unix(out,pattern,sizeof(out)), (int)len*sizeof(smb_ucs2_t)));
 			break;
@@ -1999,7 +1999,7 @@
 	while (lp <= ls && (p = strstr_w(s,pattern))) {
 		if (len && (ls + (li-lp) >= len)) {
 			fstring out;
-			DEBUG(0,("ERROR: string overflow by %d in all_string_sub_w(%.50s, %d)\n", 
+			ZERODEBUG(0,("ERROR: string overflow by %d in all_string_sub_w(%.50s, %d)\n", 
 				 (int)(sizeof(smb_ucs2_t)*(ls + (li-lp) - len)),
 				 unicode_to_unix(out,pattern,sizeof(out)), (int)len*sizeof(smb_ucs2_t)));
 			break;
diff -Naur samba-2.2.12-orig/source/lib/wins_srv.c samba-2.2.12/source/lib/wins_srv.c
--- samba-2.2.12-orig/source/lib/wins_srv.c	2004-08-12 20:24:24.000000000 +0200
+++ samba-2.2.12/source/lib/wins_srv.c	2009-03-11 10:01:00.000000000 +0100
@@ -142,7 +142,7 @@
     entry = (list_entry *)malloc( sizeof( list_entry ) );
     if( NULL == entry )
       {
-      DEBUG( 0, ("wins_srv_load_list(): malloc(list_entry) failed.\n") );
+      ZERODEBUG( 0, ("wins_srv_load_list(): malloc(list_entry) failed.\n") );
       }
     else
       {
@@ -150,7 +150,7 @@
       if( NULL == (entry->server = strdup( wins_id_bufr )) )
         {
         SAFE_FREE( entry );
-        DEBUG( 0, ("wins_srv_load_list(): strdup(\"%s\") failed.\n", wins_id_bufr) );
+        ZERODEBUG( 0, ("wins_srv_load_list(): strdup(\"%s\") failed.\n", wins_id_bufr) );
         }
       else
         {
diff -Naur samba-2.2.12-orig/source/libsmb/cliconnect.c samba-2.2.12/source/libsmb/cliconnect.c
--- samba-2.2.12-orig/source/libsmb/cliconnect.c	2004-08-12 20:24:26.000000000 +0200
+++ samba-2.2.12/source/libsmb/cliconnect.c	2009-03-11 09:59:32.000000000 +0100
@@ -705,7 +705,7 @@
 			static int depth;
 			BOOL ret;
 			if (depth > 4) {
-				DEBUG(0,("Retarget recursion - failing\n"));
+				ZERODEBUG(0,("Retarget recursion - failing\n"));
 				return False;
 			}
 			depth++;
@@ -947,7 +947,7 @@
 	struct in_addr ip;
 	
 	if (!output_cli)
-		DEBUG(0, ("output_cli is NULL!?!"));
+		ZERODEBUG(0, ("output_cli is NULL!?!"));
 
 	*output_cli = NULL;
 	
@@ -1065,7 +1065,7 @@
 			 * The name used was *SMBSERVER, don't bother with another name.
 			 */
 
-			DEBUG(0,("attempt_netbios_session_request: %s rejected the session for name *SMBSERVER with error %s.\n", 
+			ZERODEBUG(0,("attempt_netbios_session_request: %s rejected the session for name *SMBSERVER with error %s.\n", 
 				desthost, cli_errstr(cli) ));
 			return False;
 		}
@@ -1080,7 +1080,7 @@
 
 		if (!cli_initialise(cli) || !cli_connect(cli, desthost, pdest_ip) ||
        			!cli_session_request(cli, &calling, &smbservername)) {
-			DEBUG(0,("attempt_netbios_session_request: %s rejected the session for name *SMBSERVER with error %s\n", 
+			ZERODEBUG(0,("attempt_netbios_session_request: %s rejected the session for name *SMBSERVER with error %s\n", 
 				desthost, cli_errstr(cli) ));
 			return False;
 		}
diff -Naur samba-2.2.12-orig/source/libsmb/clidgram.c samba-2.2.12/source/libsmb/clidgram.c
--- samba-2.2.12-orig/source/libsmb/clidgram.c	2004-08-12 20:24:25.000000000 +0200
+++ samba-2.2.12/source/libsmb/clidgram.c	2009-03-11 09:59:32.000000000 +0100
@@ -149,7 +149,7 @@
 
   if (!resolve_name(send_to_name, &sendto_ip, 0x1d)) {
 
-    DEBUG(0, ("Could not resolve name: %s<1D>\n", send_to_name));
+    ZERODEBUG(0, ("Could not resolve name: %s<1D>\n", send_to_name));
     return False;
 
   }
@@ -158,7 +158,7 @@
  
   if (!resolve_name(myname, &my_ip, 0x00)) { /* FIXME: Call others here */
 
-    DEBUG(0, ("Could not resolve name: %s<00>\n", myname));
+    ZERODEBUG(0, ("Could not resolve name: %s<00>\n", myname));
 
   }
 
@@ -177,7 +177,7 @@
 
   if (fcntl(dgram_sock, F_SETFL, O_NONBLOCK) < 0) {
 
-    DEBUG(0, ("Unable to set non blocking on dgram sock\n"));
+    ZERODEBUG(0, ("Unable to set non blocking on dgram sock\n"));
 
   }
 
diff -Naur samba-2.2.12-orig/source/libsmb/clientgen.c samba-2.2.12/source/libsmb/clientgen.c
--- samba-2.2.12-orig/source/libsmb/clientgen.c	2004-08-12 20:24:25.000000000 +0200
+++ samba-2.2.12/source/libsmb/clientgen.c	2009-03-11 09:59:32.000000000 +0100
@@ -98,7 +98,7 @@
                         close(cli->fd);
                         cli->fd = -1;
 			cli->smb_rw_error = WRITE_ERROR;
-			DEBUG(0,("Error writing %d bytes to client. %d (%s)\n",
+			ZERODEBUG(0,("Error writing %d bytes to client. %d (%s)\n",
 				 (int)len,(int)ret, strerror(errno) ));
 			return False;
 		}
@@ -169,7 +169,7 @@
 
 	/* Check the effective uid - make sure we are not setuid */
 	if (is_setuid_root()) {
-		DEBUG(0,("libsmb based programs must *NOT* be setuid root.\n"));
+		ZERODEBUG(0,("libsmb based programs must *NOT* be setuid root.\n"));
 		return NULL;
 	}
 
@@ -304,7 +304,7 @@
         if (!send_keepalive(cli->fd)) {
                 close(cli->fd);
                 cli->fd = -1;
-                DEBUG(0,("Error sending keepalive packet to client. (%s)\n",
+                ZERODEBUG(0,("Error sending keepalive packet to client. (%s)\n",
 					strerror(errno) ));
                 return False;
         }
diff -Naur samba-2.2.12-orig/source/libsmb/clilist.c samba-2.2.12/source/libsmb/clilist.c
--- samba-2.2.12-orig/source/libsmb/clilist.c	2004-08-12 20:24:25.000000000 +0200
+++ samba-2.2.12/source/libsmb/clilist.c	2009-03-11 09:59:32.000000000 +0100
@@ -164,7 +164,7 @@
 	while (ff_eos == 0) {
 		loop_count++;
 		if (loop_count > 200) {
-			DEBUG(0,("Error: Looping in FIND_NEXT??\n"));
+			ZERODEBUG(0,("Error: Looping in FIND_NEXT??\n"));
 			break;
 		}
 
@@ -266,7 +266,7 @@
 		tdl = Realloc(dirlist,dirlist_len + data_len);
 
 		if (!tdl) {
-			DEBUG(0,("cli_list_new: Failed to expand dirlist\n"));
+			ZERODEBUG(0,("cli_list_new: Failed to expand dirlist\n"));
 			break;
 		}
 		else dirlist = tdl;
@@ -394,7 +394,7 @@
 		tdl = Realloc(dirlist,(num_received + received)*DIR_STRUCT_SIZE);
 
 		if (!tdl) {
-			DEBUG(0,("cli_list_old: failed to expand dirlist"));
+			ZERODEBUG(0,("cli_list_old: failed to expand dirlist"));
 			SAFE_FREE(dirlist);
 			return 0;
 		}
@@ -437,7 +437,7 @@
 		cli_setup_bcc(cli, p);
 		cli_send_smb(cli);
 		if (!cli_receive_smb(cli)) {
-			DEBUG(0,("Error closing search: %s\n",cli_errstr(cli)));
+			ZERODEBUG(0,("Error closing search: %s\n",cli_errstr(cli)));
 		}
 	}
 
diff -Naur samba-2.2.12-orig/source/libsmb/cli_lsarpc.c samba-2.2.12/source/libsmb/cli_lsarpc.c
--- samba-2.2.12-orig/source/libsmb/cli_lsarpc.c	2004-08-12 20:24:25.000000000 +0200
+++ samba-2.2.12/source/libsmb/cli_lsarpc.c	2009-03-11 09:59:32.000000000 +0100
@@ -284,21 +284,21 @@
 
 	if (!((*domains) = (char **)talloc(mem_ctx, sizeof(char *) *
 					   num_sids))) {
-		DEBUG(0, ("cli_lsa_lookup_sids(): out of memory\n"));
+		ZERODEBUG(0, ("cli_lsa_lookup_sids(): out of memory\n"));
 		result = NT_STATUS_UNSUCCESSFUL;
 		goto done;
 	}
 
 	if (!((*names) = (char **)talloc(mem_ctx, sizeof(char *) *
 					 num_sids))) {
-		DEBUG(0, ("cli_lsa_lookup_sids(): out of memory\n"));
+		ZERODEBUG(0, ("cli_lsa_lookup_sids(): out of memory\n"));
 		result = NT_STATUS_UNSUCCESSFUL;
 		goto done;
 	}
 
 	if (!((*types) = (uint32 *)talloc(mem_ctx, sizeof(uint32) *
 					  num_sids))) {
-		DEBUG(0, ("cli_lsa_lookup_sids(): out of memory\n"));
+		ZERODEBUG(0, ("cli_lsa_lookup_sids(): out of memory\n"));
 		result = NT_STATUS_UNSUCCESSFUL;
 		goto done;
 	}
@@ -319,7 +319,7 @@
 			(*types)[i] = t_names.name[i].sid_name_use;
 			
 			if (((*names)[i] == NULL) || ((*domains)[i] == NULL)) {
-				DEBUG(0, ("cli_lsa_lookup_sids(): out of memory\n"));
+				ZERODEBUG(0, ("cli_lsa_lookup_sids(): out of memory\n"));
 				result = NT_STATUS_UNSUCCESSFUL;
 				goto done;
 			}
@@ -402,14 +402,14 @@
 
 	if (!((*sids = (DOM_SID *)talloc(mem_ctx, sizeof(DOM_SID) *
 					 num_names)))) {
-		DEBUG(0, ("cli_lsa_lookup_sids(): out of memory\n"));
+		ZERODEBUG(0, ("cli_lsa_lookup_sids(): out of memory\n"));
 		result = NT_STATUS_UNSUCCESSFUL;
 		goto done;
 	}
 
 	if (!((*types = (uint32 *)talloc(mem_ctx, sizeof(uint32) *
 					 num_names)))) {
-		DEBUG(0, ("cli_lsa_lookup_sids(): out of memory\n"));
+		ZERODEBUG(0, ("cli_lsa_lookup_sids(): out of memory\n"));
 		result = NT_STATUS_UNSUCCESSFUL;
 		goto done;
 	}
@@ -593,7 +593,7 @@
 						r.num_domains);
 
 		if (!*domain_names) {
-			DEBUG(0, ("cli_lsa_enum_trust_dom(): out of memory\n"));
+			ZERODEBUG(0, ("cli_lsa_enum_trust_dom(): out of memory\n"));
 			result = NT_STATUS_UNSUCCESSFUL;
 			goto done;
 		}
@@ -601,7 +601,7 @@
 		*domain_sids = (DOM_SID *)talloc(mem_ctx, sizeof(DOM_SID) *
 						 r.num_domains);
 		if (!domain_sids) {
-			DEBUG(0, ("cli_lsa_enum_trust_dom(): out of memory\n"));
+			ZERODEBUG(0, ("cli_lsa_enum_trust_dom(): out of memory\n"));
 			result = NT_STATUS_UNSUCCESSFUL;
 			goto done;
 		}
@@ -675,19 +675,19 @@
 	*count = r.count;
 
 	if (!((*privs_name = (char **)talloc(mem_ctx, sizeof(char *) * r.count)))) {
-		DEBUG(0, ("(cli_lsa_enum_privilege): out of memory\n"));
+		ZERODEBUG(0, ("(cli_lsa_enum_privilege): out of memory\n"));
 		result = NT_STATUS_UNSUCCESSFUL;
 		goto done;
 	}
 
 	if (!((*privs_high = (uint32 *)talloc(mem_ctx, sizeof(uint32) * r.count)))) {
-		DEBUG(0, ("(cli_lsa_enum_privilege): out of memory\n"));
+		ZERODEBUG(0, ("(cli_lsa_enum_privilege): out of memory\n"));
 		result = NT_STATUS_UNSUCCESSFUL;
 		goto done;
 	}
 
 	if (!((*privs_low = (uint32 *)talloc(mem_ctx, sizeof(uint32) * r.count)))) {
-		DEBUG(0, ("(cli_lsa_enum_privilege): out of memory\n"));
+		ZERODEBUG(0, ("(cli_lsa_enum_privilege): out of memory\n"));
 		result = NT_STATUS_UNSUCCESSFUL;
 		goto done;
 	}
@@ -812,7 +812,7 @@
 
 	*sids = (DOM_SID *)talloc(mem_ctx, sizeof(DOM_SID) * r.sids.num_entries);
 	if (!*sids) {
-		DEBUG(0, ("(cli_lsa_enum_sids): out of memory\n"));
+		ZERODEBUG(0, ("(cli_lsa_enum_sids): out of memory\n"));
 		result = NT_STATUS_UNSUCCESSFUL;
 		goto done;
 	}
@@ -936,7 +936,7 @@
 		goto done;
 
 	if (!((*set = (LUID_ATTR *)talloc(mem_ctx, sizeof(LUID_ATTR) * r.count)))) {
-		DEBUG(0, ("(cli_lsa_enum_privsaccount): out of memory\n"));
+		ZERODEBUG(0, ("(cli_lsa_enum_privsaccount): out of memory\n"));
 		result = NT_STATUS_UNSUCCESSFUL;
 		goto done;
 	}
@@ -1070,23 +1070,23 @@
  
 	ZERO_STRUCT(cli);
 	if(cli_initialise(&cli) == False) {
-		DEBUG(0,("fetch_domain_sid: unable to initialize client connection.\n"));
+		ZERODEBUG(0,("fetch_domain_sid: unable to initialize client connection.\n"));
 		return False;
 	}
  
 	if(!resolve_name( remote_machine, &cli.dest_ip, 0x20)) {
-		DEBUG(0,("fetch_domain_sid: Can't resolve address for %s\n", remote_machine));
+		ZERODEBUG(0,("fetch_domain_sid: Can't resolve address for %s\n", remote_machine));
 		goto done;
 	}
  
 	if (!cli_connect(&cli, remote_machine, &cli.dest_ip)) {
-		DEBUG(0,("fetch_domain_sid: unable to connect to SMB server on \
+		ZERODEBUG(0,("fetch_domain_sid: unable to connect to SMB server on \
 machine %s. Error was : %s.\n", remote_machine, cli_errstr(&cli) ));
 		goto done;
 	}
 
 	if (!attempt_netbios_session_request(&cli, global_myname, remote_machine, &cli.dest_ip)) {
-		DEBUG(0,("fetch_domain_sid: machine %s rejected the NetBIOS session request.\n", 
+		ZERODEBUG(0,("fetch_domain_sid: machine %s rejected the NetBIOS session request.\n", 
 			remote_machine));
 		goto done;
 	}
@@ -1094,13 +1094,13 @@
 	cli.protocol = PROTOCOL_NT1;
  
 	if (!cli_negprot(&cli)) {
-		DEBUG(0,("fetch_domain_sid: machine %s rejected the negotiate protocol. \
+		ZERODEBUG(0,("fetch_domain_sid: machine %s rejected the negotiate protocol. \
 Error was : %s.\n", remote_machine, cli_errstr(&cli) ));
 		goto done;
 	}
  
 	if (cli.protocol != PROTOCOL_NT1) {
-		DEBUG(0,("fetch_domain_sid: machine %s didn't negotiate NT protocol.\n",
+		ZERODEBUG(0,("fetch_domain_sid: machine %s didn't negotiate NT protocol.\n",
 			remote_machine));
 		goto done;
 	}
@@ -1110,19 +1110,19 @@
 	 */
  
 	if (!cli_session_setup(&cli, "", "", 0, "", 0, "")) {
-		DEBUG(0,("fetch_domain_sid: machine %s rejected the session setup. \
+		ZERODEBUG(0,("fetch_domain_sid: machine %s rejected the session setup. \
 Error was : %s.\n", remote_machine, cli_errstr(&cli) ));
 		goto done;
 	}
  
 	if (!(cli.sec_mode & 1)) {
-		DEBUG(0,("fetch_domain_sid: machine %s isn't in user level security mode\n",
+		ZERODEBUG(0,("fetch_domain_sid: machine %s isn't in user level security mode\n",
 			remote_machine));
 		goto done;
 	}
 
 	if (!cli_send_tconX(&cli, "IPC$", "IPC", "", 1)) {
-		DEBUG(0,("fetch_domain_sid: machine %s rejected the tconX on the IPC$ share. \
+		ZERODEBUG(0,("fetch_domain_sid: machine %s rejected the tconX on the IPC$ share. \
 Error was : %s.\n", remote_machine, cli_errstr(&cli) ));
 		goto done;
 	}
@@ -1130,20 +1130,20 @@
 	/* Fetch domain sid */
  
 	if (!cli_nt_session_open(&cli, PIPE_LSARPC)) {
-		DEBUG(0, ("fetch_domain_sid: Error connecting to SAM pipe\n"));
+		ZERODEBUG(0, ("fetch_domain_sid: Error connecting to SAM pipe\n"));
 		goto done;
 	}
  
 	result = cli_lsa_open_policy(&cli, cli.mem_ctx, True, SEC_RIGHTS_QUERY_VALUE, &lsa_pol);
 	if (!NT_STATUS_IS_OK(result)) {
-		DEBUG(0, ("fetch_domain_sid: Error opening lsa policy handle. %s\n",
+		ZERODEBUG(0, ("fetch_domain_sid: Error opening lsa policy handle. %s\n",
 			get_nt_error_msg(result) ));
 		goto done;
 	}
  
 	result = cli_lsa_query_info_policy(&cli, cli.mem_ctx, &lsa_pol, 5, domain, psid);
 	if (!NT_STATUS_IS_OK(result)) {
-		DEBUG(0, ("fetch_domain_sid: Error querying lsa policy handle. %s\n",
+		ZERODEBUG(0, ("fetch_domain_sid: Error querying lsa policy handle. %s\n",
 			get_nt_error_msg(result) ));
 		goto done;
 	}
diff -Naur samba-2.2.12-orig/source/libsmb/cli_netlogon.c samba-2.2.12/source/libsmb/cli_netlogon.c
--- samba-2.2.12-orig/source/libsmb/cli_netlogon.c	2004-08-12 20:24:25.000000000 +0200
+++ samba-2.2.12/source/libsmb/cli_netlogon.c	2009-03-11 09:59:32.000000000 +0100
@@ -147,7 +147,7 @@
                         /*
                          * Server replied with bad credential. Fail.
                          */
-                        DEBUG(0,("new_cli_net_auth2: server %s replied with bad credential (bad machine \
+                        ZERODEBUG(0,("new_cli_net_auth2: server %s replied with bad credential (bad machine \
 password ?).\n", cli->desthost ));
                         result = NT_STATUS_ACCESS_DENIED;
                         goto done;
@@ -180,7 +180,7 @@
         result = new_cli_net_req_chal(cli, &clnt_chal, &srv_chal);
 
         if (!NT_STATUS_IS_OK(result)) {
-                DEBUG(0,("new_cli_nt_setup_creds: request challenge failed\n"));
+                ZERODEBUG(0,("new_cli_nt_setup_creds: request challenge failed\n"));
                 return result;
         }
         
@@ -206,7 +206,7 @@
 	result = new_cli_net_auth2(cli, sec_chan, 0x000001ff, 
 				   &srv_chal);
 	if (!NT_STATUS_IS_OK(result)) {
-                DEBUG(0,("new_cli_nt_setup_creds: auth2 challenge failed %s\n",
+                ZERODEBUG(0,("new_cli_nt_setup_creds: auth2 challenge failed %s\n",
 			 get_nt_error_msg(result)));
         }
 
@@ -472,7 +472,7 @@
                 break;
         }
         default:
-                DEBUG(0, ("switch value %d not supported\n", 
+                ZERODEBUG(0, ("switch value %d not supported\n", 
                           ctr.switch_value));
                 goto done;
         }
@@ -542,7 +542,7 @@
 	workstation_name_slash = talloc_asprintf(mem_ctx, "\\\\%s", workstation);
 	
 	if (!workstation_name_slash) {
-		DEBUG(0, ("talloc_asprintf failed!\n"));
+		ZERODEBUG(0, ("talloc_asprintf failed!\n"));
 		return NT_STATUS_NO_MEMORY;
 	}
 
@@ -629,7 +629,7 @@
 	mach_acct = talloc_asprintf(mem_ctx, "%s$", machine_name);
 	
 	if (!mach_acct) {
-		DEBUG(0,("talloc_asprintf failed!\n"));
+		ZERODEBUG(0,("talloc_asprintf failed!\n"));
 		nt_status = NT_STATUS_NO_MEMORY;
 		goto done;
 	}
@@ -645,7 +645,7 @@
 	
 	/* turn parameters into data stream */
 	if(!net_io_q_srv_pwset("", &q_s,  &qbuf, 0)) {
-		DEBUG(0,("cli_net_srv_pwset: Error : failed to marshall NET_Q_SRV_PWSET struct.\n"));
+		ZERODEBUG(0,("cli_net_srv_pwset: Error : failed to marshall NET_Q_SRV_PWSET struct.\n"));
 		nt_status = NT_STATUS_UNSUCCESSFUL;
 		goto done;
 	}
@@ -665,7 +665,7 @@
 		if (!NT_STATUS_IS_OK(r_s.status))
 		{
 			/* report error code */
-			DEBUG(0,("cli_net_srv_pwset: %s\n", nt_errstr(nt_status)));
+			ZERODEBUG(0,("cli_net_srv_pwset: %s\n", nt_errstr(nt_status)));
 			goto done;
 		}
 
@@ -675,7 +675,7 @@
 			/*
 			 * Server replied with bad credential. Fail.
 			 */
-			DEBUG(0,("cli_net_srv_pwset: server %s replied with bad credential (bad machine \
+			ZERODEBUG(0,("cli_net_srv_pwset: server %s replied with bad credential (bad machine \
 password ?).\n", cli->desthost ));
 			nt_status = NT_STATUS_UNSUCCESSFUL;
 		}
diff -Naur samba-2.2.12-orig/source/libsmb/clirap.c samba-2.2.12/source/libsmb/clirap.c
--- samba-2.2.12-orig/source/libsmb/clirap.c	2004-08-12 20:24:26.000000000 +0200
+++ samba-2.2.12/source/libsmb/clirap.c	2009-03-11 09:59:32.000000000 +0100
@@ -297,7 +297,7 @@
   pstring dos_new_password;
 
   if (strlen(user) >= sizeof(fstring)-1) {
-    DEBUG(0,("cli_oem_change_password: user name %s is too long.\n", user));
+    ZERODEBUG(0,("cli_oem_change_password: user name %s is too long.\n", user));
     return False;
   }
 
@@ -346,7 +346,7 @@
                     param,param_len,2,                    /* param, length, max */
                     data,data_len,0                       /* data, length, max */
                    ) == False) {
-    DEBUG(0,("cli_oem_change_password: Failed to send password change for user %s\n",
+    ZERODEBUG(0,("cli_oem_change_password: Failed to send password change for user %s\n",
               user ));
     return False;
   }
diff -Naur samba-2.2.12-orig/source/libsmb/cli_samr.c samba-2.2.12/source/libsmb/cli_samr.c
--- samba-2.2.12-orig/source/libsmb/cli_samr.c	2004-08-12 20:24:25.000000000 +0200
+++ samba-2.2.12/source/libsmb/cli_samr.c	2009-03-11 09:59:32.000000000 +0100
@@ -878,12 +878,12 @@
 	/* XXX: Some level 0 debugs to try and identify the cause of cr1168 */
 
 	if (!samr_io_q_query_dispinfo("", &q, &qbuf, 0)) {
-		DEBUG(0, ("cli_samr_query_dispinfo: samr_io_q_query_dispinfo failed!\n"));
+		ZERODEBUG(0, ("cli_samr_query_dispinfo: samr_io_q_query_dispinfo failed!\n"));
 		goto done;
 	}
 
 	if (!rpc_api_pipe_req(cli, SAMR_QUERY_DISPINFO, &qbuf, &rbuf)) {
-		DEBUG(0, ("cli_samr_query_dispinfo: rpc_api_pipe_req failed!\n"));
+		ZERODEBUG(0, ("cli_samr_query_dispinfo: rpc_api_pipe_req failed!\n"));
 		goto done;
 	}
 
@@ -892,7 +892,7 @@
 	r.ctr = ctr;
 
 	if (!samr_io_r_query_dispinfo("", &r, &rbuf, 0)) {
-		DEBUG(0, ("cli_samr_query_dispinfo: samr_io_r_query_dispinfo failed!\n"));
+		ZERODEBUG(0, ("cli_samr_query_dispinfo: samr_io_r_query_dispinfo failed!\n"));
 		goto done;
 	}
 
diff -Naur samba-2.2.12-orig/source/libsmb/clisecdesc.c samba-2.2.12/source/libsmb/clisecdesc.c
--- samba-2.2.12-orig/source/libsmb/clisecdesc.c	2004-08-12 20:24:25.000000000 +0200
+++ samba-2.2.12/source/libsmb/clisecdesc.c	2009-03-11 09:59:32.000000000 +0100
@@ -85,7 +85,7 @@
 	BOOL ret = False;
 
 	if ((mem_ctx = talloc_init()) == NULL) {
-		DEBUG(0,("talloc_init failed.\n"));
+		ZERODEBUG(0,("talloc_init failed.\n"));
 		goto cleanup;
 	}
 
diff -Naur samba-2.2.12-orig/source/libsmb/clitrans.c samba-2.2.12/source/libsmb/clitrans.c
--- samba-2.2.12-orig/source/libsmb/clitrans.c	2004-08-12 20:24:26.000000000 +0200
+++ samba-2.2.12/source/libsmb/clitrans.c	2009-03-11 09:59:32.000000000 +0100
@@ -159,7 +159,7 @@
 	
 	/* sanity check */
 	if (CVAL(cli->inbuf,smb_com) != trans) {
-		DEBUG(0,("Expected %s response, got command 0x%02x\n",
+		ZERODEBUG(0,("Expected %s response, got command 0x%02x\n",
 			 trans==SMBtrans?"SMBtrans":"SMBtrans2", 
 			 CVAL(cli->inbuf,smb_com)));
 		return(False);
@@ -183,7 +183,7 @@
 	if (total_data!=0) {
 		tdata = Realloc(*data,total_data);
 		if (!tdata) {
-			DEBUG(0,("cli_receive_trans: failed to enlarge data buffer\n"));
+			ZERODEBUG(0,("cli_receive_trans: failed to enlarge data buffer\n"));
 			return False;
 		}
 		else
@@ -193,7 +193,7 @@
 	if (total_param!=0) {
 		tparam = Realloc(*param,total_param);
 		if (!tparam) {
-			DEBUG(0,("cli_receive_trans: failed to enlarge param buffer\n"));
+			ZERODEBUG(0,("cli_receive_trans: failed to enlarge param buffer\n"));
 			return False;
 		}
 		else
@@ -273,7 +273,7 @@
 		
 		/* sanity check */
 		if (CVAL(cli->inbuf,smb_com) != trans) {
-			DEBUG(0,("Expected %s response, got command 0x%02x\n",
+			ZERODEBUG(0,("Expected %s response, got command 0x%02x\n",
 				 trans==SMBtrans?"SMBtrans":"SMBtrans2", 
 				 CVAL(cli->inbuf,smb_com)));
 			return(False);
@@ -424,7 +424,7 @@
 	
 	/* sanity check */
 	if (CVAL(cli->inbuf,smb_com) != SMBnttrans) {
-		DEBUG(0,("Expected SMBnttrans response, got command 0x%02x\n",
+		ZERODEBUG(0,("Expected SMBnttrans response, got command 0x%02x\n",
 			 CVAL(cli->inbuf,smb_com)));
 		return(False);
 	}
@@ -448,7 +448,7 @@
 	if (total_data) {
 		tdata = Realloc(*data,total_data);
 		if (!tdata) {
-			DEBUG(0,("cli_receive_nt_trans: failed to enlarge data buffer to %d\n",total_data));
+			ZERODEBUG(0,("cli_receive_nt_trans: failed to enlarge data buffer to %d\n",total_data));
 			return False;
 		} else {
 			*data = tdata;
@@ -458,7 +458,7 @@
 	if (total_param) {
 		tparam = Realloc(*param,total_param);
 		if (!tparam) {
-			DEBUG(0,("cli_receive_nt_trans: failed to enlarge param buffer to %d\n", total_param));
+			ZERODEBUG(0,("cli_receive_nt_trans: failed to enlarge param buffer to %d\n", total_param));
 			return False;
 		} else {
 			*param = tparam;
@@ -540,7 +540,7 @@
 		
 		/* sanity check */
 		if (CVAL(cli->inbuf,smb_com) != SMBnttrans) {
-			DEBUG(0,("Expected SMBnttrans response, got command 0x%02x\n",
+			ZERODEBUG(0,("Expected SMBnttrans response, got command 0x%02x\n",
 				 CVAL(cli->inbuf,smb_com)));
 			return(False);
 		}
diff -Naur samba-2.2.12-orig/source/libsmb/libsmbclient.c samba-2.2.12/source/libsmb/libsmbclient.c
--- samba-2.2.12-orig/source/libsmb/libsmbclient.c	2004-08-12 20:24:26.000000000 +0200
+++ samba-2.2.12/source/libsmb/libsmbclient.c	2009-03-11 13:48:39.000000000 +0100
@@ -496,7 +496,7 @@
 	smbc_auth_fn = fn;
 	/*  smbc_debug = debug; */
 
-	DEBUGLEVEL = -1;
+	DEBUGLEVEL = 0;
 
 	setup_logging(pname, False);
 
@@ -552,7 +552,7 @@
 		pid = getpid();
 		slprintf(my_netbios_name, 16, "smbc%s%d", user, pid);
 	}
-	DEBUG(0,("Using netbios name %s.\n", my_netbios_name));
+	ZERODEBUG(0,("Using netbios name %s.\n", my_netbios_name));
 
 	name_register_wins(my_netbios_name, 0);
 
@@ -568,7 +568,7 @@
 		
 		if (getrlimit(RLIMIT_NOFILE, &rlp)) {
 
-			DEBUG(0, ("smbc_init: getrlimit(1) for RLIMIT_NOFILE failed with error %s\n", strerror(errno)));
+			ZERODEBUG(0, ("smbc_init: getrlimit(1) for RLIMIT_NOFILE failed with error %s\n", strerror(errno)));
 
 			smbc_start_fd = 1000000;
 
@@ -1631,7 +1631,7 @@
 
 		if (!name_status_find("*", 0, 0, rem_ip, server)) {
 
-			DEBUG(0,("Could not get the name of local/domain master browser for server %s\n", server));
+			ZERODEBUG(0,("Could not get the name of local/domain master browser for server %s\n", server));
 			errno = EINVAL;
 			return -1;
 
@@ -1703,7 +1703,7 @@
 
 				if (!name_status_find("*", 0, 0, rem_ip, buserver)) {
 
-					DEBUG(0, ("Could not get name of local/domain master browser for server %s\n", server));
+					ZERODEBUG(0, ("Could not get name of local/domain master browser for server %s\n", server));
 					errno = EPERM;  /* FIXME, is this correct */
 					return -1;
 
diff -Naur samba-2.2.12-orig/source/libsmb/namequery.c samba-2.2.12/source/libsmb/namequery.c
--- samba-2.2.12-orig/source/libsmb/namequery.c	2004-08-12 20:24:25.000000000 +0200
+++ samba-2.2.12/source/libsmb/namequery.c	2009-03-11 09:59:32.000000000 +0100
@@ -240,7 +240,7 @@
 
   if ((nmb->additional = (struct res_rec *)malloc(sizeof(struct res_rec))) == NULL) {
 
-    DEBUG(0, ("name_register: malloc fail for additional record.\n"));
+    ZERODEBUG(0, ("name_register: malloc fail for additional record.\n"));
     return False;
 
   }
@@ -411,7 +411,7 @@
 												* ( (*count) + nmb2->answers->rdlength/6 ) );
 
 			if (!tmp_ip_list) {
-				DEBUG(0,("name_query: Realloc failed.\n"));
+				ZERODEBUG(0,("name_query: Realloc failed.\n"));
 					SAFE_FREE(ip_list);
 			}
 
@@ -520,13 +520,13 @@
 
     if (count > 0 && count < 2)
     {
-      DEBUG(0,("getlmhostsent: Ill formed hosts line [%s]\n",line));
+      ZERODEBUG(0,("getlmhostsent: Ill formed hosts line [%s]\n",line));
       continue;
     }
 
     if (count >= 4)
     {
-      DEBUG(0,("getlmhostsent: too many columns in lmhosts file (obsolete syntax)\n"));
+      ZERODEBUG(0,("getlmhostsent: too many columns in lmhosts file (obsolete syntax)\n"));
       continue;
     }
 
@@ -534,7 +534,7 @@
 
     if (strchr(flags,'G') || strchr(flags,'S'))
     {
-      DEBUG(0,("getlmhostsent: group flag in lmhosts ignored (obsolete)\n"));
+      ZERODEBUG(0,("getlmhostsent: group flag in lmhosts ignored (obsolete)\n"));
       continue;
     }
 
@@ -551,7 +551,7 @@
 
       if(!*ptr1 || (endptr == ptr1))
       {
-        DEBUG(0,("getlmhostsent: invalid name %s containing '#'.\n", name));
+        ZERODEBUG(0,("getlmhostsent: invalid name %s containing '#'.\n", name));
         continue;
       }
 
@@ -903,7 +903,7 @@
               goto done;
 		  }
 	  } else {
-		  DEBUG(0,("resolve_name: unknown name switch type %s\n", tok));
+		  ZERODEBUG(0,("resolve_name: unknown name switch type %s\n", tok));
 	  }
   }
 
@@ -1136,7 +1136,7 @@
 	
 	/* Find out the transient UDP port we have been allocated. */
 	if(getsockname(sock, (struct sockaddr *)&sock_name, &sock_len)<0) {
-		DEBUG(0,("lookup_dc_name: Failed to get local UDP port. Error was %s\n",
+		ZERODEBUG(0,("lookup_dc_name: Failed to get local UDP port. Error was %s\n",
 			 strerror(errno)));
 		close(sock);
 		return False;
@@ -1213,7 +1213,7 @@
 	GetTimeOfDay(&tval);
 	
 	if (!send_packet(&p)) {
-		DEBUG(0,("lookup_dc_name: send_packet failed.\n"));
+		ZERODEBUG(0,("lookup_dc_name: send_packet failed.\n"));
 		close(sock);
 		return False;
 	}
@@ -1229,7 +1229,7 @@
 			if (!retries)
 				break;
 			if (!send_packet(&p)) {
-				DEBUG(0,("lookup_dc_name: send_packet failed.\n"));
+				ZERODEBUG(0,("lookup_dc_name: send_packet failed.\n"));
 				close(sock);
 				return False;
 			}
@@ -1246,7 +1246,7 @@
 			buf -= 4;
 
 			if (CVAL(buf,smb_com) != SMBtrans) {
-				DEBUG(0,("lookup_dc_name: datagram type %u != SMBtrans(%u)\n", (unsigned int)
+				ZERODEBUG(0,("lookup_dc_name: datagram type %u != SMBtrans(%u)\n", (unsigned int)
 					 CVAL(buf,smb_com), (unsigned int)SMBtrans ));
 				free_packet(p_ret);
 				continue;
@@ -1256,7 +1256,7 @@
 			buf2 = smb_base(buf) + SVAL(buf,smb_vwv12);
 			
 			if (len <= 0) {
-				DEBUG(0,("lookup_dc_name: datagram len < 0 (%d)\n", len ));
+				ZERODEBUG(0,("lookup_dc_name: datagram len < 0 (%d)\n", len ));
 				free_packet(p_ret);
 				continue;
 			}
@@ -1266,7 +1266,7 @@
 				 inet_ntoa(p_ret->ip), smb_buf(buf),SVAL(buf2,0),len));
 
 			if(SVAL(buf2,0) != QUERYFORPDC_R) {
-				DEBUG(0,("lookup_dc_name: datagram type (%u) != QUERYFORPDC_R(%u)\n",
+				ZERODEBUG(0,("lookup_dc_name: datagram type (%u) != QUERYFORPDC_R(%u)\n",
 					 (unsigned int)SVAL(buf,0), (unsigned int)QUERYFORPDC_R ));
 				free_packet(p_ret);
 				continue;
diff -Naur samba-2.2.12-orig/source/libsmb/nmblib.c samba-2.2.12/source/libsmb/nmblib.c
--- samba-2.2.12-orig/source/libsmb/nmblib.c	2004-08-12 20:24:25.000000000 +0200
+++ samba-2.2.12/source/libsmb/nmblib.c	2009-03-11 09:59:32.000000000 +0100
@@ -527,7 +527,7 @@
 
   if(( pkt_copy = (struct packet_struct *)malloc(sizeof(*packet))) == NULL)
   {
-    DEBUG(0,("copy_nmb_packet: malloc fail.\n"));
+    ZERODEBUG(0,("copy_nmb_packet: malloc fail.\n"));
     return NULL;
   }
 
@@ -582,7 +582,7 @@
   SAFE_FREE(copy_nmb->additional);
   SAFE_FREE(pkt_copy);
 
-  DEBUG(0,("copy_nmb_packet: malloc fail in resource records.\n"));
+  ZERODEBUG(0,("copy_nmb_packet: malloc fail in resource records.\n"));
   return NULL;
 }
 
@@ -595,7 +595,7 @@
 
   if(( pkt_copy = (struct packet_struct *)malloc(sizeof(*packet))) == NULL)
   {
-    DEBUG(0,("copy_dgram_packet: malloc fail.\n"));
+    ZERODEBUG(0,("copy_dgram_packet: malloc fail.\n"));
     return NULL;
   }
 
@@ -752,7 +752,7 @@
   }
 
   if (!ret)
-    DEBUG(0,("Packet send failed to %s(%d) ERRNO=%s\n",
+    ZERODEBUG(0,("Packet send failed to %s(%d) ERRNO=%s\n",
 	     inet_ntoa(ip),port,strerror(errno)));
 
   if (ret)
@@ -970,7 +970,7 @@
 
 	if ((ret = sys_select_intr(fd+1,&fds,NULL,NULL,&timeout)) == -1) {
 		/* errno should be EBADF or EINVAL. */
-		DEBUG(0,("select returned -1, errno = %s (%d)\n", strerror(errno), errno));
+		ZERODEBUG(0,("select returned -1, errno = %s (%d)\n", strerror(errno), errno));
 		return NULL;
 	}
 
diff -Naur samba-2.2.12-orig/source/libsmb/smbencrypt.c samba-2.2.12/source/libsmb/smbencrypt.c
--- samba-2.2.12-orig/source/libsmb/smbencrypt.c	2004-08-12 20:24:26.000000000 +0200
+++ samba-2.2.12/source/libsmb/smbencrypt.c	2009-03-11 09:59:32.000000000 +0100
@@ -158,7 +158,7 @@
 
 	if (new_pw_len > 512)
 	{
-		DEBUG(0,("make_oem_passwd_hash: new password is too long.\n"));
+		ZERODEBUG(0,("make_oem_passwd_hash: new password is too long.\n"));
 		return False;
 	}
 
@@ -257,7 +257,7 @@
 
 	/* Password cannot be longer than 128 characters */
 	if ( (byte_len < 0) || (byte_len > new_pwrd_size - 1)) {
-		DEBUG(0, ("decode_pw_buffer: incorrect password length (%d).\n", byte_len));
+		ZERODEBUG(0, ("decode_pw_buffer: incorrect password length (%d).\n", byte_len));
 		return False;
 	}
 	
diff -Naur samba-2.2.12-orig/source/libsmb/unexpected.c samba-2.2.12/source/libsmb/unexpected.c
--- samba-2.2.12-orig/source/libsmb/unexpected.c	2004-08-12 20:24:25.000000000 +0200
+++ samba-2.2.12/source/libsmb/unexpected.c	2009-03-11 09:59:32.000000000 +0100
@@ -51,7 +51,7 @@
 			       TDB_CLEAR_IF_FIRST|TDB_DEFAULT,
 			       O_RDWR | O_CREAT, 0644);
 		if (!tdbd) {
-			DEBUG(0,("Failed to open unexpected.tdb\n"));
+			ZERODEBUG(0,("Failed to open unexpected.tdb\n"));
 			return;
 		}
 	}
diff -Naur samba-2.2.12-orig/source/locking/brlock.c samba-2.2.12/source/locking/brlock.c
--- samba-2.2.12-orig/source/locking/brlock.c	2004-08-12 20:24:31.000000000 +0200
+++ samba-2.2.12/source/locking/brlock.c	2009-03-11 09:59:33.000000000 +0100
@@ -205,7 +205,7 @@
 		/* If check_self is true we want to remove our own records. */
 		if (check_self && (mypid == lock->context.pid)) {
 
-			DEBUG(0,("brlock : delete_fn. LOGIC ERROR ! Shutting down and a record for my pid (%u) exists !\n",
+			ZERODEBUG(0,("brlock : delete_fn. LOGIC ERROR ! Shutting down and a record for my pid (%u) exists !\n",
 					(unsigned int)lock->context.pid ));
 
 		} else if (process_exists(lock->context.pid)) {
@@ -248,7 +248,7 @@
 	tdb = tdb_open_log(lock_path("brlock.tdb"), 0,  TDB_DEFAULT|(read_only?0x0:TDB_CLEAR_IF_FIRST),
 		       read_only?O_RDONLY:(O_RDWR|O_CREAT), 0644);
 	if (!tdb) {
-		DEBUG(0,("Failed to open byte range locking database\n"));
+		ZERODEBUG(0,("Failed to open byte range locking database\n"));
 		return;
 	}
 
@@ -321,7 +321,7 @@
 
 #if !ZERO_ZERO
 	if (start == 0 && size == 0) {
-		DEBUG(0,("client sent 0/0 lock - please report this\n"));
+		ZERODEBUG(0,("client sent 0/0 lock - please report this\n"));
 	}
 #endif
 
diff -Naur samba-2.2.12-orig/source/locking/locking.c samba-2.2.12/source/locking/locking.c
--- samba-2.2.12-orig/source/locking/locking.c	2004-08-12 20:24:31.000000000 +0200
+++ samba-2.2.12/source/locking/locking.c	2009-03-11 09:59:33.000000000 +0100
@@ -271,10 +271,10 @@
 	for (i=0;i<data->u.num_share_mode_entries;) {
 
 		if (check_self && (shares[i].pid == mypid)) {
-			DEBUG(0,("locking : delete_fn. LOGIC ERROR ! Shutting down and a record for my pid (%u) exists !\n",
+			ZERODEBUG(0,("locking : delete_fn. LOGIC ERROR ! Shutting down and a record for my pid (%u) exists !\n",
 					(unsigned int)shares[i].pid ));
 		} else if (!process_exists(shares[i].pid)) {
-			DEBUG(0,("locking : delete_fn. LOGIC ERROR ! Entry for pid %u and it no longer exists !\n",
+			ZERODEBUG(0,("locking : delete_fn. LOGIC ERROR ! Entry for pid %u and it no longer exists !\n",
 					(unsigned int)shares[i].pid ));
 		} else {
 			/* Process exists, leave this record alone. */
@@ -325,7 +325,7 @@
 		       0644);
 
 	if (!tdb) {
-		DEBUG(0,("ERROR: Failed to initialise locking database\n"));
+		ZERODEBUG(0,("ERROR: Failed to initialise locking database\n"));
 		return False;
 	}
 	
@@ -555,7 +555,7 @@
 		e1->dev == e2->dev &&
 		e1->inode == e2->inode &&
 		(e1->share_mode & ~DELETE_ON_CLOSE_FLAG) != (e2->share_mode & ~DELETE_ON_CLOSE_FLAG)) {
-			DEBUG(0,("PANIC: share_modes_identical: share_mode missmatch (e1 = %u, e2 = %u). Logic error.\n",
+			ZERODEBUG(0,("PANIC: share_modes_identical: share_mode missmatch (e1 = %u, e2 = %u). Logic error.\n",
 				(unsigned int)(e1->share_mode & ~DELETE_ON_CLOSE_FLAG),
 				(unsigned int)(e2->share_mode & ~DELETE_ON_CLOSE_FLAG) ));
 		smb_panic("PANIC: share_modes_identical logic error.\n");
diff -Naur samba-2.2.12-orig/source/locking/posix.c samba-2.2.12/source/locking/posix.c
--- samba-2.2.12-orig/source/locking/posix.c	2004-08-12 20:24:31.000000000 +0200
+++ samba-2.2.12/source/locking/posix.c	2009-03-11 09:59:33.000000000 +0100
@@ -105,7 +105,7 @@
 
 	tp = Realloc(dbuf.dptr, dbuf.dsize + sizeof(int));
 	if (!tp) {
-		DEBUG(0,("add_fd_to_close_entry: Realloc fail !\n"));
+		ZERODEBUG(0,("add_fd_to_close_entry: Realloc fail !\n"));
 		SAFE_FREE(dbuf.dptr);
 		return False;
 	} else
@@ -115,7 +115,7 @@
 	dbuf.dsize += sizeof(int);
 
 	if (tdb_store(posix_pending_close_tdb, kbuf, dbuf, TDB_REPLACE) == -1) {
-		DEBUG(0,("add_fd_to_close_entry: tdb_store fail !\n"));
+		ZERODEBUG(0,("add_fd_to_close_entry: tdb_store fail !\n"));
 	}
 
 	SAFE_FREE(dbuf.dptr);
@@ -131,7 +131,7 @@
 	TDB_DATA kbuf = locking_key_fsp(fsp);
 
 	if (tdb_delete(posix_pending_close_tdb, kbuf) == -1)
-		DEBUG(0,("delete_close_entries: tdb_delete fail !\n"));
+		ZERODEBUG(0,("delete_close_entries: tdb_delete fail !\n"));
 }
 
 /****************************************************************************
@@ -372,7 +372,7 @@
 
 	tp = Realloc(dbuf.dptr, dbuf.dsize + sizeof(pl));
 	if (!tp) {
-		DEBUG(0,("add_posix_lock_entry: Realloc fail !\n"));
+		ZERODEBUG(0,("add_posix_lock_entry: Realloc fail !\n"));
 		goto fail;
 	} else
 		dbuf.dptr = tp;
@@ -381,7 +381,7 @@
 	dbuf.dsize += sizeof(pl);
 
 	if (tdb_store(posix_lock_tdb, kbuf, dbuf, TDB_REPLACE) == -1) {
-		DEBUG(0,("add_posix_lock: Failed to add lock entry on file %s\n", fsp->fsp_name));
+		ZERODEBUG(0,("add_posix_lock: Failed to add lock entry on file %s\n", fsp->fsp_name));
 		goto fail;
 	}
 
@@ -653,10 +653,10 @@
 
 	if (!ret && ((errno == EFBIG) || (errno == ENOLCK) || (errno ==  EINVAL))) {
 
-		DEBUG(0,("posix_fcntl_lock: WARNING: lock request at offset %.0f, length %.0f returned\n",
+		ZERODEBUG(0,("posix_fcntl_lock: WARNING: lock request at offset %.0f, length %.0f returned\n",
 					(double)offset,(double)count));
-		DEBUG(0,("an %s error. This can happen when using 64 bit lock offsets\n", strerror(errno)));
-		DEBUG(0,("on 32 bit NFS mounted file systems.\n"));
+		ZERODEBUG(0,("an %s error. This can happen when using 64 bit lock offsets\n", strerror(errno)));
+		ZERODEBUG(0,("on 32 bit NFS mounted file systems.\n"));
 
 		/*
 		 * If the offset is > 0x7FFFFFFF then this will cause problems on
@@ -664,13 +664,13 @@
 		 */
 
 		if (offset & ~((SMB_OFF_T)0x7fffffff)) {
-			DEBUG(0,("Offset greater than 31 bits. Returning success.\n"));
+			ZERODEBUG(0,("Offset greater than 31 bits. Returning success.\n"));
 			return True;
 		}
 
 		if (count & ~((SMB_OFF_T)0x7fffffff)) {
 			/* 32 bit NFS file system, retry with smaller offset */
-			DEBUG(0,("Count greater than 31 bits - retrying with 31 bit truncated length.\n"));
+			ZERODEBUG(0,("Count greater than 31 bits - retrying with 31 bit truncated length.\n"));
 			errno = 0;
 			count &= 0x7fffffff;
 			ret = conn->vfs_ops.lock(fsp,fsp->fd,op,offset,count,type);
@@ -900,7 +900,7 @@
 													sizeof(struct lock_list));
 
 				if(l_new == NULL) {
-					DEBUG(0,("posix_lock_list: talloc fail.\n"));
+					ZERODEBUG(0,("posix_lock_list: talloc fail.\n"));
 					return NULL; /* The talloc_destroy takes care of cleanup. */
 				}
 
@@ -998,12 +998,12 @@
 	 */
 	
 	if ((l_ctx = talloc_init()) == NULL) {
-		DEBUG(0,("set_posix_lock: unable to init talloc context.\n"));
+		ZERODEBUG(0,("set_posix_lock: unable to init talloc context.\n"));
 		return True; /* Not a fatal error. */
 	}
 
 	if ((ll = (struct lock_list *)talloc(l_ctx, sizeof(struct lock_list))) == NULL) {
-		DEBUG(0,("set_posix_lock: unable to talloc unlock list.\n"));
+		ZERODEBUG(0,("set_posix_lock: unable to talloc unlock list.\n"));
 		talloc_destroy(l_ctx);
 		return True; /* Not a fatal error. */
 	}
@@ -1036,7 +1036,7 @@
 	 */
 
 	if (!add_posix_lock_entry(fsp,offset,count,posix_lock_type,&entry_num)) {
-		DEBUG(0,("set_posix_lock: Unable to create posix lock entry !\n"));
+		ZERODEBUG(0,("set_posix_lock: Unable to create posix lock entry !\n"));
 		talloc_destroy(l_ctx);
 		return False;
 	}
@@ -1138,18 +1138,18 @@
 
 	if (num_overlapped_entries > 0 && deleted_lock.lock_type == F_WRLCK) {
 		if (!posix_fcntl_lock(fsp,SMB_F_SETLK,offset,count,F_RDLCK)) {
-			DEBUG(0,("release_posix_lock: downgrade of lock failed with error %s !\n", strerror(errno) ));
+			ZERODEBUG(0,("release_posix_lock: downgrade of lock failed with error %s !\n", strerror(errno) ));
 			return False;
 		}
 	}
 
 	if ((ul_ctx = talloc_init()) == NULL) {
-		DEBUG(0,("release_posix_lock: unable to init talloc context.\n"));
+		ZERODEBUG(0,("release_posix_lock: unable to init talloc context.\n"));
 		return True; /* Not a fatal error. */
 	}
 
 	if ((ul = (struct lock_list *)talloc(ul_ctx, sizeof(struct lock_list))) == NULL) {
-		DEBUG(0,("release_posix_lock: unable to talloc unlock list.\n"));
+		ZERODEBUG(0,("release_posix_lock: unable to talloc unlock list.\n"));
 		talloc_destroy(ul_ctx);
 		return True; /* Not a fatal error. */
 	}
@@ -1205,7 +1205,7 @@
 	TDB_DATA kbuf = locking_key_fsp(fsp);
 
 	if (tdb_delete(posix_lock_tdb, kbuf) == -1)
-		DEBUG(0,("delete_close_entries: tdb_delete fail !\n"));
+		ZERODEBUG(0,("delete_close_entries: tdb_delete fail !\n"));
 }
 
 /****************************************************************************
@@ -1284,14 +1284,14 @@
 		posix_lock_tdb = tdb_open_log(NULL, 0, TDB_INTERNAL,
 					  read_only?O_RDONLY:(O_RDWR|O_CREAT), 0644);
 	if (!posix_lock_tdb) {
-		DEBUG(0,("Failed to open POSIX byte range locking database.\n"));
+		ZERODEBUG(0,("Failed to open POSIX byte range locking database.\n"));
 		return False;
 	}
 	if (!posix_pending_close_tdb)
 		posix_pending_close_tdb = tdb_open_log(NULL, 0, TDB_INTERNAL,
 						   read_only?O_RDONLY:(O_RDWR|O_CREAT), 0644);
 	if (!posix_pending_close_tdb) {
-		DEBUG(0,("Failed to open POSIX pending close database.\n"));
+		ZERODEBUG(0,("Failed to open POSIX pending close database.\n"));
 		return False;
 	}
 
diff -Naur samba-2.2.12-orig/source/msdfs/msdfs.c samba-2.2.12/source/msdfs/msdfs.c
--- samba-2.2.12-orig/source/msdfs/msdfs.c	2004-08-12 20:24:35.000000000 +0200
+++ samba-2.2.12/source/msdfs/msdfs.c	2009-03-11 09:59:33.000000000 +0100
@@ -91,7 +91,7 @@
 	pstring_sub(conn->connectpath, "%S", lp_servicename(snum));
 
 	if (!smbd_vfs_init(conn)) {
-		DEBUG(0,("create_conn_struct: smbd_vfs_init failed.\n"));
+		ZERODEBUG(0,("create_conn_struct: smbd_vfs_init failed.\n"));
 		return False;
 	}
 	return True;
@@ -130,7 +130,7 @@
 
 	reflist = *preflist = (struct referral*) malloc(count * sizeof(struct referral));
 	if(reflist == NULL) {
-		DEBUG(0,("parse_symlink: Malloc failed!\n"));
+		ZERODEBUG(0,("parse_symlink: Malloc failed!\n"));
 		return False;
 	}
 	
@@ -182,7 +182,7 @@
 		referral_len = conn->vfs_ops.readlink(conn, path, referral, 
 						      sizeof(pstring));
 		if (referral_len == -1) {
-			DEBUG(0,("is_msdfs_link: Error reading msdfs link %s: %s\n", path, strerror(errno)));
+			ZERODEBUG(0,("is_msdfs_link: Error reading msdfs link %s: %s\n", path, strerror(errno)));
 			return False;
 		}
 
@@ -398,7 +398,7 @@
 		jn->referral_count = 1;
 		if((ref = (struct referral*) malloc(sizeof(struct referral)))
 		   == NULL) {
-			DEBUG(0,("malloc failed for referral\n"));
+			ZERODEBUG(0,("malloc failed for referral\n"));
 			return False;
 		}
       
@@ -459,7 +459,7 @@
 
 	pdata = Realloc(pdata,reply_size);
 	if(pdata == NULL) {
-		DEBUG(0,("malloc failed for Realloc!\n"));
+		ZERODEBUG(0,("malloc failed for Realloc!\n"));
 		return -1;
 	} else
 		*ppdata = pdata;
@@ -538,7 +538,7 @@
 
 	pdata = Realloc(pdata,reply_size);
 	if(pdata == NULL) {
-		DEBUG(0,("version3 referral setup: malloc failed for Realloc!\n"));
+		ZERODEBUG(0,("version3 referral setup: malloc failed for Realloc!\n"));
 		return -1;
 	} else
 		*ppdata = pdata;
@@ -650,7 +650,7 @@
 		}
 	default:
 		{
-		DEBUG(0,("setup_dfs_referral: Invalid dfs referral version: %d\n", max_referral_level));
+		ZERODEBUG(0,("setup_dfs_referral: Invalid dfs referral version: %d\n", max_referral_level));
 		return -1;
 		}
 	}
@@ -825,7 +825,7 @@
 			 local_machine, service_name);
 		ref = jn[cnt].referral_list = (struct referral*) malloc(sizeof(struct referral));
 		if (jn[cnt].referral_list == NULL) {
-			DEBUG(0, ("Malloc failed!\n"));
+			ZERODEBUG(0, ("Malloc failed!\n"));
 			return False;
 		}
 
diff -Naur samba-2.2.12-orig/source/nmbd/asyncdns.c samba-2.2.12/source/nmbd/asyncdns.c
--- samba-2.2.12-orig/source/nmbd/asyncdns.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/nmbd/asyncdns.c	2009-03-11 13:48:39.000000000 +0100
@@ -83,7 +83,7 @@
 	struct query_record r;
 	fstring qname;
 
-	DEBUGLEVEL = -1;
+	DEBUGLEVEL = 0;
 
 	while (1) {
 		if (read_data(fd_in, (char *)&r, sizeof(r)) != sizeof(r)) 
@@ -134,7 +134,7 @@
 	CatchChild();
 
 	if (pipe(fd1) || pipe(fd2)) {
-		DEBUG(0,("can't create asyncdns pipes\n"));
+		ZERODEBUG(0,("can't create asyncdns pipes\n"));
 		return;
 	}
 
@@ -145,7 +145,7 @@
 		fd_out = fd2[1];
 		close(fd1[1]);
 		close(fd2[0]);
-		DEBUG(0,("started asyncdns process %d\n", (int)child_pid));
+		ZERODEBUG(0,("started asyncdns process %d\n", (int)child_pid));
 		return;
 	}
 
@@ -207,7 +207,7 @@
 
 	if ((size=read_data(fd_in, (char *)&r, sizeof(r))) != sizeof(r)) {
 		if (size) {
-			DEBUG(0,("Incomplete DNS answer from child!\n"));
+			ZERODEBUG(0,("Incomplete DNS answer from child!\n"));
 			fd_in = -1;
 		}
                 BlockSignals(True, SIGTERM);
diff -Naur samba-2.2.12-orig/source/nmbd/nmbd_become_dmb.c samba-2.2.12/source/nmbd/nmbd_become_dmb.c
--- samba-2.2.12-orig/source/nmbd/nmbd_become_dmb.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/nmbd/nmbd_become_dmb.c	2009-03-11 13:35:20.000000000 +0100
@@ -46,7 +46,7 @@
 
   if(!work)
   {
-    DEBUG(0,("become_domain_master_fail: Error - cannot find \
+    ZERODEBUG(0,("become_domain_master_fail: Error - cannot find \
 workgroup %s on subnet %s\n", fail_name->name, subrec->subnet_name));
     return;
   }
@@ -56,7 +56,7 @@
 
   if((servrec = find_server_in_workgroup( work, global_myname)) == NULL)
   {
-    DEBUG(0,("become_domain_master_fail: Error - cannot find server %s \
+    ZERODEBUG(0,("become_domain_master_fail: Error - cannot find server %s \
 in workgroup %s on subnet %s\n",
        global_myname, work->work_group, subrec->subnet_name));
     return;
@@ -68,7 +68,7 @@
   /* Tell the namelist writer to write out a change. */
   subrec->work_changed = True;
 
-  DEBUG(0,("become_domain_master_fail: Failed to become a domain master browser for \
+  ZERODEBUG(0,("become_domain_master_fail: Failed to become a domain master browser for \
 workgroup %s on subnet %s. Couldn't register name %s.\n",
        work->work_group, subrec->subnet_name, nmb_namestr(fail_name)));
 }
@@ -88,14 +88,14 @@
 
   if(!work)
   {
-    DEBUG(0,("become_domain_master_stage2: Error - cannot find \
+    ZERODEBUG(0,("become_domain_master_stage2: Error - cannot find \
 workgroup %s on subnet %s\n", registered_name->name, subrec->subnet_name));
     return;
   }
 
   if((servrec = find_server_in_workgroup( work, global_myname)) == NULL)
   {
-    DEBUG(0,("become_domain_master_stage2: Error - cannot find server %s \
+    ZERODEBUG(0,("become_domain_master_stage2: Error - cannot find server %s \
 in workgroup %s on subnet %s\n", 
        global_myname, registered_name->name, subrec->subnet_name));
     work->dom_state = DOMAIN_NONE;
@@ -111,7 +111,7 @@
   /* Tell the namelist writer to write out a change. */
   subrec->work_changed = True;
 
-  if( DEBUGLVL( 0 ) )
+  if( ZERODEBUGLVL( 0 ) )
     {
     dbgtext( "*****\n\nSamba server %s ", global_myname );
     dbgtext( "is now a domain master browser for " );
@@ -180,7 +180,7 @@
   /* First, find the workgroup on the subnet. */
   if((work = find_workgroup_on_subnet( subrec, wg_name )) == NULL)
   {
-    DEBUG(0,("become_domain_master_stage1: Error - unable to find workgroup %s on subnet %s.\n",
+    ZERODEBUG(0,("become_domain_master_stage1: Error - unable to find workgroup %s on subnet %s.\n",
           wg_name, subrec->subnet_name));
     return;
   }
@@ -229,7 +229,7 @@
   }
   else
   {
-    if( DEBUGLVL( 0 ) )
+    if( ZERODEBUGLVL( 0 ) )
     {
       dbgtext( "become_domain_master_query_success:\n" );
       dbgtext( "There is already a domain master browser at " );
@@ -254,7 +254,7 @@
      then this is a failure. Otherwise, not finding the name is what we want. */
   if((subrec == unicast_subnet) && (fail_code != NAM_ERR))
   {
-    DEBUG(0,("become_domain_master_query_fail: Error %d returned when \
+    ZERODEBUG(0,("become_domain_master_query_fail: Error %d returned when \
 querying WINS server for name %s.\n", 
                   fail_code, nmb_namestr(question_name)));
     return;
@@ -288,7 +288,7 @@
 
       if (find_name_on_subnet(subrec, &nmbname, FIND_SELF_NAME) == NULL)
       {
-        if( DEBUGLVL( 0 ) )
+        if( ZERODEBUGLVL( 0 ) )
           {
           dbgtext( "become_domain_master_browser_bcast:\n" );
           dbgtext( "Attempting to become domain master browser on " );
@@ -301,7 +301,7 @@
            we can become a domain controller. 
          */
 
-        DEBUG(0,("become_domain_master_browser_bcast: querying subnet %s \
+        ZERODEBUG(0,("become_domain_master_browser_bcast: querying subnet %s \
 for domain master browser on workgroup %s\n", subrec->subnet_name, workgroup_name));
 
         query_name(subrec, nmbname.name, nmbname.name_type,
@@ -336,7 +336,7 @@
 
     if (find_name_on_subnet(unicast_subnet, &nmbname, FIND_SELF_NAME) == NULL)
     {
-      if( DEBUGLVL( 0 ) )
+      if( ZERODEBUGLVL( 0 ) )
         {
         dbgtext( "become_domain_master_browser_wins:\n" );
         dbgtext( "Attempting to become domain master browser " );
@@ -349,7 +349,7 @@
          we can become a domain master browser. 
        */
 
-      DEBUG(0,("become_domain_master_browser_wins: querying WINS server at IP %s \
+      ZERODEBUG(0,("become_domain_master_browser_wins: querying WINS server at IP %s \
 for domain master browser name %s on workgroup %s\n",
          inet_ntoa(unicast_subnet->myip), nmb_namestr(&nmbname), workgroup_name));
 
diff -Naur samba-2.2.12-orig/source/nmbd/nmbd_become_lmb.c samba-2.2.12/source/nmbd/nmbd_become_lmb.c
--- samba-2.2.12-orig/source/nmbd/nmbd_become_lmb.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/nmbd/nmbd_become_lmb.c	2009-03-11 13:35:20.000000000 +0100
@@ -85,14 +85,14 @@
 
   if((work = find_workgroup_on_subnet( subrec, workgroup_name)) == NULL)
   {
-    DEBUG(0,("reset_workgroup_state: Error - cannot find workgroup %s on \
+    ZERODEBUG(0,("reset_workgroup_state: Error - cannot find workgroup %s on \
 subnet %s.\n", workgroup_name, subrec->subnet_name ));
     return;
   }
 
   if((servrec = find_server_in_workgroup( work, global_myname)) == NULL)
   {
-    DEBUG(0,("reset_workgroup_state: Error - cannot find server %s \
+    ZERODEBUG(0,("reset_workgroup_state: Error - cannot find server %s \
 in workgroup %s on subnet %s\n",
        global_myname, work->work_group, subrec->subnet_name));
     work->mst_state = lp_local_master() ? MST_POTENTIAL : MST_NONE;
@@ -151,7 +151,7 @@
   /* Now reset the workgroup and server state. */
   reset_workgroup_state( subrec, released_name->name, force_new_election );
 
-  if( DEBUGLVL( 0 ) )
+  if( ZERODEBUGLVL( 0 ) )
   {
     dbgtext( "*****\n\n" );
     dbgtext( "Samba name server %s ", global_myname );
@@ -175,7 +175,7 @@
 
   memcpy((char *)&force_new_election, userdata->data, sizeof(BOOL));
 
-  DEBUG(0,("unbecome_local_master_fail: failed to release name %s. \
+  ZERODEBUG(0,("unbecome_local_master_fail: failed to release name %s. \
 Removing from namelist anyway.\n", nmb_namestr(fail_name)));
 
   /* Do it anyway. */
@@ -186,7 +186,7 @@
   /* Now reset the workgroup and server state. */
   reset_workgroup_state( subrec, fail_name->name, force_new_election );
 
-  if( DEBUGLVL( 0 ) )
+  if( ZERODEBUGLVL( 0 ) )
   {
     dbgtext( "*****\n\n" );
     dbgtext( "Samba name server %s ", global_myname );
@@ -214,7 +214,7 @@
 
     if((userdata = (struct userdata_struct *)malloc(size)) == NULL)
     {
-      DEBUG(0,("release_1d_name: malloc fail.\n"));
+      ZERODEBUG(0,("release_1d_name: malloc fail.\n"));
       return;
     }
 
@@ -288,7 +288,7 @@
   
   if(find_server_in_workgroup( work, global_myname) == NULL)
   {
-    DEBUG(0,("unbecome_local_master_browser: Error - cannot find server %s \
+    ZERODEBUG(0,("unbecome_local_master_browser: Error - cannot find server %s \
 in workgroup %s on subnet %s\n",
        global_myname, work->work_group, subrec->subnet_name));
     work->mst_state = lp_local_master() ? MST_POTENTIAL : MST_NONE;
@@ -342,14 +342,14 @@
 
   if(!work)
   {
-    DEBUG(0,("become_local_master_stage2: Error - cannot find \
+    ZERODEBUG(0,("become_local_master_stage2: Error - cannot find \
 workgroup %s on subnet %s\n", registered_name->name, subrec->subnet_name));
     return;
   }
 
   if((servrec = find_server_in_workgroup( work, global_myname)) == NULL)
   {
-    DEBUG(0,("become_local_master_stage2: Error - cannot find server %s \
+    ZERODEBUG(0,("become_local_master_stage2: Error - cannot find server %s \
 in workgroup %s on subnet %s\n",
        global_myname, registered_name->name, subrec->subnet_name));
     work->mst_state = lp_local_master() ? MST_POTENTIAL : MST_NONE;
@@ -401,7 +401,7 @@
      master browser as soon as possible that we are a local master browser. */
   reset_announce_timer();
 
-  if( DEBUGLVL( 0 ) )
+  if( ZERODEBUGLVL( 0 ) )
   {
     dbgtext( "*****\n\n" );
     dbgtext( "Samba name server %s ", global_myname );
@@ -421,12 +421,12 @@
 {
   struct work_record *work = find_workgroup_on_subnet( subrec, fail_name->name);
 
-  DEBUG(0,("become_local_master_fail2: failed to register name %s on subnet %s. \
+  ZERODEBUG(0,("become_local_master_fail2: failed to register name %s on subnet %s. \
 Failed to become a local master browser.\n", nmb_namestr(fail_name), subrec->subnet_name));
 
   if(!work)
   {
-    DEBUG(0,("become_local_master_fail2: Error - cannot find \
+    ZERODEBUG(0,("become_local_master_fail2: Error - cannot find \
 workgroup %s on subnet %s\n", fail_name->name, subrec->subnet_name));
     return;
   }
@@ -450,7 +450,7 @@
 
   if(!work)
   {
-    DEBUG(0,("become_local_master_stage1: Error - cannot find \
+    ZERODEBUG(0,("become_local_master_stage1: Error - cannot find \
 workgroup %s on subnet %s\n", work_name, subrec->subnet_name));
     return;
   }
@@ -489,14 +489,14 @@
 
   if(!work)
   {
-    DEBUG(0,("become_local_master_fail1: Error - cannot find \
+    ZERODEBUG(0,("become_local_master_fail1: Error - cannot find \
 workgroup %s on subnet %s\n", work_name, subrec->subnet_name));
     return;
   }
 
   if(find_server_in_workgroup(work, global_myname) == NULL)
   {
-    DEBUG(0,("become_local_master_fail1: Error - cannot find server %s \
+    ZERODEBUG(0,("become_local_master_fail1: Error - cannot find server %s \
 in workgroup %s on subnet %s\n",
        global_myname, work->work_group, subrec->subnet_name));
     return;
@@ -504,7 +504,7 @@
 
   reset_workgroup_state( subrec, work->work_group, False );
 
-  DEBUG(0,("become_local_master_fail1: Failed to become a local master browser for \
+  ZERODEBUG(0,("become_local_master_fail1: Failed to become a local master browser for \
 workgroup %s on subnet %s. Couldn't register name %s.\n",
        work->work_group, subrec->subnet_name, nmb_namestr(fail_name)));
 }
@@ -526,7 +526,7 @@
   /* Sanity check. */
   if (!lp_local_master())
   { 
-    DEBUG(0,("become_local_master_browser: Samba not configured as a local master browser.\n"));
+    ZERODEBUG(0,("become_local_master_browser: Samba not configured as a local master browser.\n"));
     return;
   }
 
@@ -539,7 +539,7 @@
 
   if(find_server_in_workgroup( work, global_myname) == NULL)
   {
-    DEBUG(0,("become_local_master_browser: Error - cannot find server %s \
+    ZERODEBUG(0,("become_local_master_browser: Error - cannot find server %s \
 in workgroup %s on subnet %s\n",
        global_myname, work->work_group, subrec->subnet_name));
     return;
@@ -559,7 +559,7 @@
   /* Setup the userdata_struct. */
   if((userdata = (struct userdata_struct *)malloc(size)) == NULL)
   {
-    DEBUG(0,("become_local_master_browser: malloc fail.\n"));
+    ZERODEBUG(0,("become_local_master_browser: malloc fail.\n"));
     return;
   }
 
diff -Naur samba-2.2.12-orig/source/nmbd/nmbd_browserdb.c samba-2.2.12/source/nmbd/nmbd_browserdb.c
--- samba-2.2.12-orig/source/nmbd/nmbd_browserdb.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/nmbd/nmbd_browserdb.c	2009-03-11 10:01:01.000000000 +0100
@@ -93,7 +93,7 @@
 
   if( NULL == browc )
     {
-    DEBUG( 0, ("create_browser_in_lmb_cache: malloc fail !\n") );
+    ZERODEBUG( 0, ("create_browser_in_lmb_cache: malloc fail !\n") );
     return( NULL );
     }
 
diff -Naur samba-2.2.12-orig/source/nmbd/nmbd_browsesync.c samba-2.2.12/source/nmbd/nmbd_browsesync.c
--- samba-2.2.12-orig/source/nmbd/nmbd_browsesync.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/nmbd/nmbd_browsesync.c	2009-03-11 13:35:20.000000000 +0100
@@ -40,7 +40,7 @@
 
   if( !(work = find_workgroup_on_subnet(unicast_subnet, browc->work_group)) )
   {
-    if( DEBUGLVL( 0 ) )
+    if( ZERODEBUGLVL( 0 ) )
     {
       dbgtext( "sync_with_lmb:\n" );
       dbgtext( "Failed to get a workgroup for a local master browser " );
@@ -55,7 +55,7 @@
 
   if(!AM_DOMAIN_MASTER_BROWSER(work))
   {
-    if( DEBUGLVL( 0 ) )
+    if( ZERODEBUGLVL( 0 ) )
     {
       dbgtext( "sync_with_lmb:\n" );
       dbgtext( "We are trying to sync with a local master browser " );
@@ -180,7 +180,7 @@
 
   if( work == NULL )
   {
-    if( DEBUGLVL( 0 ) )
+    if( ZERODEBUGLVL( 0 ) )
     {
       dbgtext( "domain_master_node_status_success:\n" );
       dbgtext( "Unable to find workgroup " );
@@ -242,7 +242,7 @@
     }
   }
   else
-    if( DEBUGLVL( 0 ) )
+    if( ZERODEBUGLVL( 0 ) )
     {
       dbgtext( "domain_master_node_status_success:\n" );
       dbgtext( "Failed to find a SERVER<0x20> name in reply from IP " );
@@ -259,7 +259,7 @@
 {
   struct userdata_struct *userdata = rrec->userdata;
 
-  if( DEBUGLVL( 0 ) )
+  if( ZERODEBUGLVL( 0 ) )
   {
     dbgtext( "domain_master_node_status_fail:\n" );
     dbgtext( "Doing a node status request to the domain master browser\n" );
@@ -297,7 +297,7 @@
 
   if( !(work = find_workgroup_on_subnet(subrec, q_name->name)) )
   {
-    if( DEBUGLVL( 0 ) )
+    if( ZERODEBUGLVL( 0 ) )
       {
       dbgtext( "find_domain_master_name_query_success:\n" );
       dbgtext( "Failed to find workgroup %s\n", q_name->name );
@@ -331,7 +331,7 @@
      a stack variable for this. */
   if((userdata = (struct userdata_struct *)malloc(size)) == NULL)
   {
-    DEBUG(0, ("find_domain_master_name_query_success: malloc fail.\n"));
+    ZERODEBUG(0, ("find_domain_master_name_query_success: malloc fail.\n"));
     return;
   }
 
@@ -355,7 +355,7 @@
                                     struct response_record *rrec,
                                     struct nmb_name *question_name, int fail_code)
 {
-  if( DEBUGLVL( 0 ) )
+  if( ZERODEBUGLVL( 0 ) )
   {
     dbgtext( "find_domain_master_name_query_fail:\n" );
     dbgtext( "Unable to find the Domain Master Browser name " );
@@ -491,7 +491,7 @@
     }
   }
   else
-    if( DEBUGLVL( 0 ) )
+    if( ZERODEBUGLVL( 0 ) )
     {
       dbgtext( "get_domain_master_name_node_status_success:\n" );
       dbgtext( "Failed to find a WORKGROUP<0x1b> name in reply from IP " );
@@ -506,7 +506,7 @@
 static void get_domain_master_name_node_status_fail(struct subnet_record *subrec,
                        struct response_record *rrec)
 {
-  if( DEBUGLVL( 0 ) )
+  if( ZERODEBUGLVL( 0 ) )
   {
     dbgtext( "get_domain_master_name_node_status_fail:\n" );
     dbgtext( "Doing a node status request to the domain master browser " );
@@ -614,7 +614,7 @@
   /* Check to see if we are a domain master browser on the unicast subnet. */
   if((work = find_workgroup_on_subnet( unicast_subnet, global_myworkgroup)) == NULL)
   {
-    if( DEBUGLVL( 0 ) )
+    if( ZERODEBUGLVL( 0 ) )
     {
       dbgtext( "collect_all_workgroup_names_from_wins_server:\n" );
       dbgtext( "Cannot find my workgroup %s ", global_myworkgroup );
diff -Naur samba-2.2.12-orig/source/nmbd/nmbd.c samba-2.2.12/source/nmbd/nmbd.c
--- samba-2.2.12-orig/source/nmbd/nmbd.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/nmbd/nmbd.c	2009-03-11 13:48:39.000000000 +0100
@@ -56,7 +56,7 @@
 
 static void terminate(void)
 {
-	DEBUG(0,("Got SIGTERM: going down...\n"));
+	ZERODEBUG(0,("Got SIGTERM: going down...\n"));
 
 	/* Write out wins.dat file if samba is a WINS server */
 	wins_write_database(False);
@@ -131,7 +131,7 @@
 #endif
 
 
-  DEBUG(0,("Dumping core in %s\n",dname));
+  ZERODEBUG(0,("Dumping core in %s\n",dname));
   abort();
   return( True );
 } /* dump_core */
@@ -253,7 +253,7 @@
 
 	/* We need to shutdown if there are no subnets... */
 	if (FIRST_SUBNET == NULL) {
-		DEBUG(0,("reload_interfaces: No subnets to listen to. Shutting down...\n"));
+		ZERODEBUG(0,("reload_interfaces: No subnets to listen to. Shutting down...\n"));
 		return True;
 	}
 	return False;
@@ -296,7 +296,7 @@
   /* Do a sanity check for a misconfigured nmbd */
   if( lp_wins_support() && *lp_wins_server() )
   {
-    DEBUG(0,("ERROR: both 'wins support = true' and 'wins server = <server>' \
+    ZERODEBUG(0,("ERROR: both 'wins support = true' and 'wins server = <server>' \
 cannot be set in the smb.conf file. nmbd aborting.\n"));
     exit(10);
   }
@@ -499,7 +499,7 @@
      */
 
     if(reload_after_sighup) {
-      DEBUG( 0, ( "Got SIGHUP dumping debug info.\n" ) );
+      ZERODEBUG( 0, ( "Got SIGHUP dumping debug info.\n" ) );
       write_browse_list( 0, True );
       dump_all_namelists();
       reload_nmbd_services( True );
@@ -588,7 +588,7 @@
   my_netbios_names = (char **)malloc( sizeof(char *) * (namecount+1) );
   if( NULL == my_netbios_names )
   {
-     DEBUG( 0, ( "init_structs: malloc fail.\n" ) );
+     ZERODEBUG( 0, ( "init_structs: malloc fail.\n" ) );
      return( False );
   }
  
@@ -616,7 +616,7 @@
   for( n = 0; n < namecount; n++ )
     if( NULL == my_netbios_names[n] )
     {
-      DEBUG(0,("init_structs: malloc fail when allocating names.\n"));
+      ZERODEBUG(0,("init_structs: malloc fail when allocating names.\n"));
       return False;
     }
   
@@ -644,7 +644,7 @@
 static void usage(char *pname)
 {
 
-  printf( "Usage: %s [-DaiohV] [-H lmhosts file] [-d debuglevel] [-l log basename]\n", pname );
+  printf( "Usage: %s [-DaiohV] [-H lmhosts file] [-l log basename]\n", pname );
   printf( "       [-n name] [-p port] [-s configuration file]\n" );
   printf( "\t-D                    Become a daemon (default)\n" );
   printf( "\t-a                    Append to log file (default)\n" );
@@ -653,7 +653,6 @@
   printf( "\t-h                    Print usage\n" );
   printf( "\t-V                    Print version\n" );
   printf( "\t-H hosts file         Load a netbios hosts file\n" );
-  printf( "\t-d debuglevel         Set the debuglevel\n" );
   printf( "\t-l log basename.      Basename for log/debug files\n" );
   printf( "\t-n netbiosname.       Primary netbios name\n" );
   printf( "\t-p port               Listen on the specified port\n" );
@@ -738,7 +737,7 @@
         case 'I':
         case 'C':
         case 'G':
-          DEBUG(0,("Obsolete option '%c' used\n",opt));
+          ZERODEBUG(0,("Obsolete option '%c' used\n",opt));
           break;
         case 'H':
           pstrcpy(host_file,optarg);
@@ -764,7 +763,7 @@
           is_daemon = True;
           break;
         case 'd':
-          DEBUGLEVEL = atoi(optarg);
+          DEBUGLEVEL = 0;
 	  AllowDebugChange = False;
           break;
         case 'p':
@@ -781,7 +780,7 @@
         default:
           if( !is_a_socket(0) )
           {
-	    DEBUG(0,("Incorrect program usage - is the command line correct?\n"));
+	    ZERODEBUG(0,("Incorrect program usage - is the command line correct?\n"));
             usage(argv[0]);
             exit(0);
           }
@@ -792,15 +791,15 @@
   setup_logging( argv[0], opt_interactive );
   reopen_logs();
 
-  DEBUG( 0, ( "Netbios nameserver version %s started.\n", VERSION ) );
-  DEBUGADD( 0, ( "Copyright Andrew Tridgell and the Samba Team 1994-2002\n" ) );
+  ZERODEBUG( 0, ( "Netbios nameserver version %s started.\n", VERSION ) );
+  ZERODEBUGADD( 0, ( "Copyright Andrew Tridgell and the Samba Team 1994-2002\n" ) );
 
   if ( !reload_nmbd_services(False) )
     return(-1);
 
 #ifdef WITH_PROFILE
   if (!profile_setup(False)) {
-	DEBUG(0,("ERROR: failed to setup profiling shared memory\n"));
+	ZERODEBUG(0,("ERROR: failed to setup profiling shared memory\n"));
 	return -1;
   }
 #endif /* WITH_PROFILE */
@@ -816,7 +815,7 @@
 
   if (strequal(global_myworkgroup,"*"))
   {
-    DEBUG(0,("ERROR: a workgroup name of * is no longer supported\n"));
+    ZERODEBUG(0,("ERROR: a workgroup name of * is no longer supported\n"));
     exit(1);
   }
 
@@ -824,7 +823,7 @@
 
   if (!is_daemon && !is_a_socket(0))
   {
-    DEBUG(0,("standard input is not a socket, assuming -D option\n"));
+    ZERODEBUG(0,("standard input is not a socket, assuming -D option\n"));
     is_daemon = True;
   }
   
@@ -870,7 +869,7 @@
   /* Create an nmbd subnet record for each of the above. */
   if( False == create_subnets() )
   {
-    DEBUG(0,("ERROR: Failed when creating subnet lists. Exiting.\n"));
+    ZERODEBUG(0,("ERROR: Failed when creating subnet lists. Exiting.\n"));
     exit(1);
   }
 
@@ -884,7 +883,7 @@
   /* If we are acting as a WINS server, initialise data structures. */
   if( !initialise_wins() )
   {
-    DEBUG( 0, ( "nmbd: Failed when initialising WINS server.\n" ) );
+    ZERODEBUG( 0, ( "nmbd: Failed when initialising WINS server.\n" ) );
     exit(1);
   }
 
@@ -898,7 +897,7 @@
 
   if( False == register_my_workgroup_and_names() )
   {
-    DEBUG(0,("ERROR: Failed when creating my my workgroup. Exiting.\n"));
+    ZERODEBUG(0,("ERROR: Failed when creating my my workgroup. Exiting.\n"));
     exit(1);
   }
 
diff -Naur samba-2.2.12-orig/source/nmbd/nmbd_elections.c samba-2.2.12/source/nmbd/nmbd_elections.c
--- samba-2.2.12-orig/source/nmbd/nmbd_elections.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/nmbd/nmbd_elections.c	2009-03-11 09:59:33.000000000 +0100
@@ -88,7 +88,7 @@
 
   if(work == NULL)
   {
-    DEBUG(0,("check_for_master_browser_fail: Unable to find workgroup %s on subnet %s.=\n",
+    ZERODEBUG(0,("check_for_master_browser_fail: Unable to find workgroup %s on subnet %s.=\n",
           workgroup_name, subrec->subnet_name ));
     return;
   }
@@ -286,7 +286,7 @@
 
   if(( work = find_workgroup_on_subnet(subrec, workgroup_name)) == NULL)
   {
-    DEBUG(0,("process_election: Cannot find workgroup %s on subnet %s.\n",
+    ZERODEBUG(0,("process_election: Cannot find workgroup %s on subnet %s.\n",
           workgroup_name, subrec->subnet_name ));
     goto done;
   }
diff -Naur samba-2.2.12-orig/source/nmbd/nmbd_incomingdgrams.c samba-2.2.12/source/nmbd/nmbd_incomingdgrams.c
--- samba-2.2.12-orig/source/nmbd/nmbd_incomingdgrams.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/nmbd/nmbd_incomingdgrams.c	2009-03-11 09:59:33.000000000 +0100
@@ -223,7 +223,7 @@
   /* Workgroup announcements must only go to the MSBROWSE name. */
   if (!strequal(dgram->dest_name.name, MSBROWSE) || (dgram->dest_name.name_type != 0x1))
   {
-    DEBUG(0,("process_workgroup_announce: from IP %s should be to __MSBROWSE__<0x01> not %s\n",
+    ZERODEBUG(0,("process_workgroup_announce: from IP %s should be to __MSBROWSE__<0x01> not %s\n",
               inet_ntoa(p->ip), nmb_namestr(&dgram->dest_name)));
     goto done;
   }
@@ -280,7 +280,7 @@
   /* A local master announcement must be sent to the name WORKGROUP<1e>. */
   if(dgram->dest_name.name_type != 0x1e)
   {
-    DEBUG(0,("process_local_master_announce: incorrect name type for destination from IP %s \
+    ZERODEBUG(0,("process_local_master_announce: incorrect name type for destination from IP %s \
 (was %02x) should be 0x1e. Ignoring packet.\n",
               inet_ntoa(p->ip), dgram->dest_name.name_type));
     goto done;
@@ -309,7 +309,7 @@
    */
   if(AM_LOCAL_MASTER_BROWSER(work))
   {
-    DEBUG(0,("process_local_master_announce: Server %s at IP %s is announcing itself as \
+    ZERODEBUG(0,("process_local_master_announce: Server %s at IP %s is announcing itself as \
 a local master browser for workgroup %s and we think we are master. Forcing election.\n",
       server_name, inet_ntoa(p->ip), work_name));
 
@@ -392,21 +392,21 @@
   
   if (!lp_domain_master()) 
   {
-    DEBUG(0,("process_master_browser_announce: Not configured as domain \
+    ZERODEBUG(0,("process_master_browser_announce: Not configured as domain \
 master - ignoring master announce.\n"));
     goto done;
   }
   
   if((work = find_workgroup_on_subnet(subrec, global_myworkgroup)) == NULL)
   {
-    DEBUG(0,("process_master_browser_announce: Cannot find workgroup %s on subnet %s\n",
+    ZERODEBUG(0,("process_master_browser_announce: Cannot find workgroup %s on subnet %s\n",
            global_myworkgroup, subrec->subnet_name));
     goto done;
   }
 
   if(!AM_DOMAIN_MASTER_BROWSER(work))
   {
-    DEBUG(0,("process_master_browser_announce: Local master announce made to us from \
+    ZERODEBUG(0,("process_master_browser_announce: Local master announce made to us from \
 %s IP %s and we are not a domain master browser.\n", local_master_name, inet_ntoa(p->ip)));
     goto done;
   }
@@ -674,7 +674,7 @@
 
   if((work = find_workgroup_on_subnet(search_subrec, workgroup_name)) == NULL)
   {
-    DEBUG(0,("process_get_backup_list_request: Cannot find workgroup %s on \
+    ZERODEBUG(0,("process_get_backup_list_request: Cannot find workgroup %s on \
 subnet %s.\n", workgroup_name, search_subrec->subnet_name));
     goto done;
   }
@@ -692,7 +692,7 @@
 
     if(!AM_DOMAIN_MASTER_BROWSER(work))
     {
-      DEBUG(0,("process_get_backup_list_request: domain list requested for workgroup %s \
+      ZERODEBUG(0,("process_get_backup_list_request: domain list requested for workgroup %s \
 and I am not a domain master browser.\n", workgroup_name));
       goto done;
     }
@@ -706,14 +706,14 @@
 
     if(!AM_LOCAL_MASTER_BROWSER(work))
     {
-      DEBUG(0,("process_get_backup_list_request: domain list requested for workgroup %s \
+      ZERODEBUG(0,("process_get_backup_list_request: domain list requested for workgroup %s \
 and I am not a local master browser.\n", workgroup_name));
       goto done;
     }
   }
   else
   {
-    DEBUG(0,("process_get_backup_list_request: Invalid name type %x - should be 0x1b or 0x1d.\n",
+    ZERODEBUG(0,("process_get_backup_list_request: Invalid name type %x - should be 0x1b or 0x1d.\n",
             name_type));
     goto done;
   }
@@ -810,7 +810,7 @@
 
   if((work = find_workgroup_on_subnet(subrec, workgroup_name)) == NULL)
   {
-    DEBUG(0,("process_announce_request: Unable to find workgroup %s on subnet !\n",
+    ZERODEBUG(0,("process_announce_request: Unable to find workgroup %s on subnet !\n",
             workgroup_name));
     goto done;
   }
@@ -849,7 +849,7 @@
 
   if(find_workgroup_on_subnet(subrec, workgroup_name) == NULL)
   {
-    DEBUG(0,("process_announce_request: Unable to find workgroup %s on subnet !\n",
+    ZERODEBUG(0,("process_announce_request: Unable to find workgroup %s on subnet !\n",
             workgroup_name));
     goto done;
   }
diff -Naur samba-2.2.12-orig/source/nmbd/nmbd_incomingrequests.c samba-2.2.12/source/nmbd/nmbd_incomingrequests.c
--- samba-2.2.12-orig/source/nmbd/nmbd_incomingrequests.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/nmbd/nmbd_incomingrequests.c	2009-03-11 09:59:33.000000000 +0100
@@ -79,7 +79,7 @@
        the request was malformed. Either way, log an error here.
        and send an error reply back.
      */
-    DEBUG(0,("process_name_release_request: unicast name release request \
+    ZERODEBUG(0,("process_name_release_request: unicast name release request \
 received for name %s from IP %s on subnet %s. Error - should be sent to WINS server\n",
           nmb_namestr(question), inet_ntoa(owner_ip), subrec->subnet_name));      
 
@@ -119,7 +119,7 @@
      || (namerec->data.source == PERMANENT_NAME) ) )
   {
     rcode = ACT_ERR;
-    DEBUG(0, ("process_name_release_request: Attempt to release name %s from IP %s \
+    ZERODEBUG(0, ("process_name_release_request: Attempt to release name %s from IP %s \
 on subnet %s being rejected as it is one of our names.\n", 
           nmb_namestr(&nmb->question.question_name), inet_ntoa(owner_ip), subrec->subnet_name));
   }
@@ -178,10 +178,10 @@
        the request was malformed. Either way, log an error here.
        and send an error reply back.
      */
-    DEBUG(0,("process_name_refresh_request: unicast name registration request \
+    ZERODEBUG(0,("process_name_refresh_request: unicast name registration request \
 received for name %s from IP %s on subnet %s.\n",
           nmb_namestr(question), inet_ntoa(from_ip), subrec->subnet_name));
-    DEBUG(0,("Error - should be sent to WINS server\n"));
+    ZERODEBUG(0,("Error - should be sent to WINS server\n"));
     
     send_name_registration_response(FMT_ERR, 0, p);
     goto done;
@@ -225,7 +225,7 @@
        the request was malformed. Either way, log an error here.
        and send an error reply back.
      */
-    DEBUG(0,("process_name_registration_request: unicast name registration request \
+    ZERODEBUG(0,("process_name_registration_request: unicast name registration request \
 received for name %s from IP %s on subnet %s. Error - should be sent to WINS server\n",
           nmb_namestr(question), inet_ntoa(from_ip), subrec->subnet_name));      
 
@@ -560,7 +560,7 @@
       {
         if((prdata = (char *)malloc( namerec->data.num_ips * 6 )) == NULL)
         {
-          DEBUG(0,("process_name_query_request: malloc fail !\n"));
+          ZERODEBUG(0,("process_name_query_request: malloc fail !\n"));
           goto done;
         }
       }
diff -Naur samba-2.2.12-orig/source/nmbd/nmbd_logonnames.c samba-2.2.12/source/nmbd/nmbd_logonnames.c
--- samba-2.2.12-orig/source/nmbd/nmbd_logonnames.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/nmbd/nmbd_logonnames.c	2009-03-11 13:35:07.000000000 +0100
@@ -43,14 +43,14 @@
 
   if(!work)
   {
-    DEBUG(0,("become_logon_server_fail: Error - cannot find \
+    ZERODEBUG(0,("become_logon_server_fail: Error - cannot find \
 workgroup %s on subnet %s\n", fail_name->name, subrec->subnet_name));
     return;
   }
 
   if((servrec = find_server_in_workgroup( work, global_myname)) == NULL)
   {
-    DEBUG(0,("become_logon_server_fail: Error - cannot find server %s \
+    ZERODEBUG(0,("become_logon_server_fail: Error - cannot find server %s \
 in workgroup %s on subnet %s\n",
        global_myname, fail_name->name, subrec->subnet_name));
     work->log_state = LOGON_NONE;
@@ -62,7 +62,7 @@
 
   servrec->serv.type &= ~SV_TYPE_DOMAIN_CTRL;
 
-  DEBUG(0,("become_logon_server_fail: Failed to become a domain master for \
+  ZERODEBUG(0,("become_logon_server_fail: Failed to become a domain master for \
 workgroup %s on subnet %s. Couldn't register name %s.\n",
        work->work_group, subrec->subnet_name, nmb_namestr(fail_name)));
 
@@ -83,14 +83,14 @@
 
   if(!work)
   {
-    DEBUG(0,("become_logon_server_success: Error - cannot find \
+    ZERODEBUG(0,("become_logon_server_success: Error - cannot find \
 workgroup %s on subnet %s\n", registered_name->name, subrec->subnet_name));
     return;
   }
 
   if((servrec = find_server_in_workgroup( work, global_myname)) == NULL)
   {
-    DEBUG(0,("become_logon_server_success: Error - cannot find server %s \
+    ZERODEBUG(0,("become_logon_server_success: Error - cannot find server %s \
 in workgroup %s on subnet %s\n",
        global_myname, registered_name->name, subrec->subnet_name));
     work->log_state = LOGON_NONE;
@@ -120,7 +120,7 @@
 	  insert_permanent_name_into_unicast(subrec, &nmbname, 0x1c);
   }
 
-  DEBUG(0,("become_logon_server_success: Samba is now a logon server \
+  ZERODEBUG(0,("become_logon_server_success: Samba is now a logon server \
 for workgroup %s on subnet %s\n", work->work_group, subrec->subnet_name));
 }
 
@@ -162,7 +162,7 @@
 
       if (find_name_on_subnet(subrec, &nmbname, FIND_SELF_NAME) == NULL)
       {
-        if( DEBUGLVL( 0 ) )
+        if( ZERODEBUGLVL( 0 ) )
         {
           dbgtext( "add_domain_logon_names:\n" );
           dbgtext( "Attempting to become logon server " );
diff -Naur samba-2.2.12-orig/source/nmbd/nmbd_mynames.c samba-2.2.12/source/nmbd/nmbd_mynames.c
--- samba-2.2.12-orig/source/nmbd/nmbd_mynames.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/nmbd/nmbd_mynames.c	2009-03-11 09:59:33.000000000 +0100
@@ -36,7 +36,7 @@
 static void my_name_register_failed(struct subnet_record *subrec,
                               struct response_record *rrec, struct nmb_name *nmbname)
 {
-  DEBUG(0,("my_name_register_failed: Failed to register my name %s on subnet %s.\n",
+  ZERODEBUG(0,("my_name_register_failed: Failed to register my name %s on subnet %s.\n",
             nmb_namestr(nmbname), subrec->subnet_name));
 }
 
@@ -54,7 +54,7 @@
 	/* Create the workgroup on the subnet. */
 	if((work = create_workgroup_on_subnet(subrec, global_myworkgroup, 
 					      PERMANENT_TTL)) == NULL) {
-		DEBUG(0,("register_my_workgroup_and_names: Failed to create my workgroup %s on subnet %s. \
+		ZERODEBUG(0,("register_my_workgroup_and_names: Failed to create my workgroup %s on subnet %s. \
 Exiting.\n", global_myworkgroup, subrec->subnet_name));
 		return;
 	}
diff -Naur samba-2.2.12-orig/source/nmbd/nmbd_namelistdb.c samba-2.2.12/source/nmbd/nmbd_namelistdb.c
--- samba-2.2.12-orig/source/nmbd/nmbd_namelistdb.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/nmbd/nmbd_namelistdb.c	2009-03-11 10:01:01.000000000 +0100
@@ -190,7 +190,7 @@
   namerec = (struct name_record *)malloc( sizeof(*namerec) );
   if( NULL == namerec )
   {
-    DEBUG( 0, ( "add_name_to_subnet: malloc fail.\n" ) );
+    ZERODEBUG( 0, ( "add_name_to_subnet: malloc fail.\n" ) );
     return( NULL );
   }
 
@@ -199,7 +199,7 @@
                                                * num_ips );
   if( NULL == namerec->data.ip )
   {
-     DEBUG( 0, ( "add_name_to_subnet: malloc fail when creating ip_flgs.\n" ) );
+     ZERODEBUG( 0, ( "add_name_to_subnet: malloc fail when creating ip_flgs.\n" ) );
 
      ZERO_STRUCTP(namerec);
      SAFE_FREE( namerec );
@@ -285,7 +285,7 @@
 
   namerec = find_name_on_subnet( subrec, nmbname, FIND_SELF_NAME );
 
-  DEBUG( 0, ( "standard_fail_register: Failed to register/refresh name %s \
+  ZERODEBUG( 0, ( "standard_fail_register: Failed to register/refresh name %s \
 on subnet %s\n",
             nmb_namestr(nmbname), subrec->subnet_name) );
 
@@ -340,7 +340,7 @@
                                        * sizeof(struct in_addr) );
   if( NULL == new_list )
   {
-    DEBUG(0,("add_ip_to_name_record: Malloc fail !\n"));
+    ZERODEBUG(0,("add_ip_to_name_record: Malloc fail !\n"));
     return;
   }
 
@@ -392,7 +392,7 @@
 
   if( namerec == NULL )
   {
-    DEBUG( 0, ( "standard_success_release: Name release for name %s IP %s \
+    ZERODEBUG( 0, ( "standard_success_release: Name release for name %s IP %s \
 on subnet %s. Name was not found on subnet.\n",
                 nmb_namestr(nmbname),
                 inet_ntoa(released_ip),
@@ -406,7 +406,7 @@
     remove_ip_from_name_record( namerec, released_ip );
 
     if( namerec->data.num_ips == orig_num )
-      DEBUG( 0, ( "standard_success_release: Name release for name %s IP %s \
+      ZERODEBUG( 0, ( "standard_success_release: Name release for name %s IP %s \
 on subnet %s. This ip is not known for this name.\n",
                 nmb_namestr(nmbname),
                 inet_ntoa(released_ip),
@@ -495,7 +495,7 @@
     iplist = (struct in_addr *)malloc( num_ips * sizeof(struct in_addr) );
     if( NULL == iplist )
     {
-      DEBUG(0,("add_samba_names_to_subnet: Malloc fail !\n"));
+      ZERODEBUG(0,("add_samba_names_to_subnet: Malloc fail !\n"));
       return;
     }
 
@@ -604,7 +604,7 @@
      
   if (!fp)
   { 
-    DEBUG(0,("dump_all_namelists: Can't open file %s. Error was %s\n",
+    ZERODEBUG(0,("dump_all_namelists: Can't open file %s. Error was %s\n",
               "namelist.debug",strerror(errno)));
     return;
   }
diff -Naur samba-2.2.12-orig/source/nmbd/nmbd_namequery.c samba-2.2.12/source/nmbd/nmbd_namequery.c
--- samba-2.2.12-orig/source/nmbd/nmbd_namequery.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/nmbd/nmbd_namequery.c	2009-03-11 13:35:07.000000000 +0100
@@ -109,7 +109,7 @@
   }
   else if( rrec->num_msgs > 1)
   {
-    if( DEBUGLVL( 0 ) )
+    if( ZERODEBUGLVL( 0 ) )
       {
       if (nmb->answers)
         putip( (char *)&answer_ip, &nmb->answers->rdata[2] );
@@ -233,7 +233,7 @@
     rrec.rdlength = namerec->data.num_ips * 6;
     if(rrec.rdlength > MAX_DGRAM_SIZE)
     {
-      if( DEBUGLVL( 0 ) )
+      if( ZERODEBUGLVL( 0 ) )
         {
         dbgtext( "query_name: nmbd internal error - " );
         dbgtext( "there are %d ip addresses ", namerec->data.num_ips );
@@ -262,7 +262,7 @@
         userdata,
         &nmbname) == NULL)
   {
-    if( DEBUGLVL( 0 ) )
+    if( ZERODEBUGLVL( 0 ) )
       {
       dbgtext( "query_name: Failed to send packet " );
       dbgtext( "trying to query name %s\n", nmb_namestr(&nmbname) );
@@ -294,7 +294,7 @@
         userdata,
         &nmbname) == NULL)
   {
-    if( DEBUGLVL( 0 ) )
+    if( ZERODEBUGLVL( 0 ) )
       {
       dbgtext( "query_name_from_wins_server: Failed to send packet " );
       dbgtext( "trying to query name %s\n", nmb_namestr(&nmbname) );
diff -Naur samba-2.2.12-orig/source/nmbd/nmbd_nameregister.c samba-2.2.12/source/nmbd/nmbd_nameregister.c
--- samba-2.2.12-orig/source/nmbd/nmbd_nameregister.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/nmbd/nmbd_nameregister.c	2009-03-11 09:59:33.000000000 +0100
@@ -53,14 +53,14 @@
 
   if(!question_name || !answer_name)
   {
-    DEBUG(0,("register_name_response: malformed response (%s is NULL).\n",
+    ZERODEBUG(0,("register_name_response: malformed response (%s is NULL).\n",
            question_name ? "question_name" : "answer_name" ));
     return;
   }
 
   if(!nmb_name_equal(question_name, answer_name))
   {
-    DEBUG(0,("register_name_response: Answer name %s differs from question \
+    ZERODEBUG(0,("register_name_response: Answer name %s differs from question \
 name %s.\n", nmb_namestr(answer_name), nmb_namestr(question_name)));
     return;
   }
@@ -104,7 +104,7 @@
       /* Error code - we didn't get the name. */
       success = False;
 
-      DEBUG(0,("register_name_response: server at IP %s rejected our \
+      ZERODEBUG(0,("register_name_response: server at IP %s rejected our \
 name registration of %s with error code %d.\n", inet_ntoa(p->ip), 
                   nmb_namestr(answer_name), nmb->header.rcode));
 
@@ -278,7 +278,7 @@
 
   if((ip_list = (struct in_addr *)malloc(num_ips * sizeof(struct in_addr)))==NULL)
   {
-    DEBUG(0,("multihomed_register_name: malloc fail !\n"));
+    ZERODEBUG(0,("multihomed_register_name: malloc fail !\n"));
     return True;
   }
 
@@ -306,7 +306,7 @@
         nb_flags,
         ip_list[i]) == NULL)
     {
-      DEBUG(0,("multihomed_register_name: Failed to send packet trying to \
+      ZERODEBUG(0,("multihomed_register_name: Failed to send packet trying to \
 register name %s IP %s\n", nmb_namestr(nmbname), inet_ntoa(ip_list[i]) ));
 
       SAFE_FREE(ip_list);
@@ -356,7 +356,7 @@
         &nmbname,
         nb_flags) == NULL)
   {
-    DEBUG(0,("register_name: Failed to send packet trying to register name %s\n",
+    ZERODEBUG(0,("register_name: Failed to send packet trying to register name %s\n",
           nmb_namestr(&nmbname)));
     return True;
   }
@@ -391,7 +391,7 @@
         namerec,
         namerec->data.ip[i]) == NULL)
     {
-      DEBUG(0,("refresh_name: Failed to send packet trying to refresh name %s\n",
+      ZERODEBUG(0,("refresh_name: Failed to send packet trying to refresh name %s\n",
             nmb_namestr(&namerec->name)));
       return True;
     }
diff -Naur samba-2.2.12-orig/source/nmbd/nmbd_namerelease.c samba-2.2.12/source/nmbd/nmbd_namerelease.c
--- samba-2.2.12-orig/source/nmbd/nmbd_namerelease.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/nmbd/nmbd_namerelease.c	2009-03-11 09:59:34.000000000 +0100
@@ -48,7 +48,7 @@
 
   if(!nmb_name_equal(question_name, answer_name))
   {
-    DEBUG(0,("release_name_response: Answer name %s differs from question \
+    ZERODEBUG(0,("release_name_response: Answer name %s differs from question \
 name %s.\n", nmb_namestr(answer_name), nmb_namestr(question_name)));
     return;
   }
@@ -68,7 +68,7 @@
       /* Error code - we were told not to release the name ! What now ! */
       success = False;
 
-      DEBUG(0,("release_name_response: WINS server at IP %s rejected our \
+      ZERODEBUG(0,("release_name_response: WINS server at IP %s rejected our \
 name release of name %s with error code %d.\n", inet_ntoa(p->ip), 
                   nmb_namestr(answer_name), nmb->header.rcode));
 
@@ -199,7 +199,7 @@
   /* Ensure it's a SELF name, and in the ACTIVE state. */
   if((namerec->data.source != SELF_NAME) || !NAME_IS_ACTIVE(namerec))
   {
-    DEBUG(0,("release_name: Cannot release name %s from subnet %s. Source was %d \n",
+    ZERODEBUG(0,("release_name: Cannot release name %s from subnet %s. Source was %d \n",
           nmb_namestr(&namerec->name), subrec->subnet_name, namerec->data.source)); 
     return True;
   }
@@ -225,7 +225,7 @@
         namerec->data.nb_flags,
         namerec->data.ip[i]) == NULL)
     {
-      DEBUG(0,("release_name: Failed to send packet trying to release name %s IP %s\n",
+      ZERODEBUG(0,("release_name: Failed to send packet trying to release name %s IP %s\n",
             nmb_namestr(&namerec->name), inet_ntoa(namerec->data.ip[i]) ));
       return True;
     }
diff -Naur samba-2.2.12-orig/source/nmbd/nmbd_nodestatus.c samba-2.2.12/source/nmbd/nmbd_nodestatus.c
--- samba-2.2.12-orig/source/nmbd/nmbd_nodestatus.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/nmbd/nmbd_nodestatus.c	2009-03-11 09:59:34.000000000 +0100
@@ -39,7 +39,7 @@
 
   if(!nmb_name_equal(question_name, answer_name))
   {
-    DEBUG(0,("node_status_response: Answer name %s differs from question \
+    ZERODEBUG(0,("node_status_response: Answer name %s differs from question \
 name %s.\n", nmb_namestr(answer_name), nmb_namestr(question_name)));
     return;
   }
@@ -87,7 +87,7 @@
               node_status_response, node_status_timeout_response,
               success_fn, fail_fn, userdata, nmbname, send_ip)==NULL)
   {
-    DEBUG(0,("node_status: Failed to send packet trying to get node status for \
+    ZERODEBUG(0,("node_status: Failed to send packet trying to get node status for \
 name %s, IP address %s\n", nmb_namestr(nmbname), inet_ntoa(send_ip)));
     return True;
   } 
diff -Naur samba-2.2.12-orig/source/nmbd/nmbd_packets.c samba-2.2.12/source/nmbd/nmbd_packets.c
--- samba-2.2.12-orig/source/nmbd/nmbd_packets.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/nmbd/nmbd_packets.c	2009-03-11 09:59:34.000000000 +0100
@@ -168,7 +168,7 @@
   }
   else if (!send_packet(p))
   {
-    DEBUG(0,("send_netbios_packet: send_packet() to IP %s port %d failed\n",
+    ZERODEBUG(0,("send_netbios_packet: send_packet() to IP %s port %d failed\n",
                          inet_ntoa(p->ip),p->port));
     return False;
   }
@@ -195,7 +195,7 @@
   /* Allocate the packet_struct we will return. */
   if((packet = (struct packet_struct *)malloc(sizeof(*packet))) == NULL)
   {
-    DEBUG(0,("create_and_init_netbios_packet: malloc fail (1) for packet struct.\n"));
+    ZERODEBUG(0,("create_and_init_netbios_packet: malloc fail (1) for packet struct.\n"));
     return NULL;
   }
     
@@ -242,7 +242,7 @@
 
   if((nmb->additional = (struct res_rec *)malloc(sizeof(struct res_rec))) == NULL)
   {
-    DEBUG(0,("initiate_name_register_packet: malloc fail for additional record.\n"));
+    ZERODEBUG(0,("initiate_name_register_packet: malloc fail for additional record.\n"));
     return False;
   }
 
@@ -455,7 +455,7 @@
 {
   if( subrec == remote_broadcast_subnet)
   {
-    DEBUG(0,("assert_check_subnet: Attempt to send packet on remote broadcast subnet. \
+    ZERODEBUG(0,("assert_check_subnet: Attempt to send packet on remote broadcast subnet. \
 This is a bug.\n"));
     return True;
   }
@@ -532,7 +532,7 @@
   /* Sanity check. */
   if(subrec != unicast_subnet)
   {
-    DEBUG(0,("queue_register_multihomed_name: should only be done on \
+    ZERODEBUG(0,("queue_register_multihomed_name: should only be done on \
 unicast subnet. subnet is %s\n.", subrec->subnet_name ));
     return NULL;
   }
@@ -707,7 +707,7 @@
       struct in_addr *ifip = iface_n_ip(i);
 
       if(ifip == NULL) {
-        DEBUG(0,("queue_query_name: interface %d has NULL IP address !\n", i));
+        ZERODEBUG(0,("queue_query_name: interface %d has NULL IP address !\n", i));
         continue;
       }
 
@@ -804,7 +804,7 @@
   /* Sanity check. */
   if(subrec != unicast_subnet)
   {
-    DEBUG(0,("queue_register_multihomed_name: should only be done on \
+    ZERODEBUG(0,("queue_register_multihomed_name: should only be done on \
 unicast subnet. subnet is %s\n.", subrec->subnet_name ));
     return NULL;
   }
@@ -923,7 +923,7 @@
 
     default:
     {
-      DEBUG(0,("reply_netbios_packet: Unknown packet type: %s %s to ip %s\n",
+      ZERODEBUG(0,("reply_netbios_packet: Unknown packet type: %s %s to ip %s\n",
 	            packet_type, nmb_namestr(&orig_nmb->question.question_name),
                     inet_ntoa(packet.ip)));
 
@@ -983,7 +983,7 @@
   }
   else if (!send_packet(&packet)) 
   {
-    DEBUG(0,("reply_netbios_packet: send_packet to IP %s port %d failed\n",
+    ZERODEBUG(0,("reply_netbios_packet: send_packet to IP %s port %d failed\n",
                  inet_ntoa(packet.ip),packet.port));
   }
 }
@@ -1059,7 +1059,7 @@
 
   if (is_myname(dgram->source_name.name))
   {
-    DEBUG(0,("process_browse_packet: Discarding datagram from IP %s. Source name \
+    ZERODEBUG(0,("process_browse_packet: Discarding datagram from IP %s. Source name \
 %s is one of our names !\n", inet_ntoa(p->ip), nmb_namestr(&dgram->source_name)));
     return;
   }
@@ -1107,7 +1107,7 @@
       debug_browse_data(buf, len);
       /* We never send ANN_GetBackupListReq so we
          should never get these. */
-      DEBUG(0,("process_browse_packet: Discarding GetBackupListResponse \
+      ZERODEBUG(0,("process_browse_packet: Discarding GetBackupListResponse \
 packet from %s IP %s\n", nmb_namestr(&dgram->source_name), inet_ntoa(p->ip)));
       break;
     }
@@ -1142,7 +1142,7 @@
     default:
     {
       debug_browse_data(buf, len);
-      DEBUG(0,("process_browse_packet: On subnet %s ignoring browse packet \
+      ZERODEBUG(0,("process_browse_packet: On subnet %s ignoring browse packet \
 command code %d from %s IP %s to %s\n", 
             subrec->subnet_name, command, nmb_namestr(&dgram->source_name),
             inet_ntoa(p->ip), nmb_namestr(&dgram->dest_name)));
@@ -1172,7 +1172,7 @@
 
   if (is_myname(dgram->source_name.name))
   {
-    DEBUG(0,("process_lanman_packet: Discarding datagram from IP %s. Source name \
+    ZERODEBUG(0,("process_lanman_packet: Discarding datagram from IP %s. Source name \
 %s is one of our names !\n", inet_ntoa(p->ip), nmb_namestr(&dgram->source_name)));
     return;
   }
@@ -1192,7 +1192,7 @@
     }
     default:
     {
-      DEBUG(0,("process_lanman_packet: On subnet %s ignoring browse packet \
+      ZERODEBUG(0,("process_lanman_packet: On subnet %s ignoring browse packet \
 command code %d from %s IP %s to %s\n",
             subrec->subnet_name, command, nmb_namestr(&dgram->source_name),
             inet_ntoa(p->ip), nmb_namestr(&dgram->dest_name)));
@@ -1323,7 +1323,7 @@
     case NMB_NAME_REFRESH_OPCODE_9: /* WinNT uses 8 by default. */
       if (nmb->header.ancount == 0)
       {
-        DEBUG(0,("validate_nmb_response_packet: Bad REG/REFRESH Packet. "));
+        ZERODEBUG(0,("validate_nmb_response_packet: Bad REG/REFRESH Packet. "));
         ignore = True;
       }
       break;
@@ -1331,14 +1331,14 @@
     case NMB_NAME_QUERY_OPCODE:
       if ((nmb->header.ancount != 0) && (nmb->header.ancount != 1))
       {
-        DEBUG(0,("validate_nmb_response_packet: Bad QUERY Packet. "));
+        ZERODEBUG(0,("validate_nmb_response_packet: Bad QUERY Packet. "));
         ignore = True;
       }
       break;
     case NMB_NAME_RELEASE_OPCODE:
       if (nmb->header.ancount == 0)
       {
-        DEBUG(0,("validate_nmb_response_packet: Bad RELEASE Packet. "));
+        ZERODEBUG(0,("validate_nmb_response_packet: Bad RELEASE Packet. "));
         ignore = True;
       }
       break;
@@ -1346,18 +1346,18 @@
       /* Check WACK response here. */
       if (nmb->header.ancount != 1)
       {
-        DEBUG(0,("validate_nmb_response_packet: Bad WACK Packet. "));
+        ZERODEBUG(0,("validate_nmb_response_packet: Bad WACK Packet. "));
         ignore = True;
       }
       break;
     default:
-      DEBUG(0,("validate_nmb_response_packet: Ignoring packet with unknown opcode %d.\n",
+      ZERODEBUG(0,("validate_nmb_response_packet: Ignoring packet with unknown opcode %d.\n",
         nmb->header.opcode));
       return True;
   }
 
   if(ignore)
-    DEBUG(0,("Ignoring response packet with opcode %d.\n", nmb->header.opcode));
+    ZERODEBUG(0,("Ignoring response packet with opcode %d.\n", nmb->header.opcode));
 
   return ignore;
 }
@@ -1378,7 +1378,7 @@
     case NMB_NAME_MULTIHOMED_REG_OPCODE:
       if (nmb->header.qdcount==0 || nmb->header.arcount==0)
       {
-        DEBUG(0,("validate_nmb_packet: Bad REG/REFRESH Packet. "));
+        ZERODEBUG(0,("validate_nmb_packet: Bad REG/REFRESH Packet. "));
         ignore = True;
       }
       break;
@@ -1388,7 +1388,7 @@
          ((nmb->question.question_type != QUESTION_TYPE_NB_QUERY) &&
          (nmb->question.question_type != QUESTION_TYPE_NB_STATUS)))
       {
-        DEBUG(0,("validate_nmb_packet: Bad QUERY Packet. "));
+        ZERODEBUG(0,("validate_nmb_packet: Bad QUERY Packet. "));
         ignore = True;
       }
       break;
@@ -1396,18 +1396,18 @@
     case NMB_NAME_RELEASE_OPCODE:
       if (nmb->header.qdcount==0 || nmb->header.arcount==0)
       {
-        DEBUG(0,("validate_nmb_packet: Bad RELEASE Packet. "));
+        ZERODEBUG(0,("validate_nmb_packet: Bad RELEASE Packet. "));
         ignore = True;
       }
       break;
     default:
-      DEBUG(0,("validate_nmb_packet: Ignoring packet with unknown opcode %d.\n",
+      ZERODEBUG(0,("validate_nmb_packet: Ignoring packet with unknown opcode %d.\n",
         nmb->header.opcode));
       return True;
   }
 
   if(ignore)
-    DEBUG(0,("validate_nmb_packet: Ignoring request packet with opcode %d.\n", nmb->header.opcode));
+    ZERODEBUG(0,("validate_nmb_packet: Ignoring request packet with opcode %d.\n", nmb->header.opcode));
 
   return ignore;
 }
@@ -1441,7 +1441,7 @@
 
     if(subrec == NULL)
     {
-      DEBUG(0,("find_subnet_for_nmb_packet: subnet record not found for response id %hu\n",
+      ZERODEBUG(0,("find_subnet_for_nmb_packet: subnet record not found for response id %hu\n",
                nmb->header.name_trn_id));
       return NULL;
     }
@@ -1514,7 +1514,7 @@
         wins_process_multihomed_name_registration_request(subrec, p);
       else
       {
-        DEBUG(0,("process_nmb_request: Multihomed registration request must be \
+        ZERODEBUG(0,("process_nmb_request: Multihomed registration request must be \
 directed at a WINS server.\n"));
       }
       break;
@@ -1534,7 +1534,7 @@
         {
           if(subrec == wins_server_subnet)
           {
-            DEBUG(0,("process_nmb_request: NB_STATUS request directed at WINS server is \
+            ZERODEBUG(0,("process_nmb_request: NB_STATUS request directed at WINS server is \
 not allowed.\n"));
             break;
           }
@@ -1575,7 +1575,7 @@
 
   if(rrec == NULL)
   {
-    DEBUG(0,("process_nmb_response: response packet received but no response record \
+    ZERODEBUG(0,("process_nmb_response: response packet received but no response record \
 found for id = %hu. Ignoring packet.\n", nmb->header.name_trn_id));
     return;
   }
@@ -1650,7 +1650,7 @@
           /* Resend while we have a non-zero repeat_count. */
           if(!send_packet(rrec->packet))
           {
-            DEBUG(0,("retransmit_or_expire_response_records: Failed to resend packet id %hu \
+            ZERODEBUG(0,("retransmit_or_expire_response_records: Failed to resend packet id %hu \
 to IP %s on subnet %s\n", rrec->response_id, inet_ntoa(rrec->packet->ip), 
                           subrec->subnet_name));
           }
@@ -1709,7 +1709,7 @@
 
   if(pset == NULL)
   {
-    DEBUG(0,("create_listen_fdset: malloc fail !\n"));
+    ZERODEBUG(0,("create_listen_fdset: malloc fail !\n"));
     return True;
   }
 
@@ -1719,14 +1719,14 @@
 
   if((count*2) + 2 > FD_SETSIZE)
   {
-    DEBUG(0,("create_listen_fdset: Too many file descriptors needed (%d). We can \
+    ZERODEBUG(0,("create_listen_fdset: Too many file descriptors needed (%d). We can \
 only use %d.\n", (count*2) + 2, FD_SETSIZE));
     return True;
   }
 
   if((sock_array = (int *)malloc(((count*2) + 2)*sizeof(int))) == NULL)
   {
-    DEBUG(0,("create_listen_fdset: malloc fail for socket array.\n"));
+    ZERODEBUG(0,("create_listen_fdset: malloc fail for socket array.\n"));
     return True;
   }
 
@@ -1788,7 +1788,7 @@
   {
     if(create_listen_fdset(&listen_set, &sock_array, &listen_number))
     {
-      DEBUG(0,("listen_for_packets: Fatal error. unable to create listen set. Exiting.\n"));
+      ZERODEBUG(0,("listen_for_packets: Fatal error. unable to create listen set. Exiting.\n"));
       return True;
     }
     rescan_listen_set = False;
diff -Naur samba-2.2.12-orig/source/nmbd/nmbd_responserecordsdb.c samba-2.2.12/source/nmbd/nmbd_responserecordsdb.c
--- samba-2.2.12-orig/source/nmbd/nmbd_responserecordsdb.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/nmbd/nmbd_responserecordsdb.c	2009-03-11 09:59:34.000000000 +0100
@@ -110,7 +110,7 @@
 
   if (!(rrec = (struct response_record *)malloc(sizeof(*rrec)))) 
   {
-    DEBUG(0,("make_response_queue_record: malloc fail for response_record.\n"));
+    ZERODEBUG(0,("make_response_queue_record: malloc fail for response_record.\n"));
     return NULL;
   }
 
@@ -132,7 +132,7 @@
     {
       if((rrec->userdata = (*userdata->copy_fn)(userdata)) == NULL)
       {
-        DEBUG(0,("make_response_queue_record: copy fail for userdata.\n"));
+        ZERODEBUG(0,("make_response_queue_record: copy fail for userdata.\n"));
 	ZERO_STRUCTP(rrec);
         SAFE_FREE(rrec);
         return NULL;
@@ -144,7 +144,7 @@
       if((rrec->userdata = (struct userdata_struct *)
            malloc(sizeof(struct userdata_struct)+userdata->userdata_len)) == NULL)
       {
-        DEBUG(0,("make_response_queue_record: malloc fail for userdata.\n"));
+        ZERODEBUG(0,("make_response_queue_record: malloc fail for userdata.\n"));
 	ZERO_STRUCTP(rrec);
         SAFE_FREE(rrec);
         return NULL;
@@ -219,7 +219,7 @@
      Sanity check to ensure this is so. */
   if(remote_broadcast_subnet->responselist != NULL)
   {
-    DEBUG(0,("find_response_record: response record found on subnet %s. This should \
+    ZERODEBUG(0,("find_response_record: response record found on subnet %s. This should \
 never happen !\n", remote_broadcast_subnet->subnet_name));
   }
 
@@ -231,7 +231,7 @@
       return rrec;
   }
 
-  DEBUG(0,("find_response_record: response packet id %hu received with no \
+  ZERODEBUG(0,("find_response_record: response packet id %hu received with no \
 matching record.\n", id));
  
   *ppsubrec = NULL;
diff -Naur samba-2.2.12-orig/source/nmbd/nmbd_sendannounce.c samba-2.2.12/source/nmbd/nmbd_sendannounce.c
--- samba-2.2.12-orig/source/nmbd/nmbd_sendannounce.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/nmbd/nmbd_sendannounce.c	2009-03-11 09:59:34.000000000 +0100
@@ -576,7 +576,7 @@
 
   if((work = find_workgroup_on_subnet(FIRST_SUBNET, global_myworkgroup)) == NULL)
   {   
-    DEBUG(0,("browse_sync_remote: Cannot find workgroup %s on subnet %s\n",
+    ZERODEBUG(0,("browse_sync_remote: Cannot find workgroup %s on subnet %s\n",
            global_myworkgroup, FIRST_SUBNET->subnet_name ));
     return;
   }   
diff -Naur samba-2.2.12-orig/source/nmbd/nmbd_serverlistdb.c samba-2.2.12/source/nmbd/nmbd_serverlistdb.c
--- samba-2.2.12-orig/source/nmbd/nmbd_serverlistdb.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/nmbd/nmbd_serverlistdb.c	2009-03-11 09:59:34.000000000 +0100
@@ -143,14 +143,14 @@
   
   if((servrec = find_server_in_workgroup(work, name)) != NULL)
   {
-    DEBUG(0,("create_server_on_workgroup: Server %s already exists on \
+    ZERODEBUG(0,("create_server_on_workgroup: Server %s already exists on \
 workgroup %s. This is a bug.\n", name, work->work_group));
     return NULL;
   }
   
   if((servrec = (struct server_record *)malloc(sizeof(*servrec))) == NULL)
   {
-    DEBUG(0,("create_server_entry_on_workgroup: malloc fail !\n"));
+    ZERODEBUG(0,("create_server_entry_on_workgroup: malloc fail !\n"));
     return NULL;
   }
 
@@ -359,7 +359,7 @@
  
   if (!fp)
   {
-    DEBUG(0,("write_browse_list: Can't open file %s. Error was %s\n",
+    ZERODEBUG(0,("write_browse_list: Can't open file %s. Error was %s\n",
               fnamenew,strerror(errno)));
     return;
   } 
@@ -371,7 +371,7 @@
 
   if((work = find_workgroup_on_subnet(FIRST_SUBNET, global_myworkgroup)) == NULL)
   { 
-    DEBUG(0,("write_browse_list: Fatal error - cannot find my workgroup %s\n",
+    ZERODEBUG(0,("write_browse_list: Fatal error - cannot find my workgroup %s\n",
              global_myworkgroup));
     fclose(fp);
     return;
diff -Naur samba-2.2.12-orig/source/nmbd/nmbd_subnetdb.c samba-2.2.12/source/nmbd/nmbd_subnetdb.c
--- samba-2.2.12-orig/source/nmbd/nmbd_subnetdb.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/nmbd/nmbd_subnetdb.c	2009-03-11 13:35:07.000000000 +0100
@@ -136,7 +136,7 @@
 
     if((nmb_sock = open_socket_in(SOCK_DGRAM, global_nmb_port,0, myip.s_addr,True)) == -1)
     {
-      if( DEBUGLVL( 0 ) )
+      if( ZERODEBUGLVL( 0 ) )
       {
         Debug1( "nmbd_subnetdb:make_subnet()\n" );
         Debug1( "  Failed to open nmb socket on interface %s ", inet_ntoa(myip) );
@@ -148,7 +148,7 @@
 
     if((dgram_sock = open_socket_in(SOCK_DGRAM,DGRAM_PORT,3, myip.s_addr,True)) == -1)
     {
-      if( DEBUGLVL( 0 ) )
+      if( ZERODEBUGLVL( 0 ) )
       {
         Debug1( "nmbd_subnetdb:make_subnet()\n" );
         Debug1( "  Failed to open dgram socket on interface %s ", inet_ntoa(myip) );
@@ -168,7 +168,7 @@
   
   if (!subrec) 
   {
-    DEBUG(0,("make_subnet: malloc fail !\n"));
+    ZERODEBUG(0,("make_subnet: malloc fail !\n"));
     close(nmb_sock);
     close(dgram_sock);
     return(NULL);
@@ -181,7 +181,7 @@
 
   if((subrec->subnet_name = strdup(name)) == NULL)
   {
-    DEBUG(0,("make_subnet: malloc fail for subnet name !\n"));
+    ZERODEBUG(0,("make_subnet: malloc fail for subnet name !\n"));
     close(nmb_sock);
     close(dgram_sock);
     ZERO_STRUCTP(subrec);
@@ -236,7 +236,7 @@
 
   if(num_interfaces == 0)
   {
-    DEBUG(0,("create_subnets: No local interfaces !\n"));
+    ZERODEBUG(0,("create_subnets: No local interfaces !\n"));
     return False;
   }
 
@@ -288,7 +288,7 @@
       /* wins_srv_ip() can return a zero IP if all servers are
        * either down or incorrectly entered in smb.conf.  crh
        */
-      DEBUG(0,("No 'live' WINS servers found.  Check 'wins server' parameter.\n"));
+      ZERODEBUG(0,("No 'live' WINS servers found.  Check 'wins server' parameter.\n"));
       return False;
     }
   } 
diff -Naur samba-2.2.12-orig/source/nmbd/nmbd_winsproxy.c samba-2.2.12/source/nmbd/nmbd_winsproxy.c
--- samba-2.2.12-orig/source/nmbd/nmbd_winsproxy.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/nmbd/nmbd_winsproxy.c	2009-03-11 09:59:34.000000000 +0100
@@ -52,7 +52,7 @@
   num_ips = rrec->rdlength / 6;
   if(num_ips == 0)
   {
-    DEBUG(0,("wins_proxy_name_query_request_success: Invalid number of IP records (0) \
+    ZERODEBUG(0,("wins_proxy_name_query_request_success: Invalid number of IP records (0) \
 returned for name %s.\n", nmb_namestr(nmbname) ));
     return;
   }
@@ -63,7 +63,7 @@
   {
     if((iplist = (struct in_addr *)malloc( num_ips * sizeof(struct in_addr) )) == NULL)
     {
-      DEBUG(0,("wins_proxy_name_query_request_success: malloc fail !\n"));
+      ZERODEBUG(0,("wins_proxy_name_query_request_success: malloc fail !\n"));
       return;
     }
 
diff -Naur samba-2.2.12-orig/source/nmbd/nmbd_winsserver.c samba-2.2.12/source/nmbd/nmbd_winsserver.c
--- samba-2.2.12-orig/source/nmbd/nmbd_winsserver.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/nmbd/nmbd_winsserver.c	2009-03-11 09:59:34.000000000 +0100
@@ -215,7 +215,7 @@
 	    if (sscanf(line,"VERSION %d %u", &version, &hash) != 2 ||
 		version != WINS_VERSION ||
 		hash != wins_hash()) {
-		    DEBUG(0,("Discarding invalid wins.dat file [%s]\n",line));
+		    ZERODEBUG(0,("Discarding invalid wins.dat file [%s]\n",line));
 		    fclose(fp);
 		    return True;
 	    }
@@ -233,13 +233,13 @@
 
     if (!next_token(&ptr,name_str,NULL,sizeof(name_str))) 
     {
-      DEBUG(0,("initialise_wins: Failed to parse name when parsing line %s\n", line ));
+      ZERODEBUG(0,("initialise_wins: Failed to parse name when parsing line %s\n", line ));
       continue;
     }
 
     if (!next_token(&ptr,ttl_str,NULL,sizeof(ttl_str)))
     {
-      DEBUG(0,("initialise_wins: Failed to parse time to live when parsing line %s\n", line ));
+      ZERODEBUG(0,("initialise_wins: Failed to parse time to live when parsing line %s\n", line ));
       continue;
     }
 
@@ -261,20 +261,20 @@
 
     if(num_ips == 0)
     {
-      DEBUG(0,("initialise_wins: Missing IP address when parsing line %s\n", line ));
+      ZERODEBUG(0,("initialise_wins: Missing IP address when parsing line %s\n", line ));
       continue;
     }
 
     if(!got_token)
     {
-      DEBUG(0,("initialise_wins: Missing nb_flags when parsing line %s\n", line ));
+      ZERODEBUG(0,("initialise_wins: Missing nb_flags when parsing line %s\n", line ));
       continue;
     }
 
     /* Allocate the space for the ip_list. */
     if((ip_list = (struct in_addr *)malloc( num_ips * sizeof(struct in_addr))) == NULL)
     {
-      DEBUG(0,("initialise_wins: Malloc fail !\n"));
+      ZERODEBUG(0,("initialise_wins: Malloc fail !\n"));
       return False;
     }
  
@@ -421,7 +421,7 @@
      * server. Log an error here.
      */
 
-    DEBUG(0,("wins_process_name_refresh_request: broadcast name refresh request \
+    ZERODEBUG(0,("wins_process_name_refresh_request: broadcast name refresh request \
 received for name %s from IP %s on subnet %s. Error - should not be sent to WINS server\n",
           nmb_namestr(question), inet_ntoa(from_ip), subrec->subnet_name));
     return;
@@ -670,7 +670,7 @@
      * server. Log an error here.
      */
 
-    DEBUG(0,("wins_process_name_registration_request: broadcast name registration request \
+    ZERODEBUG(0,("wins_process_name_registration_request: broadcast name registration request \
 received for name %s from IP %s on subnet %s. Error - should not be sent to WINS server\n",
           nmb_namestr(question), inet_ntoa(from_ip), subrec->subnet_name));
     return;
@@ -1003,7 +1003,7 @@
      * server. Log an error here.
      */
 
-    DEBUG(0,("wins_process_multihomed_name_registration_request: broadcast name registration request \
+    ZERODEBUG(0,("wins_process_multihomed_name_registration_request: broadcast name registration request \
 received for name %s from IP %s on subnet %s. Error - should not be sent to WINS server\n",
           nmb_namestr(question), inet_ntoa(from_ip), subrec->subnet_name));
     return;
@@ -1015,7 +1015,7 @@
 
   if(group)
   {
-    DEBUG(0,("wins_process_multihomed_name_registration_request: group name registration request \
+    ZERODEBUG(0,("wins_process_multihomed_name_registration_request: group name registration request \
 received for name %s from IP %s on subnet %s. Errror - group names should not be multihomed.\n",
           nmb_namestr(question), inet_ntoa(from_ip), subrec->subnet_name));
     return;
@@ -1239,7 +1239,7 @@
 
   if((prdata = (char *)malloc( num_ips * 6 )) == NULL)
   {
-    DEBUG(0,("process_wins_dmb_query_request: Malloc fail !.\n"));
+    ZERODEBUG(0,("process_wins_dmb_query_request: Malloc fail !.\n"));
     return;
   }
 
@@ -1311,7 +1311,7 @@
     {
       if((prdata = (char *)malloc( namerec->data.num_ips * 6 )) == NULL)
       {
-        DEBUG(0,("send_wins_name_query_response: malloc fail !\n"));
+        ZERODEBUG(0,("send_wins_name_query_response: malloc fail !\n"));
         return;
       }
     }
@@ -1469,7 +1469,7 @@
      * server. Log an error here.
      */
 
-    DEBUG(0,("wins_process_name_release_request: broadcast name registration request \
+    ZERODEBUG(0,("wins_process_name_release_request: broadcast name registration request \
 received for name %s from IP %s on subnet %s. Error - should not be sent to WINS server\n",
           nmb_namestr(question), inet_ntoa(from_ip), subrec->subnet_name));
     return;
@@ -1600,7 +1600,7 @@
 
   if((fp = sys_fopen(fnamenew,"w")) == NULL)
   {
-    DEBUG(0,("wins_write_database: Can't open %s. Error was %s\n", fnamenew, strerror(errno)));
+    ZERODEBUG(0,("wins_write_database: Can't open %s. Error was %s\n", fnamenew, strerror(errno)));
     if (background) {
 	    _exit(0);
     }
diff -Naur samba-2.2.12-orig/source/nmbd/nmbd_workgroupdb.c samba-2.2.12/source/nmbd/nmbd_workgroupdb.c
--- samba-2.2.12-orig/source/nmbd/nmbd_workgroupdb.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/nmbd/nmbd_workgroupdb.c	2009-03-11 13:48:39.000000000 +0100
@@ -57,7 +57,7 @@
   
   if((work = (struct work_record *)malloc(sizeof(*work))) == NULL)
   {
-    DEBUG(0,("create_workgroup: malloc fail !\n"));
+    ZERODEBUG(0,("create_workgroup: malloc fail !\n"));
     return NULL;
   }
   memset((char *)work, '\0', sizeof(*work));
@@ -215,7 +215,7 @@
 static void fail_register(struct subnet_record *subrec, struct response_record *rrec,
                           struct nmb_name *nmbname)
 {  
-  DEBUG(0,("fail_register: Failed to register name %s on subnet %s.\n",
+  ZERODEBUG(0,("fail_register: Failed to register name %s on subnet %s.\n",
             nmb_namestr(nmbname), subrec->subnet_name));
 }  
 
@@ -278,7 +278,7 @@
 void dump_workgroups(BOOL force_write)
 {
   struct subnet_record *subrec;
-  int debuglevel = force_write ? 0 : 4;
+  int debuglevel = 0;
  
   for (subrec = FIRST_SUBNET; subrec; subrec = NEXT_SUBNET_INCLUDING_UNICAST(subrec))
   {
diff -Naur samba-2.2.12-orig/source/nsswitch/winbindd.c samba-2.2.12/source/nsswitch/winbindd.c
--- samba-2.2.12-orig/source/nsswitch/winbindd.c	2004-08-12 20:24:23.000000000 +0200
+++ samba-2.2.12/source/nsswitch/winbindd.c	2009-03-11 13:51:50.000000000 +0100
@@ -104,7 +104,7 @@
 #endif
 #endif
  
-	DEBUG(0,("Dumping core in %s\n",dname));
+	ZERODEBUG(0,("Dumping core in %s\n",dname));
 	abort();
 	return( True );
 } /* dump_core */
@@ -125,11 +125,11 @@
 {
 	struct winbindd_cli_state *tmp;
 
-	DEBUG(0, ("winbindd status:\n"));
+	ZERODEBUG(0, ("winbindd status:\n"));
 
 	/* Print client state information */
 	
-	DEBUG(0, ("\t%d clients currently active\n", num_clients));
+	ZERODEBUG(0, ("\t%d clients currently active\n", num_clients));
 	
 	if (DEBUGLEVEL >= 2 && num_clients) {
 		DEBUG(2, ("\tclient list:\n"));
@@ -635,7 +635,7 @@
 					DEBUG(5,("winbindd: Exceeding %d client connections, removing idle connection.\n",
 						WINBINDD_MAX_SIMULTANEOUS_CLIENTS));
 					if (!remove_idle_client()) {
-						DEBUG(0,("winbindd: Exceeding %d client connections, no idle connection found\n",
+						ZERODEBUG(0,("winbindd: Exceeding %d client connections, no idle connection found\n",
 							 WINBINDD_MAX_SIMULTANEOUS_CLIENTS));
 						break;
 					}
@@ -665,7 +665,7 @@
 
 					if (state->read_buf_len >= sizeof(uint32)
 					    && *(uint32 *) &state->request != sizeof(state->request)) {
-						DEBUG(0,("process_loop: Invalid request size (%d) sent, should be (%d)\n",
+						ZERODEBUG(0,("process_loop: Invalid request size (%d) sent, should be (%d)\n",
 								*(uint32 *) &state->request, sizeof(state->request)));
 
 						remove_client(state);
@@ -768,7 +768,7 @@
 
 	/* Initialise samba/rpc client stuff */
 
-	while ((opt = getopt(argc, argv, "id:s:nh")) != EOF) {
+	while ((opt = getopt(argc, argv, "is:nh")) != EOF) {
 		switch (opt) {
 
 			/* Don't become a daemon */
@@ -783,7 +783,7 @@
 
 			/* Run with specified debug level */
 		case 'd':
-			DEBUGLEVEL = atoi(optarg);
+			DEBUGLEVEL = 0;
 			AllowDebugChange = False;
 			break;
 
@@ -820,7 +820,7 @@
 	DEBUGADD( 1, ( "Copyright The Samba Team 2000-2001\n" ) );
 
 	if (!reload_services_file(False)) {
-		DEBUG(0, ("error opening config file\n"));
+		ZERODEBUG(0, ("error opening config file\n"));
 		exit(1);
 	}
 
@@ -858,7 +858,7 @@
 
 	if (!secrets_init()) {
 
-		DEBUG(0,("Could not initialize domain trust account secrets. Giving up\n"));
+		ZERODEBUG(0,("Could not initialize domain trust account secrets. Giving up\n"));
 		return 1;
 
 	}
@@ -907,14 +907,14 @@
 	/* Initialise messaging system */
 
 	if (!message_init()) {
-		DEBUG(0, ("unable to initialise messaging system\n"));
+		ZERODEBUG(0, ("unable to initialise messaging system\n"));
 		exit(1);
 	}
 
 	/* Create UNIX domain socket */
 	
 	if ((accept_sock = create_sock()) == -1) {
-		DEBUG(0, ("failed to create socket\n"));
+		ZERODEBUG(0, ("failed to create socket\n"));
 		return 1;
 	}
 
diff -Naur samba-2.2.12-orig/source/nsswitch/winbindd_cache.c samba-2.2.12/source/nsswitch/winbindd_cache.c
--- samba-2.2.12-orig/source/nsswitch/winbindd_cache.c	2004-08-12 20:24:23.000000000 +0200
+++ samba-2.2.12/source/nsswitch/winbindd_cache.c	2009-03-11 09:59:34.000000000 +0100
@@ -54,7 +54,7 @@
 				   TDB_DEFAULT, O_RDWR | O_CREAT | O_TRUNC, 0600);
 
 	if (!wcache->tdb) {
-		DEBUG(0,("Failed to open winbindd_cache.tdb!\n"));
+		ZERODEBUG(0,("Failed to open winbindd_cache.tdb!\n"));
 	}
 }
 
@@ -70,12 +70,12 @@
 		return;
 
 	if (wcache == NULL || wcache->tdb == NULL) {
-		DEBUG(0, ("Unable to check size of tdb cache - cache not open !\n"));
+		ZERODEBUG(0, ("Unable to check size of tdb cache - cache not open !\n"));
 		return;
 	}
 
 	if (fstat(wcache->tdb->fd, &st) == -1) {
-		DEBUG(0, ("Unable to check size of tdb cache %s!\n", strerror(errno) ));
+		ZERODEBUG(0, ("Unable to check size of tdb cache %s!\n", strerror(errno) ));
 		return;
 	}
 
@@ -133,7 +133,7 @@
 {
 	uint32 ret;
 	if (centry->len - centry->ofs < 4) {
-		DEBUG(0,("centry corruption? needed 4 bytes, have %d\n", 
+		ZERODEBUG(0,("centry corruption? needed 4 bytes, have %d\n", 
 			 centry->len - centry->ofs));
 		smb_panic("centry_uint32");
 	}
@@ -149,7 +149,7 @@
 {
 	uint8 ret;
 	if (centry->len - centry->ofs < 1) {
-		DEBUG(0,("centry corruption? needed 1 bytes, have %d\n", 
+		ZERODEBUG(0,("centry corruption? needed 1 bytes, have %d\n", 
 			 centry->len - centry->ofs));
 		smb_panic("centry_uint32");
 	}
@@ -174,7 +174,7 @@
 	}
 
 	if (centry->len - centry->ofs < len) {
-		DEBUG(0,("centry corruption? needed %d bytes, have %d\n", 
+		ZERODEBUG(0,("centry corruption? needed %d bytes, have %d\n", 
 			 len, centry->len - centry->ofs));
 		smb_panic("centry_string");
 	}
@@ -324,7 +324,7 @@
 	centry->len *= 2;
 	p = realloc(centry->data, centry->len);
 	if (!p) {
-		DEBUG(0,("out of memory: needed %d bytes in centry_expand\n", centry->len));
+		ZERODEBUG(0,("out of memory: needed %d bytes in centry_expand\n", centry->len));
 		smb_panic("out of memory in centry_expand");
 	}
 	centry->data = p;
diff -Naur samba-2.2.12-orig/source/nsswitch/winbindd_cm.c samba-2.2.12/source/nsswitch/winbindd_cm.c
--- samba-2.2.12-orig/source/nsswitch/winbindd_cm.c	2004-08-12 20:24:23.000000000 +0200
+++ samba-2.2.12/source/nsswitch/winbindd_cm.c	2009-03-11 09:59:34.000000000 +0100
@@ -237,7 +237,7 @@
 
 	if (!(fcc = (struct failed_connection_cache *)
 	      malloc(sizeof(struct failed_connection_cache)))) {
-		DEBUG(0, ("malloc failed in add_failed_connection_entry!\n"));
+		ZERODEBUG(0, ("malloc failed in add_failed_connection_entry!\n"));
 		return;
 	}
 	
@@ -349,14 +349,14 @@
 	}
 
 	if (!conn->cli) {
-		DEBUG(0, ("Connection to %s for domain %s (pipe %s) has NULL conn->cli!\n", 
+		ZERODEBUG(0, ("Connection to %s for domain %s (pipe %s) has NULL conn->cli!\n", 
 			  conn->controller, conn->domain, conn->pipe_name));
 		smb_panic("connection_ok: conn->cli was null!");
 		return False;
 	}
 
 	if (!conn->cli->initialised) {
-		DEBUG(0, ("Connection to %s for domain %s (pipe %s) was never initialised!\n", 
+		ZERODEBUG(0, ("Connection to %s for domain %s (pipe %s) was never initialised!\n", 
 			  conn->controller, conn->domain, conn->pipe_name));
 		smb_panic("connection_ok: conn->cli->initialised is False!");
 		return False;
@@ -637,7 +637,7 @@
 	}
 	
 	if (!basic_conn) {
-		DEBUG(0, ("No domain sam handle was created!\n"));
+		ZERODEBUG(0, ("No domain sam handle was created!\n"));
 		return NULL;
 	}
 
@@ -714,7 +714,7 @@
 	}
 	
 	if (!basic_conn) {
-		DEBUG(0, ("No domain sam handle was created!\n"));
+		ZERODEBUG(0, ("No domain sam handle was created!\n"));
 		return NULL;
 	}
 
@@ -775,7 +775,7 @@
 					SEC_CHAN_WKSTA : SEC_CHAN_BDC, trust_passwd);
 
 	if (!NT_STATUS_IS_OK(result)) {
-		DEBUG(0, ("error connecting to domain password server: %s\n",
+		ZERODEBUG(0, ("error connecting to domain password server: %s\n",
 			  nt_errstr(result)));
 		
 		/* Hit the cache code again.  This cleans out the old connection and gets a new one */
@@ -808,7 +808,7 @@
 {
 	struct winbindd_cm_conn *con;
 
-	DEBUG(0, ("\tDomain	     Controller	     Pipe\n"));
+	ZERODEBUG(0, ("\tDomain	     Controller	     Pipe\n"));
 
 	for(con = cm_conns; con; con = con->next) {
 		char *msg;
@@ -816,9 +816,9 @@
 		/* Display pipe info */
 		
 		if (asprintf(&msg, "\t%-15s %-15s %-16s", con->domain, con->controller, con->pipe_name) < 0) {
-			DEBUG(0, ("Error: not enough memory!\n"));
+			ZERODEBUG(0, ("Error: not enough memory!\n"));
 		} else {
-			DEBUG(0, ("%s\n", msg));
+			ZERODEBUG(0, ("%s\n", msg));
 			SAFE_FREE(msg);
 		}
 	}
@@ -828,12 +828,12 @@
 {
 	/* List open connections */
 
-	DEBUG(0, ("winbindd connection manager status:\n"));
+	ZERODEBUG(0, ("winbindd connection manager status:\n"));
 
 	if (cm_conns)
 		dump_conn_list();
 	else
-		DEBUG(0, ("\tNo active connections\n"));
+		ZERODEBUG(0, ("\tNo active connections\n"));
 }
 
 /* Close all cached connections */
diff -Naur samba-2.2.12-orig/source/nsswitch/winbindd_group.c samba-2.2.12/source/nsswitch/winbindd_group.c
--- samba-2.2.12-orig/source/nsswitch/winbindd_group.c	2004-08-12 20:24:23.000000000 +0200
+++ samba-2.2.12/source/nsswitch/winbindd_group.c	2009-03-11 09:59:34.000000000 +0100
@@ -207,7 +207,7 @@
 	/* Get info for the domain */
 
 	if ((domain = find_domain_from_name(name_domain)) == NULL) {
-		DEBUG(0, ("could not get domain sid for domain %s\n",
+		ZERODEBUG(0, ("could not get domain sid for domain %s\n",
 			  name_domain));
 		return WINBINDD_ERROR;
 	}
@@ -598,7 +598,7 @@
 				gr_mem_list_len + gr_mem_len);
 
 			if (!new_gr_mem_list && (group_list[group_list_ndx].num_gr_mem != 0)) {
-				DEBUG(0, ("out of memory\n"));
+				ZERODEBUG(0, ("out of memory\n"));
 				SAFE_FREE(gr_mem_list);
 				gr_mem_list_len = 0;
 				break;
@@ -636,7 +636,7 @@
 				sizeof(struct winbindd_gr);
 			
 		} else {
-			DEBUG(0, ("could not lookup domain group %s\n", 
+			ZERODEBUG(0, ("could not lookup domain group %s\n", 
 				  domain_group_name));
 		}
 	}
@@ -651,7 +651,7 @@
 		group_list_ndx * sizeof(struct winbindd_gr) + gr_mem_list_len);
 
 	if (!new_extra_data) {
-		DEBUG(0, ("out of memory\n"));
+		ZERODEBUG(0, ("out of memory\n"));
 		group_list_ndx = 0;
 		SAFE_FREE(state->response.extra_data);
 		SAFE_FREE(gr_mem_list);
@@ -734,7 +734,7 @@
                 ted = Realloc(extra_data, sizeof(fstring) * total_entries);
  
 		if (!ted) {
-			DEBUG(0,("failed to enlarge buffer!\n"));
+			ZERODEBUG(0,("failed to enlarge buffer!\n"));
 			SAFE_FREE(extra_data);
 			return WINBINDD_ERROR;
 		} else
@@ -803,7 +803,7 @@
 	/* Get info for the domain */
 	
 	if ((domain = find_domain_from_name(name_domain)) == NULL) {
-		DEBUG(0, ("could not find domain entry for domain %s\n", 
+		ZERODEBUG(0, ("could not find domain entry for domain %s\n", 
 			  name_domain));
 		goto done;
 	}
diff -Naur samba-2.2.12-orig/source/nsswitch/winbindd_idmap.c samba-2.2.12/source/nsswitch/winbindd_idmap.c
--- samba-2.2.12-orig/source/nsswitch/winbindd_idmap.c	2004-08-12 20:24:23.000000000 +0200
+++ samba-2.2.12/source/nsswitch/winbindd_idmap.c	2009-03-11 09:59:34.000000000 +0100
@@ -51,7 +51,7 @@
 
     if ((isgroup && (hwm > server_state.gid_high)) ||
         (!isgroup && (hwm > server_state.uid_high))) {
-        DEBUG(0, ("winbind %sid range full!\n", isgroup ? "g" : "u"));
+        ZERODEBUG(0, ("winbind %sid range full!\n", isgroup ? "g" : "u"));
         return False;
     }
 
@@ -262,8 +262,8 @@
 	domain = find_domain_from_name(dom_name);
 	if (!domain) {
 		/* We must delete the old record. */
-		DEBUG(0,("winbindd: convert_fn : Unable to find domain %s\n", dom_name ));
-		DEBUG(0,("winbindd: convert_fn : deleting record %s\n", key.dptr ));
+		ZERODEBUG(0,("winbindd: convert_fn : Unable to find domain %s\n", dom_name ));
+		ZERODEBUG(0,("winbindd: convert_fn : deleting record %s\n", key.dptr ));
 		tdb_delete(idmap_tdb, key);
 		return 0;
 	}
@@ -279,15 +279,15 @@
 
 	if (tdb_store(idmap_tdb, key2, data, TDB_INSERT) != 0) {
 		/* not good! */
-		DEBUG(0,("winbindd: convert_fn : Unable to update record %s\n", key2.dptr ));
-		DEBUG(0,("winbindd: convert_fn : conversion failed - idmap corrupt ?\n"));
+		ZERODEBUG(0,("winbindd: convert_fn : Unable to update record %s\n", key2.dptr ));
+		ZERODEBUG(0,("winbindd: convert_fn : conversion failed - idmap corrupt ?\n"));
 		return -1;
 	}
 
 	if (tdb_store(idmap_tdb, data, key2, TDB_REPLACE) != 0) {
 		/* not good! */
-		DEBUG(0,("winbindd: convert_fn : Unable to update record %s\n", data.dptr ));
-		DEBUG(0,("winbindd: convert_fn : conversion failed - idmap corrupt ?\n"));
+		ZERODEBUG(0,("winbindd: convert_fn : Unable to update record %s\n", data.dptr ));
+		ZERODEBUG(0,("winbindd: convert_fn : conversion failed - idmap corrupt ?\n"));
 		return -1;
 	}
 
@@ -392,7 +392,7 @@
 			wm = server_state.uid_low;
 
 		if (tdb_store_int32(idmap_tdb, HWM_USER, wm) == -1) {
-			DEBUG(0, ("idmap_convert: Unable to byteswap user hwm in idmap database\n"));
+			ZERODEBUG(0, ("idmap_convert: Unable to byteswap user hwm in idmap database\n"));
 			return False;
 		}
 
@@ -403,7 +403,7 @@
 			wm = server_state.gid_low;
 
 		if (tdb_store_int32(idmap_tdb, HWM_GROUP, wm) == -1) {
-			DEBUG(0, ("idmap_convert: Unable to byteswap group hwm in idmap database\n"));
+			ZERODEBUG(0, ("idmap_convert: Unable to byteswap group hwm in idmap database\n"));
 			return False;
 		}
 	}
@@ -412,7 +412,7 @@
 	tdb_traverse(idmap_tdb, convert_fn, NULL);
 
 	if (tdb_store_int32(idmap_tdb, "IDMAP_VERSION", IDMAP_VERSION) == -1) {
-		DEBUG(0, ("idmap_convert: Unable to byteswap group hwm in idmap database\n"));
+		ZERODEBUG(0, ("idmap_convert: Unable to byteswap group hwm in idmap database\n"));
 		return False;
 	}
 
@@ -429,13 +429,13 @@
 
 	if (!(idmap_tdb = tdb_open_log(lock_path("winbindd_idmap.tdb"), 0,
 				TDB_DEFAULT, O_RDWR | O_CREAT, 0600))) {
-		DEBUG(0, ("winbindd_idmap_init: Unable to open idmap database\n"));
+		ZERODEBUG(0, ("winbindd_idmap_init: Unable to open idmap database\n"));
 		return False;
 	}
 
 	/* possibly convert from an earlier version */
 	if (!idmap_convert(lock_path("winbindd_idmap.tdb"))) {
-		DEBUG(0, ("winbindd_idmap_init: Unable to open idmap database\n"));
+		ZERODEBUG(0, ("winbindd_idmap_init: Unable to open idmap database\n"));
 		return False;
 	}
 
@@ -443,14 +443,14 @@
 
 	if (tdb_fetch_int32(idmap_tdb, HWM_USER) == -1) {
 		if (tdb_store_int32(idmap_tdb, HWM_USER, server_state.uid_low) == -1) {
-			DEBUG(0, ("winbindd_idmap_init: Unable to initialise user hwm in idmap database\n"));
+			ZERODEBUG(0, ("winbindd_idmap_init: Unable to initialise user hwm in idmap database\n"));
 			return False;
 		}
 	}
 
 	if (tdb_fetch_int32(idmap_tdb, HWM_GROUP) == -1) {
 		if (tdb_store_int32(idmap_tdb, HWM_GROUP, server_state.gid_low) == -1) {
-			DEBUG(0, ("winbindd_idmap_init: Unable to initialise group hwm in idmap database\n"));
+			ZERODEBUG(0, ("winbindd_idmap_init: Unable to initialise group hwm in idmap database\n"));
 			return False;
 		}
 	}
@@ -480,7 +480,7 @@
 {
 	int user_hwm, group_hwm;
 
-	DEBUG(0, ("winbindd idmap status:\n"));
+	ZERODEBUG(0, ("winbindd idmap status:\n"));
 
 	/* Get current high water marks */
 
diff -Naur samba-2.2.12-orig/source/nsswitch/winbindd_misc.c samba-2.2.12/source/nsswitch/winbindd_misc.c
--- samba-2.2.12-orig/source/nsswitch/winbindd_misc.c	2004-08-12 20:24:23.000000000 +0200
+++ samba-2.2.12/source/nsswitch/winbindd_misc.c	2009-03-11 09:59:34.000000000 +0100
@@ -112,7 +112,7 @@
                               total_entries);
 
 		if (!ted) {
-			DEBUG(0,("winbindd_list_trusted_domains: failed to enlarge buffer!\n"));
+			ZERODEBUG(0,("winbindd_list_trusted_domains: failed to enlarge buffer!\n"));
 			SAFE_FREE(extra_data);
 			return WINBINDD_ERROR;
 		} else 
diff -Naur samba-2.2.12-orig/source/nsswitch/winbindd_pam.c samba-2.2.12/source/nsswitch/winbindd_pam.c
--- samba-2.2.12-orig/source/nsswitch/winbindd_pam.c	2004-08-12 20:24:23.000000000 +0200
+++ samba-2.2.12/source/nsswitch/winbindd_pam.c	2009-03-11 09:59:34.000000000 +0100
@@ -47,7 +47,7 @@
 		  state->request.data.auth.user));
 
 	if (!(mem_ctx = talloc_init_named("winbind pam auth for %s", state->request.data.auth.user))) {
-		DEBUG(0, ("winbindd_pam_auth: could not talloc_init()!\n"));
+		ZERODEBUG(0, ("winbindd_pam_auth: could not talloc_init()!\n"));
 		result = NT_STATUS_NO_MEMORY;
 		goto done;
 	}
@@ -82,7 +82,7 @@
 
 	if (!secrets_fetch_trust_account_password(
                 lp_workgroup(), trust_passwd, &last_change_time)) {
-		DEBUG(0, ("winbindd_pam_auth: could not fetch trust account "
+		ZERODEBUG(0, ("winbindd_pam_auth: could not fetch trust account "
                           "password for domain %s\n", lp_workgroup()));
 		result = NT_STATUS_CANT_ACCESS_DOMAIN_INFO;
 		goto done;
@@ -147,7 +147,7 @@
 		  state->request.data.auth_crap.domain, state->request.data.auth_crap.user));
 
 	if (!(mem_ctx = talloc_init_named("winbind pam auth crap for %s", state->request.data.auth_crap.user))) {
-		DEBUG(0, ("winbindd_pam_auth_crap: could not talloc_init()!\n"));
+		ZERODEBUG(0, ("winbindd_pam_auth_crap: could not talloc_init()!\n"));
 		result = NT_STATUS_NO_MEMORY;
 		goto done;
 	}
@@ -163,7 +163,7 @@
 	}
 
 	if (!domain) {
-		DEBUG(0,("winbindd_pam_auth_crap: talloc_strdup failed!\n"));
+		ZERODEBUG(0,("winbindd_pam_auth_crap: talloc_strdup failed!\n"));
 		result = NT_STATUS_NO_MEMORY;
 		goto done;
 	}
@@ -177,7 +177,7 @@
 
 	if (!secrets_fetch_trust_account_password(
                 lp_workgroup(), trust_passwd, &last_change_time)) {
-		DEBUG(0, ("winbindd_pam_auth: could not fetch trust account "
+		ZERODEBUG(0, ("winbindd_pam_auth: could not fetch trust account "
                           "password for domain %s\n", lp_workgroup()));
 		result = NT_STATUS_CANT_ACCESS_DOMAIN_INFO;
 		goto done;
diff -Naur samba-2.2.12-orig/source/nsswitch/winbindd_rpc.c samba-2.2.12/source/nsswitch/winbindd_rpc.c
--- samba-2.2.12-orig/source/nsswitch/winbindd_rpc.c	2004-08-12 20:24:23.000000000 +0200
+++ samba-2.2.12/source/nsswitch/winbindd_rpc.c	2009-03-11 09:59:34.000000000 +0100
@@ -226,14 +226,14 @@
 	int retry;
 
 	if (!(mem_ctx = talloc_init_named("name_to_sid[rpc] for [%s]\\[%s]", domain->name, name))) {
-		DEBUG(0, ("talloc_init failed!\n"));
+		ZERODEBUG(0, ("talloc_init failed!\n"));
 		return NT_STATUS_NO_MEMORY;
 	}
         
 	full_name = talloc_asprintf(mem_ctx, "%s\\%s", domain->name, name);
 	
 	if (!full_name) {
-		DEBUG(0, ("talloc_asprintf failed!\n"));
+		ZERODEBUG(0, ("talloc_asprintf failed!\n"));
 		talloc_destroy(mem_ctx);
 		return NT_STATUS_NO_MEMORY;
 	}
diff -Naur samba-2.2.12-orig/source/nsswitch/winbindd_sid.c samba-2.2.12/source/nsswitch/winbindd_sid.c
--- samba-2.2.12-orig/source/nsswitch/winbindd_sid.c	2004-08-12 20:24:23.000000000 +0200
+++ samba-2.2.12/source/nsswitch/winbindd_sid.c	2009-03-11 09:59:34.000000000 +0100
@@ -86,7 +86,7 @@
 	name_user = state->request.data.name.name;
 
 	if ((domain = find_domain_from_name(name_domain)) == NULL) {
-		DEBUG(0, ("could not find domain entry for domain %s\n", 
+		ZERODEBUG(0, ("could not find domain entry for domain %s\n", 
 			  name_domain));
 		return WINBINDD_ERROR;
 	}
diff -Naur samba-2.2.12-orig/source/nsswitch/winbindd_user.c samba-2.2.12/source/nsswitch/winbindd_user.c
--- samba-2.2.12-orig/source/nsswitch/winbindd_user.c	2004-08-12 20:24:23.000000000 +0200
+++ samba-2.2.12/source/nsswitch/winbindd_user.c	2009-03-11 09:59:34.000000000 +0100
@@ -374,7 +374,7 @@
 						       num_entries));
 		
 		if (!tnl) {
-			DEBUG(0,("get_sam_user_entries realloc failed.\n"));
+			ZERODEBUG(0,("get_sam_user_entries realloc failed.\n"));
 			SAFE_FREE(name_list);
 			goto done;
 		} else
@@ -605,7 +605,7 @@
 		ted = Realloc(extra_data, sizeof(fstring) * total_entries);
 			
 		if (!ted) {
-			DEBUG(0,("failed to enlarge buffer!\n"));
+			ZERODEBUG(0,("failed to enlarge buffer!\n"));
 			SAFE_FREE(extra_data);
 			goto done;
 		} else 
diff -Naur samba-2.2.12-orig/source/nsswitch/winbindd_util.c samba-2.2.12/source/nsswitch/winbindd_util.c
--- samba-2.2.12-orig/source/nsswitch/winbindd_util.c	2004-08-12 20:24:23.000000000 +0200
+++ samba-2.2.12/source/nsswitch/winbindd_util.c	2009-03-11 09:59:35.000000000 +0100
@@ -320,12 +320,12 @@
 	/* Parse winbind uid and winbind_gid parameters */
 
 	if (!lp_winbind_uid(&server_state.uid_low, &server_state.uid_high)) {
-		DEBUG(0, ("winbind uid range missing or invalid\n"));
+		ZERODEBUG(0, ("winbind uid range missing or invalid\n"));
 		return False;
 	}
 	
 	if (!lp_winbind_gid(&server_state.gid_low, &server_state.gid_high)) {
-		DEBUG(0, ("winbind gid range missing or invalid\n"));
+		ZERODEBUG(0, ("winbind gid range missing or invalid\n"));
 		return False;
 	}
 	
diff -Naur samba-2.2.12-orig/source/param/loadparm.c samba-2.2.12/source/param/loadparm.c
--- samba-2.2.12-orig/source/param/loadparm.c	2004-08-12 20:24:23.000000000 +0200
+++ samba-2.2.12/source/param/loadparm.c	2009-03-11 09:59:35.000000000 +0100
@@ -1923,7 +1923,7 @@
 						num_to_alloc);
  
 		if (!tsp) {
-			DEBUG(0,("add_a_service: failed to enlarge ServicePtrs!\n"));
+			ZERODEBUG(0,("add_a_service: failed to enlarge ServicePtrs!\n"));
 			return (-1);
 		} else {
 			ServicePtrs = tsp;
@@ -2079,7 +2079,7 @@
 		if (strwicmp(parm_table[iIndex].label, pszParmName) == 0)
 			return (iIndex);
 
-	DEBUG(0, ("Unknown parameter encountered: \"%s\"\n", pszParmName));
+	ZERODEBUG(0, ("Unknown parameter encountered: \"%s\"\n", pszParmName));
 	return (-1);
 }
 
@@ -2105,7 +2105,7 @@
 		*pb = False;
 	else
 	{
-		DEBUG(0,
+		ZERODEBUG(0,
 		      ("ERROR: Badly formed boolean in configuration file: \"%s\".\n",
 		       pszParmValue));
 		bRetval = False;
@@ -2210,9 +2210,9 @@
 	bRetval = True;
 	if (ServicePtrs[iService]->szService[0] == '\0')
 	{
-		DEBUG(0,
+		ZERODEBUG(0,
 		      ("The following message indicates an internal error:\n"));
-		DEBUG(0, ("No service name in service entry.\n"));
+		ZERODEBUG(0, ("No service name in service entry.\n"));
 		bRetval = False;
 	}
 
@@ -2220,7 +2220,7 @@
 	/* I can't see why you'd want a non-printable printer service...        */
 	if (strwicmp(ServicePtrs[iService]->szService, PRINTERS_NAME) == 0) {
 		if (!ServicePtrs[iService]->bPrint_ok) {
-			DEBUG(0,
+			ZERODEBUG(0,
 			      ("WARNING: [%s] service MUST be printable!\n",
 			       ServicePtrs[iService]->szService));
 			ServicePtrs[iService]->bPrint_ok = True;
@@ -2233,7 +2233,7 @@
 	if (ServicePtrs[iService]->szPath[0] == '\0' &&
 	    strwicmp(ServicePtrs[iService]->szService, HOMES_NAME) != 0)
 	{
-		DEBUG(0,
+		ZERODEBUG(0,
 		      ("No path in service %s - using %s\n",
 		       ServicePtrs[iService]->szService, tmpdir()));
 		string_set(&ServicePtrs[iService]->szPath, tmpdir());
@@ -2377,7 +2377,7 @@
 
 		if ((varval = malloc(len + 1)) == NULL)
 		{
-			DEBUG(0, ("source_env: Not enough memory!\n"));
+			ZERODEBUG(0, ("source_env: Not enough memory!\n"));
 			return (False);
 		}
 
@@ -2394,7 +2394,7 @@
 
 		if (putenv(varval))
 		{
-			DEBUG(0,
+			ZERODEBUG(0,
 			      ("source_env: Failed to put environment variable %s\n",
 			       varval));
 			continue;
@@ -2445,7 +2445,7 @@
 
 	if (!lines)
 	{
-		DEBUG(0,
+		ZERODEBUG(0,
 		      ("handle_source_env: Failed to open file %s, Error was %s\n",
 		       fname, strerror(errno)));
 		return (False);
@@ -2579,7 +2579,7 @@
 	{
 		if (iTemp == iServiceIndex)
 		{
-			DEBUG(0,
+			ZERODEBUG(0,
 			      ("Can't copy service %s - unable to copy self!\n",
 			       pszParmValue));
 		}
@@ -2593,7 +2593,7 @@
 	}
 	else
 	{
-		DEBUG(0, ("Unable to copy service - source not found: %s\n",
+		ZERODEBUG(0, ("Unable to copy service - source not found: %s\n",
 			  pszParmValue));
 		bRetval = False;
 	}
@@ -2734,7 +2734,7 @@
 	SAFE_FREE(pservice->copymap);
 	pservice->copymap = (BOOL *)malloc(sizeof(BOOL) * NUMPARAMETERS);
 	if (!pservice->copymap)
-		DEBUG(0,
+		ZERODEBUG(0,
 		      ("Couldn't allocate copymap!! (size %d)\n",
 		       (int)NUMPARAMETERS));
 	else
@@ -2766,14 +2766,14 @@
 
 	if (parmnum < 0)
 	{
-		DEBUG(0,
+		ZERODEBUG(0,
 		      ("Ignoring unknown parameter \"%s\"\n", pszParmName));
 		return (True);
 	}
 
 	if (parm_table[parmnum].flags & FLAG_DEPRECATED)
 	{
-		DEBUG(0, ("WARNING: The \"%s\"option is deprecated\n",
+		ZERODEBUG(0, ("WARNING: The \"%s\"option is deprecated\n",
 			  pszParmName));
 	}
 
@@ -2788,7 +2788,7 @@
 	{
 		if (parm_table[parmnum].class == P_GLOBAL)
 		{
-			DEBUG(0,
+			ZERODEBUG(0,
 			      ("Global parameter %s found in service section!\n",
 			       pszParmName));
 			return (True);
@@ -3075,7 +3075,7 @@
 		if ((iServiceIndex = add_a_service(&sDefault, pszSectionName))
 		    < 0)
 		{
-			DEBUG(0, ("Failed to add a new service\n"));
+			ZERODEBUG(0, ("Failed to add a new service\n"));
 			return (False);
 		}
 	}
@@ -3435,7 +3435,7 @@
 	switch (lp_security()) {
 		case SEC_SHARE:
 			if (lp_domain_logons())
-				DEBUG(0, ("Server's Role (logon server) conflicts with share-level security\n"));
+				ZERODEBUG(0, ("Server's Role (logon server) conflicts with share-level security\n"));
 			DEBUG(10,("set_server_role: ROLE_STANDALONE\n"));
 			break;
 		case SEC_SERVER:
@@ -3457,7 +3457,7 @@
 			DEBUG(10,("set_server_role: ROLE_STANDALONE\n"));
 			break;
 		default:
-			DEBUG(0, ("Server's Role undefined due to unknown security mode\n"));
+			ZERODEBUG(0, ("Server's Role undefined due to unknown security mode\n"));
 			DEBUG(10,("set_server_role: ROLE_STANDALONE\n"));
 			break;
 	}
diff -Naur samba-2.2.12-orig/source/param/params.c samba-2.2.12/source/param/params.c
--- samba-2.2.12-orig/source/param/params.c	2004-08-12 20:24:23.000000000 +0200
+++ samba-2.2.12/source/param/params.c	2009-03-11 09:59:35.000000000 +0100
@@ -255,7 +255,7 @@
       tb = Realloc( bufr, bSize +BUFR_INC );
       if( NULL == tb )
         {
-        DEBUG(0, ("%s Memory re-allocation failure.", func) );
+        ZERODEBUG(0, ("%s Memory re-allocation failure.", func) );
         return( False );
         }
       bufr = tb;
@@ -269,7 +269,7 @@
         bufr[end] = '\0';
         if( 0 == end )                  /* Don't allow an empty name.       */
           {
-          DEBUG(0, ("%s Empty section name in configuration file.\n", func ));
+          ZERODEBUG(0, ("%s Empty section name in configuration file.\n", func ));
           return( False );
           }
         if( !sfunc( unix_to_dos(bufr) ) )            /* Got a valid name.  Deal with it. */
@@ -282,7 +282,7 @@
         if( i < 0 )
           {
           bufr[end] = '\0';
-          DEBUG(0, ("%s Badly formed line in configuration file: %s\n",
+          ZERODEBUG(0, ("%s Badly formed line in configuration file: %s\n",
                    func, bufr ));
           return( False );
           }
@@ -307,7 +307,7 @@
     }
 
   /* We arrive here if we've met the EOF before the closing bracket. */
-  DEBUG(0, ("%s Unexpected EOF in the configuration file: %s\n", func, bufr ));
+  ZERODEBUG(0, ("%s Unexpected EOF in the configuration file: %s\n", func, bufr ));
   return( False );
   } /* Section */
 
@@ -352,7 +352,7 @@
       tb = Realloc( bufr, bSize + BUFR_INC );
       if( NULL == tb )
         {
-        DEBUG(0, ("%s Memory re-allocation failure.", func) );
+        ZERODEBUG(0, ("%s Memory re-allocation failure.", func) );
         return( False );
         }
       bufr = tb;
@@ -364,7 +364,7 @@
       case '=':                 /* Equal sign marks end of param name. */
         if( 0 == end )              /* Don't allow an empty name.      */
           {
-          DEBUG(0, ("%s Invalid parameter name in config. file.\n", func ));
+          ZERODEBUG(0, ("%s Invalid parameter name in config. file.\n", func ));
           return( False );
           }
         bufr[end++] = '\0';         /* Mark end of string & advance.   */
@@ -419,7 +419,7 @@
       bufr   = Realloc( bufr, bSize );
       if( NULL == bufr )
         {
-        DEBUG(0, ("%s Memory re-allocation failure.", func) );
+        ZERODEBUG(0, ("%s Memory re-allocation failure.", func) );
         return( False );
         }
       }
@@ -586,7 +586,7 @@
     bufr = (char *)malloc( bSize );
     if( NULL == bufr )
       {
-      DEBUG(0,("%s memory allocation failure.\n", func));
+      ZERODEBUG(0,("%s memory allocation failure.\n", func));
       myfile_close(InFile);
       return( False );
       }
@@ -600,7 +600,7 @@
 
   if( !result )                               /* Generic failure. */
     {
-    DEBUG(0,("%s Failed.  Error returned from params.c:parse().\n", func));
+    ZERODEBUG(0,("%s Failed.  Error returned from params.c:parse().\n", func));
     return( False );
     }
 
diff -Naur samba-2.2.12-orig/source/parsing.doc samba-2.2.12/source/parsing.doc
--- samba-2.2.12-orig/source/parsing.doc	2004-08-12 20:24:35.000000000 +0200
+++ samba-2.2.12/source/parsing.doc	2009-03-11 10:01:00.000000000 +0100
@@ -232,7 +232,7 @@
 
    to send the output to stdout, then you would write
 
-     DEBUG( 0, ( "This is a %s message.\n", "debug" ) );
+     ZERODEBUG( 0, ( "This is a %s message.\n", "debug" ) );
 
    to send the output to the debug file.  All of the normal printf()
    formatting escapes work.
@@ -257,12 +257,12 @@
    DEBUG() has been used to write partial lines. Here's a simple (dumb)
    example of the kind of thing I'm talking about:
 
-    DEBUG( 0, ("The test returned " ) );
+    ZERODEBUG( 0, ("The test returned " ) );
     if( test() )
-      DEBUG(0, ("True") );
+      ZERODEBUG(0, ("True") );
     else
-      DEBUG(0, ("False") );
-    DEBUG(0, (".\n") );
+      ZERODEBUG(0, ("False") );
+    ZERODEBUG(0, (".\n") );
 
    Without the format buffer, the output (assuming test() returned true)
    would look like this:
@@ -284,7 +284,7 @@
    message even if the format buffer is empty. The syntax of the
    DEBUGADD() macro is the same as that of the DEBUG() macro.
 
-    DEBUG( 0, ("This is the first line.\n" ) );
+    ZERODEBUG( 0, ("This is the first line.\n" ) );
     DEBUGADD( 0, ("This is the second line.\nThis is the third line.\n" ) );
 
    Produces
diff -Naur samba-2.2.12-orig/source/passdb/machine_sid.c samba-2.2.12/source/passdb/machine_sid.c
--- samba-2.2.12-orig/source/passdb/machine_sid.c	2004-08-12 20:24:27.000000000 +0200
+++ samba-2.2.12/source/passdb/machine_sid.c	2009-03-11 09:59:35.000000000 +0100
@@ -43,7 +43,7 @@
 
 	ret = string_to_sid(sid, lines[0]);
 	if (!ret)
-		DEBUG(0,("read_sid_from_file: Failed to convert machine SID. (%s)\n", lines[0]));
+		ZERODEBUG(0,("read_sid_from_file: Failed to convert machine SID. (%s)\n", lines[0]));
 	file_lines_free(lines);
 	return ret;
 }
@@ -106,7 +106,7 @@
 			/* No domain sid and we're a pdc/bdc. Store it */
 
 			if (!secrets_store_domain_sid(global_myworkgroup, &global_sam_sid)) {
-				DEBUG(0,("pdb_generate_sam_sid: Can't store domain SID as a pdc/bdc.\n"));
+				ZERODEBUG(0,("pdb_generate_sam_sid: Can't store domain SID as a pdc/bdc.\n"));
 				return False;
 			}
 			return True;
@@ -116,9 +116,9 @@
 
 			/* Domain name sid doesn't match global sam sid. Re-store global sam sid as domain sid. */
 
-			DEBUG(0,("pdb_generate_sam_sid: Mismatched SIDs as a pdc/bdc.\n"));
+			ZERODEBUG(0,("pdb_generate_sam_sid: Mismatched SIDs as a pdc/bdc.\n"));
 			if (!secrets_store_domain_sid(global_myworkgroup, &global_sam_sid)) {
-				DEBUG(0,("pdb_generate_sam_sid: Can't re-store domain SID as a pdc/bdc.\n"));
+				ZERODEBUG(0,("pdb_generate_sam_sid: Can't re-store domain SID as a pdc/bdc.\n"));
 				return False;
 			}
 			return True;
@@ -134,14 +134,14 @@
 	if (read_sid_from_file(fname, &global_sam_sid)) {
 		/* remember it for future reference and unlink the old MACHINE.SID */
 		if (!secrets_store_domain_sid(global_myname, &global_sam_sid)) {
-			DEBUG(0,("pdb_generate_sam_sid: Failed to store SID from file.\n"));
+			ZERODEBUG(0,("pdb_generate_sam_sid: Failed to store SID from file.\n"));
 			SAFE_FREE(fname);
 			return False;
 		}
 		unlink(fname);
 		if (is_dc) {
 			if (!secrets_store_domain_sid(global_myworkgroup, &global_sam_sid)) {
-				DEBUG(0,("pdb_generate_sam_sid: Failed to store domain SID from file.\n"));
+				ZERODEBUG(0,("pdb_generate_sam_sid: Failed to store domain SID from file.\n"));
 				SAFE_FREE(fname);
 				return False;
 			}
@@ -160,12 +160,12 @@
 	generate_random_sid(&global_sam_sid);
 	DEBUG(10, ("Generated random SID ...\n"));
 	if (!secrets_store_domain_sid(global_myname, &global_sam_sid)) {
-		DEBUG(0,("pdb_generate_sam_sid: Failed to store generated machine SID.\n"));
+		ZERODEBUG(0,("pdb_generate_sam_sid: Failed to store generated machine SID.\n"));
 		return False;
 	}
 	if (is_dc) {
 		if (!secrets_store_domain_sid(global_myworkgroup, &global_sam_sid)) {
-			DEBUG(0,("pdb_generate_sam_sid: Failed to store generated domain SID.\n"));
+			ZERODEBUG(0,("pdb_generate_sam_sid: Failed to store generated domain SID.\n"));
 			return False;
 		}
 	}
diff -Naur samba-2.2.12-orig/source/passdb/pampass.c samba-2.2.12/source/passdb/pampass.c
--- samba-2.2.12-orig/source/passdb/pampass.c	2004-08-12 20:24:27.000000000 +0200
+++ samba-2.2.12/source/passdb/pampass.c	2009-03-11 09:59:35.000000000 +0100
@@ -89,7 +89,7 @@
 
 	if (NT_STATUS_IS_OK(*nt_status)) {
 		/* Complain LOUDLY */
-		DEBUG(0, ("smb_pam_nt_status_error_handler: PAM: BUG: PAM and NT_STATUS \
+		ZERODEBUG(0, ("smb_pam_nt_status_error_handler: PAM: BUG: PAM and NT_STATUS \
 error MISMATCH, forcing to NT_STATUS_LOGON_FAILURE"));
 		*nt_status = NT_STATUS_LOGON_FAILURE;
 	}
@@ -122,7 +122,7 @@
 	 */
 
 	if (udp == NULL) {
-		DEBUG(0,("smb_pam_conv: PAM on this system is broken - appdata_ptr == NULL !\n"));
+		ZERODEBUG(0,("smb_pam_conv: PAM on this system is broken - appdata_ptr == NULL !\n"));
 		return PAM_CONV_ERR;
 	}
 
@@ -209,7 +209,7 @@
 	while (1) {
 		t = (struct chat_struct *)malloc(sizeof(*t));
 		if (!t) {
-			DEBUG(0,("make_pw_chat: malloc failed!\n"));
+			ZERODEBUG(0,("make_pw_chat: malloc failed!\n"));
 			return NULL;
 		}
 
@@ -281,14 +281,14 @@
 	 */
 
 	if (udp == NULL) {
-		DEBUG(0,("smb_pam_passchange_conv: PAM on this system is broken - appdata_ptr == NULL !\n"));
+		ZERODEBUG(0,("smb_pam_passchange_conv: PAM on this system is broken - appdata_ptr == NULL !\n"));
 		free_pw_chat(pw_chat);
 		return PAM_CONV_ERR;
 	}
 
 	reply = malloc(sizeof(struct pam_response) * num_msg);
 	if (!reply) {
-		DEBUG(0,("smb_pam_passchange_conv: malloc for reply failed!\n"));
+		ZERODEBUG(0,("smb_pam_passchange_conv: malloc for reply failed!\n"));
 		free_pw_chat(pw_chat);
 		return PAM_CONV_ERR;
 	}
@@ -527,7 +527,7 @@
 			nt_status = NT_STATUS_REMOTE_SESSION_LIMIT;
 			break;
 		case PAM_ABORT:
-			DEBUG(0, ("smb_pam_auth: PAM: One or more PAM modules failed to load for user %s\n", user));
+			ZERODEBUG(0, ("smb_pam_auth: PAM: One or more PAM modules failed to load for user %s\n", user));
 			nt_status = NT_STATUS_LOGON_FAILURE;
 			break;
 		case PAM_SUCCESS:
@@ -535,7 +535,7 @@
 			nt_status = NT_STATUS_OK;
 			break;
 		default:
-			DEBUG(0, ("smb_pam_auth: PAM: UNKNOWN ERROR while authenticating user %s\n", user));
+			ZERODEBUG(0, ("smb_pam_auth: PAM: UNKNOWN ERROR while authenticating user %s\n", user));
 			nt_status = NT_STATUS_LOGON_FAILURE;
 			break;
 	}
@@ -568,11 +568,11 @@
 			nt_status = NT_STATUS_LOGON_FAILURE;
 			break;
 		case PAM_PERM_DENIED:
-			DEBUG(0, ("smb_pam_account: PAM: User %s is NOT permitted to access system at this time\n", user));
+			ZERODEBUG(0, ("smb_pam_account: PAM: User %s is NOT permitted to access system at this time\n", user));
 			nt_status = NT_STATUS_ACCOUNT_RESTRICTION;
 			break;
 		case PAM_USER_UNKNOWN:
-			DEBUG(0, ("smb_pam_account: PAM: User \"%s\" is NOT known to account management\n", user));
+			ZERODEBUG(0, ("smb_pam_account: PAM: User \"%s\" is NOT known to account management\n", user));
 			nt_status = NT_STATUS_NO_SUCH_USER;
 			break;
 		case PAM_SUCCESS:
@@ -581,7 +581,7 @@
 			break;
 		default:
 			nt_status = NT_STATUS_ACCOUNT_DISABLED;
-			DEBUG(0, ("smb_pam_account: PAM: UNKNOWN PAM ERROR (%d) during Account Management for User: %s\n", pam_error, user));
+			ZERODEBUG(0, ("smb_pam_account: PAM: UNKNOWN PAM ERROR (%d) during Account Management for User: %s\n", pam_error, user));
 			break;
 	}
 
@@ -607,19 +607,19 @@
 	pam_error = pam_setcred(pamh, (PAM_ESTABLISH_CRED|PAM_SILENT)); 
 	switch( pam_error ) {
 		case PAM_CRED_UNAVAIL:
-			DEBUG(0, ("smb_pam_setcred: PAM: Credentials not found for user:%s\n", user ));
+			ZERODEBUG(0, ("smb_pam_setcred: PAM: Credentials not found for user:%s\n", user ));
 			 nt_status = NT_STATUS_NO_TOKEN;
 			break;
 		case PAM_CRED_EXPIRED:
-			DEBUG(0, ("smb_pam_setcred: PAM: Credentials for user: \"%s\" EXPIRED!\n", user ));
+			ZERODEBUG(0, ("smb_pam_setcred: PAM: Credentials for user: \"%s\" EXPIRED!\n", user ));
 			nt_status = NT_STATUS_PASSWORD_EXPIRED;
 			break;
 		case PAM_USER_UNKNOWN:
-			DEBUG(0, ("smb_pam_setcred: PAM: User: \"%s\" is NOT known so can not set credentials!\n", user ));
+			ZERODEBUG(0, ("smb_pam_setcred: PAM: User: \"%s\" is NOT known so can not set credentials!\n", user ));
 			nt_status = NT_STATUS_NO_SUCH_USER;
 			break;
 		case PAM_CRED_ERR:
-			DEBUG(0, ("smb_pam_setcred: PAM: Unknown setcredentials error - unable to set credentials for %s\n", user ));
+			ZERODEBUG(0, ("smb_pam_setcred: PAM: Unknown setcredentials error - unable to set credentials for %s\n", user ));
 			nt_status = NT_STATUS_LOGON_FAILURE;
 			break;
 		case PAM_SUCCESS:
@@ -627,7 +627,7 @@
 			nt_status = NT_STATUS_OK;
 			break;
 		default:
-			DEBUG(0, ("smb_pam_setcred: PAM: UNKNOWN PAM ERROR (%d) during SetCredentials for User: %s\n", pam_error, user));
+			ZERODEBUG(0, ("smb_pam_setcred: PAM: UNKNOWN PAM ERROR (%d) during SetCredentials for User: %s\n", pam_error, user));
 			nt_status = NT_STATUS_NO_TOKEN;
 			break;
 	}
@@ -694,19 +694,19 @@
 		DEBUG(2, ("PAM: Authentication token aging has been disabled.\n"));
 		break;
 	case PAM_PERM_DENIED:
-		DEBUG(0, ("PAM: Permission denied.\n"));
+		ZERODEBUG(0, ("PAM: Permission denied.\n"));
 		break;
 	case PAM_TRY_AGAIN:
-		DEBUG(0, ("PAM: Could not update all authentication token(s). No authentication tokens were updated.\n"));
+		ZERODEBUG(0, ("PAM: Could not update all authentication token(s). No authentication tokens were updated.\n"));
 		break;
 	case PAM_USER_UNKNOWN:
-		DEBUG(0, ("PAM: User not known to PAM\n"));
+		ZERODEBUG(0, ("PAM: User not known to PAM\n"));
 		break;
 	case PAM_SUCCESS:
 		DEBUG(4, ("PAM: Account OK for User: %s\n", user));
 		break;
 	default:
-		DEBUG(0, ("PAM: UNKNOWN PAM ERROR (%d) for User: %s\n", pam_error, user));
+		ZERODEBUG(0, ("PAM: UNKNOWN PAM ERROR (%d) for User: %s\n", pam_error, user));
 	}
  
 	if(!smb_pam_error_handler(pamh, pam_error, "Password Change Failed", 2)) {
@@ -795,7 +795,7 @@
 		return NT_STATUS_ACCOUNT_DISABLED;
 
 	if (!NT_STATUS_IS_OK(nt_status = smb_pam_account(pamh, user)))
-		DEBUG(0, ("smb_pam_accountcheck: PAM: Account Validation Failed - Rejecting User %s!\n", user));
+		ZERODEBUG(0, ("smb_pam_accountcheck: PAM: Account Validation Failed - Rejecting User %s!\n", user));
 
 	smb_pam_end(pamh, pconv);
 	return nt_status;
@@ -824,19 +824,19 @@
 		return NT_STATUS_LOGON_FAILURE;
 
 	if (!NT_STATUS_IS_OK(nt_status = smb_pam_auth(pamh, user))) {
-		DEBUG(0, ("smb_pam_passcheck: PAM: smb_pam_auth failed - Rejecting User %s !\n", user));
+		ZERODEBUG(0, ("smb_pam_passcheck: PAM: smb_pam_auth failed - Rejecting User %s !\n", user));
 		smb_pam_end(pamh, pconv);
 		return nt_status;
 	}
 
 	if (!NT_STATUS_IS_OK(nt_status = smb_pam_account(pamh, user))) {
-		DEBUG(0, ("smb_pam_passcheck: PAM: smb_pam_account failed - Rejecting User %s !\n", user));
+		ZERODEBUG(0, ("smb_pam_passcheck: PAM: smb_pam_account failed - Rejecting User %s !\n", user));
 		smb_pam_end(pamh, pconv);
 		return nt_status;
 	}
 
 	if (!NT_STATUS_IS_OK(nt_status = smb_pam_setcred(pamh, user))) {
-		DEBUG(0, ("smb_pam_passcheck: PAM: smb_pam_setcred failed - Rejecting User %s !\n", user));
+		ZERODEBUG(0, ("smb_pam_passcheck: PAM: smb_pam_setcred failed - Rejecting User %s !\n", user));
 		smb_pam_end(pamh, pconv);
 		return nt_status;
 	}
@@ -862,7 +862,7 @@
 		return False;
 
 	if (!smb_pam_chauthtok(pamh, user)) {
-		DEBUG(0, ("smb_pam_passchange: PAM: Password Change Failed for user %s!\n", user));
+		ZERODEBUG(0, ("smb_pam_passchange: PAM: Password Change Failed for user %s!\n", user));
 		smb_pam_end(pamh, pconv);
 		return False;
 	}
diff -Naur samba-2.2.12-orig/source/passdb/pass_check.c samba-2.2.12/source/passdb/pass_check.c
--- samba-2.2.12-orig/source/passdb/pass_check.c	2004-08-12 20:24:27.000000000 +0200
+++ samba-2.2.12/source/passdb/pass_check.c	2009-03-11 09:59:35.000000000 +0100
@@ -119,7 +119,7 @@
 	if (err != error_status_ok)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0, ("DCE can't get current context. %s\n", dce_errstr));
+		ZERODEBUG(0, ("DCE can't get current context. %s\n", dce_errstr));
 
 		return (False);
 	}
@@ -128,7 +128,7 @@
 	if (err != error_status_ok)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0, ("DCE can't get current context. %s\n", dce_errstr));
+		ZERODEBUG(0, ("DCE can't get current context. %s\n", dce_errstr));
 
 		return (False);
 	}
@@ -137,7 +137,7 @@
 	if (err != error_status_ok)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0, ("DCE can't get expiration. %s\n", dce_errstr));
+		ZERODEBUG(0, ("DCE can't get expiration. %s\n", dce_errstr));
 
 		return (False);
 	}
@@ -154,7 +154,7 @@
 		if (err != error_status_ok)
 		{
 			dce_error_inq_text(err, dce_errstr, &err2);
-			DEBUG(0, ("DCE can't get pwent. %s\n", dce_errstr));
+			ZERODEBUG(0, ("DCE can't get pwent. %s\n", dce_errstr));
 
 			return (False);
 		}
@@ -163,7 +163,7 @@
 		if (err != error_status_ok)
 		{
 			dce_error_inq_text(err, dce_errstr, &err2);
-			DEBUG(0, ("DCE can't refresh identity. %s\n",
+			ZERODEBUG(0, ("DCE can't refresh identity. %s\n",
 				  dce_errstr));
 
 			return (False);
@@ -176,7 +176,7 @@
 		if (err != error_status_ok)
 		{
 			dce_error_inq_text(err, dce_errstr, &err2);
-			DEBUG(0, ("DCE can't get key for %s. %s\n",
+			ZERODEBUG(0, ("DCE can't get key for %s. %s\n",
 				  pw->pw_name, dce_errstr));
 
 			return (False);
@@ -188,7 +188,7 @@
 		if (err != error_status_ok)
 		{
 			dce_error_inq_text(err, dce_errstr, &err2);
-			DEBUG(0,
+			ZERODEBUG(0,
 			      ("DCE can't validate and certify identity for %s. %s\n",
 			       pw->pw_name, dce_errstr));
 		}
@@ -197,7 +197,7 @@
 		if (err != error_status_ok)
 		{
 			dce_error_inq_text(err, dce_errstr, &err2);
-			DEBUG(0, ("DCE can't free key.\n", dce_errstr));
+			ZERODEBUG(0, ("DCE can't free key.\n", dce_errstr));
 		}
 	}
 
@@ -206,7 +206,7 @@
 				     &my_dce_sec_context, &err) == 0)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0, ("DCE Setup Identity for %s failed: %s\n",
+		ZERODEBUG(0, ("DCE Setup Identity for %s failed: %s\n",
 			  user, dce_errstr));
 		return (False);
 	}
@@ -216,7 +216,7 @@
 	if (err != error_status_ok)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0, ("DCE can't get pwent. %s\n", dce_errstr));
+		ZERODEBUG(0, ("DCE can't get pwent. %s\n", dce_errstr));
 
 		return (False);
 	}
@@ -225,7 +225,7 @@
 	if (err != error_status_ok)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0, ("DCE can't purge context. %s\n", dce_errstr));
+		ZERODEBUG(0, ("DCE can't purge context. %s\n", dce_errstr));
 
 		return (False);
 	}
@@ -249,7 +249,7 @@
 				     &my_dce_sec_context, &err) == 0)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0, ("DCE Setup Identity for %s failed: %s\n",
+		ZERODEBUG(0, ("DCE Setup Identity for %s failed: %s\n",
 			  user, dce_errstr));
 		goto err;
 	}
@@ -259,7 +259,7 @@
 	if (err != error_status_ok)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0, ("DCE can't get pwent. %s\n", dce_errstr));
+		ZERODEBUG(0, ("DCE can't get pwent. %s\n", dce_errstr));
 		goto err;
 	}
 
@@ -274,7 +274,7 @@
 	if (err != error_status_ok)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0,
+		ZERODEBUG(0,
 		      ("DCE Identity Validation failed for principal %s: %s\n",
 		       user, dce_errstr));
 		goto err;
@@ -284,20 +284,20 @@
 	if (err != error_status_ok)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0, ("DCE certify identity failed: %s\n", dce_errstr));
+		ZERODEBUG(0, ("DCE certify identity failed: %s\n", dce_errstr));
 		goto err;
 	}
 
 	if (auth_src != sec_login_auth_src_network)
 	{
-		DEBUG(0, ("DCE context has no network credentials.\n"));
+		ZERODEBUG(0, ("DCE context has no network credentials.\n"));
 	}
 
 	sec_login_set_context(my_dce_sec_context, &err);
 	if (err != error_status_ok)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0,
+		ZERODEBUG(0,
 		      ("DCE login failed for principal %s, cant set context: %s\n",
 		       user, dce_errstr));
 
@@ -310,11 +310,11 @@
 	if (err != error_status_ok)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0, ("DCE can't get pwent. %s\n", dce_errstr));
+		ZERODEBUG(0, ("DCE can't get pwent. %s\n", dce_errstr));
 		goto err;
 	}
 
-	DEBUG(0, ("DCE login succeeded for principal %s on pid %d\n",
+	ZERODEBUG(0, ("DCE login succeeded for principal %s on pid %d\n",
 		  user, sys_getpid()));
 
 	DEBUG(3, ("DCE principal: %s\n"
@@ -330,14 +330,14 @@
 	if (err != error_status_ok)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0, ("DCE can't get expiration. %s\n", dce_errstr));
+		ZERODEBUG(0, ("DCE can't get expiration. %s\n", dce_errstr));
 		goto err;
 	}
 
 	set_effective_uid(0);
 	set_effective_gid(0);
 
-	DEBUG(0,
+	ZERODEBUG(0,
 	      ("DCE context expires: %s", asctime(localtime(&expire_time))));
 
 	dcelogin_atmost_once = 1;
@@ -361,7 +361,7 @@
 	if (err != error_status_ok)
 	{
 		dce_error_inq_text(err, dce_errstr, &err2);
-		DEBUG(0,
+		ZERODEBUG(0,
 		      ("DCE purge login context failed for server instance %d: %s\n",
 		       sys_getpid(), dce_errstr));
 	}
diff -Naur samba-2.2.12-orig/source/passdb/passdb.c samba-2.2.12/source/passdb/passdb.c
--- samba-2.2.12-orig/source/passdb/passdb.c	2004-08-12 20:24:27.000000000 +0200
+++ samba-2.2.12/source/passdb/passdb.c	2009-03-11 09:59:35.000000000 +0100
@@ -71,7 +71,7 @@
 static BOOL pdb_fill_default_sam(SAM_ACCOUNT *user)
 {
 	if (user == NULL) {
-		DEBUG(0,("pdb_fill_default_sam: SAM_ACCOUNT was NULL\n"));
+		ZERODEBUG(0,("pdb_fill_default_sam: SAM_ACCOUNT was NULL\n"));
 		return False;
 	}
 	
@@ -103,7 +103,7 @@
 BOOL pdb_init_sam(SAM_ACCOUNT **user)
 {
 	if (*user != NULL) {
-		DEBUG(0,("pdb_init_sam: SAM_ACCOUNT was non NULL\n"));
+		ZERODEBUG(0,("pdb_init_sam: SAM_ACCOUNT was non NULL\n"));
 #if 0
 		smb_panic("NULL pointer passed to pdb_init_sam\n");
 #endif
@@ -113,7 +113,7 @@
 	*user=(SAM_ACCOUNT *)malloc(sizeof(SAM_ACCOUNT));
 	
 	if (*user==NULL) {
-		DEBUG(0,("pdb_init_sam: error while allocating memory\n"));
+		ZERODEBUG(0,("pdb_init_sam: error while allocating memory\n"));
 		return False;
 	}
 
@@ -159,7 +159,7 @@
 static BOOL pdb_free_sam_contents(SAM_ACCOUNT *user)
 {
 	if (user == NULL) {
-		DEBUG(0,("pdb_free_sam_contents: SAM_ACCOUNT was NULL\n"));
+		ZERODEBUG(0,("pdb_free_sam_contents: SAM_ACCOUNT was NULL\n"));
 #if 0
 		smb_panic("NULL pointer passed to pdb_free_sam\n");
 #endif
@@ -184,7 +184,7 @@
 BOOL pdb_reset_sam(SAM_ACCOUNT *user)
 {
 	if (user == NULL) {
-		DEBUG(0,("pdb_reset_sam: SAM_ACCOUNT was NULL\n"));
+		ZERODEBUG(0,("pdb_reset_sam: SAM_ACCOUNT was NULL\n"));
 		return False;
 	}
 	
@@ -207,7 +207,7 @@
 BOOL pdb_free_sam(SAM_ACCOUNT *user)
 {
 	if (user == NULL) {
-		DEBUG(0,("pdb_free_sam: SAM_ACCOUNT was NULL\n"));
+		ZERODEBUG(0,("pdb_free_sam: SAM_ACCOUNT was NULL\n"));
 #if 0
 		smb_panic("NULL pointer passed to pdb_free_sam\n");
 #endif
@@ -1741,7 +1741,7 @@
 	fstring		name;
 
 	if (user==NULL) {
-		DEBUG(0,("pdb_getsampwuid: SAM_ACCOUNT is NULL.\n"));
+		ZERODEBUG(0,("pdb_getsampwuid: SAM_ACCOUNT is NULL.\n"));
 		return False;
 	}
 
@@ -1751,7 +1751,7 @@
 	 */
 	 
 	if ((pw=sys_getpwuid(uid)) == NULL)  {
-		DEBUG(0,("pdb_getsampwuid: getpwuid(%u) return NULL. User does not exist in Unix accounts!\n",
+		ZERODEBUG(0,("pdb_getsampwuid: getpwuid(%u) return NULL. User does not exist in Unix accounts!\n",
 					(unsigned int)uid));
 		return False;
 	}
diff -Naur samba-2.2.12-orig/source/passdb/passgrp.c samba-2.2.12/source/passdb/passgrp.c
--- samba-2.2.12-orig/source/passdb/passgrp.c	2004-08-12 20:24:27.000000000 +0200
+++ samba-2.2.12/source/passdb/passgrp.c	2009-03-11 09:59:35.000000000 +0100
@@ -90,7 +90,7 @@
 
 	if (fp == NULL)
 	{
-		DEBUG(0, ("unable to open smb passgrp database.\n"));
+		ZERODEBUG(0, ("unable to open smb passgrp database.\n"));
 		return NULL;
 	}
 
@@ -125,7 +125,7 @@
 
 	if (fp == NULL)
 	{
-		DEBUG(0, ("unable to open smb passgrp database.\n"));
+		ZERODEBUG(0, ("unable to open smb passgrp database.\n"));
 		return NULL;
 	}
 
diff -Naur samba-2.2.12-orig/source/passdb/pdb_ldap.c samba-2.2.12/source/passdb/pdb_ldap.c
--- samba-2.2.12-orig/source/passdb/pdb_ldap.c	2004-08-12 20:24:27.000000000 +0200
+++ samba-2.2.12/source/passdb/pdb_ldap.c	2009-03-11 10:04:13.000000000 +0100
@@ -127,14 +127,14 @@
 	 */
 	
 	if ( (pass=sys_getpwuid(uid)) == NULL ) {
-		DEBUG(0,("ldap_open_connection: Can't determine user of running process!\n"));
+		ZERODEBUG(0,("ldap_open_connection: Can't determine user of running process!\n"));
 		return False;
 	}
 
 	/* check that the user is in the domain admin group for connecting */
 
 	if ( (uid != 0) && !user_in_list(pass->pw_name, lp_domain_admin_group()) ) {
-		DEBUG(0, ("ldap_open_connection: cannot access LDAP when not root or a member of domain admin group..\n"));
+		ZERODEBUG(0, ("ldap_open_connection: cannot access LDAP when not root or a member of domain admin group..\n"));
 		return False;
 	}
 
@@ -149,7 +149,7 @@
 		lp_ldap_server(), port ));
 		
 	if ((*ldap_struct = ldap_init(lp_ldap_server(), port)) == NULL)	{
-		DEBUG(0, ("The LDAP server is not responding !\n"));
+		ZERODEBUG(0, ("The LDAP server is not responding !\n"));
 		return False;
 	}
 
@@ -179,13 +179,13 @@
 			}
 			if ((rc = ldap_start_tls_s (*ldap_struct, NULL, NULL)) != LDAP_SUCCESS)
 			{
-				DEBUG(0,("Failed to issue the StartTLS instruction: %s\n",
+				ZERODEBUG(0,("Failed to issue the StartTLS instruction: %s\n",
 				       ldap_err2string(rc)));
 				return False;
 			}
 			DEBUG (2, ("StartTLS issued: using a TLS connection\n"));
 #else
-			DEBUG(0,("ldap_open_connection: StartTLS not supported by LDAP client libraries!\n"));
+			ZERODEBUG(0,("ldap_open_connection: StartTLS not supported by LDAP client libraries!\n"));
                         return False;
 #endif
 			break;
@@ -195,12 +195,12 @@
 			tls = LDAP_OPT_X_TLS_HARD;
 			if (ldap_set_option (*ldap_struct, LDAP_OPT_X_TLS, &tls) != LDAP_SUCCESS)
 			{
-				DEBUG(0, ("Failed to setup a TLS session\n"));
+				ZERODEBUG(0, ("Failed to setup a TLS session\n"));
 			}
 			
-			DEBUG(0,("LDAPS option set...!\n"));
+			ZERODEBUG(0,("LDAPS option set...!\n"));
 #else
-			DEBUG(0,("ldap_open_connection: Secure connection not supported by LDAP client libraries!\n"));
+			ZERODEBUG(0,("ldap_open_connection: Secure connection not supported by LDAP client libraries!\n"));
 			return False;
 #endif
 			break;
@@ -304,7 +304,7 @@
 	/* get the password if we don't have it already */
 	if (!got_pw && !(got_pw=fetch_ldap_pw(lp_ldap_admin_dn(), ldap_secret, sizeof(pstring)))) 
 	{
-		DEBUG(0, ("ldap_connect_system: Failed to retrieve password for %s from secrets.tdb\n",
+		ZERODEBUG(0, ("ldap_connect_system: Failed to retrieve password for %s from secrets.tdb\n",
 			lp_ldap_admin_dn()));
 		return False;
 	}
@@ -312,7 +312,7 @@
 	/* removed the sasl_bind_s "EXTERNAL" stuff, as my testsuite 
 	   (OpenLDAP) doesnt' seem to support it */
 
-	DEBUG(0,("ldap_connect_system: Binding to ldap server as \"%s\"\n",
+	ZERODEBUG(0,("ldap_connect_system: Binding to ldap server as \"%s\"\n",
 		lp_ldap_admin_dn()));
 	   
 #if LDAP_SET_REBIND_PROC_ARGS == 2 
@@ -324,7 +324,7 @@
 	if ((rc = ldap_simple_bind_s(ldap_struct, lp_ldap_admin_dn(), 
 		ldap_secret)) != LDAP_SUCCESS)
 	{
-		DEBUG(0, ("Bind failed: %s\n", ldap_err2string(rc)));
+		ZERODEBUG(0, ("Bind failed: %s\n", ldap_err2string(rc)));
 		return False;
 	}
 	
@@ -345,7 +345,7 @@
 	rc = ldap_search_s(ldap_struct, lp_ldap_suffix (), scope, (char*)filter, attribs, 0, result);
 
 	if (rc != LDAP_SUCCESS)	{
-		DEBUG(0,("ldap_search_one_user: Problem during the LDAP search: %s\n", 
+		ZERODEBUG(0,("ldap_search_one_user: Problem during the LDAP search: %s\n", 
 			ldap_err2string (rc)));
 		DEBUG(3,("ldap_search_one_user: Query was: %s, %s\n", lp_ldap_suffix(), 
 			filter));
@@ -467,7 +467,7 @@
 		mods = (LDAPMod **) malloc(sizeof(LDAPMod *));
 		if (mods == NULL)
 		{
-			DEBUG(0, ("make_a_mod: out of memory!\n"));
+			ZERODEBUG(0, ("make_a_mod: out of memory!\n"));
 			return;
 		}
 		mods[0] = NULL;
@@ -483,13 +483,13 @@
 		mods = (LDAPMod **) Realloc (mods, (i + 2) * sizeof (LDAPMod *));
 		if (mods == NULL)
 		{
-			DEBUG(0, ("make_a_mod: out of memory!\n"));
+			ZERODEBUG(0, ("make_a_mod: out of memory!\n"));
 			return;
 		}
 		mods[i] = (LDAPMod *) malloc(sizeof(LDAPMod));
 		if (mods[i] == NULL)
 		{
-			DEBUG(0, ("make_a_mod: out of memory!\n"));
+			ZERODEBUG(0, ("make_a_mod: out of memory!\n"));
 			return;
 		}
 		mods[i]->mod_op = modop;
@@ -508,7 +508,7 @@
 					       (j + 2) * sizeof (char *));
 					       
 		if (mods[i]->mod_values == NULL) {
-			DEBUG (0, ("make_a_mod: Memory allocation failure!\n"));
+			ZERODEBUG (0, ("make_a_mod: Memory allocation failure!\n"));
 			return;
 		}
 		mods[i]->mod_values[j] = strdup(value);
@@ -853,7 +853,7 @@
 
 	if (rc != LDAP_SUCCESS)
 	{
-		DEBUG(0, ("LDAP search failed: %s\n", ldap_err2string(rc)));
+		ZERODEBUG(0, ("LDAP search failed: %s\n", ldap_err2string(rc)));
 		DEBUG(3, ("Query was: %s, %s\n", lp_ldap_suffix(), filter));
 		ldap_msgfree(global_ldap_ent.result);
 		ldap_unbind(global_ldap_ent.ldap_struct);
@@ -936,7 +936,7 @@
 
 		pstrcpy(filter, lp_ldap_filter());
 		standard_sub_advanced(-1, sname, "", -1, filter, sizeof(filter));
-		DEBUG(0,("LDAP search \"%s\" returned %d entries.\n",  filter, 
+		ZERODEBUG(0,("LDAP search \"%s\" returned %d entries.\n",  filter, 
 		       ldap_count_entries(ldap_struct, result)));
 		ldap_unbind(ldap_struct);
 		return False;
@@ -983,7 +983,7 @@
 
 	if (ldap_count_entries(ldap_struct, result) < 1)
 	{
-		DEBUG(0,
+		ZERODEBUG(0,
 		      ("We don't find this rid [%i] count=%d\n", rid,
 		       ldap_count_entries(ldap_struct, result)));
 		ldap_unbind(ldap_struct);
@@ -1026,13 +1026,13 @@
 	
 	if (!ldap_connect_system (ldap_struct)) {
 		ldap_unbind (ldap_struct);
-		DEBUG(0, ("Failed to delete user %s from LDAP.\n", sname));
+		ZERODEBUG(0, ("Failed to delete user %s from LDAP.\n", sname));
 		return False;
 	}
 
 	rc = ldap_search_one_user_by_name (ldap_struct, sname, &result);
 	if (ldap_count_entries (ldap_struct, result) == 0) {
-		DEBUG (0, ("User doesn't exit!\n"));
+		ZERODEBUG (0, ("User doesn't exit!\n"));
 		ldap_msgfree (result);
 		ldap_unbind (ldap_struct);
 		return False;
@@ -1047,7 +1047,7 @@
 	if (rc != LDAP_SUCCESS) {
 		char *ld_error;
 		ldap_get_option (ldap_struct, LDAP_OPT_ERROR_STRING, &ld_error);
-		DEBUG (0,("failed to delete user with uid = %s with: %s\n\t%s\n",
+		ZERODEBUG (0,("failed to delete user with uid = %s with: %s\n\t%s\n",
 			sname, ldap_err2string (rc), ld_error));
 		free (ld_error);
 		ldap_unbind (ldap_struct);
@@ -1084,7 +1084,7 @@
 					  pdb_get_username(newpwd), &result);
 
 	if (ldap_count_entries(ldap_struct, result) == 0) {
-		DEBUG(0, ("No user to modify!\n"));
+		ZERODEBUG(0, ("No user to modify!\n"));
 		ldap_msgfree(result);
 		ldap_unbind(ldap_struct);
 		return False;
@@ -1101,7 +1101,7 @@
 		char *ld_error;
 		ldap_get_option(ldap_struct, LDAP_OPT_ERROR_STRING,
 				&ld_error);
-		DEBUG(0,
+		ZERODEBUG(0,
 		      ("failed to modify user with uid = %s with: %s\n\t%s\n",
 		       pdb_get_username(newpwd), ldap_err2string(rc),
 		       ld_error));
@@ -1143,7 +1143,7 @@
 	rc = ldap_search_one_user_by_name (ldap_struct, pdb_get_username(newpwd), &result);
 
 	if (ldap_count_entries(ldap_struct, result) != 0) {
-		DEBUG(0,("User already in the base, with samba properties\n"));
+		ZERODEBUG(0,("User already in the base, with samba properties\n"));
 		ldap_msgfree(result);
 		ldap_unbind(ldap_struct);
 		return False;
@@ -1155,7 +1155,7 @@
 	num_result = ldap_count_entries(ldap_struct, result);
 	
 	if (num_result > 1) {
-		DEBUG (0, ("More than one user with that uid exists: bailing out!\n"));
+		ZERODEBUG (0, ("More than one user with that uid exists: bailing out!\n"));
 		return False;
 	}
 	
@@ -1193,7 +1193,7 @@
 		char *ld_error;
 
 		ldap_get_option (ldap_struct, LDAP_OPT_ERROR_STRING, &ld_error);
-		DEBUG(0,("failed to modify user with uid = %s with: %s\n\t%s\n",
+		ZERODEBUG(0,("failed to modify user with uid = %s with: %s\n\t%s\n",
 			pdb_get_username(newpwd), ldap_err2string (rc), ld_error));
 		free(ld_error);
 		ldap_mods_free(mods, 1);
diff -Naur samba-2.2.12-orig/source/passdb/pdb_nisplus.c samba-2.2.12/source/passdb/pdb_nisplus.c
--- samba-2.2.12-orig/source/passdb/pdb_nisplus.c	2004-08-12 20:24:27.000000000 +0200
+++ samba-2.2.12/source/passdb/pdb_nisplus.c	2009-03-11 09:59:35.000000000 +0100
@@ -403,7 +403,7 @@
     pdb_set_acct_ctrl(pw_buf, pdb_get_acct_ctrl(pw_buf) | ACB_PWNOTREQ);
   } else {
     if (strlen(ptr) != 32 || !pdb_gethexpwd(ptr, smbpwd)) {
-      DEBUG(0, ("malformed LM pwd entry: %s.\n",
+      ZERODEBUG(0, ("malformed LM pwd entry: %s.\n",
 		pdb_get_username(pw_buf)));
       return False;
     } 
@@ -419,7 +419,7 @@
   if (!(pdb_get_acct_ctrl(pw_buf) & ACB_PWNOTREQ) &&
       strncasecmp(ptr, "NO PASSWORD", 11)) {
     if (strlen(ptr) != 32 || !pdb_gethexpwd(ptr, smbntpwd)) {
-      DEBUG(0, ("malformed NT pwd entry:\
+      ZERODEBUG(0, ("malformed NT pwd entry:\
  uid = %d.\n",
 		pdb_get_uid(pw_buf)));
       return False;
@@ -456,7 +456,7 @@
 
 	if (result->status != NIS_SUCCESS && result->status != NIS_NOTFOUND)
 	{
-		DEBUG(0, ("NIS+ lookup failure: %s\n",
+		ZERODEBUG(0, ("NIS+ lookup failure: %s\n",
 		           nis_sperrno(result->status)));
 		return False;
 	}
@@ -906,7 +906,7 @@
 
 	  if (gotalarm)
 	  {
-		DEBUG(0,("NIS+ lookup time out\n"));
+		ZERODEBUG(0,("NIS+ lookup time out\n"));
 		nis_freeresult(result);
 		return NULL;
 	  }
@@ -956,7 +956,7 @@
   nis_result *result = global_nisp_ent.result;
   
   if (user==NULL) {
-	DEBUG(0,("SAM_ACCOUNT is NULL.\n"));
+	ZERODEBUG(0,("SAM_ACCOUNT is NULL.\n"));
 	return False;
   }
 
@@ -968,7 +968,7 @@
 
   if(!make_sam_from_nisp_object(user, &NIS_RES_OBJECT(result)[enum_entry]) )
   {
-    DEBUG(0,("Bad SAM_ACCOUNT entry returned from NIS+!\n"));
+    ZERODEBUG(0,("Bad SAM_ACCOUNT entry returned from NIS+!\n"));
 	return False;
   }
   (int)(global_nisp_ent.enum_entry)++;
@@ -989,7 +989,7 @@
 
 	if (!*pfile)
 	{
-		DEBUG(0, ("No SMB password file set\n"));
+		ZERODEBUG(0, ("No SMB password file set\n"));
 		return False;
 	}
 
@@ -1021,7 +1021,7 @@
 
 	if (!*pfile)
 	{
-		DEBUG(0, ("no SMB password file set\n"));
+		ZERODEBUG(0, ("no SMB password file set\n"));
 		return False;
 	}
 
@@ -1055,7 +1055,7 @@
   
   if (!*pfile)
     {
-      DEBUG(0, ("no SMB password file set\n"));
+      ZERODEBUG(0, ("no SMB password file set\n"));
       return False;
     }
   
@@ -1071,7 +1071,7 @@
   
   if(result->status != NIS_SUCCESS || NIS_RES_NUMOBJ(result) <= 0) {
     /* User not found. */
-    DEBUG(0,("user not found in NIS+\n"));
+    ZERODEBUG(0,("user not found in NIS+\n"));
     nis_freeresult(result);
     return False;
   }
@@ -1087,7 +1087,7 @@
   nis_freeresult(result);
 
   if(delresult->status != NIS_SUCCESS) {
-    DEBUG(0, ("NIS+ table update failed: %s %s\n",
+    ZERODEBUG(0, ("NIS+ table update failed: %s %s\n",
           nisname, nis_sperrno(delresult->status)));
     nis_freeresult(delresult);
     return False;
@@ -1245,7 +1245,7 @@
   ta_maxcol = obj->TA_data.ta_maxcol;
   
   if(!(ecol = (entry_col*)malloc(ta_maxcol*sizeof(entry_col)))) {
-    DEBUG(0, ("memory allocation failure\n"));
+    ZERODEBUG(0, ("memory allocation failure\n"));
     nis_freeresult(tblresult);
     return False;
   }
@@ -1292,7 +1292,7 @@
 
   if (!*pfile)
     {
-      DEBUG(0, ("no SMB password file set\n"));
+      ZERODEBUG(0, ("no SMB password file set\n"));
       return False;
     }
   
@@ -1310,7 +1310,7 @@
   
   if(result->status != NIS_SUCCESS || NIS_RES_NUMOBJ(result) <= 0) {
     /* User not found. */
-    DEBUG(0,("user not found in NIS+\n"));
+    ZERODEBUG(0,("user not found in NIS+\n"));
     nis_freeresult(result);
     return False;
   }
@@ -1327,7 +1327,7 @@
   ta_maxcol = obj->TA_data.ta_maxcol;
   
   if(!(ecol = (entry_col*)malloc(ta_maxcol*sizeof(entry_col)))) {
-    DEBUG(0, ("memory allocation failure\n"));
+    ZERODEBUG(0, ("memory allocation failure\n"));
     nis_freeresult(result);
     return False;
   }
@@ -1347,7 +1347,7 @@
 		  MOD_SAMEOBJ | FOLLOW_PATH | EXPAND_NAME | HARD_LOOKUP);
   
     if(addresult->status != NIS_SUCCESS) {
-      DEBUG(0, ("NIS+ table update failed: %s %s\n",
+      ZERODEBUG(0, ("NIS+ table update failed: %s %s\n",
 		nisname, nis_sperrno(addresult->status)));
       nis_freeresult(addresult);
       nis_freeresult(result);
diff -Naur samba-2.2.12-orig/source/passdb/pdb_smbpasswd.c samba-2.2.12/source/passdb/pdb_smbpasswd.c
--- samba-2.2.12-orig/source/passdb/pdb_smbpasswd.c	2004-08-12 20:24:27.000000000 +0200
+++ samba-2.2.12/source/passdb/pdb_smbpasswd.c	2009-03-11 09:59:35.000000000 +0100
@@ -127,7 +127,7 @@
   int lock_type = F_RDLCK;
 
   if (!*pfile) {
-    DEBUG(0, ("startsmbfilepwent: No SMB password file set\n"));
+    ZERODEBUG(0, ("startsmbfilepwent: No SMB password file set\n"));
     return (NULL);
   }
 
@@ -153,7 +153,7 @@
         sys_usleep(200); /* Spin, spin... */
       }
       if(fd == -1) {
-        DEBUG(0,("startsmbfilepwent_internal: too many race conditions creating file %s\n", pfile));
+        ZERODEBUG(0,("startsmbfilepwent_internal: too many race conditions creating file %s\n", pfile));
         return NULL;
       }
       close(fd);
@@ -172,7 +172,7 @@
     }
 
     if (!pw_file_lock(fileno(fp), lock_type, 5, lock_depth)) {
-      DEBUG(0, ("startsmbfilepwent_internal: unable to lock file %s. Error was %s\n", pfile, strerror(errno) ));
+      ZERODEBUG(0, ("startsmbfilepwent_internal: unable to lock file %s. Error was %s\n", pfile, strerror(errno) ));
       fclose(fp);
       return NULL;
     }
@@ -196,14 +196,14 @@
        */
 
       if (sys_stat(pfile,&sbuf1) != 0) {
-        DEBUG(0, ("startsmbfilepwent_internal: unable to stat file %s. Error was %s\n", pfile, strerror(errno)));
+        ZERODEBUG(0, ("startsmbfilepwent_internal: unable to stat file %s. Error was %s\n", pfile, strerror(errno)));
         pw_file_unlock(fileno(fp), lock_depth);
         fclose(fp);
         return NULL;
       }
 
       if (sys_fstat(fileno(fp),&sbuf2) != 0) {
-        DEBUG(0, ("startsmbfilepwent_internal: unable to fstat file %s. Error was %s\n", pfile, strerror(errno)));
+        ZERODEBUG(0, ("startsmbfilepwent_internal: unable to fstat file %s. Error was %s\n", pfile, strerror(errno)));
         pw_file_unlock(fileno(fp), lock_depth);
         fclose(fp);
         return NULL;
@@ -224,7 +224,7 @@
   }
 
   if(race_loop == 5) {
-    DEBUG(0, ("startsmbfilepwent_internal: too many race conditions opening file %s\n", pfile));
+    ZERODEBUG(0, ("startsmbfilepwent_internal: too many race conditions opening file %s\n", pfile));
     return NULL;
   }
 
@@ -233,7 +233,7 @@
 
   /* Make sure it is only rw by the owner */
   if(fchmod(fileno(fp), S_IRUSR|S_IWUSR) == -1) {
-    DEBUG(0, ("startsmbfilepwent_internal: failed to set 0600 permissions on password file %s. \
+    ZERODEBUG(0, ("startsmbfilepwent_internal: failed to set 0600 permissions on password file %s. \
 Error was %s\n.", pfile, strerror(errno) ));
     pw_file_unlock(fileno(fp), lock_depth);
     fclose(fp);
@@ -277,7 +277,7 @@
   size_t            linebuf_len;
 
   if(fp == NULL) {
-    DEBUG(0,("getsmbfilepwent: Bad password file pointer.\n"));
+    ZERODEBUG(0,("getsmbfilepwent: Bad password file pointer.\n"));
     return NULL;
   }
 
@@ -341,7 +341,7 @@
     }
     p = (unsigned char *) strchr(linebuf, ':');
     if (p == NULL) {
-      DEBUG(0, ("getsmbfilepwent: malformed password entry (no :)\n"));
+      ZERODEBUG(0, ("getsmbfilepwent: malformed password entry (no :)\n"));
       continue;
     }
     /*
@@ -356,12 +356,12 @@
     p++;		/* Go past ':' */
 
     if(*p == '-') {
-      DEBUG(0, ("getsmbfilepwent: uids in the smbpasswd file must not be negative.\n"));
+      ZERODEBUG(0, ("getsmbfilepwent: uids in the smbpasswd file must not be negative.\n"));
       continue;
     }
 
     if (!isdigit(*p)) {
-      DEBUG(0, ("getsmbfilepwent: malformed password entry (uid not number)\n"));
+      ZERODEBUG(0, ("getsmbfilepwent: malformed password entry (uid not number)\n"));
       continue;
     }
 
@@ -371,7 +371,7 @@
       p++;
 
     if (*p != ':') {
-      DEBUG(0, ("getsmbfilepwent: malformed password entry (no : after uid)\n"));
+      ZERODEBUG(0, ("getsmbfilepwent: malformed password entry (no : after uid)\n"));
       continue;
     }
 
@@ -397,12 +397,12 @@
     }
 
     if (linebuf_len < (PTR_DIFF(p, linebuf) + 33)) {
-      DEBUG(0, ("getsmbfilepwent: malformed password entry (passwd too short)\n"));
+      ZERODEBUG(0, ("getsmbfilepwent: malformed password entry (passwd too short)\n"));
       continue;
     }
 
     if (p[32] != ':') {
-      DEBUG(0, ("getsmbfilepwent: malformed password entry (no terminating :)\n"));
+      ZERODEBUG(0, ("getsmbfilepwent: malformed password entry (no terminating :)\n"));
       continue;
     }
 
@@ -411,7 +411,7 @@
       pw_buf.acct_ctrl |= ACB_PWNOTREQ;
     } else {
       if (!pdb_gethexpwd((char *)p, smbpwd)) {
-        DEBUG(0, ("getsmbfilepwent: Malformed Lanman password entry (non hex chars)\n"));
+        ZERODEBUG(0, ("getsmbfilepwent: Malformed Lanman password entry (non hex chars)\n"));
         continue;
       }
       pw_buf.smb_passwd = smbpwd;
@@ -502,7 +502,7 @@
   new_entry_length = strlen(newpwd->smb_name) + 1 + 15 + 1 + 32 + 1 + 32 + 1 + NEW_PW_FORMAT_SPACE_PADDED_LEN + 1 + 13 + 2;
 
   if((new_entry = (char *)malloc( new_entry_length )) == NULL) {
-    DEBUG(0, ("format_new_smbpasswd_entry: Malloc failed adding entry for user %s.\n", newpwd->smb_name ));
+    ZERODEBUG(0, ("format_new_smbpasswd_entry: Malloc failed adding entry for user %s.\n", newpwd->smb_name ));
     return NULL;
   }
 
@@ -572,7 +572,7 @@
   }
 
   if (fp == NULL) {
-    DEBUG(0, ("add_smbfilepwd_entry: unable to open file.\n"));
+    ZERODEBUG(0, ("add_smbfilepwd_entry: unable to open file.\n"));
     return False;
   }
 
@@ -584,7 +584,7 @@
   {
     if (strequal(newpwd->smb_name, pwd->smb_name)) 
     {
-      	DEBUG(0, ("add_smbfilepwd_entry: entry with name %s already exists\n", pwd->smb_name));
+      	ZERODEBUG(0, ("add_smbfilepwd_entry: entry with name %s already exists\n", pwd->smb_name));
       	endsmbfilepwent(fp, &pw_file_lock_depth);
       	return False;
     }
@@ -601,7 +601,7 @@
 
   if((offpos = sys_lseek(fd, 0, SEEK_END)) == -1) 
   {
-    	DEBUG(0, ("add_smbfilepwd_entry(sys_lseek): Failed to add entry for user %s to file %s. \
+    	ZERODEBUG(0, ("add_smbfilepwd_entry(sys_lseek): Failed to add entry for user %s to file %s. \
 Error was %s\n", newpwd->smb_name, pfile, strerror(errno)));
     	endsmbfilepwent(fp, &pw_file_lock_depth);
     	return False;
@@ -609,7 +609,7 @@
 
   if((new_entry = format_new_smbpasswd_entry(newpwd)) == NULL) 
   {
-    	DEBUG(0, ("add_smbfilepwd_entry(malloc): Failed to add entry for user %s to file %s. \
+    	ZERODEBUG(0, ("add_smbfilepwd_entry(malloc): Failed to add entry for user %s to file %s. \
 Error was %s\n", newpwd->smb_name, pfile, strerror(errno)));
 	endsmbfilepwent(fp, &pw_file_lock_depth);
     	return False;
@@ -624,13 +624,13 @@
 
   if ((wr_len = write(fd, new_entry, new_entry_length)) != new_entry_length) 
   {
-  	DEBUG(0, ("add_smbfilepwd_entry(write): %d Failed to add entry for user %s to file %s. \
+  	ZERODEBUG(0, ("add_smbfilepwd_entry(write): %d Failed to add entry for user %s to file %s. \
 Error was %s\n", wr_len, newpwd->smb_name, pfile, strerror(errno)));
 
     	/* Remove the entry we just wrote. */
     	if(sys_ftruncate(fd, offpos) == -1) 
 	{
-      		DEBUG(0, ("add_smbfilepwd_entry: ERROR failed to ftruncate file %s. \
+      		ZERODEBUG(0, ("add_smbfilepwd_entry: ERROR failed to ftruncate file %s. \
 Error was %s. Password file may be corrupt ! Please examine by hand !\n", 
 		newpwd->smb_name, strerror(errno)));
     	}
@@ -679,7 +679,7 @@
   int fd;
 
   if (!*pfile) {
-    DEBUG(0, ("No SMB password file set\n"));
+    ZERODEBUG(0, ("No SMB password file set\n"));
     return False;
   }
   DEBUG(10, ("mod_smbfilepwd_entry: opening file %s\n", pfile));
@@ -687,7 +687,7 @@
   fp = sys_fopen(pfile, "r+");
 
   if (fp == NULL) {
-    DEBUG(0, ("mod_smbfilepwd_entry: unable to open file %s\n", pfile));
+    ZERODEBUG(0, ("mod_smbfilepwd_entry: unable to open file %s\n", pfile));
     return False;
   }
   /* Set a buffer to do more efficient reads */
@@ -696,7 +696,7 @@
   lockfd = fileno(fp);
 
   if (!pw_file_lock(lockfd, F_WRLCK, 5, &pw_file_lock_depth)) {
-    DEBUG(0, ("mod_smbfilepwd_entry: unable to lock file %s\n", pfile));
+    ZERODEBUG(0, ("mod_smbfilepwd_entry: unable to lock file %s\n", pfile));
     fclose(fp);
     return False;
   }
@@ -767,7 +767,7 @@
     p = (unsigned char *) strchr(linebuf, ':');
 
     if (p == NULL) {
-      DEBUG(0, ("mod_smbfilepwd_entry: malformed password entry (no :)\n"));
+      ZERODEBUG(0, ("mod_smbfilepwd_entry: malformed password entry (no :)\n"));
       continue;
     }
 
@@ -795,7 +795,7 @@
   p++;		/* Go past ':' */
 
   if (!isdigit(*p)) {
-    DEBUG(0, ("mod_smbfilepwd_entry: malformed password entry (uid not number)\n"));
+    ZERODEBUG(0, ("mod_smbfilepwd_entry: malformed password entry (uid not number)\n"));
     pw_file_unlock(lockfd, &pw_file_lock_depth);
     fclose(fp);
     return False;
@@ -804,7 +804,7 @@
   while (*p && isdigit(*p))
     p++;
   if (*p != ':') {
-    DEBUG(0, ("mod_smbfilepwd_entry: malformed password entry (no : after uid)\n"));
+    ZERODEBUG(0, ("mod_smbfilepwd_entry: malformed password entry (no : after uid)\n"));
     pw_file_unlock(lockfd, &pw_file_lock_depth);
     fclose(fp);
     return False;
@@ -829,14 +829,14 @@
   }
 
   if (linebuf_len < (PTR_DIFF(p, linebuf) + 33)) {
-    DEBUG(0, ("mod_smbfilepwd_entry: malformed password entry (passwd too short)\n"));
+    ZERODEBUG(0, ("mod_smbfilepwd_entry: malformed password entry (passwd too short)\n"));
     pw_file_unlock(lockfd,&pw_file_lock_depth);
     fclose(fp);
     return (False);
   }
 
   if (p[32] != ':') {
-    DEBUG(0, ("mod_smbfilepwd_entry: malformed password entry (no terminating :)\n"));
+    ZERODEBUG(0, ("mod_smbfilepwd_entry: malformed password entry (no terminating :)\n"));
     pw_file_unlock(lockfd,&pw_file_lock_depth);
     fclose(fp);
     return False;
@@ -853,14 +853,14 @@
   p += 33; /* Move to the first character of the line after
               the lanman password. */
   if (linebuf_len < (PTR_DIFF(p, linebuf) + 33)) {
-    DEBUG(0, ("mod_smbfilepwd_entry: malformed password entry (passwd too short)\n"));
+    ZERODEBUG(0, ("mod_smbfilepwd_entry: malformed password entry (passwd too short)\n"));
     pw_file_unlock(lockfd,&pw_file_lock_depth);
     fclose(fp);
     return (False);
   }
 
   if (p[32] != ':') {
-    DEBUG(0, ("mod_smbfilepwd_entry: malformed password entry (no terminating :)\n"));
+    ZERODEBUG(0, ("mod_smbfilepwd_entry: malformed password entry (no terminating :)\n"));
     pw_file_unlock(lockfd,&pw_file_lock_depth);
     fclose(fp);
     return False;
@@ -988,7 +988,7 @@
 #endif
 
   if(wr_len > sizeof(linebuf)) {
-    DEBUG(0, ("mod_smbfilepwd_entry: line to write (%d) is too long.\n", wr_len+1));
+    ZERODEBUG(0, ("mod_smbfilepwd_entry: line to write (%d) is too long.\n", wr_len+1));
     pw_file_unlock(lockfd,&pw_file_lock_depth);
     fclose(fp);
     return (False);
@@ -1006,7 +1006,7 @@
   fd = fileno(fp);
 
   if (sys_lseek(fd, pwd_seekpos - 1, SEEK_SET) != pwd_seekpos - 1) {
-    DEBUG(0, ("mod_smbfilepwd_entry: seek fail on file %s.\n", pfile));
+    ZERODEBUG(0, ("mod_smbfilepwd_entry: seek fail on file %s.\n", pfile));
     pw_file_unlock(lockfd,&pw_file_lock_depth);
     fclose(fp);
     return False;
@@ -1014,28 +1014,28 @@
 
   /* Sanity check - ensure the areas we are writing are framed by ':' */
   if (read(fd, linebuf, wr_len+1) != wr_len+1) {
-    DEBUG(0, ("mod_smbfilepwd_entry: read fail on file %s.\n", pfile));
+    ZERODEBUG(0, ("mod_smbfilepwd_entry: read fail on file %s.\n", pfile));
     pw_file_unlock(lockfd,&pw_file_lock_depth);
     fclose(fp);
     return False;
   }
 
   if ((linebuf[0] != ':') || (linebuf[wr_len] != ':'))	{
-    DEBUG(0, ("mod_smbfilepwd_entry: check on passwd file %s failed.\n", pfile));
+    ZERODEBUG(0, ("mod_smbfilepwd_entry: check on passwd file %s failed.\n", pfile));
     pw_file_unlock(lockfd,&pw_file_lock_depth);
     fclose(fp);
     return False;
   }
  
   if (sys_lseek(fd, pwd_seekpos, SEEK_SET) != pwd_seekpos) {
-    DEBUG(0, ("mod_smbfilepwd_entry: seek fail on file %s.\n", pfile));
+    ZERODEBUG(0, ("mod_smbfilepwd_entry: seek fail on file %s.\n", pfile));
     pw_file_unlock(lockfd,&pw_file_lock_depth);
     fclose(fp);
     return False;
   }
 
   if (write(fd, ascii_p16, wr_len) != wr_len) {
-    DEBUG(0, ("mod_smbfilepwd_entry: write failed in passwd file %s\n", pfile));
+    ZERODEBUG(0, ("mod_smbfilepwd_entry: write failed in passwd file %s\n", pfile));
     pw_file_unlock(lockfd,&pw_file_lock_depth);
     fclose(fp);
     return False;
@@ -1068,7 +1068,7 @@
    */
 
   if((fp = startsmbfilepwent(pfile, PWF_UPDATE, &pw_file_lock_depth)) == NULL) {
-    DEBUG(0, ("del_smbfilepwd_entry: unable to open file %s.\n", pfile));
+    ZERODEBUG(0, ("del_smbfilepwd_entry: unable to open file %s.\n", pfile));
     return False;
   }
 
@@ -1076,7 +1076,7 @@
    * Create the replacement password file.
    */
   if((fp_write = startsmbfilepwent(pfile2, PWF_CREATE, &pfile2_lockdepth)) == NULL) {
-    DEBUG(0, ("del_smbfilepwd_entry: unable to open file %s.\n", pfile));
+    ZERODEBUG(0, ("del_smbfilepwd_entry: unable to open file %s.\n", pfile));
     endsmbfilepwent(fp, &pw_file_lock_depth);
     return False;
   }
@@ -1100,7 +1100,7 @@
 
     if((new_entry = format_new_smbpasswd_entry(pwd)) == NULL) 
     {
-    	DEBUG(0, ("del_smbfilepwd_entry(malloc): Failed to copy entry for user %s to file %s. \
+    	ZERODEBUG(0, ("del_smbfilepwd_entry(malloc): Failed to copy entry for user %s to file %s. \
 Error was %s\n", pwd->smb_name, pfile2, strerror(errno)));
 	unlink(pfile2);
 	endsmbfilepwent(fp, &pw_file_lock_depth);
@@ -1112,7 +1112,7 @@
 
     if(fwrite(new_entry, 1, new_entry_length, fp_write) != new_entry_length) 
     {
-    	DEBUG(0, ("del_smbfilepwd_entry(write): Failed to copy entry for user %s to file %s. \
+    	ZERODEBUG(0, ("del_smbfilepwd_entry(write): Failed to copy entry for user %s to file %s. \
 Error was %s\n", pwd->smb_name, pfile2, strerror(errno)));
       	unlink(pfile2);
 	endsmbfilepwent(fp, &pw_file_lock_depth);
@@ -1130,7 +1130,7 @@
 
   if(fflush(fp_write) != 0) 
   {
-  	DEBUG(0, ("del_smbfilepwd_entry: Failed to flush file %s. Error was %s\n", pfile2, strerror(errno)));
+  	ZERODEBUG(0, ("del_smbfilepwd_entry: Failed to flush file %s. Error was %s\n", pfile2, strerror(errno)));
 	endsmbfilepwent(fp, &pw_file_lock_depth);
 	endsmbfilepwent(fp_write,&pfile2_lockdepth);
 	return False;
@@ -1191,7 +1191,7 @@
 	   --jerry */ 
 	pwfile = sys_getpwnam(pw_buf->smb_name);
 	if (pwfile == NULL) {
-		DEBUG(0,("build_sam_account: smbpasswd database is corrupt!  username %s not in unix passwd database!\n", pw_buf->smb_name));
+		ZERODEBUG(0,("build_sam_account: smbpasswd database is corrupt!  username %s not in unix passwd database!\n", pw_buf->smb_name));
 		return False;
 	}
 
@@ -1272,7 +1272,7 @@
 		FILE *fp;
 		/* slprintf(msg_str,msg_str_len-1,
 			"smbpasswd file did not exist - attempting to create it.\n"); */
-		DEBUG(0,("smbpasswd file did not exist - attempting to create it.\n"));
+		ZERODEBUG(0,("smbpasswd file did not exist - attempting to create it.\n"));
 		fp = sys_fopen(lp_smb_passwd_file(), "w");
 		if (fp) 
 		{
@@ -1366,7 +1366,7 @@
 	fp = startsmbfilepwent(lp_smb_passwd_file(), PWF_READ, &pw_file_lock_depth);
 
 	if (fp == NULL) {
-		DEBUG(0, ("unable to open passdb database.\n"));
+		ZERODEBUG(0, ("unable to open passdb database.\n"));
 		return False;
 	}
 
@@ -1415,7 +1415,7 @@
 	fp = startsmbfilepwent(lp_smb_passwd_file(), PWF_READ, &pw_file_lock_depth);
 
 	if (fp == NULL) {
-		DEBUG(0, ("unable to open passdb database.\n"));
+		ZERODEBUG(0, ("unable to open passdb database.\n"));
 		return False;
 	}
 
diff -Naur samba-2.2.12-orig/source/passdb/pdb_tdb.c samba-2.2.12/source/passdb/pdb_tdb.c
--- samba-2.2.12-orig/source/passdb/pdb_tdb.c	2004-08-12 20:24:27.000000000 +0200
+++ samba-2.2.12/source/passdb/pdb_tdb.c	2009-03-11 13:38:47.000000000 +0100
@@ -93,7 +93,7 @@
 	pstring pprofile_path;
 
 	if(sampass == NULL || buf == NULL) {
-		DEBUG(0, ("init_sam_from_buffer: NULL parameters found!\n"));
+		ZERODEBUG(0, ("init_sam_from_buffer: NULL parameters found!\n"));
 		return False;
 	}
 	
@@ -139,7 +139,7 @@
 	 * to try case permutations
 	 */
 	if (!username || !(pw=getpwnam(username))) {
-		DEBUG(0,("tdb_sam: getpwnam(%s) return NULL.  User does not exist!\n",
+		ZERODEBUG(0,("tdb_sam: getpwnam(%s) return NULL.  User does not exist!\n",
 			username?username:"NULL"));
 		ret = False;
 		goto done;
@@ -279,7 +279,7 @@
 
 	/* do we have a valid SAM_ACCOUNT pointer? */
 	if (sampass == NULL) {
-		DEBUG(0, ("init_buffer_from_sam: SAM_ACCOUNT is NULL!\n"));
+		ZERODEBUG(0, ("init_buffer_from_sam: SAM_ACCOUNT is NULL!\n"));
 		return -1;
 	}
 		
@@ -390,7 +390,7 @@
 
 	/* malloc the space needed */
 	if ( (*buf=(uint8*)malloc(len)) == NULL) {
-		DEBUG(0,("init_buffer_from_sam: Unable to malloc() memory for buffer!\n"));
+		ZERODEBUG(0,("init_buffer_from_sam: Unable to malloc() memory for buffer!\n"));
 		return (-1);
 	}
 	
@@ -452,7 +452,7 @@
 	/* Open tdb passwd */
 	if (!(global_tdb_ent.passwd_tdb = tdb_open_log(tdbfile, 0, TDB_DEFAULT, update?(O_RDWR|O_CREAT):O_RDONLY, 0600)))
 	{
-		DEBUG(0, ("Unable to open/create TDB passwd\n"));
+		ZERODEBUG(0, ("Unable to open/create TDB passwd\n"));
 		return False;
 	}
 	
@@ -489,7 +489,7 @@
 	int  prefixlen = strlen (prefix);
 
 	if (user==NULL) {
-		DEBUG(0,("pdb_get_sampwent: SAM_ACCOUNT is NULL.\n"));
+		ZERODEBUG(0,("pdb_get_sampwent: SAM_ACCOUNT is NULL.\n"));
 		return False;
 	}
 
@@ -500,7 +500,7 @@
 
 	/* do we have an valid interation pointer? */
 	if(global_tdb_ent.passwd_tdb == NULL) {
-		DEBUG(0,("pdb_get_sampwent: Bad TDB Context pointer.\n"));
+		ZERODEBUG(0,("pdb_get_sampwent: Bad TDB Context pointer.\n"));
 		return False;
 	}
 
@@ -512,7 +512,7 @@
   
   	/* unpack the buffer */
 	if (!init_sam_from_buffer(user, data.dptr, data.dsize)) {
-		DEBUG(0,("pdb_getsampwent: Bad SAM_ACCOUNT entry returned from TDB!\n"));
+		ZERODEBUG(0,("pdb_getsampwent: Bad SAM_ACCOUNT entry returned from TDB!\n"));
 		SAFE_FREE(data.dptr);
 		return False;
 	}
@@ -541,7 +541,7 @@
 
 
 	if (user==NULL) {
-		DEBUG(0,("pdb_getsampwnam: SAM_ACCOUNT is NULL.\n"));
+		ZERODEBUG(0,("pdb_getsampwnam: SAM_ACCOUNT is NULL.\n"));
 		return False;
 	}
 
@@ -560,7 +560,7 @@
 
 	/* open the accounts TDB */
 	if (!(pwd_tdb = tdb_open_log(tdbfile, 0, TDB_DEFAULT, O_RDONLY, 0600))) {
-		DEBUG(0, ("pdb_getsampwnam: Unable to open TDB passwd!\n"));
+		ZERODEBUG(0, ("pdb_getsampwnam: Unable to open TDB passwd!\n"));
 		return False;
 	}
 
@@ -575,7 +575,7 @@
   
   	/* unpack the buffer */
 	if (!init_sam_from_buffer(user, data.dptr, data.dsize)) {
-		DEBUG(0,("pdb_getsampwent: Bad SAM_ACCOUNT entry returned from TDB!\n"));
+		ZERODEBUG(0,("pdb_getsampwent: Bad SAM_ACCOUNT entry returned from TDB!\n"));
 		SAFE_FREE(data.dptr);
 		tdb_close(pwd_tdb);
 		return False;
@@ -601,7 +601,7 @@
 	fstring			name;
 	
 	if (user==NULL) {
-		DEBUG(0,("pdb_getsampwrid: SAM_ACCOUNT is NULL.\n"));
+		ZERODEBUG(0,("pdb_getsampwrid: SAM_ACCOUNT is NULL.\n"));
 		return False;
 	}
 
@@ -616,7 +616,7 @@
 
 	/* open the accounts TDB */
 	if (!(pwd_tdb = tdb_open_log(tdbfile, 0, TDB_DEFAULT, O_RDONLY, 0600))) {
-		DEBUG(0, ("pdb_getsampwrid: Unable to open TDB rid database!\n"));
+		ZERODEBUG(0, ("pdb_getsampwrid: Unable to open TDB rid database!\n"));
 		return False;
 	}
 
@@ -660,7 +660,7 @@
 
 	/* open the TDB */
 	if (!(pwd_tdb = tdb_open_log(tdbfile, 0, TDB_DEFAULT, O_RDWR, 0600))) {
-		DEBUG(0, ("Unable to open TDB passwd!"));
+		ZERODEBUG(0, ("Unable to open TDB passwd!"));
 		return False;
 	}
   
@@ -685,7 +685,7 @@
 	}
 	
 	if (!init_sam_from_buffer (sam_pass, data.dptr, data.dsize)) {
-		DEBUG(0,("pdb_getsampwent: Bad SAM_ACCOUNT entry returned from TDB!\n"));
+		ZERODEBUG(0,("pdb_getsampwent: Bad SAM_ACCOUNT entry returned from TDB!\n"));
 		tdb_close (pwd_tdb);
 		SAFE_FREE(data.dptr);
 		return False;
@@ -743,7 +743,7 @@
 	pstrcat(tdbfile, PASSDB_FILE_NAME);
 	
 	if ( (!newpwd->uid) || (!newpwd->gid) )
-		DEBUG (0,("tdb_update_sam: Storing a SAM_ACCOUNT for [%s] with uid %d and gid %d!\n",
+		ZERODEBUG (0,("tdb_update_sam: Storing a SAM_ACCOUNT for [%s] with uid %d and gid %d!\n",
 			newpwd->username, newpwd->uid, newpwd->gid));
 				
 	/* if we don't have a RID, then generate one */
@@ -754,7 +754,7 @@
 
 	/* copy the SAM_ACCOUNT struct into a BYTE buffer for storage */
 	if ((data.dsize=init_buffer_from_sam (&buf, newpwd)) == -1) {
-		DEBUG(0,("tdb_update_sam: ERROR - Unable to copy SAM_ACCOUNT info BYTE buffer!\n"));
+		ZERODEBUG(0,("tdb_update_sam: ERROR - Unable to copy SAM_ACCOUNT info BYTE buffer!\n"));
 		ret = False;
 		goto done;
 	}
@@ -778,14 +778,14 @@
 	pwd_tdb = tdb_open_log(tdbfile, 0, TDB_DEFAULT, O_RDWR | O_CREAT, 0600);
   	if (!pwd_tdb)
 	{
-		DEBUG(0, ("tdb_update_sam: Unable to open TDB passwd!\n"));
+		ZERODEBUG(0, ("tdb_update_sam: Unable to open TDB passwd!\n"));
 		return False;
 	}
 
 	/* add the account */
 	if (tdb_store(pwd_tdb, key, data, flag) != TDB_SUCCESS) {
-		DEBUG(0, ("Unable to modify passwd TDB!"));
-		DEBUGADD(0, (" Error: %s\n", tdb_errorstr(pwd_tdb)));
+		ZERODEBUG(0, ("Unable to modify passwd TDB!"));
+		ZERODEBUGADD(0, (" Error: %s\n", tdb_errorstr(pwd_tdb)));
 		ret = False;
 		goto done;
 	}
@@ -801,8 +801,8 @@
 	
 	/* add the reference */
 	if (tdb_store(pwd_tdb, key, data, flag) != TDB_SUCCESS) {
-		DEBUG(0, ("Unable to modify TDB passwd !"));
-		DEBUGADD(0, (" Error: %s\n", tdb_errorstr(pwd_tdb)));
+		ZERODEBUG(0, ("Unable to modify TDB passwd !"));
+		ZERODEBUGADD(0, (" Error: %s\n", tdb_errorstr(pwd_tdb)));
 		ret = False;
 		goto done;
 	}
diff -Naur samba-2.2.12-orig/source/passdb/secrets.c samba-2.2.12/source/passdb/secrets.c
--- samba-2.2.12-orig/source/passdb/secrets.c	2004-08-12 20:24:27.000000000 +0200
+++ samba-2.2.12/source/passdb/secrets.c	2009-03-11 09:59:35.000000000 +0100
@@ -41,7 +41,7 @@
 	tdb = tdb_open_log(fname, 0, TDB_DEFAULT, O_RDWR|O_CREAT, 0600);
 
 	if (!tdb) {
-		DEBUG(0,("Failed to open %s\n", fname));
+		ZERODEBUG(0,("Failed to open %s\n", fname));
 		return False;
 	}
 	return True;
@@ -261,13 +261,13 @@
 	
 	data=secrets_fetch(key, &size);
 	if (!size) {
-		DEBUG(0,("fetch_ldap_pw: no ldap secret retrieved!\n"));
+		ZERODEBUG(0,("fetch_ldap_pw: no ldap secret retrieved!\n"));
 		return False;
 	}
 	
 	if (size > len-1)
 	{
-		DEBUG(0,("fetch_ldap_pw: ldap secret is too long (%d > %d)!\n", size, len-1));
+		ZERODEBUG(0,("fetch_ldap_pw: ldap secret is too long (%d > %d)!\n", size, len-1));
 		return False;
 	}
 
diff -Naur samba-2.2.12-orig/source/passdb/smbpassfile.c samba-2.2.12/source/passdb/smbpassfile.c
--- samba-2.2.12-orig/source/passdb/smbpassfile.c	2004-08-12 20:24:27.000000000 +0200
+++ samba-2.2.12/source/passdb/smbpassfile.c	2009-03-11 09:59:35.000000000 +0100
@@ -90,7 +90,7 @@
   mac_file_len = strlen(mac_file);
 
   if ((int)(sizeof(pstring) - mac_file_len - strlen(domain) - strlen(name) - 6) < 0) {
-    DEBUG(0,("trust_password_lock: path %s too long to add trust details.\n",
+    ZERODEBUG(0,("trust_password_lock: path %s too long to add trust details.\n",
               mac_file));
     return;
   }
@@ -120,13 +120,13 @@
       return False;
 
     if((mach_passwd_fp = fdopen(fd, "w+b")) == NULL) {
-        DEBUG(0,("trust_password_lock: cannot open file %s - Error was %s.\n",
+        ZERODEBUG(0,("trust_password_lock: cannot open file %s - Error was %s.\n",
               mac_file, strerror(errno) ));
         return False;
     }
 
     if(!pw_file_lock(fileno(mach_passwd_fp), F_WRLCK, 60, &mach_passwd_lock_depth)) {
-      DEBUG(0,("trust_password_lock: cannot lock file %s\n", mac_file));
+      ZERODEBUG(0,("trust_password_lock: cannot lock file %s\n", mac_file));
       fclose(mach_passwd_fp);
       return False;
     }
@@ -161,7 +161,7 @@
 
   get_trust_account_file_name( domain, name, mac_file);
   if(sys_ftruncate(fileno(mach_passwd_fp),(SMB_OFF_T)0) == -1) {
-    DEBUG(0,("trust_password_file_delete: Failed to truncate file %s (%s)\n",
+    ZERODEBUG(0,("trust_password_file_delete: Failed to truncate file %s (%s)\n",
         mac_file, strerror(errno) ));
   }
   ret = unlink( mac_file );
@@ -186,7 +186,7 @@
   memset(ret_pwd, '\0', 16);
 
   if(sys_fstat(fileno(mach_passwd_fp), &st) == -1) {
-    DEBUG(0,("get_trust_account_password: Failed to stat file. Error was %s.\n",
+    ZERODEBUG(0,("get_trust_account_password: Failed to stat file. Error was %s.\n",
               strerror(errno) )); 
     return False;
   }
@@ -201,14 +201,14 @@
     return False;
 
   if(sys_fseek( mach_passwd_fp, (SMB_OFF_T)0, SEEK_SET) == -1) {
-    DEBUG(0,("get_trust_account_password: Failed to seek to start of file. Error was %s.\n",
+    ZERODEBUG(0,("get_trust_account_password: Failed to seek to start of file. Error was %s.\n",
               strerror(errno) ));
     return False;
   } 
 
   fgets(linebuf, sizeof(linebuf), mach_passwd_fp);
   if(ferror(mach_passwd_fp)) {
-    DEBUG(0,("get_trust_account_password: Failed to read password. Error was %s.\n",
+    ZERODEBUG(0,("get_trust_account_password: Failed to read password. Error was %s.\n",
               strerror(errno) ));
     return False;
   }
@@ -222,7 +222,7 @@
    */
 
   if(strlen(linebuf) != 45) {
-    DEBUG(0,("get_trust_account_password: Malformed trust password file (wrong length \
+    ZERODEBUG(0,("get_trust_account_password: Malformed trust password file (wrong length \
 - was %d, should be 45).\n", (int)strlen(linebuf)));
 #ifdef DEBUG_PASSWORD
     DEBUG(100,("get_trust_account_password: line = |%s|\n", linebuf));
@@ -236,7 +236,7 @@
 
   if (!pdb_gethexpwd((char *)linebuf, ret_pwd) || linebuf[32] != ':' || 
          strncmp(&linebuf[33], "TLC-", 4)) {
-    DEBUG(0,("get_trust_account_password: Malformed trust password file (incorrect format).\n"));
+    ZERODEBUG(0,("get_trust_account_password: Malformed trust password file (incorrect format).\n"));
 #ifdef DEBUG_PASSWORD
     DEBUG(100,("get_trust_account_password: line = |%s|\n", linebuf));
 #endif
@@ -250,7 +250,7 @@
 
   for(i = 0; i < 8; i++) {
     if(p[i] == '\0' || !isxdigit((int)p[i])) {
-      DEBUG(0,("get_trust_account_password: Malformed trust password file (no timestamp).\n"));
+      ZERODEBUG(0,("get_trust_account_password: Malformed trust password file (no timestamp).\n"));
 #ifdef DEBUG_PASSWORD
       DEBUG(100,("get_trust_account_password: line = |%s|\n", linebuf));
 #endif
diff -Naur samba-2.2.12-orig/source/printing/nt_printing.c samba-2.2.12/source/printing/nt_printing.c
--- samba-2.2.12-orig/source/printing/nt_printing.c	2004-08-12 20:24:22.000000000 +0200
+++ samba-2.2.12/source/printing/nt_printing.c	2009-03-11 10:04:13.000000000 +0100
@@ -201,7 +201,7 @@
 {
 	TDB_DATA kbuf, newkey, dbuf;
  
-	DEBUG(0,("upgrade_to_version_3: upgrading print tdb's to version 3\n"));
+	ZERODEBUG(0,("upgrade_to_version_3: upgrading print tdb's to version 3\n"));
  
 	for (kbuf = tdb_firstkey(tdb_drivers); kbuf.dptr;
 			newkey = tdb_nextkey(tdb_drivers, kbuf), safe_free(kbuf.dptr), kbuf=newkey) {
@@ -209,37 +209,37 @@
 		dbuf = tdb_fetch(tdb_drivers, kbuf);
 
 		if (strncmp(kbuf.dptr, FORMS_PREFIX, strlen(FORMS_PREFIX)) == 0) {
-			DEBUG(0,("upgrade_to_version_3:moving form\n"));
+			ZERODEBUG(0,("upgrade_to_version_3:moving form\n"));
 			if (tdb_store(tdb_forms, kbuf, dbuf, TDB_REPLACE) != 0) {
-				DEBUG(0,("upgrade_to_version_3: failed to move form. Error (%s).\n", tdb_errorstr(tdb_forms)));
+				ZERODEBUG(0,("upgrade_to_version_3: failed to move form. Error (%s).\n", tdb_errorstr(tdb_forms)));
 				return False;
 			}
 			if (tdb_delete(tdb_drivers, kbuf) != 0) {
-				DEBUG(0,("upgrade_to_version_3: failed to delete form. Error (%s)\n", tdb_errorstr(tdb_drivers)));
+				ZERODEBUG(0,("upgrade_to_version_3: failed to delete form. Error (%s)\n", tdb_errorstr(tdb_drivers)));
 				return False;
 			}
 		}
  
 		if (strncmp(kbuf.dptr, PRINTERS_PREFIX, strlen(PRINTERS_PREFIX)) == 0) {
-			DEBUG(0,("upgrade_to_version_3:moving printer\n"));
+			ZERODEBUG(0,("upgrade_to_version_3:moving printer\n"));
 			if (tdb_store(tdb_printers, kbuf, dbuf, TDB_REPLACE) != 0) {
-				DEBUG(0,("upgrade_to_version_3: failed to move printer. Error (%s)\n", tdb_errorstr(tdb_printers)));
+				ZERODEBUG(0,("upgrade_to_version_3: failed to move printer. Error (%s)\n", tdb_errorstr(tdb_printers)));
 				return False;
 			}
 			if (tdb_delete(tdb_drivers, kbuf) != 0) {
-				DEBUG(0,("upgrade_to_version_3: failed to delete printer. Error (%s)\n", tdb_errorstr(tdb_drivers)));
+				ZERODEBUG(0,("upgrade_to_version_3: failed to delete printer. Error (%s)\n", tdb_errorstr(tdb_drivers)));
 				return False;
 			}
 		}
  
 		if (strncmp(kbuf.dptr, SECDESC_PREFIX, strlen(SECDESC_PREFIX)) == 0) {
-			DEBUG(0,("upgrade_to_version_3:moving secdesc\n"));
+			ZERODEBUG(0,("upgrade_to_version_3:moving secdesc\n"));
 			if (tdb_store(tdb_printers, kbuf, dbuf, TDB_REPLACE) != 0) {
-				DEBUG(0,("upgrade_to_version_3: failed to move secdesc. Error (%s)\n", tdb_errorstr(tdb_printers)));
+				ZERODEBUG(0,("upgrade_to_version_3: failed to move secdesc. Error (%s)\n", tdb_errorstr(tdb_printers)));
 				return False;
 			}
 			if (tdb_delete(tdb_drivers, kbuf) != 0) {
-				DEBUG(0,("upgrade_to_version_3: failed to delete secdesc. Error (%s)\n", tdb_errorstr(tdb_drivers)));
+				ZERODEBUG(0,("upgrade_to_version_3: failed to delete secdesc. Error (%s)\n", tdb_errorstr(tdb_drivers)));
 				return False;
 			}
 		}
@@ -264,21 +264,21 @@
  
 	tdb_drivers = tdb_open_log(lock_path("ntdrivers.tdb"), 0, TDB_DEFAULT, O_RDWR|O_CREAT, 0600);
 	if (!tdb_drivers) {
-		DEBUG(0,("nt_printing_init: Failed to open nt drivers database %s (%s)\n",
+		ZERODEBUG(0,("nt_printing_init: Failed to open nt drivers database %s (%s)\n",
 			lock_path("ntdrivers.tdb"), strerror(errno) ));
 		return False;
 	}
  
 	tdb_printers = tdb_open_log(lock_path("ntprinters.tdb"), 0, TDB_DEFAULT, O_RDWR|O_CREAT, 0600);
 	if (!tdb_printers) {
-		DEBUG(0,("nt_printing_init: Failed to open nt printers database %s (%s)\n",
+		ZERODEBUG(0,("nt_printing_init: Failed to open nt printers database %s (%s)\n",
 			lock_path("ntprinters.tdb"), strerror(errno) ));
 		return False;
 	}
  
 	tdb_forms = tdb_open_log(lock_path("ntforms.tdb"), 0, TDB_DEFAULT, O_RDWR|O_CREAT, 0600);
 	if (!tdb_forms) {
-		DEBUG(0,("nt_printing_init: Failed to open nt forms database %s (%s)\n",
+		ZERODEBUG(0,("nt_printing_init: Failed to open nt forms database %s (%s)\n",
 			lock_path("ntforms.tdb"), strerror(errno) ));
 		return False;
 	}
@@ -450,7 +450,7 @@
 
 		tl = Realloc(*list, sizeof(nt_forms_struct)*(n+1));
 		if (!tl) {
-			DEBUG(0,("get_ntforms: Realloc fail.\n"));
+			ZERODEBUG(0,("get_ntforms: Realloc fail.\n"));
 			return 0;
 		}
         *list = tl;
@@ -520,7 +520,7 @@
 
 	if (update==False) {
 		if((tl=Realloc(*list, (n+1)*sizeof(nt_forms_struct))) == NULL) {
-			DEBUG(0,("add_a_form: failed to enlarge forms list!\n"));
+			ZERODEBUG(0,("add_a_form: failed to enlarge forms list!\n"));
 			return False;
 		}
 		*list = tl;
@@ -628,7 +628,7 @@
 		if (strncmp(kbuf.dptr, key, strlen(key)) != 0) continue;
 		
 		if((fl = Realloc(*list, sizeof(fstring)*(total+1))) == NULL) {
-			DEBUG(0,("get_ntdrivers: failed to enlarge list!\n"));
+			ZERODEBUG(0,("get_ntdrivers: failed to enlarge list!\n"));
 			return -1;
 		}
 		else *list = fl;
@@ -705,7 +705,7 @@
 	ssize_t byte_count;
 
 	if ((buf=malloc(PE_HEADER_SIZE)) == NULL) {
-		DEBUG(0,("get_file_version: PE file [%s] PE Header malloc failed bytes = %d\n",
+		ZERODEBUG(0,("get_file_version: PE file [%s] PE Header malloc failed bytes = %d\n",
 				fname, PE_HEADER_SIZE));
 		goto error_exit;
 	}
@@ -758,7 +758,7 @@
 		section_table_bytes = num_sections * PE_HEADER_SECT_HEADER_SIZE;
 		SAFE_FREE(buf);
 		if ((buf=malloc(section_table_bytes)) == NULL) {
-			DEBUG(0,("get_file_version: PE file [%s] section table malloc failed bytes = %d\n",
+			ZERODEBUG(0,("get_file_version: PE file [%s] section table malloc failed bytes = %d\n",
 					fname, section_table_bytes));
 			goto error_exit;
 		}
@@ -779,7 +779,7 @@
 
 				SAFE_FREE(buf);
 				if ((buf=malloc(section_bytes)) == NULL) {
-					DEBUG(0,("get_file_version: PE file [%s] version malloc failed bytes = %d\n",
+					ZERODEBUG(0,("get_file_version: PE file [%s] version malloc failed bytes = %d\n",
 							fname, section_bytes));
 					goto error_exit;
 				}
@@ -836,7 +836,7 @@
 		/* Allocate a bit more space to speed up things */
 		SAFE_FREE(buf);
 		if ((buf=malloc(VS_NE_BUF_SIZE)) == NULL) {
-			DEBUG(0,("get_file_version: NE file [%s] malloc failed bytes  = %d\n",
+			ZERODEBUG(0,("get_file_version: NE file [%s] malloc failed bytes  = %d\n",
 					fname, PE_HEADER_SIZE));
 			goto error_exit;
 		}
@@ -861,7 +861,7 @@
 					if ((bc = vfs_read_data(fsp, &buf[byte_count-i], VS_NE_BUF_SIZE-
 								   (byte_count-i))) < 0) {
 
-						DEBUG(0,("get_file_version: NE file [%s] Read error, errno=%d\n",
+						ZERODEBUG(0,("get_file_version: NE file [%s] Read error, errno=%d\n",
 								 fname, errno));
 						goto error_exit;
 					}
@@ -895,7 +895,7 @@
 		}
 
 		/* Version info not found, fall back to origin date/time */
-		DEBUG(0,("get_file_version: NE file [%s] Version info not found\n", fname));
+		ZERODEBUG(0,("get_file_version: NE file [%s] Version info not found\n", fname));
 		SAFE_FREE(buf);
 		return 0;
 
@@ -1073,7 +1073,7 @@
 	become_root();
 	pass = sys_getpwuid(user->uid);
 	if(pass == NULL) {
-		DEBUG(0,("get_correct_cversion: Unable to get passwd entry for uid %u\n",
+		ZERODEBUG(0,("get_correct_cversion: Unable to get passwd entry for uid %u\n",
 				(unsigned int)user->uid ));
 		unbecome_root();
 		*perr = WERR_ACCESS_DENIED;
@@ -1096,14 +1096,14 @@
 	unbecome_root();
 
 	if (conn == NULL) {
-		DEBUG(0,("get_correct_cversion: Unable to connect\n"));
+		ZERODEBUG(0,("get_correct_cversion: Unable to connect\n"));
 		*perr = W_ERROR(ecode);
 		return -1;
 	}
 
 	/* We are temporarily becoming the connection user. */
 	if (!become_user(conn, conn->vuid)) {
-		DEBUG(0,("get_correct_cversion: Can't become user!\n"));
+		ZERODEBUG(0,("get_correct_cversion: Can't become user!\n"));
 		*perr = WERR_ACCESS_DENIED;
 		return -1;
 	}
@@ -1401,7 +1401,7 @@
 		convert_level_6_to_level3(&converted_driver, driver_abstract.info_6);
 		driver = &converted_driver;
 	} else {
-		DEBUG(0,("move_driver_to_download_area: Unknown info level (%u)\n", (unsigned int)level ));
+		ZERODEBUG(0,("move_driver_to_download_area: Unknown info level (%u)\n", (unsigned int)level ));
 		return False;
 	}
 
@@ -1410,7 +1410,7 @@
 	become_root();
 	pass = sys_getpwuid(user->uid);
 	if(pass == NULL) {
-		DEBUG(0,("move_driver_to_download_area: Unable to get passwd entry for uid %u\n",
+		ZERODEBUG(0,("move_driver_to_download_area: Unable to get passwd entry for uid %u\n",
 				(unsigned int)user->uid ));
 		unbecome_root();
 		return False;
@@ -1432,7 +1432,7 @@
 	unbecome_root();
 
 	if (conn == NULL) {
-		DEBUG(0,("move_driver_to_download_area: Unable to connect\n"));
+		ZERODEBUG(0,("move_driver_to_download_area: Unable to connect\n"));
 		*perr = W_ERROR(ecode);
 		return False;
 	}
@@ -1442,7 +1442,7 @@
 	 */
 
 	if (!become_user(conn, conn->vuid)) {
-		DEBUG(0,("move_driver_to_download_area: Can't become user %s\n", user_name ));
+		ZERODEBUG(0,("move_driver_to_download_area: Can't become user %s\n", user_name ));
 		return False;
 	}
 
@@ -1480,7 +1480,7 @@
 			NTSTATUS status;
 			status = rename_internals(conn, new_name, old_name, True);
 			if (!NT_STATUS_IS_OK(status)) {
-				DEBUG(0,("move_driver_to_download_area: Unable to rename [%s] to [%s]\n",
+				ZERODEBUG(0,("move_driver_to_download_area: Unable to rename [%s] to [%s]\n",
 						new_name, old_name));
 				*perr = ntstatus_to_werror(status);
 				unlink_internals(conn, 0, new_name);
@@ -1499,7 +1499,7 @@
 				NTSTATUS status;
 				status = rename_internals(conn, new_name, old_name, True);
 				if (!NT_STATUS_IS_OK(status)) {
-					DEBUG(0,("move_driver_to_download_area: Unable to rename [%s] to [%s]\n",
+					ZERODEBUG(0,("move_driver_to_download_area: Unable to rename [%s] to [%s]\n",
 							new_name, old_name));
 					*perr = ntstatus_to_werror(status);
 					unlink_internals(conn, 0, new_name);
@@ -1520,7 +1520,7 @@
 				NTSTATUS status;
 				status = rename_internals(conn, new_name, old_name, True);
 				if (!NT_STATUS_IS_OK(status)) {
-					DEBUG(0,("move_driver_to_download_area: Unable to rename [%s] to [%s]\n",
+					ZERODEBUG(0,("move_driver_to_download_area: Unable to rename [%s] to [%s]\n",
 							new_name, old_name));
 					*perr = ntstatus_to_werror(status);
 					unlink_internals(conn, 0, new_name);
@@ -1542,7 +1542,7 @@
 				NTSTATUS status;
 				status = rename_internals(conn, new_name, old_name, True);
 				if (!NT_STATUS_IS_OK(status)) {
-					DEBUG(0,("move_driver_to_download_area: Unable to rename [%s] to [%s]\n",
+					ZERODEBUG(0,("move_driver_to_download_area: Unable to rename [%s] to [%s]\n",
 							new_name, old_name));
 					*perr = ntstatus_to_werror(status);
 					unlink_internals(conn, 0, new_name);
@@ -1573,7 +1573,7 @@
 					NTSTATUS status;
 					status = rename_internals(conn, new_name, old_name, True);
 					if (!NT_STATUS_IS_OK(status)) {
-						DEBUG(0,("move_driver_to_download_area: Unable to rename [%s] to [%s]\n",
+						ZERODEBUG(0,("move_driver_to_download_area: Unable to rename [%s] to [%s]\n",
 								new_name, old_name));
 						*perr = ntstatus_to_werror(status);
 						unlink_internals(conn, 0, new_name);
@@ -1681,7 +1681,7 @@
 
 		tb = (char *)Realloc(buf, len);
 		if (!tb) {
-			DEBUG(0,("add_a_printer_driver_3: failed to enlarge buffer\n!"));
+			ZERODEBUG(0,("add_a_printer_driver_3: failed to enlarge buffer\n!"));
 			ret = -1;
 			goto done;
 		}
@@ -1700,7 +1700,7 @@
 
 done:
 	if (ret)
-		DEBUG(0,("add_a_printer_driver_3: Adding driver with key %s failed.\n", key ));
+		ZERODEBUG(0,("add_a_printer_driver_3: Adding driver with key %s failed.\n", key ));
 
 	SAFE_FREE(buf);
 	return ret;
@@ -1799,7 +1799,7 @@
 		tddfs = (fstring *)Realloc(driver.dependentfiles,
 							 sizeof(fstring)*(i+2));
 		if (tddfs == NULL) {
-			DEBUG(0,("get_a_printer_driver_3: failed to enlarge buffer!\n"));
+			ZERODEBUG(0,("get_a_printer_driver_3: failed to enlarge buffer!\n"));
 			break;
 		}
 		else driver.dependentfiles = tddfs;
@@ -2113,7 +2113,7 @@
 
 		tb = (char *)Realloc(buf, len);
 		if (!tb) {
-			DEBUG(0,("update_a_printer_2: failed to enlarge buffer!\n"));
+			ZERODEBUG(0,("update_a_printer_2: failed to enlarge buffer!\n"));
 			ret = WERR_NOMEM;
 			goto done;
 		}
@@ -2240,7 +2240,7 @@
 	NT_DEVICEMODE *nt_devmode = (NT_DEVICEMODE *)malloc(sizeof(NT_DEVICEMODE));
 
 	if (nt_devmode == NULL) {
-		DEBUG(0,("construct_nt_devicemode: malloc fail.\n"));
+		ZERODEBUG(0,("construct_nt_devicemode: malloc fail.\n"));
 		return NULL;
 	}
 
@@ -2301,7 +2301,7 @@
 	NT_DEVICEMODE *new_nt_devicemode = NULL;
 
 	if ((new_nt_devicemode = (NT_DEVICEMODE *)memdup(nt_devicemode, sizeof(NT_DEVICEMODE))) == NULL) {
-		DEBUG(0,("dup_nt_devicemode: malloc fail.\n"));
+		ZERODEBUG(0,("dup_nt_devicemode: malloc fail.\n"));
 		return NULL;
 	}
 
@@ -2309,7 +2309,7 @@
 	if (nt_devicemode->private != NULL) {
 		if ((new_nt_devicemode->private = memdup(nt_devicemode->private, nt_devicemode->driverextra)) == NULL) {
 			SAFE_FREE(new_nt_devicemode);
-			DEBUG(0,("dup_nt_devicemode: malloc fail.\n"));
+			ZERODEBUG(0,("dup_nt_devicemode: malloc fail.\n"));
 			return NULL;
         }
 	}
@@ -2490,7 +2490,7 @@
 
 	lines = file_lines_load(mapfile, &numlines, True);
 	if (numlines == 0) {
-		DEBUG(0,("No entries in OS/2 driver map %s\n",mapfile));
+		ZERODEBUG(0,("No entries in OS/2 driver map %s\n",mapfile));
 		return;
 	}
 
@@ -2612,7 +2612,7 @@
 
 	*info_ptr = (NT_PRINTER_INFO_LEVEL_2 *)memdup(&info, sizeof(info));
 	if (! *info_ptr) {
-		DEBUG(0,("get_a_printer_2_default: malloc fail.\n"));
+		ZERODEBUG(0,("get_a_printer_2_default: malloc fail.\n"));
 		goto fail;
 	}
 
@@ -3010,7 +3010,7 @@
 			break;
 			
 		default:
-			DEBUG(0,("set_driver_init: Programmer's error!  Unknown driver_init level [%d]\n",
+			ZERODEBUG(0,("set_driver_init: Programmer's error!  Unknown driver_init level [%d]\n",
 				level));
 			break;
 	}
@@ -3072,7 +3072,7 @@
 
 		tb = (char *)Realloc(buf, len);
 		if (!tb) {
-			DEBUG(0, ("update_driver_init_2: failed to enlarge buffer!\n"));
+			ZERODEBUG(0, ("update_driver_init_2: failed to enlarge buffer!\n"));
 			ret = -1;
 			goto done;
 		}
@@ -3294,7 +3294,7 @@
 		case 2:
 		{
 			if ((printer = (NT_PRINTER_INFO_LEVEL *)malloc(sizeof(NT_PRINTER_INFO_LEVEL))) == NULL) {
-				DEBUG(0,("get_a_printer: malloc fail.\n"));
+				ZERODEBUG(0,("get_a_printer: malloc fail.\n"));
 				return WERR_NOMEM;
 			}
 			ZERO_STRUCTP(printer);
@@ -3555,7 +3555,7 @@
 	/* ok... the driver exists so the delete should return success */
 		
 	if (tdb_delete(tdb_drivers, kbuf) == -1) {
-		DEBUG (0,("delete_printer_driver: fail to delete %s!\n", key));
+		ZERODEBUG (0,("delete_printer_driver: fail to delete %s!\n", key));
 		return WERR_ACCESS_DENIED;
 	}
 
@@ -3812,7 +3812,7 @@
 	}
 
 	if (!psd) {
-		DEBUG(0,("construct_default_printer_sd: Failed to make SEC_DESC.\n"));
+		ZERODEBUG(0,("construct_default_printer_sd: Failed to make SEC_DESC.\n"));
 		return NULL;
 	}
 
diff -Naur samba-2.2.12-orig/source/printing/pcap.c samba-2.2.12/source/printing/pcap.c
--- samba-2.2.12-orig/source/printing/pcap.c	2004-08-12 20:24:21.000000000 +0200
+++ samba-2.2.12/source/printing/pcap.c	2009-03-11 09:59:35.000000000 +0100
@@ -106,7 +106,7 @@
 
 	if ((pfile = sys_fopen(psz, "r")) == NULL)
 	{
-	      DEBUG(0,( "Unable to open qconfig file %s for read!\n", psz));
+	      ZERODEBUG(0,( "Unable to open qconfig file %s for read!\n", psz));
 	      return;
 	}
 
@@ -176,12 +176,12 @@
 	 pName = malloc(iLg+10);
 	if (pName == NULL)
 	{
-		DEBUG(0,(" Unable to allocate memory for printer %s\n",pszPrintername));
+		ZERODEBUG(0,(" Unable to allocate memory for printer %s\n",pszPrintername));
 		return(False);
 	}
 	if ((pfile = sys_fopen(psz, "r")) == NULL)
 	{
-	      DEBUG(0,( "Unable to open qconfig file %s for read!\n", psz));
+	      ZERODEBUG(0,( "Unable to open qconfig file %s for read!\n", psz));
 	      SAFE_FREE(pName);
 	      return(False);
 	}
@@ -257,7 +257,7 @@
 
   if (pszPrintername == NULL || pszPrintername[0] == '\0')
     {
-      DEBUG(0,( "Attempt to locate null printername! Internal error?\n"));
+      ZERODEBUG(0,( "Attempt to locate null printername! Internal error?\n"));
       return(False);
     }
 
@@ -265,7 +265,7 @@
   if ((psz = pszPrintcapname) == NULL || psz[0] == '\0')
     if (((psz = lp_printcapname()) == NULL) || (psz[0] == '\0'))
       {
-	DEBUG(0,( "No printcap file name configured!\n"));
+	ZERODEBUG(0,( "No printcap file name configured!\n"));
 	return(False);
       }
 
@@ -286,7 +286,7 @@
 
   if ((pfile = sys_fopen(psz, "r")) == NULL)
     {
-      DEBUG(0,( "Unable to open printcap file %s for read!\n", psz));
+      ZERODEBUG(0,( "Unable to open printcap file %s for read!\n", psz));
       return(False);
     }
 
@@ -341,7 +341,7 @@
   /* only go looking if no printcap name supplied */
   if (((psz = lp_printcapname()) == NULL) || (psz[0] == '\0'))
     {
-      DEBUG(0,( "No printcap file name configured!\n"));
+      ZERODEBUG(0,( "No printcap file name configured!\n"));
       return;
     }
 
@@ -369,7 +369,7 @@
 
   if ((pfile = sys_fopen(psz, "r")) == NULL)
     {
-      DEBUG(0,( "Unable to open printcap file %s for read!\n", psz));
+      ZERODEBUG(0,( "Unable to open printcap file %s for read!\n", psz));
       return;
     }
 
diff -Naur samba-2.2.12-orig/source/printing/print_cups.c samba-2.2.12/source/printing/print_cups.c
--- samba-2.2.12-orig/source/printing/print_cups.c	2004-08-12 20:24:22.000000000 +0200
+++ samba-2.2.12/source/printing/print_cups.c	2009-03-11 09:59:36.000000000 +0100
@@ -103,7 +103,7 @@
 
 	if ((http = httpConnect(cupsServer(), ippPort())) == NULL)
 	{
-		DEBUG(0,("Unable to connect to CUPS server %s - %s\n", 
+		ZERODEBUG(0,("Unable to connect to CUPS server %s - %s\n", 
 			 cupsServer(), strerror(errno)));
 		return;
 	}
@@ -141,7 +141,7 @@
 
 	if ((response = cupsDoRequest(http, request, "/")) == NULL)
 	{
-		DEBUG(0,("Unable to get printer list - %s\n",
+		ZERODEBUG(0,("Unable to get printer list - %s\n",
 			 ippErrorString(cupsLastError())));
 		httpClose(http);
 		return;
@@ -235,7 +235,7 @@
 
 	if ((response = cupsDoRequest(http, request, "/")) == NULL)
 	{
-		DEBUG(0,("Unable to get printer list - %s\n",
+		ZERODEBUG(0,("Unable to get printer list - %s\n",
 			 ippErrorString(cupsLastError())));
 		httpClose(http);
 		return;
@@ -332,7 +332,7 @@
 
 	if ((http = httpConnect(cupsServer(), ippPort())) == NULL)
 	{
-		DEBUG(0,("Unable to connect to CUPS server %s - %s\n", 
+		ZERODEBUG(0,("Unable to connect to CUPS server %s - %s\n", 
 			 cupsServer(), strerror(errno)));
 		return (0);
 	}
@@ -374,7 +374,7 @@
 
 	if ((response = cupsDoRequest(http, request, "/")) == NULL)
 	{
-		DEBUG(0,("Unable to get printer status for %s - %s\n", name,
+		ZERODEBUG(0,("Unable to get printer status for %s - %s\n", name,
 			 ippErrorString(cupsLastError())));
 		httpClose(http);
 		return (0);
@@ -384,7 +384,7 @@
 
 	if (response->request.status.status_code >= IPP_OK_CONFLICT)
 	{
-		DEBUG(0,("Unable to get printer status for %s - %s\n", name,
+		ZERODEBUG(0,("Unable to get printer status for %s - %s\n", name,
 			 ippErrorString(response->request.status.status_code)));
 		ippDelete(response);
 		return (0);
@@ -426,7 +426,7 @@
 
 	if ((http = httpConnect(cupsServer(), ippPort())) == NULL)
 	{
-		DEBUG(0,("Unable to connect to CUPS server %s - %s\n", 
+		ZERODEBUG(0,("Unable to connect to CUPS server %s - %s\n", 
 			 cupsServer(), strerror(errno)));
 		return (1);
 	}
@@ -470,7 +470,7 @@
 	if ((response = cupsDoRequest(http, request, "/jobs")) != NULL)
 	{
 	  if (response->request.status.status_code >= IPP_OK_CONFLICT)
-		DEBUG(0,("Unable to cancel job %d - %s\n", pjob->sysjob,
+		ZERODEBUG(0,("Unable to cancel job %d - %s\n", pjob->sysjob,
 			 ippErrorString(cupsLastError())));
           else
 	  	ret = 0;
@@ -478,7 +478,7 @@
 	  ippDelete(response);
 	}
 	else
-	  DEBUG(0,("Unable to cancel job %d - %s\n", pjob->sysjob,
+	  ZERODEBUG(0,("Unable to cancel job %d - %s\n", pjob->sysjob,
 		   ippErrorString(cupsLastError())));
 
 	httpClose(http);
@@ -516,7 +516,7 @@
 
 	if ((http = httpConnect(cupsServer(), ippPort())) == NULL)
 	{
-		DEBUG(0,("Unable to connect to CUPS server %s - %s\n", 
+		ZERODEBUG(0,("Unable to connect to CUPS server %s - %s\n", 
 			 cupsServer(), strerror(errno)));
 		return (1);
 	}
@@ -560,7 +560,7 @@
 	if ((response = cupsDoRequest(http, request, "/jobs")) != NULL)
 	{
 	  if (response->request.status.status_code >= IPP_OK_CONFLICT)
-		DEBUG(0,("Unable to hold job %d - %s\n", pjob->sysjob,
+		ZERODEBUG(0,("Unable to hold job %d - %s\n", pjob->sysjob,
 			 ippErrorString(cupsLastError())));
           else
 	  	ret = 0;
@@ -568,7 +568,7 @@
 	  ippDelete(response);
 	}
 	else
-	  DEBUG(0,("Unable to hold job %d - %s\n", pjob->sysjob,
+	  ZERODEBUG(0,("Unable to hold job %d - %s\n", pjob->sysjob,
 		   ippErrorString(cupsLastError())));
 
 	httpClose(http);
@@ -606,7 +606,7 @@
 
 	if ((http = httpConnect(cupsServer(), ippPort())) == NULL)
 	{
-		DEBUG(0,("Unable to connect to CUPS server %s - %s\n", 
+		ZERODEBUG(0,("Unable to connect to CUPS server %s - %s\n", 
 			 cupsServer(), strerror(errno)));
 		return (1);
 	}
@@ -650,7 +650,7 @@
 	if ((response = cupsDoRequest(http, request, "/jobs")) != NULL)
 	{
 	  if (response->request.status.status_code >= IPP_OK_CONFLICT)
-		DEBUG(0,("Unable to release job %d - %s\n", pjob->sysjob,
+		ZERODEBUG(0,("Unable to release job %d - %s\n", pjob->sysjob,
 			 ippErrorString(cupsLastError())));
           else
 	  	ret = 0;
@@ -658,7 +658,7 @@
 	  ippDelete(response);
 	}
 	else
-	  DEBUG(0,("Unable to release job %d - %s\n", pjob->sysjob,
+	  ZERODEBUG(0,("Unable to release job %d - %s\n", pjob->sysjob,
 		   ippErrorString(cupsLastError())));
 
 	httpClose(http);
@@ -696,7 +696,7 @@
 
 	if ((http = httpConnect(cupsServer(), ippPort())) == NULL)
 	{
-		DEBUG(0,("Unable to connect to CUPS server %s - %s\n", 
+		ZERODEBUG(0,("Unable to connect to CUPS server %s - %s\n", 
 			 cupsServer(), strerror(errno)));
 		return (1);
 	}
@@ -752,7 +752,7 @@
 	                                  pjob->filename)) != NULL)
 	{
 		if (response->request.status.status_code >= IPP_OK_CONFLICT)
-			DEBUG(0,("Unable to print file to %s - %s\n", PRINTERNAME(snum),
+			ZERODEBUG(0,("Unable to print file to %s - %s\n", PRINTERNAME(snum),
 			         ippErrorString(cupsLastError())));
         	else
 			ret = 0;
@@ -760,7 +760,7 @@
 		ippDelete(response);
 	}
 	else
-		DEBUG(0,("Unable to print file to `%s' - %s\n", PRINTERNAME(snum),
+		ZERODEBUG(0,("Unable to print file to `%s' - %s\n", PRINTERNAME(snum),
 			 ippErrorString(cupsLastError())));
 
 	httpClose(http);
@@ -828,7 +828,7 @@
 
 	if ((http = httpConnect(cupsServer(), ippPort())) == NULL)
 	{
-		DEBUG(0,("Unable to connect to CUPS server %s - %s\n", 
+		ZERODEBUG(0,("Unable to connect to CUPS server %s - %s\n", 
 			 cupsServer(), strerror(errno)));
 		return (0);
 	}
@@ -877,7 +877,7 @@
 
 	if ((response = cupsDoRequest(http, request, "/")) == NULL)
 	{
-		DEBUG(0,("Unable to get jobs for %s - %s\n", uri,
+		ZERODEBUG(0,("Unable to get jobs for %s - %s\n", uri,
 			 ippErrorString(cupsLastError())));
 		httpClose(http);
 		return (0);
@@ -885,7 +885,7 @@
 
 	if (response->request.status.status_code >= IPP_OK_CONFLICT)
 	{
-		DEBUG(0,("Unable to get jobs for %s - %s\n", uri,
+		ZERODEBUG(0,("Unable to get jobs for %s - %s\n", uri,
 			 ippErrorString(response->request.status.status_code)));
 		ippDelete(response);
 		httpClose(http);
@@ -924,7 +924,7 @@
 
 			if (temp == NULL)
 			{
-				DEBUG(0,("cups_queue_get: Not enough memory!"));
+				ZERODEBUG(0,("cups_queue_get: Not enough memory!"));
 				ippDelete(response);
 				httpClose(http);
 
@@ -1057,7 +1057,7 @@
 
 	if ((response = cupsDoRequest(http, request, "/")) == NULL)
 	{
-		DEBUG(0,("Unable to get printer status for %s - %s\n", PRINTERNAME(snum),
+		ZERODEBUG(0,("Unable to get printer status for %s - %s\n", PRINTERNAME(snum),
 			 ippErrorString(cupsLastError())));
 		httpClose(http);
 		*q = queue;
@@ -1066,7 +1066,7 @@
 
 	if (response->request.status.status_code >= IPP_OK_CONFLICT)
 	{
-		DEBUG(0,("Unable to get printer status for %s - %s\n", PRINTERNAME(snum),
+		ZERODEBUG(0,("Unable to get printer status for %s - %s\n", PRINTERNAME(snum),
 			 ippErrorString(response->request.status.status_code)));
 		ippDelete(response);
 		httpClose(http);
@@ -1133,7 +1133,7 @@
 
 	if ((http = httpConnect(cupsServer(), ippPort())) == NULL)
 	{
-		DEBUG(0,("Unable to connect to CUPS server %s - %s\n", 
+		ZERODEBUG(0,("Unable to connect to CUPS server %s - %s\n", 
 			 cupsServer(), strerror(errno)));
 		return (1);
 	}
@@ -1178,7 +1178,7 @@
 	if ((response = cupsDoRequest(http, request, "/admin/")) != NULL)
 	{
 	  if (response->request.status.status_code >= IPP_OK_CONFLICT)
-		DEBUG(0,("Unable to pause printer %s - %s\n", PRINTERNAME(snum),
+		ZERODEBUG(0,("Unable to pause printer %s - %s\n", PRINTERNAME(snum),
 			 ippErrorString(cupsLastError())));
           else
 	  	ret = 0;
@@ -1186,7 +1186,7 @@
 	  ippDelete(response);
 	}
 	else
-	  DEBUG(0,("Unable to pause printer %s - %s\n", PRINTERNAME(snum),
+	  ZERODEBUG(0,("Unable to pause printer %s - %s\n", PRINTERNAME(snum),
 		   ippErrorString(cupsLastError())));
 
 	httpClose(http);
@@ -1225,7 +1225,7 @@
 
 	if ((http = httpConnect(cupsServer(), ippPort())) == NULL)
 	{
-		DEBUG(0,("Unable to connect to CUPS server %s - %s\n", 
+		ZERODEBUG(0,("Unable to connect to CUPS server %s - %s\n", 
 			 cupsServer(), strerror(errno)));
 		return (1);
 	}
@@ -1270,7 +1270,7 @@
 	if ((response = cupsDoRequest(http, request, "/admin/")) != NULL)
 	{
 	  if (response->request.status.status_code >= IPP_OK_CONFLICT)
-		DEBUG(0,("Unable to resume printer %s - %s\n", PRINTERNAME(snum),
+		ZERODEBUG(0,("Unable to resume printer %s - %s\n", PRINTERNAME(snum),
 			 ippErrorString(cupsLastError())));
           else
 	  	ret = 0;
@@ -1278,7 +1278,7 @@
 	  ippDelete(response);
 	}
 	else
-	  DEBUG(0,("Unable to resume printer %s - %s\n", PRINTERNAME(snum),
+	  ZERODEBUG(0,("Unable to resume printer %s - %s\n", PRINTERNAME(snum),
 		   ippErrorString(cupsLastError())));
 
 	httpClose(http);
diff -Naur samba-2.2.12-orig/source/printing/print_generic.c samba-2.2.12/source/printing/print_generic.c
--- samba-2.2.12-orig/source/printing/print_generic.c	2004-08-12 20:24:22.000000000 +0200
+++ samba-2.2.12/source/printing/print_generic.c	2009-03-11 09:59:36.000000000 +0100
@@ -64,7 +64,7 @@
 	if (!command || !*command) return -1;
 
 	if (!VALID_SNUM(snum)) {
-		DEBUG(0,("Invalid snum %d for command %s\n", snum, command));
+		ZERODEBUG(0,("Invalid snum %d for command %s\n", snum, command));
 		return -1;
 	}
 
diff -Naur samba-2.2.12-orig/source/printing/printing.c samba-2.2.12/source/printing/printing.c
--- samba-2.2.12-orig/source/printing/printing.c	2004-08-12 20:24:22.000000000 +0200
+++ samba-2.2.12/source/printing/printing.c	2009-03-11 09:59:36.000000000 +0100
@@ -57,7 +57,7 @@
 		return True;
 	tdb = tdb_open_log(lock_path("printing.tdb"), 0, TDB_DEFAULT, O_RDWR|O_CREAT, 0600);
 	if (!tdb) {
-		DEBUG(0,("print_backend_init: Failed to open printing backend database %s.\n",
+		ZERODEBUG(0,("print_backend_init: Failed to open printing backend database %s.\n",
 					lock_path("printing.tdb") ));
 		return False;
 	}
@@ -385,7 +385,7 @@
 	slprintf(keystr, sizeof(keystr) - 1, "LOCK/%s", printer_name);
 	/* Only wait 10 seconds for this. */
 	if (tdb_lock_bystring(tdb, keystr, 10) == -1) {
-		DEBUG(0,("print_queue_update: Failed to lock printing database\n" ));
+		ZERODEBUG(0,("print_queue_update: Failed to lock printing database\n" ));
 		return;
 	}
 
@@ -1012,7 +1012,7 @@
 
 	/* Lock the database - only wait 20 seconds. */
 	if (tdb_lock_bystring(tdb, "INFO/nextjob", 20) == -1) {
-		DEBUG(0,("print_job_start: failed to lock printing database.\n"));
+		ZERODEBUG(0,("print_job_start: failed to lock printing database.\n"));
 		return -1;
 	}
 
@@ -1041,7 +1041,7 @@
 	if (pjob.fd == -1) {
 		if (errno == EACCES) {
 			/* Common setup error, force a report. */
-			DEBUG(0, ("print_job_start: insufficient permissions \
+			ZERODEBUG(0, ("print_job_start: insufficient permissions \
 to open spool file %s.\n", pjob.filename));
 		} else {
 			/* Normal case, report at level 3 and above. */
diff -Naur samba-2.2.12-orig/source/printing/print_svid.c samba-2.2.12/source/printing/print_svid.c
--- samba-2.2.12-orig/source/printing/print_svid.c	2004-08-12 20:24:21.000000000 +0200
+++ samba-2.2.12/source/printing/print_svid.c	2009-03-11 09:59:36.000000000 +0100
@@ -92,11 +92,11 @@
 		if ((ptmp = malloc(sizeof (*ptmp))) != NULL) {
 			ZERO_STRUCTP(ptmp);
 			if((ptmp->name = strdup(name)) == NULL)
-				DEBUG(0,("populate_printers: malloc fail in strdup !\n"));
+				ZERODEBUG(0,("populate_printers: malloc fail in strdup !\n"));
 			ptmp->next = printers;
 			printers = ptmp;
 		} else {
-			DEBUG(0,("populate_printers: malloc fail for ptmp\n"));
+			ZERODEBUG(0,("populate_printers: malloc fail for ptmp\n"));
 		}
 	}
 
diff -Naur samba-2.2.12-orig/source/profile/profile.c samba-2.2.12/source/profile/profile.c
--- samba-2.2.12-orig/source/profile/profile.c	2004-08-12 20:24:34.000000000 +0200
+++ samba-2.2.12/source/profile/profile.c	2009-03-11 09:59:36.000000000 +0100
@@ -115,7 +115,7 @@
 	}
 	
 	if (shm_id == -1) {
-		DEBUG(0,("Can't create or use IPC area. Error was %s\n", 
+		ZERODEBUG(0,("Can't create or use IPC area. Error was %s\n", 
 			 strerror(errno)));
 		return False;
 	}   
@@ -124,27 +124,27 @@
 	profile_h = (struct profile_header *)shmat(shm_id, 0, 
 						   read_only?SHM_RDONLY:0);
 	if ((long)profile_p == -1) {
-		DEBUG(0,("Can't attach to IPC area. Error was %s\n", 
+		ZERODEBUG(0,("Can't attach to IPC area. Error was %s\n", 
 			 strerror(errno)));
 		return False;
 	}
 
 	/* find out who created this memory area */
 	if (shmctl(shm_id, IPC_STAT, &shm_ds) != 0) {
-		DEBUG(0,("ERROR shmctl : can't IPC_STAT. Error was %s\n", 
+		ZERODEBUG(0,("ERROR shmctl : can't IPC_STAT. Error was %s\n", 
 			 strerror(errno)));
 		return False;
 	}
 
 #if 0
 	if (shm_ds.shm_perm.cuid != 0 || shm_ds.shm_perm.cgid != 0) {
-		DEBUG(0,("ERROR: root did not create the shmem\n"));
+		ZERODEBUG(0,("ERROR: root did not create the shmem\n"));
 		return False;
 	}
 #endif
 
 	if (shm_ds.shm_segsz != sizeof(*profile_h)) {
-		DEBUG(0,("WARNING: profile size is %d (expected %d). Deleting\n",
+		ZERODEBUG(0,("WARNING: profile size is %d (expected %d). Deleting\n",
 			 (int)shm_ds.shm_segsz, sizeof(*profile_h)));
 		if (shmctl(shm_id, IPC_RMID, &shm_ds) == 0) {
 			goto again;
diff -Naur samba-2.2.12-orig/source/rpcclient/cmd_spoolss.c samba-2.2.12/source/rpcclient/cmd_spoolss.c
--- samba-2.2.12-orig/source/rpcclient/cmd_spoolss.c	2004-08-12 20:24:20.000000000 +0200
+++ samba-2.2.12/source/rpcclient/cmd_spoolss.c	2009-03-11 09:59:37.000000000 +0100
@@ -958,7 +958,7 @@
 	
 	if (archi_table[i].long_archi == NULL)
 	{
-		DEBUG(0, ("set_drv_info_3_env: Unknown arch [%s]\n", arch));
+		ZERODEBUG(0, ("set_drv_info_3_env: Unknown arch [%s]\n", arch));
 	}
 	
 	return;
@@ -1033,7 +1033,7 @@
 	   NULL */
 	if ((info->dependentfiles=(uint16*)talloc(mem_ctx, (len+1)*sizeof(uint16))) == NULL)
 	{
-		DEBUG(0,("init_drv_info_3_members: Unable to malloc memory for dependenfiles\n"));
+		ZERODEBUG(0,("init_drv_info_3_members: Unable to malloc memory for dependenfiles\n"));
 		return False;
 	}
 	for (i=0; i<len; i++)
diff -Naur samba-2.2.12-orig/source/rpcclient/rpcclient.c samba-2.2.12/source/rpcclient/rpcclient.c
--- samba-2.2.12-orig/source/rpcclient/rpcclient.c	2004-08-12 20:24:20.000000000 +0200
+++ samba-2.2.12/source/rpcclient/rpcclient.c	2009-03-11 13:51:50.000000000 +0100
@@ -207,7 +207,7 @@
 
 	if (!(mem_ctx=talloc_init()))
 	{
-		DEBUG(0,("fetch_machine_sid: talloc_init returned NULL!\n"));
+		ZERODEBUG(0,("fetch_machine_sid: talloc_init returned NULL!\n"));
 		goto error;
 	}
 
@@ -359,12 +359,12 @@
                                int argc, char **argv)
 {
 	if (argc > 2) {
-		printf("Usage: %s [debuglevel]\n", argv[0]);
+		printf("Usage: %s\n", argv[0]);
 		return NT_STATUS_OK;
 	}
 
 	if (argc == 2) {
-		DEBUGLEVEL = atoi(argv[1]);
+		DEBUGLEVEL = 0;
 	}
 
 	printf("debuglevel is %d\n", DEBUGLEVEL);
@@ -428,7 +428,7 @@
 	struct cmd_list *entry;
 
 	if (!(entry = (struct cmd_list *)malloc(sizeof(struct cmd_list)))) {
-		DEBUG(0, ("out of memory\n"));
+		ZERODEBUG(0, ("out of memory\n"));
 		return;
 	}
 
@@ -486,7 +486,7 @@
                 /* Create mem_ctx */
 
                 if (!(mem_ctx = talloc_init())) {
-                        DEBUG(0, ("talloc_init() failed\n"));
+                        ZERODEBUG(0, ("talloc_init() failed\n"));
                         goto done;
                 }
 
@@ -494,7 +494,7 @@
 
                 if (cmd_entry->pipe)
                         if (!cli_nt_session_open(cli, cmd_entry->pipe)) {
-                                DEBUG(0, ("Could not initialise %s\n",
+                                ZERODEBUG(0, ("Could not initialise %s\n",
                                           cmd_entry->pipe));
                                 goto done;
                         }
@@ -590,7 +590,6 @@
 
 	printf("\t-A authfile           file containing user credentials\n");
 	printf("\t-c \"command string\"   execute semicolon separated cmds\n");
-	printf("\t-d debuglevel         set the debuglevel\n");
 	printf("\t-l logfile            name of logfile to use as opposed to stdout\n");
 	printf("\t-h                    Print this help message.\n");
 	printf("\t-N                    don't ask for a password\n");
@@ -626,7 +625,7 @@
 
 	setlinebuf(stdout);
 
-	DEBUGLEVEL = 1;
+	DEBUGLEVEL = 0;
 	AllowDebugChange = False;
 
 	/* Parse options */
@@ -646,7 +645,7 @@
 	pstrcpy(server, "");
 
         while (argc > optind) {
-		while ((opt = getopt(argc, argv, "A:s:Nd:U:W:c:l:h")) != EOF) {
+		while ((opt = getopt(argc, argv, "A:s:NU:W:c:l:h")) != EOF) {
 			switch (opt) {
 			case 'A':
 				/* only get the username, password, and domain from the file */
@@ -660,7 +659,7 @@
 				break;
 
 			case 'd':
-				DEBUGLEVEL = atoi(optarg);
+				DEBUGLEVEL = 0;
 				break;
 
 			case 'l':
diff -Naur samba-2.2.12-orig/source/rpcclient/samsync.c samba-2.2.12/source/rpcclient/samsync.c
--- samba-2.2.12-orig/source/rpcclient/samsync.c	2004-08-12 20:24:20.000000000 +0200
+++ samba-2.2.12/source/rpcclient/samsync.c	2009-03-11 13:51:50.000000000 +0100
@@ -36,19 +36,19 @@
         /* Initialise */
 
 	if (!(mem_ctx = talloc_init())) {
-		DEBUG(0,("talloc_init failed\n"));
+		ZERODEBUG(0,("talloc_init failed\n"));
 		return result;
 	}
 
 	if (!cli_nt_session_open (cli, PIPE_NETLOGON)) {
-		DEBUG(0, ("Could not initialize netlogon pipe!\n"));
+		ZERODEBUG(0, ("Could not initialize netlogon pipe!\n"));
 		goto done;
 	}
 
         /* Request a challenge */
 
         if (!NT_STATUS_IS_OK(new_cli_nt_setup_creds(cli, trust_passwd))) {
-                DEBUG(0, ("Error initialising session creds\n"));
+                ZERODEBUG(0, ("Error initialising session creds\n"));
                 goto done;
         }
 
@@ -132,7 +132,6 @@
 	printf("Usage: samsync [options]\n");
 	printf("Version: %s\n", VERSION);
 
-	printf("\t-d debuglevel         set the debuglevel\n");
 	printf("\t-h                    Print this help message.\n");
 	printf("\t-s configfile         specify an alternative config file\n");
 	printf("\t-S                    synchronise sam database\n");
@@ -190,14 +189,14 @@
         /* Look up name of PDC controller */
 
         if (!get_dc_list(True, lp_workgroup(), &dest_ip, &count)) {
-                DEBUG(0, ("Cannot find domain controller for domain %s\n",
+                ZERODEBUG(0, ("Cannot find domain controller for domain %s\n",
                           lp_workgroup()));
                 return NULL;
         }
 
         if (!lookup_pdc_name(global_myname, lp_workgroup(), dest_ip, 
                              dest_host)) {
-                DEBUG(0, ("Could not lookup up PDC name for domain %s\n",
+                ZERODEBUG(0, ("Could not lookup up PDC name for domain %s\n",
                           lp_workgroup()));
                 return NULL;
         }
@@ -244,13 +243,13 @@
 
         /* Parse command line options */
 
-        while((opt = getopt(argc, argv, "s:d:SR:hiU:W:p")) != EOF) {
+        while((opt = getopt(argc, argv, "s:SR:hiU:W:p")) != EOF) {
                 switch (opt) {
                 case 's':
                         pstrcpy(servicesf, optarg);
                         break;
                 case 'd':
-                        DEBUGLEVEL = atoi(optarg);
+                        DEBUGLEVEL = 0;
                         break;
                 case 'S':
                         do_sam_sync = 1;
@@ -334,13 +333,13 @@
         /* BDC operations require the machine account password */
 
         if (!secrets_init()) {
-                DEBUG(0, ("Unable to initialise secrets database\n"));
+                ZERODEBUG(0, ("Unable to initialise secrets database\n"));
                 return 1;
         }
 
 	if (!secrets_fetch_trust_account_password(lp_workgroup(), 
                                                   trust_passwd, NULL)) {
-		DEBUG(0, ("could not fetch trust account password\n"));
+		ZERODEBUG(0, ("could not fetch trust account password\n"));
 		return 1;
 	}        
 
@@ -356,7 +355,7 @@
                 result = sam_repl(&cli, trust_passwd, low_serial);
 
         if (!NT_STATUS_IS_OK(result)) {
-                DEBUG(0, ("%s\n", get_nt_error_msg(result)));
+                ZERODEBUG(0, ("%s\n", get_nt_error_msg(result)));
                 return 1;
         }
 
diff -Naur samba-2.2.12-orig/source/rpc_client/cli_login.c samba-2.2.12/source/rpc_client/cli_login.c
--- samba-2.2.12-orig/source/rpc_client/cli_login.c	2004-08-12 20:24:19.000000000 +0200
+++ samba-2.2.12/source/rpc_client/cli_login.c	2009-03-11 09:59:36.000000000 +0100
@@ -44,7 +44,7 @@
 	
 	/* Send a client challenge; receive a server challenge */
 	if (!cli_net_req_chal(cli, &clnt_chal, &srv_chal)) {
-		DEBUG(0,("cli_nt_setup_creds: request challenge failed\n"));
+		ZERODEBUG(0,("cli_nt_setup_creds: request challenge failed\n"));
 		return NT_STATUS_UNSUCCESSFUL;
 	}
 
@@ -69,7 +69,7 @@
 			SEC_CHAN_WKSTA : SEC_CHAN_BDC, 0x000001ff, &srv_chal);
   
 	if (!NT_STATUS_IS_OK(result)) {
-		DEBUG(0,("cli_nt_setup_creds: auth2 challenge failed\n"));
+		ZERODEBUG(0,("cli_nt_setup_creds: auth2 challenge failed\n"));
 		return result;
 	}
 
diff -Naur samba-2.2.12-orig/source/rpc_client/cli_netlogon.c samba-2.2.12/source/rpc_client/cli_netlogon.c
--- samba-2.2.12-orig/source/rpc_client/cli_netlogon.c	2004-08-12 20:24:19.000000000 +0200
+++ samba-2.2.12/source/rpc_client/cli_netlogon.c	2009-03-11 09:59:36.000000000 +0100
@@ -73,7 +73,7 @@
 
   /* turn parameters into data stream */
   if(!net_io_q_logon_ctrl2("", &q_l,  &buf, 0)) {
-    DEBUG(0,("cli_net_logon_ctrl2: Error : failed to marshall NET_Q_LOGON_CTRL2 struct.\n"));
+    ZERODEBUG(0,("cli_net_logon_ctrl2: Error : failed to marshall NET_Q_LOGON_CTRL2 struct.\n"));
     prs_mem_free(&buf);
     prs_mem_free(&rbuf);
     return False;
@@ -92,7 +92,7 @@
     if (ok && r_l.status != 0)
     {
       /* report error code */
-      DEBUG(0,("do_net_logon_ctrl2: Error %s\n", get_nt_error_msg(r_l.status)));
+      ZERODEBUG(0,("do_net_logon_ctrl2: Error %s\n", get_nt_error_msg(r_l.status)));
       cli->nt_error = r_l.status;
       ok = False;
     }
@@ -137,7 +137,7 @@
 
   /* turn parameters into data stream */
   if(!net_io_q_auth_2("", &q_a,  &buf, 0)) {
-    DEBUG(0,("cli_net_auth2: Error : failed to marshall NET_Q_AUTH_2 struct.\n"));
+    ZERODEBUG(0,("cli_net_auth2: Error : failed to marshall NET_Q_AUTH_2 struct.\n"));
     prs_mem_free(&buf);
     prs_mem_free(&rbuf);
     return result;
@@ -154,7 +154,7 @@
     if (ok && !NT_STATUS_IS_OK(result))
     {
       /* report error code */
-      DEBUG(0,("cli_net_auth2: Error %s\n", get_nt_error_msg(result)));
+      ZERODEBUG(0,("cli_net_auth2: Error %s\n", get_nt_error_msg(result)));
       ok = False;
     }
 
@@ -171,7 +171,7 @@
         /*
          * Server replied with bad credential. Fail.
          */
-        DEBUG(0,("cli_net_auth2: server %s replied with bad credential (bad machine \
+        ZERODEBUG(0,("cli_net_auth2: server %s replied with bad credential (bad machine \
 password ?).\n", cli->desthost ));
         ok = False;
       }
@@ -186,7 +186,7 @@
     if (ok && r_a.srv_flgs.neg_flags != q_a.clnt_flgs.neg_flags)
     {
       /* report different neg_flags */
-      DEBUG(0,("cli_net_auth2: error neg_flags (q,r) differ - (%x,%x)\n",
+      ZERODEBUG(0,("cli_net_auth2: error neg_flags (q,r) differ - (%x,%x)\n",
           q_a.clnt_flgs.neg_flags, r_a.srv_flgs.neg_flags));
       ok = False;
     }
@@ -226,7 +226,7 @@
 
   /* turn parameters into data stream */
   if(!net_io_q_req_chal("", &q_c,  &buf, 0)) {
-    DEBUG(0,("cli_net_req_chal: Error : failed to marshall NET_Q_REQ_CHAL struct.\n"));
+    ZERODEBUG(0,("cli_net_req_chal: Error : failed to marshall NET_Q_REQ_CHAL struct.\n"));
     prs_mem_free(&buf);
     prs_mem_free(&rbuf);
     return False;
@@ -243,7 +243,7 @@
     if (ok && !NT_STATUS_IS_OK(r_c.status))
     {
       /* report error code */
-      DEBUG(0,("cli_net_req_chal: Error %s\n", get_nt_error_msg(r_c.status)));
+      ZERODEBUG(0,("cli_net_req_chal: Error %s\n", get_nt_error_msg(r_c.status)));
       ok = False;
     }
 
@@ -292,7 +292,7 @@
 
   /* turn parameters into data stream */
   if(!net_io_q_srv_pwset("", &q_s,  &buf, 0)) {
-    DEBUG(0,("cli_net_srv_pwset: Error : failed to marshall NET_Q_SRV_PWSET struct.\n"));
+    ZERODEBUG(0,("cli_net_srv_pwset: Error : failed to marshall NET_Q_SRV_PWSET struct.\n"));
     prs_mem_free(&buf);
     prs_mem_free(&rbuf);
     return False;
@@ -308,7 +308,7 @@
     if (ok && !NT_STATUS_IS_OK(r_s.status))
     {
       /* report error code */
-      DEBUG(0,("cli_net_srv_pwset: %s\n", get_nt_error_msg(r_s.status)));
+      ZERODEBUG(0,("cli_net_srv_pwset: %s\n", get_nt_error_msg(r_s.status)));
       ok = False;
     }
 
@@ -318,7 +318,7 @@
       /*
        * Server replied with bad credential. Fail.
        */
-      DEBUG(0,("cli_net_srv_pwset: server %s replied with bad credential (bad machine \
+      ZERODEBUG(0,("cli_net_srv_pwset: server %s replied with bad credential (bad machine \
 password ?).\n", cli->desthost ));
       ok = False;
     }
@@ -370,14 +370,14 @@
 
 	/* turn parameters into data stream */
 	if(!net_io_q_sam_logon("", &q_s,  &buf, 0)) {
-		DEBUG(0,("cli_net_sam_logon_internal: Error : failed to marshall NET_Q_SAM_LOGON struct.\n"));
+		ZERODEBUG(0,("cli_net_sam_logon_internal: Error : failed to marshall NET_Q_SAM_LOGON struct.\n"));
 		retval = NT_STATUS_NO_MEMORY;
 		goto out;
 	}
 
 	/* send the data on \PIPE\ */
 	if (!rpc_api_pipe_req(cli, NET_SAMLOGON, &buf, &rbuf)) {
-		DEBUG(0,("cli_net_sam_logon_internal: Error rpc_api_pipe_req failed.\n"));
+		ZERODEBUG(0,("cli_net_sam_logon_internal: Error rpc_api_pipe_req failed.\n"));
                 retval = NT_STATUS_UNSUCCESSFUL;
 		goto out;
 	}
@@ -385,7 +385,7 @@
 	r_s.user = user_info3;
 
 	if(!net_io_r_sam_logon("", &r_s, &rbuf, 0)) {
-		DEBUG(0,("cli_net_sam_logon_internal: Error : failed to unmarshal NET_R_SAM_LOGON struct.\n"));
+		ZERODEBUG(0,("cli_net_sam_logon_internal: Error : failed to unmarshal NET_R_SAM_LOGON struct.\n"));
 		retval = NT_STATUS_NO_MEMORY;
 		goto out;
 	}
@@ -403,7 +403,7 @@
 
 	if (!NT_STATUS_IS_OK(retval)) {
 		/* report error code */
-		DEBUG(0,("cli_net_sam_logon_internal: %s\n", get_nt_error_msg(r_s.status)));
+		ZERODEBUG(0,("cli_net_sam_logon_internal: %s\n", get_nt_error_msg(r_s.status)));
 		goto out;
     }
 
@@ -412,14 +412,14 @@
 		/*
 		 * Server replied with bad credential. Fail.
 		 */
-		DEBUG(0,("cli_net_sam_logon_internal: server %s replied with bad credential (bad machine \
+		ZERODEBUG(0,("cli_net_sam_logon_internal: server %s replied with bad credential (bad machine \
 password ?).\n", cli->desthost ));
 		retval = NT_STATUS_WRONG_PASSWORD;
     }
 
     if (r_s.switch_value != validation_level) {
 		/* report different switch_value */
-		DEBUG(0,("cli_net_sam_logon: switch_value of %x expected %x\n", (unsigned int)validation_level,
+		ZERODEBUG(0,("cli_net_sam_logon: switch_value of %x expected %x\n", (unsigned int)validation_level,
 					(unsigned int)r_s.switch_value));
 		retval = NT_STATUS_INVALID_PARAMETER;
     }
@@ -502,7 +502,7 @@
 
   /* turn parameters into data stream */
   if(!net_io_q_sam_logoff("", &q_s,  &buf, 0)) {
-    DEBUG(0,("cli_net_sam_logoff: Error : failed to marshall NET_Q_SAM_LOGOFF struct.\n"));
+    ZERODEBUG(0,("cli_net_sam_logoff: Error : failed to marshall NET_Q_SAM_LOGOFF struct.\n"));
     prs_mem_free(&buf);
     prs_mem_free(&rbuf);
     return False;
@@ -518,7 +518,7 @@
     if (ok && !NT_STATUS_IS_OK(r_s.status))
     {
       /* report error code */
-      DEBUG(0,("cli_net_sam_logoff: %s\n", get_nt_error_msg(r_s.status)));
+      ZERODEBUG(0,("cli_net_sam_logoff: %s\n", get_nt_error_msg(r_s.status)));
       ok = False;
     }
 
@@ -528,7 +528,7 @@
       /*
        * Server replied with bad credential. Fail.
        */
-      DEBUG(0,("cli_net_sam_logoff: server %s replied with bad credential (bad machine \
+      ZERODEBUG(0,("cli_net_sam_logoff: server %s replied with bad credential (bad machine \
 password ?).\n", cli->desthost ));
       ok = False;
     }
diff -Naur samba-2.2.12-orig/source/rpc_client/cli_pipe.c samba-2.2.12/source/rpc_client/cli_pipe.c
--- samba-2.2.12-orig/source/rpc_client/cli_pipe.c	2004-08-12 20:24:19.000000000 +0200
+++ samba-2.2.12/source/rpc_client/cli_pipe.c	2009-03-11 09:59:36.000000000 +0100
@@ -59,7 +59,7 @@
 
 	if (extra_data_size > 0) {
 		if(!prs_force_grow(rdata, (uint32)extra_data_size)) {
-			DEBUG(0,("rpc_read: Failed to grow parse struct by %d bytes.\n", extra_data_size ));
+			ZERODEBUG(0,("rpc_read: Failed to grow parse struct by %d bytes.\n", extra_data_size ));
 			return False;
 		}
 		DEBUG(5,("rpc_read: grew buffer by %d bytes to %u\n", extra_data_size, prs_data_size(rdata) ));
@@ -83,7 +83,7 @@
         if (cli_is_dos_error(cli)) {
 			cli_dos_error(cli, &eclass, &ecode);
 			if (eclass != ERRDOS && ecode != ERRmoredata) {
-                                DEBUG(0,("rpc_read: Error %d/%u in cli_read\n",
+                                ZERODEBUG(0,("rpc_read: Error %d/%u in cli_read\n",
                                          eclass, (unsigned int)ecode));
 				return False;
 			}
@@ -116,12 +116,12 @@
 	/* Next call sets endian bit. */
 
 	if(!smb_io_rpc_hdr("rpc_hdr   ", rhdr, rdata, 0)) {
-		DEBUG(0,("rpc_check_hdr: Failed to unmarshall RPC_HDR.\n"));
+		ZERODEBUG(0,("rpc_check_hdr: Failed to unmarshall RPC_HDR.\n"));
 		return False;
 	}
 
 	if (prs_offset(rdata) != RPC_HEADER_LEN) {
-		DEBUG(0,("rpc_check_hdr: offset was %x, should be %x.\n", prs_offset(rdata), RPC_HEADER_LEN));
+		ZERODEBUG(0,("rpc_check_hdr: offset was %x, should be %x.\n", prs_offset(rdata), RPC_HEADER_LEN));
 		return False;
 	}
 
@@ -218,7 +218,7 @@
 		char *dp = prs_data_p(rdata) + len - auth_len - RPC_HDR_AUTH_LEN;
 
 		if(dp - prs_data_p(rdata) > prs_data_size(rdata)) {
-			DEBUG(0,("rpc_auth_pipe: auth data > data size !\n"));
+			ZERODEBUG(0,("rpc_auth_pipe: auth data > data size !\n"));
 			return False;
 		}
 
@@ -238,12 +238,12 @@
 		 */
 
 		if(!smb_io_rpc_hdr_auth("hdr_auth", &rhdr_auth, &auth_req, 0)) {
-			DEBUG(0,("rpc_auth_pipe: unmarshalling RPC_HDR_AUTH failed.\n"));
+			ZERODEBUG(0,("rpc_auth_pipe: unmarshalling RPC_HDR_AUTH failed.\n"));
 			return False;
 		}
 
 		if (!rpc_hdr_auth_chk(&rhdr_auth)) {
-			DEBUG(0,("rpc_auth_pipe: rpc_hdr_auth_chk failed.\n"));
+			ZERODEBUG(0,("rpc_auth_pipe: rpc_hdr_auth_chk failed.\n"));
 			return False;
 		}
 	}
@@ -262,7 +262,7 @@
 		char *dp = prs_data_p(rdata) + len - auth_len;
 
 		if(dp - prs_data_p(rdata) > prs_data_size(rdata)) {
-			DEBUG(0,("rpc_auth_pipe: auth data > data size !\n"));
+			ZERODEBUG(0,("rpc_auth_pipe: auth data > data size !\n"));
 			return False;
 		}
 
@@ -281,14 +281,14 @@
 		prs_give_memory(&auth_verf, data, RPC_AUTH_NTLMSSP_CHK_LEN, False);
 
 		if(!smb_io_rpc_auth_ntlmssp_chk("auth_sign", &chk, &auth_verf, 0)) {
-			DEBUG(0,("rpc_auth_pipe: unmarshalling RPC_AUTH_NTLMSSP_CHK failed.\n"));
+			ZERODEBUG(0,("rpc_auth_pipe: unmarshalling RPC_AUTH_NTLMSSP_CHK failed.\n"));
 			return False;
 		}
 
 		crc32 = crc32_calc_buffer(reply_data, data_len);
 
 		if (!rpc_auth_ntlmssp_chk(&chk, crc32 , cli->ntlmssp_seq_num)) {
-			DEBUG(0,("rpc_auth_pipe: rpc_auth_ntlmssp_chk failed.\n"));
+			ZERODEBUG(0,("rpc_auth_pipe: rpc_auth_ntlmssp_chk failed.\n"));
 			return False;
 		}
 		cli->ntlmssp_seq_num++;
@@ -356,7 +356,7 @@
 	          &rparam, &rparam_len,            /* return params, len */
 	          &prdata, &rdata_len))            /* return data, len */
 	{
-		DEBUG(0, ("cli_pipe: return critical error. Error was %s\n", cli_errstr(cli)));
+		ZERODEBUG(0, ("cli_pipe: return critical error. Error was %s\n", cli_errstr(cli)));
 		return False;
 	}
 
@@ -365,7 +365,7 @@
 	SAFE_FREE(rparam);
 
 	if (prdata == NULL) {
-		DEBUG(0,("rpc_api_pipe: cmd %x on pipe %x failed to return data.\n",
+		ZERODEBUG(0,("rpc_api_pipe: cmd %x on pipe %x failed to return data.\n",
 			(int)cmd, (int)cli->nt_pipe_fnum));
 		return False;
 	}
@@ -470,7 +470,7 @@
 		if (cli_is_dos_error(cli)) {
 			cli_dos_error(cli, &eclass, &ecode);
 			if (eclass != ERRDOS && ecode != ERRmoredata) {
-				DEBUG(0,("rpc_api_pipe: cli_read error : %d/%d\n", eclass, ecode));
+				ZERODEBUG(0,("rpc_api_pipe: cli_read error : %d/%d\n", eclass, ecode));
 				return False;
 			}
 		}
@@ -478,7 +478,7 @@
 		DEBUG(5,("rpc_api_pipe: read header (size:%d)\n", num_read));
 
 		if (num_read != RPC_HEADER_LEN+RPC_HDR_RESP_LEN) {
-			DEBUG(0,("rpc_api_pipe: Error : requested %d bytes, got %d.\n",
+			ZERODEBUG(0,("rpc_api_pipe: Error : requested %d bytes, got %d.\n",
 				RPC_HEADER_LEN+RPC_HDR_RESP_LEN, num_read ));
 			return False;
 		}
@@ -491,19 +491,19 @@
 		/* Ensure the endianness in rdata is set correctly - must be same as hps. */
 
 		if (hps.bigendian_data != rdata->bigendian_data) {
-			DEBUG(0,("rpc_api_pipe: Error : Endianness changed from %s to %s\n",
+			ZERODEBUG(0,("rpc_api_pipe: Error : Endianness changed from %s to %s\n",
 				rdata->bigendian_data ? "big" : "little",
 				hps.bigendian_data ? "big" : "little" ));
 			return False;
 		}
 
 		if(!smb_io_rpc_hdr_resp("rpc_hdr_resp", &rhdr_resp, &hps, 0)) {
-			DEBUG(0,("rpc_api_pipe: Error in unmarshalling RPC_HDR_RESP.\n"));
+			ZERODEBUG(0,("rpc_api_pipe: Error in unmarshalling RPC_HDR_RESP.\n"));
 			return False;
 		}
 
 		if (first) {
-			DEBUG(0,("rpc_api_pipe: secondary PDU rpc header has 'first' set !\n"));
+			ZERODEBUG(0,("rpc_api_pipe: secondary PDU rpc header has 'first' set !\n"));
 			return False;
 		}
 
@@ -579,17 +579,17 @@
 		 */
 
 		if(!smb_io_rpc_hdr_auth("hdr_auth", &hdr_auth, &auth_info, 0)) {
-			DEBUG(0,("create_rpc_bind_req: failed to marshall RPC_HDR_AUTH.\n"));
+			ZERODEBUG(0,("create_rpc_bind_req: failed to marshall RPC_HDR_AUTH.\n"));
 			return False;
 		}
 
 		if(!smb_io_rpc_auth_verifier("auth_verifier", &auth_verifier, &auth_info, 0)) {
-			DEBUG(0,("create_rpc_bind_req: failed to marshall RPC_AUTH_VERIFIER.\n"));
+			ZERODEBUG(0,("create_rpc_bind_req: failed to marshall RPC_AUTH_VERIFIER.\n"));
 			return False;
 		}
 
 		if(!smb_io_rpc_auth_ntlmssp_neg("ntlmssp_neg", &ntlmssp_neg, &auth_info, 0)) {
-			DEBUG(0,("create_rpc_bind_req: failed to marshall RPC_AUTH_NTLMSSP_NEG.\n"));
+			ZERODEBUG(0,("create_rpc_bind_req: failed to marshall RPC_AUTH_NTLMSSP_NEG.\n"));
 			return False;
 		}
 
@@ -603,7 +603,7 @@
 		auth_len);
 
 	if(!smb_io_rpc_hdr("hdr"   , &hdr, rpc_out, 0)) {
-		DEBUG(0,("create_rpc_bind_req: failed to marshall RPC_HDR.\n"));
+		ZERODEBUG(0,("create_rpc_bind_req: failed to marshall RPC_HDR.\n"));
 		return False;
 	}
 
@@ -613,7 +613,7 @@
 
 	/* Marshall the bind request data */
 	if(!smb_io_rpc_hdr_rb("", &hdr_rb, rpc_out, 0)) {
-		DEBUG(0,("create_rpc_bind_req: failed to marshall RPC_HDR_RB.\n"));
+		ZERODEBUG(0,("create_rpc_bind_req: failed to marshall RPC_HDR_RB.\n"));
 		return False;
 	}
 
@@ -623,7 +623,7 @@
 
 	if(hdr.auth_len != 0) {
 		if(!prs_append_prs_data( rpc_out, &auth_info)) {
-			DEBUG(0,("create_rpc_bind_req: failed to grow parse struct to add auth.\n"));
+			ZERODEBUG(0,("create_rpc_bind_req: failed to grow parse struct to add auth.\n"));
 			return False;
 		}
 	}
@@ -683,12 +683,12 @@
 	 */
 
 	if(!smb_io_rpc_auth_verifier("auth_verifier", &auth_verifier, &auth_info, 0)) {
-		DEBUG(0,("create_rpc_bind_resp: failed to marshall RPC_AUTH_VERIFIER.\n"));
+		ZERODEBUG(0,("create_rpc_bind_resp: failed to marshall RPC_AUTH_VERIFIER.\n"));
 		return False;
 	}
 
 	if(!smb_io_rpc_auth_ntlmssp_resp("ntlmssp_resp", &ntlmssp_resp, &auth_info, 0)) {
-		DEBUG(0,("create_rpc_bind_resp: failed to marshall RPC_AUTH_NTLMSSP_RESP.\n"));
+		ZERODEBUG(0,("create_rpc_bind_resp: failed to marshall RPC_AUTH_NTLMSSP_RESP.\n"));
 		return False;
 	}
 
@@ -699,7 +699,7 @@
 
 	/* Marshall it. */
 	if(!smb_io_rpc_hdr("hdr", &hdr, rpc_out, 0)) {
-		DEBUG(0,("create_rpc_bind_resp: failed to marshall RPC_HDR.\n"));
+		ZERODEBUG(0,("create_rpc_bind_resp: failed to marshall RPC_HDR.\n"));
 		return False;
 	}
 
@@ -708,7 +708,7 @@
 			NTLMSSP_AUTH_TYPE, NTLMSSP_AUTH_LEVEL, 0x00);
 
 	if(!smb_io_rpc_hdr_autha("hdr_autha", &hdr_autha, rpc_out, 0)) {
-		DEBUG(0,("create_rpc_bind_resp: failed to marshall RPC_HDR_AUTHA.\n"));
+		ZERODEBUG(0,("create_rpc_bind_resp: failed to marshall RPC_HDR_AUTHA.\n"));
 		return False;
 	}
 
@@ -717,7 +717,7 @@
 	 */
 
 	if(!prs_append_prs_data(rpc_out, &auth_info)) {
-		DEBUG(0,("create_rpc_bind_req: failed to grow parse struct to add auth.\n"));
+		ZERODEBUG(0,("create_rpc_bind_req: failed to grow parse struct to add auth.\n"));
 		return False;
 	}
 
@@ -816,7 +816,7 @@
 	 */
 
 	if(!prs_init(&outgoing_packet, data_len + 8, cli->mem_ctx, MARSHALL)) {
-		DEBUG(0,("rpc_api_pipe_req: Failed to malloc %u bytes.\n", (unsigned int)data_len ));
+		ZERODEBUG(0,("rpc_api_pipe_req: Failed to malloc %u bytes.\n", (unsigned int)data_len ));
 		return False;
 	}
 
@@ -827,7 +827,7 @@
 	 */
 
 	if(!create_rpc_request(&outgoing_packet, op_num, data_len, auth_len)) {
-		DEBUG(0,("rpc_api_pipe_req: Failed to create RPC request.\n"));
+		ZERODEBUG(0,("rpc_api_pipe_req: Failed to create RPC request.\n"));
 		prs_mem_free(&outgoing_packet);
 		return False;
 	}
@@ -846,7 +846,7 @@
 	 */
 
 	if(!prs_append_prs_data( &outgoing_packet, data)) {
-		DEBUG(0,("rpc_api_pipe_req: Failed to append data to outgoing packet.\n"));
+		ZERODEBUG(0,("rpc_api_pipe_req: Failed to append data to outgoing packet.\n"));
 		prs_mem_free(&outgoing_packet);
 		return False;
 	}
@@ -861,7 +861,7 @@
 		init_rpc_hdr_auth(&hdr_auth, NTLMSSP_AUTH_TYPE,
 			NTLMSSP_AUTH_LEVEL, 0x08, (auth_verify ? 1 : 0));
 		if(!smb_io_rpc_hdr_auth("hdr_auth", &hdr_auth, &outgoing_packet, 0)) {
-			DEBUG(0,("rpc_api_pipe_req: Failed to marshal RPC_HDR_AUTH.\n"));
+			ZERODEBUG(0,("rpc_api_pipe_req: Failed to marshal RPC_HDR_AUTH.\n"));
 			prs_mem_free(&outgoing_packet);
 			return False;
 		}
@@ -877,7 +877,7 @@
 
 		init_rpc_auth_ntlmssp_chk(&chk, NTLMSSP_SIGN_VERSION, crc32, cli->ntlmssp_seq_num++);
 		if(!smb_io_rpc_auth_ntlmssp_chk("auth_sign", &chk, &outgoing_packet, 0)) {
-			DEBUG(0,("rpc_api_pipe_req: Failed to marshal RPC_AUTH_NTLMSSP_CHK.\n"));
+			ZERODEBUG(0,("rpc_api_pipe_req: Failed to marshal RPC_AUTH_NTLMSSP_CHK.\n"));
 			prs_mem_free(&outgoing_packet);
 			return False;
 		}
@@ -1000,7 +1000,7 @@
 	/* check the transfer syntax */
 	if ((hdr_ba->transfer.version != transfer->version) ||
 	     (memcmp(&hdr_ba->transfer.uuid, &transfer->uuid, sizeof(transfer->uuid)) !=0)) {
-		DEBUG(0,("bind_rpc_pipe: transfer syntax differs\n"));
+		ZERODEBUG(0,("bind_rpc_pipe: transfer syntax differs\n"));
 		return False;
 	}
 
@@ -1032,15 +1032,15 @@
 	unsigned char lm_hash[16];
 
 	if(!smb_io_rpc_hdr_auth("", &rhdr_auth, rdata, 0)) {
-		DEBUG(0,("rpc_send_auth_reply: Failed to unmarshall RPC_HDR_AUTH.\n"));
+		ZERODEBUG(0,("rpc_send_auth_reply: Failed to unmarshall RPC_HDR_AUTH.\n"));
 		return False;
 	}
 	if(!smb_io_rpc_auth_verifier("", &rhdr_verf, rdata, 0)) {
-		DEBUG(0,("rpc_send_auth_reply: Failed to unmarshall RPC_AUTH_VERIFIER.\n"));
+		ZERODEBUG(0,("rpc_send_auth_reply: Failed to unmarshall RPC_AUTH_VERIFIER.\n"));
 		return False;
 	}
 	if(!smb_io_rpc_auth_ntlmssp_chal("", &rhdr_chal, rdata, 0)) {
-		DEBUG(0,("rpc_send_auth_reply: Failed to unmarshall RPC_AUTH_NTLMSSP_CHAL.\n"));
+		ZERODEBUG(0,("rpc_send_auth_reply: Failed to unmarshall RPC_AUTH_NTLMSSP_CHAL.\n"));
 		return False;
 	}
 
@@ -1093,7 +1093,7 @@
 
 	if ((ret = cli_write(cli, cli->nt_pipe_fnum, 0x8, prs_data_p(&rpc_out), 
 			0, (size_t)prs_offset(&rpc_out))) != (ssize_t)prs_offset(&rpc_out)) {
-		DEBUG(0,("rpc_send_auth_reply: cli_write failed. Return was %d\n", (int)ret));
+		ZERODEBUG(0,("rpc_send_auth_reply: cli_write failed. Return was %d\n", (int)ret));
 		return False;
 	}
 
@@ -1145,13 +1145,13 @@
 		DEBUG(5, ("rpc_pipe_bind: rpc_api_pipe returned OK.\n"));
 
 		if(!smb_io_rpc_hdr_ba("", &hdr_ba, &rdata, 0)) {
-			DEBUG(0,("rpc_pipe_bind: Failed to unmarshall RPC_HDR_BA.\n"));
+			ZERODEBUG(0,("rpc_pipe_bind: Failed to unmarshall RPC_HDR_BA.\n"));
 			prs_mem_free(&rdata);
 			return False;
 		}
 
 		if(!check_bind_response(&hdr_ba, pipe_name, &transfer)) {
-			DEBUG(0,("rpc_pipe_bind: check_bind_response failed.\n"));
+			ZERODEBUG(0,("rpc_pipe_bind: check_bind_response failed.\n"));
 			prs_mem_free(&rdata);
 			return False;
 		}
@@ -1166,7 +1166,7 @@
 		 */
 
 		if (do_auth && !rpc_send_auth_reply(cli, &rdata, rpc_call_id)) {
-			DEBUG(0,("rpc_pipe_bind: rpc_send_auth_reply failed.\n"));
+			ZERODEBUG(0,("rpc_pipe_bind: rpc_send_auth_reply failed.\n"));
 			prs_mem_free(&rdata);
 			return False;
 		}
@@ -1198,7 +1198,7 @@
 
 	if (cli->capabilities & CAP_NT_SMBS) {
 		if ((fnum = cli_nt_create(cli, &pipe_name[5], DESIRED_ACCESS_PIPE)) == -1) {
-			DEBUG(0,("cli_nt_session_open: cli_nt_create failed on pipe %s to machine %s.  Error was %s\n",
+			ZERODEBUG(0,("cli_nt_session_open: cli_nt_create failed on pipe %s to machine %s.  Error was %s\n",
 				 &pipe_name[5], cli->desthost, cli_errstr(cli)));
 			return False;
 		}
@@ -1206,7 +1206,7 @@
 		cli->nt_pipe_fnum = (uint16)fnum;
 	} else {
 		if ((fnum = cli_open(cli, pipe_name, O_CREAT|O_RDWR, DENY_NONE)) == -1) {
-			DEBUG(0,("cli_nt_session_open: cli_open failed on pipe %s to machine %s.  Error was %s\n",
+			ZERODEBUG(0,("cli_nt_session_open: cli_open failed on pipe %s to machine %s.  Error was %s\n",
 				 pipe_name, cli->desthost, cli_errstr(cli)));
 			return False;
 		}
@@ -1215,7 +1215,7 @@
 
 		/**************** Set Named Pipe State ***************/
 		if (!rpc_pipe_set_hnd_state(cli, pipe_name, 0x4300)) {
-			DEBUG(0,("cli_nt_session_open: pipe hnd state failed.  Error was %s\n",
+			ZERODEBUG(0,("cli_nt_session_open: pipe hnd state failed.  Error was %s\n",
 				  cli_errstr(cli)));
 			cli_close(cli, cli->nt_pipe_fnum);
 			return False;
@@ -1225,7 +1225,7 @@
 	/******************* bind request on pipe *****************/
 
 	if (!rpc_pipe_bind(cli, pipe_name, global_myname)) {
-		DEBUG(0,("cli_nt_session_open: rpc bind failed. Error was %s\n",
+		ZERODEBUG(0,("cli_nt_session_open: rpc bind failed. Error was %s\n",
 		          cli_errstr(cli)));
 		cli_close(cli, cli->nt_pipe_fnum);
 		return False;
diff -Naur samba-2.2.12-orig/source/rpc_client/cli_spoolss_notify.c samba-2.2.12/source/rpc_client/cli_spoolss_notify.c
--- samba-2.2.12-orig/source/rpc_client/cli_spoolss_notify.c	2004-08-12 20:24:19.000000000 +0200
+++ samba-2.2.12/source/rpc_client/cli_spoolss_notify.c	2009-03-11 09:59:36.000000000 +0100
@@ -71,30 +71,30 @@
 {
 	ZERO_STRUCTP(cli);
 	if(cli_initialise(cli) == NULL) {
-		DEBUG(0,("connect_to_client: unable to initialize client connection.\n"));
+		ZERODEBUG(0,("connect_to_client: unable to initialize client connection.\n"));
 		return False;
 	}
 
 	if(!resolve_name( remote_machine, &cli->dest_ip, 0x20)) {
-		DEBUG(0,("connect_to_client: Can't resolve address for %s\n", remote_machine));
+		ZERODEBUG(0,("connect_to_client: Can't resolve address for %s\n", remote_machine));
 		cli_shutdown(cli);
 	return False;
 	}
 
 	if (ismyip(cli->dest_ip)) {
-		DEBUG(0,("connect_to_client: Machine %s is one of our addresses. Cannot add to ourselves.\n", remote_machine));
+		ZERODEBUG(0,("connect_to_client: Machine %s is one of our addresses. Cannot add to ourselves.\n", remote_machine));
 		cli_shutdown(cli);
 		return False;
 	}
 
 	if (!cli_connect(cli, remote_machine, &cli->dest_ip)) {
-		DEBUG(0,("connect_to_client: unable to connect to SMB server on machine %s. Error was : %s.\n", remote_machine, cli_errstr(cli) ));
+		ZERODEBUG(0,("connect_to_client: unable to connect to SMB server on machine %s. Error was : %s.\n", remote_machine, cli_errstr(cli) ));
 		cli_shutdown(cli);
 		return False;
 	}
   
 	if (!attempt_netbios_session_request(cli, global_myname, remote_machine, &cli->dest_ip)) {
-		DEBUG(0,("connect_to_client: machine %s rejected the NetBIOS session request.\n", 
+		ZERODEBUG(0,("connect_to_client: machine %s rejected the NetBIOS session request.\n", 
 			remote_machine));
 		cli_shutdown(cli);
 		return False;
@@ -103,13 +103,13 @@
 	cli->protocol = PROTOCOL_NT1;
     
 	if (!cli_negprot(cli)) {
-		DEBUG(0,("connect_to_client: machine %s rejected the negotiate protocol. Error was : %s.\n", remote_machine, cli_errstr(cli) ));
+		ZERODEBUG(0,("connect_to_client: machine %s rejected the negotiate protocol. Error was : %s.\n", remote_machine, cli_errstr(cli) ));
 		cli_shutdown(cli);
 		return False;
 	}
 
 	if (cli->protocol != PROTOCOL_NT1) {
-		DEBUG(0,("connect_to_client: machine %s didn't negotiate NT protocol.\n", remote_machine));
+		ZERODEBUG(0,("connect_to_client: machine %s didn't negotiate NT protocol.\n", remote_machine));
 		cli_shutdown(cli);
 		return False;
 	}
@@ -119,19 +119,19 @@
 	 */
     
 	if (!cli_session_setup(cli, "", "", 0, "", 0, "")) {
-		DEBUG(0,("connect_to_client: machine %s rejected the session setup. Error was : %s.\n", remote_machine, cli_errstr(cli) ));
+		ZERODEBUG(0,("connect_to_client: machine %s rejected the session setup. Error was : %s.\n", remote_machine, cli_errstr(cli) ));
 		cli_shutdown(cli);
 		return False;
 	}
     
 	if (!(cli->sec_mode & NEGOTIATE_SECURITY_USER_LEVEL)) {
-		DEBUG(0,("connect_to_client: machine %s isn't in user level security mode\n", remote_machine));
+		ZERODEBUG(0,("connect_to_client: machine %s isn't in user level security mode\n", remote_machine));
 		cli_shutdown(cli);
 		return False;
 	}
     
 	if (!cli_send_tconX(cli, "IPC$", "IPC", "", 1)) {
-		DEBUG(0,("connect_to_client: machine %s rejected the tconX on the IPC$ share. Error was : %s.\n", remote_machine, cli_errstr(cli) ));
+		ZERODEBUG(0,("connect_to_client: machine %s rejected the tconX on the IPC$ share. Error was : %s.\n", remote_machine, cli_errstr(cli) ));
 		cli_shutdown(cli);
 		return False;
 	}
@@ -142,7 +142,7 @@
 	 */
 
 	if(cli_nt_session_open(cli, PIPE_SPOOLSS) == False) {
-		DEBUG(0,("connect_to_client: unable to open the domain client session to machine %s. Error was : %s.\n", remote_machine, cli_errstr(cli)));
+		ZERODEBUG(0,("connect_to_client: unable to open the domain client session to machine %s. Error was : %s.\n", remote_machine, cli_errstr(cli)));
 		cli_nt_session_close(cli);
 		cli_ulogoff(cli);
 		cli_shutdown(cli);
@@ -183,7 +183,7 @@
 
 	/* turn parameters into data stream */
 	if(!spoolss_io_q_replyopenprinter("", &q_s,  &buf, 0)) {
-		DEBUG(0,("cli_spoolss_reply_open_printer: Error : failed to marshall SPOOL_Q_REPLYOPENPRINTER struct.\n"));
+		ZERODEBUG(0,("cli_spoolss_reply_open_printer: Error : failed to marshall SPOOL_Q_REPLYOPENPRINTER struct.\n"));
 		goto done;
 	}
 
@@ -193,7 +193,7 @@
 	
 	/* turn data stream into parameters*/
 	if(!spoolss_io_r_replyopenprinter("", &r_s, &rbuf, 0)) {
-		DEBUG(0,("cli_spoolss_reply_open_printer: Error : failed to unmarshall SPOOL_R_REPLYOPENPRINTER struct.\n"));
+		ZERODEBUG(0,("cli_spoolss_reply_open_printer: Error : failed to unmarshall SPOOL_R_REPLYOPENPRINTER struct.\n"));
 		goto done;
 	}
 	
@@ -231,7 +231,7 @@
 
 	/* turn parameters into data stream */
 	if(!spoolss_io_q_replycloseprinter("", &q_s,  &buf, 0)) {
-		DEBUG(0,("cli_spoolss_reply_close_printer: Error : failed to marshall SPOOL_Q_REPLY_CLOSEPRINTER struct.\n"));
+		ZERODEBUG(0,("cli_spoolss_reply_close_printer: Error : failed to marshall SPOOL_Q_REPLY_CLOSEPRINTER struct.\n"));
 		goto done;
 	}
 
@@ -241,7 +241,7 @@
 
 	/* turn data stream into parameters*/
 	if(!spoolss_io_r_replycloseprinter("", &r_s, &rbuf, 0)) {
-		DEBUG(0,("cli_spoolss_reply_close_printer: Error : failed to marshall SPOOL_R_REPLY_CLOSEPRINTER struct.\n"));
+		ZERODEBUG(0,("cli_spoolss_reply_close_printer: Error : failed to marshall SPOOL_R_REPLY_CLOSEPRINTER struct.\n"));
 		goto done;
 	}
 	
@@ -286,7 +286,7 @@
 
 	/* Marshall data and send request */
 	if (!spoolss_io_q_routerreplyprinter ("", &q, &qbuf, 0)) {
-		DEBUG(0,("cli_spoolss_routerreplyprinter: Unable to marshall SPOOL_Q_ROUTERREPLYPRINTER!\n"));
+		ZERODEBUG(0,("cli_spoolss_routerreplyprinter: Unable to marshall SPOOL_Q_ROUTERREPLYPRINTER!\n"));
 		goto done;
 	}
 		
@@ -296,7 +296,7 @@
 
 	/* Unmarshall response */
 	if (!spoolss_io_r_routerreplyprinter ("", &r, &rbuf, 0)) {
-		DEBUG(0,("cli_spoolss_routerreplyprinter: Unable to unmarshall SPOOL_R_ROUTERREPLYPRINTER!\n"));
+		ZERODEBUG(0,("cli_spoolss_routerreplyprinter: Unable to unmarshall SPOOL_R_ROUTERREPLYPRINTER!\n"));
 		goto done;
 	}
 		
@@ -329,7 +329,7 @@
 			DEBUG(10,("build_notify_data: %s set on [%s][%d]\n", msg_table[i].name,
 				printer->info_2->printername, idx));
 			if ((data=Realloc(*notify_data, (idx+1)*sizeof(SPOOL_NOTIFY_INFO_DATA))) == NULL) {
-				DEBUG(0,("build_notify_data: Realloc() failed with size [%d]!\n",
+				ZERODEBUG(0,("build_notify_data: Realloc() failed with size [%d]!\n",
 					(idx+1)*sizeof(SPOOL_NOTIFY_INFO_DATA)));
 				return -1;
 			}
@@ -396,7 +396,7 @@
 
 	data_len = build_notify_data(mem_ctx, printer, info->flags, &notify_data);
 	if (info->flags && (data_len == -1)) {
-		DEBUG(0,("cli_spoolss_reply_rrpcn: Failed to build SPOOL_NOTIFY_INFO_DATA [flags == 0x%x] for printer [%s]\n",
+		ZERODEBUG(0,("cli_spoolss_reply_rrpcn: Failed to build SPOOL_NOTIFY_INFO_DATA [flags == 0x%x] for printer [%s]\n",
 			info->flags, info->printer_name));
 		result = WERR_NOMEM;
 		goto done;
@@ -413,7 +413,7 @@
 
 	/* turn parameters into data stream */
 	if(!spoolss_io_q_reply_rrpcn("", &q_s,  &buf, 0)) {
-		DEBUG(0,("cli_spoolss_reply_rrpcn: Error : failed to marshall SPOOL_Q_REPLY_RRPCN struct.\n"));
+		ZERODEBUG(0,("cli_spoolss_reply_rrpcn: Error : failed to marshall SPOOL_Q_REPLY_RRPCN struct.\n"));
 		goto done;
 	}
 
@@ -424,7 +424,7 @@
 
 	/* turn data stream into parameters*/
 	if(!spoolss_io_r_reply_rrpcn("", &r_s, &rbuf, 0)) {
-		DEBUG(0,("cli_spoolss_reply_rrpcn: Error : failed to unmarshall SPOOL_R_REPLY_RRPCN struct.\n"));
+		ZERODEBUG(0,("cli_spoolss_reply_rrpcn: Error : failed to unmarshall SPOOL_R_REPLY_RRPCN struct.\n"));
 		goto done;
 	}
 
diff -Naur samba-2.2.12-orig/source/rpc_client/cli_trust.c samba-2.2.12/source/rpc_client/cli_trust.c
--- samba-2.2.12-orig/source/rpc_client/cli_trust.c	2004-08-12 20:24:19.000000000 +0200
+++ samba-2.2.12/source/rpc_client/cli_trust.c	2009-03-11 09:59:36.000000000 +0100
@@ -43,38 +43,38 @@
    */
 
   if (!secrets_fetch_domain_sid(domain, &domain_sid)) {
-    DEBUG(0, ("domain_client_validate: unable to fetch domain sid.\n"));
+    ZERODEBUG(0, ("domain_client_validate: unable to fetch domain sid.\n"));
     return False;
   }
 
   ZERO_STRUCT(cli);
   if(cli_initialise(&cli) == NULL) {
-    DEBUG(0,("modify_trust_password: unable to initialize client connection.\n"));
+    ZERODEBUG(0,("modify_trust_password: unable to initialize client connection.\n"));
     return False;
   }
 
   if(!resolve_name( remote_machine, &cli.dest_ip, 0x20)) {
-    DEBUG(0,("modify_trust_password: Can't resolve address for %s\n", remote_machine));
+    ZERODEBUG(0,("modify_trust_password: Can't resolve address for %s\n", remote_machine));
     cli_shutdown(&cli);
     return False;
   }
 
   if (ismyip(cli.dest_ip)) {
-    DEBUG(0,("modify_trust_password: Machine %s is one of our addresses. Cannot add \
+    ZERODEBUG(0,("modify_trust_password: Machine %s is one of our addresses. Cannot add \
 to ourselves.\n", remote_machine));
     cli_shutdown(&cli);
     return False;
   }
 
   if (!cli_connect(&cli, remote_machine, &cli.dest_ip)) {
-    DEBUG(0,("modify_trust_password: unable to connect to SMB server on \
+    ZERODEBUG(0,("modify_trust_password: unable to connect to SMB server on \
 machine %s. Error was : %s.\n", remote_machine, cli_errstr(&cli) ));
     cli_shutdown(&cli);
     return False;
   }
   
   if (!attempt_netbios_session_request(&cli, global_myname, remote_machine, &cli.dest_ip)) {
-    DEBUG(0,("modify_trust_password: machine %s rejected the NetBIOS session request.\n", 
+    ZERODEBUG(0,("modify_trust_password: machine %s rejected the NetBIOS session request.\n", 
       remote_machine ));
     cli_shutdown(&cli);
     return False;
@@ -83,14 +83,14 @@
   cli.protocol = PROTOCOL_NT1;
     
   if (!cli_negprot(&cli)) {
-    DEBUG(0,("modify_trust_password: machine %s rejected the negotiate protocol. \
+    ZERODEBUG(0,("modify_trust_password: machine %s rejected the negotiate protocol. \
 Error was : %s.\n", remote_machine, cli_errstr(&cli) ));
     cli_shutdown(&cli);
     return False;
   }
 
   if (cli.protocol != PROTOCOL_NT1) {
-    DEBUG(0,("modify_trust_password: machine %s didn't negotiate NT protocol.\n", 
+    ZERODEBUG(0,("modify_trust_password: machine %s didn't negotiate NT protocol.\n", 
             remote_machine));
     cli_shutdown(&cli);
     return False;
@@ -101,21 +101,21 @@
    */
     
   if (!cli_session_setup(&cli, "", "", 0, "", 0, "")) {
-    DEBUG(0,("modify_trust_password: machine %s rejected the session setup. \
+    ZERODEBUG(0,("modify_trust_password: machine %s rejected the session setup. \
 Error was : %s.\n", remote_machine, cli_errstr(&cli) ));
     cli_shutdown(&cli);
     return False;
   }
     
   if (!(cli.sec_mode & 1)) {
-    DEBUG(0,("modify_trust_password: machine %s isn't in user level security mode\n",
+    ZERODEBUG(0,("modify_trust_password: machine %s isn't in user level security mode\n",
           remote_machine));
     cli_shutdown(&cli);
     return False;
   }
     
   if (!cli_send_tconX(&cli, "IPC$", "IPC", "", 1)) {
-    DEBUG(0,("modify_trust_password: machine %s rejected the tconX on the IPC$ share. \
+    ZERODEBUG(0,("modify_trust_password: machine %s rejected the tconX on the IPC$ share. \
 Error was : %s.\n", remote_machine, cli_errstr(&cli) ));
     cli_shutdown(&cli);
     return False;
@@ -127,7 +127,7 @@
    */
 
   if(cli_nt_session_open(&cli, PIPE_NETLOGON) == False) {
-    DEBUG(0,("modify_trust_password: unable to open the domain client session to \
+    ZERODEBUG(0,("modify_trust_password: unable to open the domain client session to \
 machine %s. Error was : %s.\n", remote_machine, cli_errstr(&cli)));
     cli_nt_session_close(&cli);
     cli_ulogoff(&cli);
@@ -138,7 +138,7 @@
   result = cli_nt_setup_creds(&cli, orig_trust_passwd_hash);
 
   if (!NT_STATUS_IS_OK(result)) {
-    DEBUG(0,("modify_trust_password: unable to setup the PDC credentials to machine \
+    ZERODEBUG(0,("modify_trust_password: unable to setup the PDC credentials to machine \
 %s. Error was : %s.\n", remote_machine, get_nt_error_msg(result)));
     cli_nt_session_close(&cli);
     cli_ulogoff(&cli);
@@ -147,7 +147,7 @@
   } 
 
   if( cli_nt_srv_pwset( &cli,new_trust_passwd_hash ) == False) {
-    DEBUG(0,("modify_trust_password: unable to change password for machine %s in domain \
+    ZERODEBUG(0,("modify_trust_password: unable to change password for machine %s in domain \
 %s to Domain controller %s. Error was %s.\n", global_myname, domain, remote_machine, 
                             cli_errstr(&cli)));
     cli_close(&cli, cli.nt_pipe_fnum);
@@ -178,7 +178,7 @@
   BOOL res = False;
 
   if(!secrets_fetch_trust_account_password(domain, old_trust_passwd_hash, &lct)) {
-    DEBUG(0,("change_trust_account_password: unable to read the machine \
+    ZERODEBUG(0,("change_trust_account_password: unable to read the machine \
 account password for domain %s.\n", domain));
     return False;
   }
@@ -228,7 +228,7 @@
     }
 
     if(res) {
-      DEBUG(0,("%s : change_trust_account_password: Changed password for \
+      ZERODEBUG(0,("%s : change_trust_account_password: Changed password for \
 domain %s.\n", timestring(False), domain));
       /*
        * Return the result of trying to write the new password
@@ -244,7 +244,7 @@
   memset(new_trust_passwd_hash, 0, 16);
   memset(old_trust_passwd_hash, 0, 16);
 
-  DEBUG(0,("%s : change_trust_account_password: Failed to change password for \
+  ZERODEBUG(0,("%s : change_trust_account_password: Failed to change password for \
 domain %s.\n", timestring(False), domain));
   return False;
 }
diff -Naur samba-2.2.12-orig/source/rpc_parse/parse_net.c samba-2.2.12/source/rpc_parse/parse_net.c
--- samba-2.2.12-orig/source/rpc_parse/parse_net.c	2004-08-12 20:24:27.000000000 +0200
+++ samba-2.2.12/source/rpc_parse/parse_net.c	2009-03-11 09:59:36.000000000 +0100
@@ -2134,7 +2134,7 @@
                                     info->num_members2);
 
                 if (info->rids == NULL) {
-                        DEBUG(0, ("out of memory allocating %d rids\n",
+                        ZERODEBUG(0, ("out of memory allocating %d rids\n",
                                   info->num_members2));
                         return False;
                 }
@@ -2162,7 +2162,7 @@
                                        info->num_members3);
 
                 if (info->attribs == NULL) {
-                        DEBUG(0, ("out of memory allocating %d attribs\n",
+                        ZERODEBUG(0, ("out of memory allocating %d attribs\n",
                                   info->num_members3));
                         return False;
                 }
@@ -2249,7 +2249,7 @@
                                         info->num_sids);
                 
                 if (info->ptr_sids == NULL) {
-                        DEBUG(0, ("out of memory allocating %d ptr_sids\n",
+                        ZERODEBUG(0, ("out of memory allocating %d ptr_sids\n",
                                   info->num_sids));
                         return False;
                 }
@@ -2265,7 +2265,7 @@
                                     info->num_sids);
 
                 if (info->sids == NULL) {
-                        DEBUG(0, ("error allocating %d sids\n",
+                        ZERODEBUG(0, ("error allocating %d sids\n",
                                   info->num_sids));
                         return False;
                 }
@@ -2355,7 +2355,7 @@
 		}
 		default:
 		{
-			DEBUG(0,
+			ZERODEBUG(0,
 			      ("Replication error: Unknown delta type 0x%x\n",
 			       type));
 			break;
@@ -2407,7 +2407,7 @@
                                                sizeof(SAM_DELTA_HDR));
                           
                                 if (r_s->hdr_deltas == NULL) {
-                                        DEBUG(0, ("error tallocating memory "
+                                        ZERODEBUG(0, ("error tallocating memory "
                                                   "for %d delta headers\n", 
                                                   r_s->num_deltas2));
                                         return False;
@@ -2428,7 +2428,7 @@
                                                sizeof(SAM_DELTA_CTR));
 
                                 if (r_s->deltas == NULL) {
-                                        DEBUG(0, ("error tallocating memory "
+                                        ZERODEBUG(0, ("error tallocating memory "
                                                   "for %d deltas\n", 
                                                   r_s->num_deltas2));
                                         return False;
@@ -2441,7 +2441,7 @@
                                         "", sess_key, &r_s->deltas[i],
                                         r_s->hdr_deltas[i].type3,
                                         ps, depth)) {
-                                        DEBUG(0, ("hmm, failed on i=%d\n", i));
+                                        ZERODEBUG(0, ("hmm, failed on i=%d\n", i));
                                         return False;
                                 }
 			}
@@ -2542,7 +2542,7 @@
                                         talloc(ps->mem_ctx, r_s->num_deltas *
                                                sizeof(SAM_DELTA_HDR));
                                 if (r_s->hdr_deltas == NULL) {
-                                        DEBUG(0, ("error tallocating memory "
+                                        ZERODEBUG(0, ("error tallocating memory "
                                                   "for %d delta headers\n", 
                                                   r_s->num_deltas));
                                         return False;
@@ -2561,7 +2561,7 @@
                                                sizeof(SAM_DELTA_CTR));
 
                                 if (r_s->deltas == NULL) {
-                                        DEBUG(0, ("error tallocating memory "
+                                        ZERODEBUG(0, ("error tallocating memory "
                                                   "for %d deltas\n", 
                                                   r_s->num_deltas));
                                         return False;
diff -Naur samba-2.2.12-orig/source/rpc_parse/parse_prs.c samba-2.2.12/source/rpc_parse/parse_prs.c
--- samba-2.2.12-orig/source/rpc_parse/parse_prs.c	2004-08-12 20:24:27.000000000 +0200
+++ samba-2.2.12/source/rpc_parse/parse_prs.c	2009-03-11 09:59:36.000000000 +0100
@@ -43,7 +43,7 @@
 	if (fd != -1) {
 		write(fd, ps->data_p + ps->data_offset, ps->buffer_size - ps->data_offset);
 		close(fd);
-		DEBUG(0,("created %s\n", fname));
+		ZERODEBUG(0,("created %s\n", fname));
 	}
 }
 
@@ -84,7 +84,7 @@
 	if (size != 0) {
 		ps->buffer_size = size;
 		if((ps->data_p = (char *)malloc((size_t)size)) == NULL) {
-			DEBUG(0,("prs_init: malloc fail for %u bytes.\n", (unsigned int)size));
+			ZERODEBUG(0,("prs_init: malloc fail for %u bytes.\n", (unsigned int)size));
 			return False;
 		}
 		memset(ps->data_p, '\0', (size_t)size);
@@ -196,9 +196,9 @@
 		char *new_data_p = Realloc(ps->data_p, newsize);
 		/* if newsize is zero, Realloc acts like free() & returns NULL*/
 		if (new_data_p == NULL && newsize != 0) {
-			DEBUG(0,("prs_set_buffer_size: Realloc failure for size %u.\n",
+			ZERODEBUG(0,("prs_set_buffer_size: Realloc failure for size %u.\n",
 				(unsigned int)newsize));
-			DEBUG(0,("prs_set_buffer_size: Reason %s\n",strerror(errno)));
+			ZERODEBUG(0,("prs_set_buffer_size: Reason %s\n",strerror(errno)));
 			return False;
 		}
 		ps->data_p = new_data_p;
@@ -229,7 +229,7 @@
 	 */
 
 	if(UNMARSHALLING(ps) || !ps->is_dynamic) {
-		DEBUG(0,("prs_grow: Buffer overflow - unable to expand buffer by %u bytes.\n",
+		ZERODEBUG(0,("prs_grow: Buffer overflow - unable to expand buffer by %u bytes.\n",
 				(unsigned int)extra_space));
 		return False;
 	}
@@ -248,7 +248,7 @@
 		new_size = MAX(MAX_PDU_FRAG_LEN,extra_space);
 
 		if((new_data = malloc(new_size)) == NULL) {
-			DEBUG(0,("prs_grow: Malloc failure for size %u.\n", (unsigned int)new_size));
+			ZERODEBUG(0,("prs_grow: Malloc failure for size %u.\n", (unsigned int)new_size));
 			return False;
 		}
 		memset(new_data, '\0', (size_t)new_size );
@@ -260,7 +260,7 @@
 		new_size = MAX(ps->buffer_size*2, ps->buffer_size + extra_space);		
 
 		if ((new_data = Realloc(ps->data_p, new_size)) == NULL) {
-			DEBUG(0,("prs_grow: Realloc failure for size %u.\n",
+			ZERODEBUG(0,("prs_grow: Realloc failure for size %u.\n",
 				(unsigned int)new_size));
 			return False;
 		}
@@ -285,13 +285,13 @@
 	char *new_data;
 
 	if(!UNMARSHALLING(ps) || !ps->is_dynamic) {
-		DEBUG(0,("prs_force_grow: Buffer overflow - unable to expand buffer by %u bytes.\n",
+		ZERODEBUG(0,("prs_force_grow: Buffer overflow - unable to expand buffer by %u bytes.\n",
 				(unsigned int)extra_space));
 		return False;
 	}
 
 	if((new_data = Realloc(ps->data_p, new_size)) == NULL) {
-		DEBUG(0,("prs_force_grow: Realloc failure for size %u.\n",
+		ZERODEBUG(0,("prs_force_grow: Realloc failure for size %u.\n",
 			(unsigned int)new_size));
 		return False;
 	}
@@ -479,7 +479,7 @@
 		 * If reading, ensure that we can read the requested size item.
 		 */
 		if (ps->data_offset + extra_size > ps->buffer_size) {
-			DEBUG(0,("prs_mem_get: reading data of size %u would overrun buffer.\n",
+			ZERODEBUG(0,("prs_mem_get: reading data of size %u would overrun buffer.\n",
 					(unsigned int)extra_size ));
 			return NULL;
 		}
diff -Naur samba-2.2.12-orig/source/rpc_parse/parse_samr.c samba-2.2.12/source/rpc_parse/parse_samr.c
--- samba-2.2.12-orig/source/rpc_parse/parse_samr.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/rpc_parse/parse_samr.c	2009-03-11 09:59:36.000000000 +0100
@@ -846,7 +846,7 @@
 				return False;
 			break;
 		default:
-			DEBUG(0, ("samr_io_r_query_dom_info: unknown switch level 0x%x\n",
+			ZERODEBUG(0, ("samr_io_r_query_dom_info: unknown switch level 0x%x\n",
 				r_u->switch_value));
 			r_u->status = NT_STATUS_INVALID_INFO_CLASS;
 			return False;
@@ -1351,7 +1351,7 @@
 		}
 
 		if ((r_u->sam == NULL || r_u->uni_acct_name == NULL) && r_u->num_entries2 != 0) {
-			DEBUG(0,("NULL pointers in SAMR_R_ENUM_DOM_USERS\n"));
+			ZERODEBUG(0,("NULL pointers in SAMR_R_ENUM_DOM_USERS\n"));
 			r_u->num_entries4 = 0;
 			r_u->status = NT_STATUS_MEMORY_NOT_ALLOCATED;
 			return False;
@@ -1508,14 +1508,14 @@
 		if ((sam->sam = (SAM_ENTRY1 *)
 		     prs_alloc_mem(ps, sizeof(SAM_ENTRY1) *
 				   num_entries)) == NULL) {
-			DEBUG(0, ("out of memory allocating SAM_ENTRY1\n"));
+			ZERODEBUG(0, ("out of memory allocating SAM_ENTRY1\n"));
 			return False;
 		}
 
 		if ((sam->str = (SAM_STR1 *)
 		     prs_alloc_mem(ps, sizeof(SAM_STR1) * 
 				   num_entries)) == NULL) {
-			DEBUG(0, ("out of memory allocating SAM_STR1\n"));
+			ZERODEBUG(0, ("out of memory allocating SAM_STR1\n"));
 			return False;
 		}
 	}
@@ -1608,14 +1608,14 @@
 		if ((sam->sam = (SAM_ENTRY2 *)
 		     prs_alloc_mem(ps, sizeof(SAM_ENTRY2) *
 				   num_entries)) == NULL) {
-			DEBUG(0, ("out of memory allocating SAM_ENTRY2\n"));
+			ZERODEBUG(0, ("out of memory allocating SAM_ENTRY2\n"));
 			return False;
 		}
 
 		if ((sam->str = (SAM_STR2 *)
 		     prs_alloc_mem(ps, sizeof(SAM_STR2) * 
 				   num_entries)) == NULL) {
-			DEBUG(0, ("out of memory allocating SAM_STR2\n"));
+			ZERODEBUG(0, ("out of memory allocating SAM_STR2\n"));
 			return False;
 		}
 	}
@@ -1702,14 +1702,14 @@
 		if ((sam->sam = (SAM_ENTRY3 *)
 		     prs_alloc_mem(ps, sizeof(SAM_ENTRY3) *
 				   num_entries)) == NULL) {
-			DEBUG(0, ("out of memory allocating SAM_ENTRY3\n"));
+			ZERODEBUG(0, ("out of memory allocating SAM_ENTRY3\n"));
 			return False;
 		}
 
 		if ((sam->str = (SAM_STR3 *)
 		     prs_alloc_mem(ps, sizeof(SAM_STR3) * 
 				   num_entries)) == NULL) {
-			DEBUG(0, ("out of memory allocating SAM_STR3\n"));
+			ZERODEBUG(0, ("out of memory allocating SAM_STR3\n"));
 			return False;
 		}
 	}
@@ -1795,14 +1795,14 @@
 		if ((sam->sam = (SAM_ENTRY4 *)
 		     prs_alloc_mem(ps, sizeof(SAM_ENTRY4) *
 				   num_entries)) == NULL) {
-			DEBUG(0, ("out of memory allocating SAM_ENTRY4\n"));
+			ZERODEBUG(0, ("out of memory allocating SAM_ENTRY4\n"));
 			return False;
 		}
 
 		if ((sam->str = (SAM_STR4 *)
 		     prs_alloc_mem(ps, sizeof(SAM_STR4) * 
 				   num_entries)) == NULL) {
-			DEBUG(0, ("out of memory allocating SAM_STR4\n"));
+			ZERODEBUG(0, ("out of memory allocating SAM_STR4\n"));
 			return False;
 		}
 	}
@@ -1885,14 +1885,14 @@
 		if ((sam->sam = (SAM_ENTRY5 *)
 		     prs_alloc_mem(ps, sizeof(SAM_ENTRY5) *
 				   num_entries)) == NULL) {
-			DEBUG(0, ("out of memory allocating SAM_ENTRY5\n"));
+			ZERODEBUG(0, ("out of memory allocating SAM_ENTRY5\n"));
 			return False;
 		}
 
 		if ((sam->str = (SAM_STR5 *)
 		     prs_alloc_mem(ps, sizeof(SAM_STR5) * 
 				   num_entries)) == NULL) {
-			DEBUG(0, ("out of memory allocating SAM_STR5\n"));
+			ZERODEBUG(0, ("out of memory allocating SAM_STR5\n"));
 			return False;
 		}
 	}
@@ -2011,7 +2011,7 @@
 			return False;
 		break;
 	default:
-		DEBUG(0,("samr_io_r_query_dispinfo: unknown switch value\n"));
+		ZERODEBUG(0,("samr_io_r_query_dispinfo: unknown switch value\n"));
 		break;
 	}
 	
@@ -2256,7 +2256,7 @@
 			return False;
 		break;
 	default:
-		DEBUG(0,("samr_group_info_ctr: unsupported switch level\n"));
+		ZERODEBUG(0,("samr_group_info_ctr: unsupported switch level\n"));
 		break;
 	}
 
@@ -3081,7 +3081,7 @@
 		}
 
 		if ((r_u->sam == NULL || r_u->uni_dom_name == NULL) && r_u->num_entries2 != 0) {
-			DEBUG(0, ("NULL pointers in SAMR_R_ENUM_DOMAINS\n"));
+			ZERODEBUG(0, ("NULL pointers in SAMR_R_ENUM_DOMAINS\n"));
 			r_u->num_entries4 = 0;
 			r_u->status = NT_STATUS_MEMORY_NOT_ALLOCATED;
 			return False;
@@ -3220,7 +3220,7 @@
 		}
 
 		if ((r_u->sam == NULL || r_u->uni_grp_name == NULL) && r_u->num_entries2 != 0) {
-			DEBUG(0,
+			ZERODEBUG(0,
 			      ("NULL pointers in SAMR_R_ENUM_DOM_GROUPS\n"));
 			r_u->num_entries4 = 0;
 			r_u->status = NT_STATUS_MEMORY_NOT_ALLOCATED;
@@ -3355,7 +3355,7 @@
 
 		if (r_u->num_entries2 != 0 && 
 		    (r_u->sam == NULL || r_u->uni_grp_name == NULL)) {
-			DEBUG(0,("NULL pointers in SAMR_R_ENUM_DOM_ALIASES\n"));
+			ZERODEBUG(0,("NULL pointers in SAMR_R_ENUM_DOM_ALIASES\n"));
 			r_u->num_entries4 = 0;
 			r_u->status = NT_STATUS_MEMORY_NOT_ALLOCATED;
 			return False;
@@ -3508,7 +3508,7 @@
 			return False;
 		break;
 	default:
-		DEBUG(0,("samr_alias_info_ctr: unsupported switch level\n"));
+		ZERODEBUG(0,("samr_alias_info_ctr: unsupported switch level\n"));
 		break;
 	}
 
@@ -4714,7 +4714,7 @@
 			r_u->rids = (uint32 *)prs_alloc_mem(ps, sizeof(uint32)*r_u->num_rids2);
 
 		if (!r_u->rids) {
-			DEBUG(0, ("NULL rids in samr_io_r_lookup_names\n"));
+			ZERODEBUG(0, ("NULL rids in samr_io_r_lookup_names\n"));
 			return False;
 		}
 
@@ -4743,7 +4743,7 @@
 			r_u->types = (uint32 *)prs_alloc_mem(ps, sizeof(uint32)*r_u->num_types2);
 
 		if (!r_u->types) {
-			DEBUG(0, ("NULL types in samr_io_r_lookup_names\n"));
+			ZERODEBUG(0, ("NULL types in samr_io_r_lookup_names\n"));
 			return False;
 		}
 
@@ -7032,7 +7032,7 @@
 				return False;
 			break;
 		default:
-			DEBUG(0, ("samr_io_r_samr_unknown_2e: unknown switch level 0x%x\n",
+			ZERODEBUG(0, ("samr_io_r_samr_unknown_2e: unknown switch level 0x%x\n",
 				r_u->switch_value));
 			r_u->status = NT_STATUS_INVALID_INFO_CLASS;
 			return False;
@@ -7128,7 +7128,7 @@
 			return False;
 		break;
 	default:
-		DEBUG(0, ("samr_io_r_samr_unknown_2e: unknown switch level 0x%x\n",
+		ZERODEBUG(0, ("samr_io_r_samr_unknown_2e: unknown switch level 0x%x\n",
 			q_u->switch_value));
 		return False;
 	}
diff -Naur samba-2.2.12-orig/source/rpc_parse/parse_spoolss.c samba-2.2.12/source/rpc_parse/parse_spoolss.c
--- samba-2.2.12-orig/source/rpc_parse/parse_spoolss.c	2004-08-12 20:24:28.000000000 +0200
+++ samba-2.2.12/source/rpc_parse/parse_spoolss.c	2009-03-11 09:59:36.000000000 +0100
@@ -157,7 +157,7 @@
 			/* smb_io_doc_info_2("",&info->doc_info_2, ps, depth); */
 			break;
 		default:
-			DEBUG(0,("Something is obviously wrong somewhere !\n"));
+			ZERODEBUG(0,("Something is obviously wrong somewhere !\n"));
 			break;
 	}
 
@@ -603,9 +603,9 @@
 			break;
 			
 		default:
-			DEBUG(0,("spoolss_io_devmode: Unknown specversion in devicemode [0x%x]\n",
+			ZERODEBUG(0,("spoolss_io_devmode: Unknown specversion in devicemode [0x%x]\n",
 				devmode->specversion));
-			DEBUG(0,("spoolss_io_devmode: please report to samba-technical@samba.org!\n"));
+			ZERODEBUG(0,("spoolss_io_devmode: please report to samba-technical@samba.org!\n"));
 			break;
 	}
 			
@@ -677,9 +677,9 @@
 	/* Sanity check - we only have uint32's left tp parse */
 	
 	if ( available_space && ((available_space % sizeof(uint32)) != 0) ) {
-		DEBUG(0,("spoolss_io_devmode: available_space [%d] no in multiple of 4 bytes (size = %d)!\n",
+		ZERODEBUG(0,("spoolss_io_devmode: available_space [%d] no in multiple of 4 bytes (size = %d)!\n",
 			available_space, devmode->size));
-		DEBUG(0,("spoolss_io_devmode: please report to samba-technical@samba.org!\n"));
+		ZERODEBUG(0,("spoolss_io_devmode: please report to samba-technical@samba.org!\n"));
 		return False;
 	}
 	
@@ -701,10 +701,10 @@
 	   MS changes the device mode structure */
 	   
 	if (available_space) {
-		DEBUG(0,("spoolss_io_devmode: I've parsed all I know and there is still stuff left|\n"));
-		DEBUG(0,("spoolss_io_devmode: available_space = [%d], devmode_size = [%d]!\n",
+		ZERODEBUG(0,("spoolss_io_devmode: I've parsed all I know and there is still stuff left|\n"));
+		ZERODEBUG(0,("spoolss_io_devmode: available_space = [%d], devmode_size = [%d]!\n",
 			available_space, devmode->size));
-		DEBUG(0,("spoolss_io_devmode: please report to samba-technical@samba.org!\n"));
+		ZERODEBUG(0,("spoolss_io_devmode: please report to samba-technical@samba.org!\n"));
 		return False;
 	}
 	
@@ -874,7 +874,7 @@
 		case 2:
 			/* init q_u->info.info2 from *info */
 			if (!make_spoolss_printer_info_2(mem_ctx, &q_u->info.info_2, ctr->printers_2)) {
-				DEBUG(0,("make_spoolss_q_addprinterex: Unable to fill SPOOL_Q_ADDPRINTEREX struct!\n"));
+				ZERODEBUG(0,("make_spoolss_q_addprinterex: Unable to fill SPOOL_Q_ADDPRINTEREX struct!\n"));
 				return False;
 			}
 			break;
@@ -912,7 +912,7 @@
 
 	/* allocate the necessary memory */
 	if (!(inf=(SPOOL_PRINTER_INFO_LEVEL_2*)talloc(mem_ctx, sizeof(SPOOL_PRINTER_INFO_LEVEL_2)))) {
-		DEBUG(0,("make_spoolss_printer_info_2: Unable to allocate SPOOL_PRINTER_INFO_LEVEL_2 sruct!\n"));
+		ZERODEBUG(0,("make_spoolss_printer_info_2: Unable to allocate SPOOL_PRINTER_INFO_LEVEL_2 sruct!\n"));
 		return False;
 	}
 	
@@ -3859,7 +3859,7 @@
 #endif
 		break;
 	default: 
-		DEBUG(0,("make_spoolss_q_setprinter: Unknown info level [%d]\n", level));
+		ZERODEBUG(0,("make_spoolss_q_setprinter: Unknown info level [%d]\n", level));
 			break;
 	}
 
@@ -5106,7 +5106,7 @@
 		break;
 				
 	default:
-		DEBUG(0,("make_spoolss_q_addprinterdriver: Unknown info level [%d]\n", level));
+		ZERODEBUG(0,("make_spoolss_q_addprinterdriver: Unknown info level [%d]\n", level));
 		break;
 	}
 	
@@ -5188,7 +5188,7 @@
 	buf5->buf_len = len;
 	if((buf5->buffer=(uint16*)talloc_memdup(mem_ctx, src, sizeof(uint16)*len)) == NULL)
 	{
-		DEBUG(0,("make_spoolss_buffer5: Unable to malloc memory for buffer!\n"));
+		ZERODEBUG(0,("make_spoolss_buffer5: Unable to malloc memory for buffer!\n"));
 		return False;
 	}
 	
@@ -5746,7 +5746,7 @@
 	if (UNMARSHALLING(ps) && r_u->valuesize) {
 		r_u->value = (uint16 *)prs_alloc_mem(ps, r_u->valuesize * 2);
 		if (!r_u->value) {
-			DEBUG(0, ("spoolss_io_r_enumprinterdata: out of memory for printerdata value\n"));
+			ZERODEBUG(0, ("spoolss_io_r_enumprinterdata: out of memory for printerdata value\n"));
 			return False;
 		}
 	}
@@ -5769,7 +5769,7 @@
 	if (UNMARSHALLING(ps) && r_u->datasize) {
 		r_u->data = (uint8 *)prs_alloc_mem(ps, r_u->datasize);
 		if (!r_u->data) {
-			DEBUG(0, ("spoolss_io_r_enumprinterdata: out of memory for printerdata data\n"));
+			ZERODEBUG(0, ("spoolss_io_r_enumprinterdata: out of memory for printerdata data\n"));
 			return False;
 		}
 	}
@@ -6466,7 +6466,7 @@
 		len = src->notify_data.data.length;
 		s = malloc(sizeof(uint16)*len);
 		if (s == NULL) {
-			DEBUG(0,("copy_spool_notify_info_data: malloc() failed!\n"));
+			ZERODEBUG(0,("copy_spool_notify_info_data: malloc() failed!\n"));
 			return False;
 		}
 		
@@ -6483,7 +6483,7 @@
 static BOOL copy_spool_notify_info(SPOOL_NOTIFY_INFO *dst, SPOOL_NOTIFY_INFO *src)
 {
 	if (!dst) {
-		DEBUG(0,("copy_spool_notify_info: NULL destination pointer!\n"));
+		ZERODEBUG(0,("copy_spool_notify_info: NULL destination pointer!\n"));
 		return False;
 	}
 		
@@ -6499,7 +6499,7 @@
 			dst->count));
 
 		if (dst->data == NULL) {
-			DEBUG(0,("copy_spool_notify_info: malloc() failed for [%d] entries!\n", 
+			ZERODEBUG(0,("copy_spool_notify_info: malloc() failed for [%d] entries!\n", 
 				dst->count));
 			return False;
 		}
diff -Naur samba-2.2.12-orig/source/rpc_server/srv_dfs_nt.c samba-2.2.12/source/rpc_server/srv_dfs_nt.c
--- samba-2.2.12-orig/source/rpc_server/srv_dfs_nt.c	2004-08-12 20:24:26.000000000 +0200
+++ samba-2.2.12/source/rpc_server/srv_dfs_nt.c	2009-03-11 09:59:36.000000000 +0100
@@ -87,7 +87,7 @@
 
   if(jn.referral_list == NULL)
     {
-      DEBUG(0,("init_reply_dfs_add: talloc failed for referral list!\n"));
+      ZERODEBUG(0,("init_reply_dfs_add: talloc failed for referral list!\n"));
       return WERR_DFS_INTERNAL_ERROR;
     }
 
diff -Naur samba-2.2.12-orig/source/rpc_server/srv_lsa.c samba-2.2.12/source/rpc_server/srv_lsa.c
--- samba-2.2.12-orig/source/rpc_server/srv_lsa.c	2004-08-12 20:24:26.000000000 +0200
+++ samba-2.2.12/source/rpc_server/srv_lsa.c	2009-03-11 09:59:36.000000000 +0100
@@ -42,7 +42,7 @@
 
 	/* grab the server, object attributes and desired access flag...*/
 	if(!lsa_io_q_open_pol2("", &q_u, data, 0)) {
-		DEBUG(0,("api_lsa_open_policy2: unable to unmarshall LSA_Q_OPEN_POL2.\n"));
+		ZERODEBUG(0,("api_lsa_open_policy2: unable to unmarshall LSA_Q_OPEN_POL2.\n"));
 		return False;
 	}
 
@@ -50,7 +50,7 @@
 
 	/* store the response in the SMB stream */
 	if(!lsa_io_r_open_pol2("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_lsa_open_policy2: unable to marshall LSA_R_OPEN_POL2.\n"));
+		ZERODEBUG(0,("api_lsa_open_policy2: unable to marshall LSA_R_OPEN_POL2.\n"));
 		return False;
 	}
 
@@ -73,7 +73,7 @@
 
 	/* grab the server, object attributes and desired access flag...*/
 	if(!lsa_io_q_open_pol("", &q_u, data, 0)) {
-		DEBUG(0,("api_lsa_open_policy: unable to unmarshall LSA_Q_OPEN_POL.\n"));
+		ZERODEBUG(0,("api_lsa_open_policy: unable to unmarshall LSA_Q_OPEN_POL.\n"));
 		return False;
 	}
 
@@ -81,7 +81,7 @@
 
 	/* store the response in the SMB stream */
 	if(!lsa_io_r_open_pol("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_lsa_open_policy: unable to marshall LSA_R_OPEN_POL.\n"));
+		ZERODEBUG(0,("api_lsa_open_policy: unable to marshall LSA_R_OPEN_POL.\n"));
 		return False;
 	}
 
@@ -130,7 +130,7 @@
 
 	/* grab the info class and policy handle */
 	if(!lsa_io_q_query("", &q_u, data, 0)) {
-		DEBUG(0,("api_lsa_query_info: failed to unmarshall LSA_Q_QUERY_INFO.\n"));
+		ZERODEBUG(0,("api_lsa_query_info: failed to unmarshall LSA_Q_QUERY_INFO.\n"));
 		return False;
 	}
 
@@ -138,7 +138,7 @@
 
 	/* store the response in the SMB stream */
 	if(!lsa_io_r_query("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_lsa_query_info: failed to marshall LSA_R_QUERY_INFO.\n"));
+		ZERODEBUG(0,("api_lsa_query_info: failed to marshall LSA_R_QUERY_INFO.\n"));
 		return False;
 	}
 
@@ -161,14 +161,14 @@
 
 	/* grab the info class and policy handle */
 	if(!lsa_io_q_lookup_sids("", &q_u, data, 0)) {
-		DEBUG(0,("api_lsa_lookup_sids: failed to unmarshall LSA_Q_LOOKUP_SIDS.\n"));
+		ZERODEBUG(0,("api_lsa_lookup_sids: failed to unmarshall LSA_Q_LOOKUP_SIDS.\n"));
 		return False;
 	}
 
 	r_u.status = _lsa_lookup_sids(p, &q_u, &r_u);
 
 	if(!lsa_io_r_lookup_sids("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_lsa_lookup_sids: Failed to marshall LSA_R_LOOKUP_SIDS.\n"));
+		ZERODEBUG(0,("api_lsa_lookup_sids: Failed to marshall LSA_R_LOOKUP_SIDS.\n"));
 		return False;
 	}
 
@@ -191,7 +191,7 @@
 
 	/* grab the info class and policy handle */
 	if(!lsa_io_q_lookup_names("", &q_u, data, 0)) {
-		DEBUG(0,("api_lsa_lookup_names: failed to unmarshall LSA_Q_LOOKUP_NAMES.\n"));
+		ZERODEBUG(0,("api_lsa_lookup_names: failed to unmarshall LSA_Q_LOOKUP_NAMES.\n"));
 		return False;
 	}
 
@@ -199,7 +199,7 @@
 
 	/* store the response in the SMB stream */
 	if(!lsa_io_r_lookup_names("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_lsa_lookup_names: Failed to marshall LSA_R_LOOKUP_NAMES.\n"));
+		ZERODEBUG(0,("api_lsa_lookup_names: Failed to marshall LSA_R_LOOKUP_NAMES.\n"));
 		return False;
 	}
 
@@ -221,7 +221,7 @@
 	ZERO_STRUCT(r_u);
 
 	if (!lsa_io_q_close("", &q_u, data, 0)) {
-		DEBUG(0,("api_lsa_close: lsa_io_q_close failed.\n"));
+		ZERODEBUG(0,("api_lsa_close: lsa_io_q_close failed.\n"));
 		return False;
 	}
 
@@ -229,7 +229,7 @@
 
 	/* store the response in the SMB stream */
 	if (!lsa_io_r_close("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_lsa_close: lsa_io_r_close failed.\n"));
+		ZERODEBUG(0,("api_lsa_close: lsa_io_r_close failed.\n"));
 		return False;
 	}
 
@@ -251,7 +251,7 @@
 	ZERO_STRUCT(r_u);
 
 	if(!lsa_io_q_open_secret("", &q_u, data, 0)) {
-		DEBUG(0,("api_lsa_open_secret: failed to unmarshall LSA_Q_OPEN_SECRET.\n"));
+		ZERODEBUG(0,("api_lsa_open_secret: failed to unmarshall LSA_Q_OPEN_SECRET.\n"));
 		return False;
 	}
 
@@ -259,7 +259,7 @@
 
 	/* store the response in the SMB stream */
 	if(!lsa_io_r_open_secret("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_lsa_open_secret: Failed to marshall LSA_R_OPEN_SECRET.\n"));
+		ZERODEBUG(0,("api_lsa_open_secret: Failed to marshall LSA_R_OPEN_SECRET.\n"));
 		return False;
 	}
 
@@ -281,7 +281,7 @@
 	ZERO_STRUCT(r_u);
 
 	if(!lsa_io_q_enum_privs("", &q_u, data, 0)) {
-		DEBUG(0,("api_lsa_enum_privs: failed to unmarshall LSA_Q_ENUM_PRIVS.\n"));
+		ZERODEBUG(0,("api_lsa_enum_privs: failed to unmarshall LSA_Q_ENUM_PRIVS.\n"));
 		return False;
 	}
 
@@ -289,7 +289,7 @@
 
 	/* store the response in the SMB stream */
 	if(!lsa_io_r_enum_privs("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_lsa_enum_privs: Failed to marshall LSA_R_ENUM_PRIVS.\n"));
+		ZERODEBUG(0,("api_lsa_enum_privs: Failed to marshall LSA_R_ENUM_PRIVS.\n"));
 		return False;
 	}
 
@@ -311,7 +311,7 @@
 	ZERO_STRUCT(r_u);
 
 	if(!lsa_io_q_priv_get_dispname("", &q_u, data, 0)) {
-		DEBUG(0,("api_lsa_priv_get_dispname: failed to unmarshall LSA_Q_PRIV_GET_DISPNAME.\n"));
+		ZERODEBUG(0,("api_lsa_priv_get_dispname: failed to unmarshall LSA_Q_PRIV_GET_DISPNAME.\n"));
 		return False;
 	}
 
@@ -319,7 +319,7 @@
 
 	/* store the response in the SMB stream */
 	if(!lsa_io_r_priv_get_dispname("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_lsa_priv_get_dispname: Failed to marshall LSA_R_PRIV_GET_DISPNAME.\n"));
+		ZERODEBUG(0,("api_lsa_priv_get_dispname: Failed to marshall LSA_R_PRIV_GET_DISPNAME.\n"));
 		return False;
 	}
 
@@ -342,7 +342,7 @@
 	ZERO_STRUCT(r_u);
 
 	if(!lsa_io_q_enum_accounts("", &q_u, data, 0)) {
-		DEBUG(0,("api_lsa_enum_accounts: failed to unmarshall LSA_Q_ENUM_ACCOUNTS.\n"));
+		ZERODEBUG(0,("api_lsa_enum_accounts: failed to unmarshall LSA_Q_ENUM_ACCOUNTS.\n"));
 		return False;
 	}
 
@@ -350,7 +350,7 @@
 
 	/* store the response in the SMB stream */
 	if(!lsa_io_r_enum_accounts("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_lsa_enum_accounts: Failed to marshall LSA_R_ENUM_ACCOUNTS.\n"));
+		ZERODEBUG(0,("api_lsa_enum_accounts: Failed to marshall LSA_R_ENUM_ACCOUNTS.\n"));
 		return False;
 	}
 
@@ -374,7 +374,7 @@
 	ZERO_STRUCT(r_u);
 
 	if(!lsa_io_q_unk_get_connuser("", &q_u, data, 0)) {
-		DEBUG(0,("api_lsa_unk_get_connuser: failed to unmarshall LSA_Q_UNK_GET_CONNUSER.\n"));
+		ZERODEBUG(0,("api_lsa_unk_get_connuser: failed to unmarshall LSA_Q_UNK_GET_CONNUSER.\n"));
 		return False;
 	}
 
@@ -382,7 +382,7 @@
 
 	/* store the response in the SMB stream */
 	if(!lsa_io_r_unk_get_connuser("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_lsa_unk_get_connuser: Failed to marshall LSA_R_UNK_GET_CONNUSER.\n"));
+		ZERODEBUG(0,("api_lsa_unk_get_connuser: Failed to marshall LSA_R_UNK_GET_CONNUSER.\n"));
 		return False;
 	}
 
@@ -405,7 +405,7 @@
 	ZERO_STRUCT(r_u);
 
 	if(!lsa_io_q_open_account("", &q_u, data, 0)) {
-		DEBUG(0,("api_lsa_open_account: failed to unmarshall LSA_Q_OPENACCOUNT.\n"));
+		ZERODEBUG(0,("api_lsa_open_account: failed to unmarshall LSA_Q_OPENACCOUNT.\n"));
 		return False;
 	}
 
@@ -413,7 +413,7 @@
 
 	/* store the response in the SMB stream */
 	if(!lsa_io_r_open_account("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_lsa_open_account: Failed to marshall LSA_R_OPENACCOUNT.\n"));
+		ZERODEBUG(0,("api_lsa_open_account: Failed to marshall LSA_R_OPENACCOUNT.\n"));
 		return False;
 	}
 
@@ -437,7 +437,7 @@
 	ZERO_STRUCT(r_u);
 
 	if(!lsa_io_q_enum_privsaccount("", &q_u, data, 0)) {
-		DEBUG(0,("api_lsa_enum_privsaccount: failed to unmarshall LSA_Q_ENUMPRIVSACCOUNT.\n"));
+		ZERODEBUG(0,("api_lsa_enum_privsaccount: failed to unmarshall LSA_Q_ENUMPRIVSACCOUNT.\n"));
 		return False;
 	}
 
@@ -445,7 +445,7 @@
 
 	/* store the response in the SMB stream */
 	if(!lsa_io_r_enum_privsaccount("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_lsa_enum_privsaccount: Failed to marshall LSA_R_ENUMPRIVSACCOUNT.\n"));
+		ZERODEBUG(0,("api_lsa_enum_privsaccount: Failed to marshall LSA_R_ENUMPRIVSACCOUNT.\n"));
 		return False;
 	}
 
@@ -469,7 +469,7 @@
 	ZERO_STRUCT(r_u);
 
 	if(!lsa_io_q_getsystemaccount("", &q_u, data, 0)) {
-		DEBUG(0,("api_lsa_getsystemaccount: failed to unmarshall LSA_Q_GETSYSTEMACCOUNT.\n"));
+		ZERODEBUG(0,("api_lsa_getsystemaccount: failed to unmarshall LSA_Q_GETSYSTEMACCOUNT.\n"));
 		return False;
 	}
 
@@ -477,7 +477,7 @@
 
 	/* store the response in the SMB stream */
 	if(!lsa_io_r_getsystemaccount("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_lsa_getsystemaccount: Failed to marshall LSA_R_GETSYSTEMACCOUNT.\n"));
+		ZERODEBUG(0,("api_lsa_getsystemaccount: Failed to marshall LSA_R_GETSYSTEMACCOUNT.\n"));
 		return False;
 	}
 
diff -Naur samba-2.2.12-orig/source/rpc_server/srv_lsa_hnd.c samba-2.2.12/source/rpc_server/srv_lsa_hnd.c
--- samba-2.2.12-orig/source/rpc_server/srv_lsa_hnd.c	2004-08-12 20:24:26.000000000 +0200
+++ samba-2.2.12/source/rpc_server/srv_lsa_hnd.c	2009-03-11 09:59:36.000000000 +0100
@@ -105,14 +105,14 @@
 	struct policy *pol;
 
 	if (p->pipe_handles->count > MAX_OPEN_POLS) {
-		DEBUG(0,("create_policy_hnd: ERROR: too many handles (%d) on this pipe.\n",
+		ZERODEBUG(0,("create_policy_hnd: ERROR: too many handles (%d) on this pipe.\n",
 				(int)p->pipe_handles->count));
 		return False;
 	}
 
 	pol = (struct policy *)malloc(sizeof(*p));
 	if (!pol) {
-		DEBUG(0,("create_policy_hnd: ERROR: out of memory!\n"));
+		ZERODEBUG(0,("create_policy_hnd: ERROR: out of memory!\n"));
 		return False;
 	}
 
diff -Naur samba-2.2.12-orig/source/rpc_server/srv_lsa_nt.c samba-2.2.12/source/rpc_server/srv_lsa_nt.c
--- samba-2.2.12-orig/source/rpc_server/srv_lsa_nt.c	2004-08-12 20:24:26.000000000 +0200
+++ samba-2.2.12/source/rpc_server/srv_lsa_nt.c	2009-03-11 09:59:37.000000000 +0100
@@ -220,13 +220,13 @@
 	if (num_entries > 0) {
 		if (!(trn->name = (LSA_TRANS_NAME *)talloc(ctx, sizeof(LSA_TRANS_NAME) *
 							  num_entries))) {
-			DEBUG(0, ("init_lsa_trans_names(): out of memory\n"));
+			ZERODEBUG(0, ("init_lsa_trans_names(): out of memory\n"));
 			return;
 		}
 
 		if (!(trn->uni_name = (UNISTR2 *)talloc(ctx, sizeof(UNISTR2) * 
 							num_entries))) {
-			DEBUG(0, ("init_lsa_trans_names(): out of memory\n"));
+			ZERODEBUG(0, ("init_lsa_trans_names(): out of memory\n"));
 			return;
 		}
 	}
@@ -457,7 +457,7 @@
 		}
 		break;
 	default:
-		DEBUG(0,("_lsa_query_info: unknown info level in Lsa Query: %d\n", q_u->info_class));
+		ZERODEBUG(0,("_lsa_query_info: unknown info level in Lsa Query: %d\n", q_u->info_class));
 		r_u->status = NT_STATUS_INVALID_INFO_CLASS;
 		break;
 	}
@@ -598,7 +598,7 @@
 
 	unistr2_to_dos(name_asc, &q_u->name, sizeof(name_asc));
 
-	DEBUG(0,("_lsa_priv_get_dispname: %s", name_asc));
+	ZERODEBUG(0,("_lsa_priv_get_dispname: %s", name_asc));
 
 	for (i=1; privs[i].se_priv!=SE_PRIV_ALL; i++) {
 		if ( strcmp(name_asc, privs[i].priv)) {
@@ -607,7 +607,7 @@
 		
 		}
 	}
-	DEBUG(0,(": %s\n", desc_asc));
+	ZERODEBUG(0,(": %s\n", desc_asc));
 
 	init_uni_hdr(&r_u->hdr_desc, strlen(desc_asc));
 	init_unistr2(&r_u->desc, desc_asc, strlen(desc_asc) );
diff -Naur samba-2.2.12-orig/source/rpc_server/srv_netlog.c samba-2.2.12/source/rpc_server/srv_netlog.c
--- samba-2.2.12-orig/source/rpc_server/srv_netlog.c	2004-08-12 20:24:27.000000000 +0200
+++ samba-2.2.12/source/rpc_server/srv_netlog.c	2009-03-11 09:59:37.000000000 +0100
@@ -42,7 +42,7 @@
 
 	/* grab the challenge... */
 	if(!net_io_q_req_chal("", &q_u, data, 0)) {
-		DEBUG(0,("api_net_req_chal: Failed to unmarshall NET_Q_REQ_CHAL.\n"));
+		ZERODEBUG(0,("api_net_req_chal: Failed to unmarshall NET_Q_REQ_CHAL.\n"));
 		return False;
 	}
 
@@ -50,7 +50,7 @@
 
 	/* store the response in the SMB stream */
 	if(!net_io_r_req_chal("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_net_req_chal: Failed to marshall NET_R_REQ_CHAL.\n"));
+		ZERODEBUG(0,("api_net_req_chal: Failed to marshall NET_R_REQ_CHAL.\n"));
 		return False;
 	}
 
@@ -73,7 +73,7 @@
 
 	/* grab the challenge... */
 	if(!net_io_q_auth("", &q_u, data, 0)) {
-		DEBUG(0,("api_net_auth: Failed to unmarshall NET_Q_AUTH.\n"));
+		ZERODEBUG(0,("api_net_auth: Failed to unmarshall NET_Q_AUTH.\n"));
 		return False;
 	}
 
@@ -81,7 +81,7 @@
 
 	/* store the response in the SMB stream */
 	if(!net_io_r_auth("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_net_auth: Failed to marshall NET_R_AUTH.\n"));
+		ZERODEBUG(0,("api_net_auth: Failed to marshall NET_R_AUTH.\n"));
 		return False;
 	}
 
@@ -104,7 +104,7 @@
 
 	/* grab the challenge... */
 	if(!net_io_q_auth_2("", &q_u, data, 0)) {
-		DEBUG(0,("api_net_auth_2: Failed to unmarshall NET_Q_AUTH_2.\n"));
+		ZERODEBUG(0,("api_net_auth_2: Failed to unmarshall NET_Q_AUTH_2.\n"));
 		return False;
 	}
 
@@ -112,7 +112,7 @@
 
 	/* store the response in the SMB stream */
 	if(!net_io_r_auth_2("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_net_auth_2: Failed to marshall NET_R_AUTH_2.\n"));
+		ZERODEBUG(0,("api_net_auth_2: Failed to marshall NET_R_AUTH_2.\n"));
 		return False;
 	}
 
@@ -135,7 +135,7 @@
 
 	/* grab the challenge and encrypted password ... */
 	if(!net_io_q_srv_pwset("", &q_u, data, 0)) {
-		DEBUG(0,("api_net_srv_pwset: Failed to unmarshall NET_Q_SRV_PWSET.\n"));
+		ZERODEBUG(0,("api_net_srv_pwset: Failed to unmarshall NET_Q_SRV_PWSET.\n"));
 		return False;
 	}
 
@@ -143,7 +143,7 @@
 
 	/* store the response in the SMB stream */
 	if(!net_io_r_srv_pwset("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_net_srv_pwset: Failed to marshall NET_R_SRV_PWSET.\n"));
+		ZERODEBUG(0,("api_net_srv_pwset: Failed to marshall NET_R_SRV_PWSET.\n"));
 		return False;
 	}
 
@@ -165,7 +165,7 @@
 	ZERO_STRUCT(r_u);
 
 	if(!net_io_q_sam_logoff("", &q_u, data, 0)) {
-		DEBUG(0,("api_net_sam_logoff: Failed to unmarshall NET_Q_SAM_LOGOFF.\n"));
+		ZERODEBUG(0,("api_net_sam_logoff: Failed to unmarshall NET_Q_SAM_LOGOFF.\n"));
 		return False;
 	}
 
@@ -173,7 +173,7 @@
 
 	/* store the response in the SMB stream */
 	if(!net_io_r_sam_logoff("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_net_sam_logoff: Failed to marshall NET_R_SAM_LOGOFF.\n"));
+		ZERODEBUG(0,("api_net_sam_logoff: Failed to marshall NET_R_SAM_LOGOFF.\n"));
 		return False;
 	}
 
@@ -195,7 +195,7 @@
 	ZERO_STRUCT(r_u);
 
     if(!net_io_q_sam_logon("", &q_u, data, 0)) {
-        DEBUG(0, ("api_net_sam_logon: Failed to unmarshall NET_Q_SAM_LOGON.\n"));
+        ZERODEBUG(0, ("api_net_sam_logon: Failed to unmarshall NET_Q_SAM_LOGON.\n"));
         return False;
     }
    
@@ -203,7 +203,7 @@
 
 	/* store the response in the SMB stream */
 	if(!net_io_r_sam_logon("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_net_sam_logon: Failed to marshall NET_R_SAM_LOGON.\n"));
+		ZERODEBUG(0,("api_net_sam_logon: Failed to marshall NET_R_SAM_LOGON.\n"));
 		return False;
 	}
 
@@ -228,7 +228,7 @@
 
 	/* grab the lsa trusted domain list query... */
 	if(!net_io_q_trust_dom("", &q_u, data, 0)) {
-		DEBUG(0,("api_net_trust_dom_list: Failed to unmarshall NET_Q_TRUST_DOM_LIST.\n"));
+		ZERODEBUG(0,("api_net_trust_dom_list: Failed to unmarshall NET_Q_TRUST_DOM_LIST.\n"));
 		return False;
 	}
 
@@ -237,7 +237,7 @@
 
 	/* store the response in the SMB stream */
 	if(!net_io_r_trust_dom("", &r_u, rdata, 0)) {
-		DEBUG(0,("net_reply_trust_dom_list: Failed to marshall NET_R_TRUST_DOM_LIST.\n"));
+		ZERODEBUG(0,("net_reply_trust_dom_list: Failed to marshall NET_R_TRUST_DOM_LIST.\n"));
 		return False;
 	}
 
@@ -264,14 +264,14 @@
 
 	/* grab the lsa netlogon ctrl2 query... */
 	if(!net_io_q_logon_ctrl2("", &q_u, data, 0)) {
-		DEBUG(0,("api_net_logon_ctrl2: Failed to unmarshall NET_Q_LOGON_CTRL2.\n"));
+		ZERODEBUG(0,("api_net_logon_ctrl2: Failed to unmarshall NET_Q_LOGON_CTRL2.\n"));
 		return False;
 	}
 
 	r_u.status = _net_logon_ctrl2(p, &q_u, &r_u);
 
 	if(!net_io_r_logon_ctrl2("", &r_u, rdata, 0)) {
-		DEBUG(0,("net_reply_logon_ctrl2: Failed to marshall NET_R_LOGON_CTRL2.\n"));
+		ZERODEBUG(0,("net_reply_logon_ctrl2: Failed to marshall NET_R_LOGON_CTRL2.\n"));
 		return False;
 	}
 
@@ -298,14 +298,14 @@
 
 	/* grab the lsa netlogon ctrl query... */
 	if(!net_io_q_logon_ctrl("", &q_u, data, 0)) {
-		DEBUG(0,("api_net_logon_ctrl: Failed to unmarshall NET_Q_LOGON_CTRL.\n"));
+		ZERODEBUG(0,("api_net_logon_ctrl: Failed to unmarshall NET_Q_LOGON_CTRL.\n"));
 		return False;
 	}
 
 	r_u.status = _net_logon_ctrl(p, &q_u, &r_u);
 
 	if(!net_io_r_logon_ctrl("", &r_u, rdata, 0)) {
-		DEBUG(0,("net_reply_logon_ctrl2: Failed to marshall NET_R_LOGON_CTRL2.\n"));
+		ZERODEBUG(0,("net_reply_logon_ctrl2: Failed to marshall NET_R_LOGON_CTRL2.\n"));
 		return False;
 	}
 
diff -Naur samba-2.2.12-orig/source/rpc_server/srv_netlog_nt.c samba-2.2.12/source/rpc_server/srv_netlog_nt.c
--- samba-2.2.12-orig/source/rpc_server/srv_netlog_nt.c	2004-08-12 20:24:27.000000000 +0200
+++ samba-2.2.12/source/rpc_server/srv_netlog_nt.c	2009-03-11 09:59:37.000000000 +0100
@@ -87,7 +87,7 @@
 	uint32 tc_status = ERROR_NO_LOGON_SERVERS;
 	const char *trusted_domain = "test_domain";
 
-        DEBUG(0, ("*** net long ctrl2 %d, %d, %d\n",
+        ZERODEBUG(0, ("*** net long ctrl2 %d, %d, %d\n",
                   q_u->function_code, q_u->query_level, q_u->switch_value));
 
 	DEBUG(6,("_net_logon_ctrl2: %d\n", __LINE__));
@@ -160,7 +160,7 @@
 	if (!allow_access(lp_domain_hostsdeny(), lp_domain_hostsallow(),
 	                  client_name(), client_addr()))
 	{
-		DEBUG(0,("get_md4pw: Workstation %s denied access to domain\n", mach_acct));
+		ZERODEBUG(0,("get_md4pw: Workstation %s denied access to domain\n", mach_acct));
 		return False;
 	}
 #endif /* 0 */
@@ -173,7 +173,7 @@
 	unbecome_root();
 
  	if (ret==False) {
- 		DEBUG(0,("get_md4pw: Workstation %s: no account in domain\n", mach_acct));
+ 		ZERODEBUG(0,("get_md4pw: Workstation %s: no account in domain\n", mach_acct));
 		pdb_free_sam(sampass);
 		return False;
 	}
@@ -185,7 +185,7 @@
 		return True;
 	}
  	
-	DEBUG(0,("get_md4pw: Workstation %s: no account in domain\n", mach_acct));
+	ZERODEBUG(0,("get_md4pw: Workstation %s: no account in domain\n", mach_acct));
 	pdb_free_sam(sampass);
 	return False;
 }
diff -Naur samba-2.2.12-orig/source/rpc_server/srv_pipe.c samba-2.2.12/source/rpc_server/srv_pipe.c
--- samba-2.2.12-orig/source/rpc_server/srv_pipe.c	2004-08-12 20:24:27.000000000 +0200
+++ samba-2.2.12/source/rpc_server/srv_pipe.c	2009-03-11 09:59:37.000000000 +0100
@@ -127,7 +127,7 @@
 	 */
 
 	if(!data_len_left) {
-		DEBUG(0,("create_next_pdu: no data left to send !\n"));
+		ZERODEBUG(0,("create_next_pdu: no data left to send !\n"));
 		return False;
 	}
 
@@ -176,13 +176,13 @@
 
 	/* Store the header in the data stream. */
 	if(!smb_io_rpc_hdr("hdr", &p->hdr, &outgoing_pdu, 0)) {
-		DEBUG(0,("create_next_pdu: failed to marshall RPC_HDR.\n"));
+		ZERODEBUG(0,("create_next_pdu: failed to marshall RPC_HDR.\n"));
 		prs_mem_free(&outgoing_pdu);
 		return False;
 	}
 
 	if(!smb_io_rpc_hdr_resp("resp", &hdr_resp, &outgoing_pdu, 0)) {
-		DEBUG(0,("create_next_pdu: failed to marshall RPC_HDR_RESP.\n"));
+		ZERODEBUG(0,("create_next_pdu: failed to marshall RPC_HDR_RESP.\n"));
 		prs_mem_free(&outgoing_pdu);
 		return False;
 	}
@@ -194,7 +194,7 @@
 	data_from = prs_data_p(&p->out_data.rdata) + p->out_data.data_sent_length;
 
 	if(!prs_append_data(&outgoing_pdu, data_from, data_len)) {
-		DEBUG(0,("create_next_pdu: failed to copy %u bytes of data.\n", (unsigned int)data_len));
+		ZERODEBUG(0,("create_next_pdu: failed to copy %u bytes of data.\n", (unsigned int)data_len));
 		prs_mem_free(&outgoing_pdu);
 		return False;
 	}
@@ -204,7 +204,7 @@
 		char pad[8];
 		memset(pad, '\0', 8);
 		if (!prs_append_data(&outgoing_pdu, pad, ss_padding_len)) {
-			DEBUG(0,("create_next_pdu: failed to add %u bytes of pad data.\n", (unsigned int)ss_padding_len));
+			ZERODEBUG(0,("create_next_pdu: failed to add %u bytes of pad data.\n", (unsigned int)ss_padding_len));
 			prs_mem_free(&outgoing_pdu);
 			return False;
 		}
@@ -233,7 +233,7 @@
 			init_rpc_hdr_auth(&auth_info, NTLMSSP_AUTH_TYPE, NTLMSSP_AUTH_LEVEL, 
 					(auth_verify ? ss_padding_len : 0), (auth_verify ? 1 : 0));
 			if(!smb_io_rpc_hdr_auth("hdr_auth", &auth_info, &outgoing_pdu, 0)) {
-				DEBUG(0,("create_next_pdu: failed to marshall RPC_HDR_AUTH.\n"));
+				ZERODEBUG(0,("create_next_pdu: failed to marshall RPC_HDR_AUTH.\n"));
 				prs_mem_free(&outgoing_pdu);
 				return False;
 			}
@@ -248,7 +248,7 @@
 					crc32, p->ntlmssp_seq_num++);
 			auth_data = prs_data_p(&outgoing_pdu) + prs_offset(&outgoing_pdu) + 4;
 			if(!smb_io_rpc_auth_ntlmssp_chk("auth_sign", &ntlmssp_chk, &outgoing_pdu, 0)) {
-				DEBUG(0,("create_next_pdu: failed to marshall RPC_AUTH_NTLMSSP_CHK.\n"));
+				ZERODEBUG(0,("create_next_pdu: failed to marshall RPC_AUTH_NTLMSSP_CHK.\n"));
 				prs_mem_free(&outgoing_pdu);
 				return False;
 			}
@@ -427,7 +427,7 @@
 		   account does not have to exist in the smbpasswd file */
 
 		if ( (pw = sys_getpwnam(pipe_user_name)) == NULL ) {
-			DEBUG(0,("api_pipe_ntlmssp_verify: Invalid guest account [%s].  getpwnam() failed!\n", 
+			ZERODEBUG(0,("api_pipe_ntlmssp_verify: Invalid guest account [%s].  getpwnam() failed!\n", 
 				pipe_user_name));
 			pdb_free_sam(sampass);
 			return False;
@@ -536,7 +536,7 @@
 	DEBUG(5,("api_pipe_bind_auth_resp: decode request. %d\n", __LINE__));
 
 	if (p->hdr.auth_len == 0) {
-		DEBUG(0,("api_pipe_bind_auth_resp: No auth field sent !\n"));
+		ZERODEBUG(0,("api_pipe_bind_auth_resp: No auth field sent !\n"));
 		return False;
 	}
 
@@ -545,18 +545,18 @@
 	 */
 
 	if(!smb_io_rpc_hdr_autha("", &autha_info, rpc_in_p, 0)) {
-		DEBUG(0,("api_pipe_bind_auth_resp: unmarshall of RPC_HDR_AUTHA failed.\n"));
+		ZERODEBUG(0,("api_pipe_bind_auth_resp: unmarshall of RPC_HDR_AUTHA failed.\n"));
 		return False;
 	}
 
 	if (autha_info.auth_type != NTLMSSP_AUTH_TYPE || autha_info.auth_level != NTLMSSP_AUTH_LEVEL) {
-		DEBUG(0,("api_pipe_bind_auth_resp: incorrect auth type (%d) or level (%d).\n",
+		ZERODEBUG(0,("api_pipe_bind_auth_resp: incorrect auth type (%d) or level (%d).\n",
 			(int)autha_info.auth_type, (int)autha_info.auth_level ));
 		return False;
 	}
 
 	if(!smb_io_rpc_auth_verifier("", &auth_verifier, rpc_in_p, 0)) {
-		DEBUG(0,("api_pipe_bind_auth_resp: unmarshall of RPC_AUTH_VERIFIER failed.\n"));
+		ZERODEBUG(0,("api_pipe_bind_auth_resp: unmarshall of RPC_AUTH_VERIFIER failed.\n"));
 		return False;
 	}
 
@@ -565,12 +565,12 @@
 	 */
 
 	if (!rpc_auth_verifier_chk(&auth_verifier, "NTLMSSP", NTLMSSP_AUTH)) {
-		DEBUG(0,("api_pipe_bind_auth_resp: rpc_auth_verifier_chk failed.\n"));
+		ZERODEBUG(0,("api_pipe_bind_auth_resp: rpc_auth_verifier_chk failed.\n"));
 		return False;
 	}
 
 	if(!smb_io_rpc_auth_ntlmssp_resp("", &ntlmssp_resp, rpc_in_p, 0)) {
-		DEBUG(0,("api_pipe_bind_auth_resp: Failed to unmarshall RPC_AUTH_NTLMSSP_RESP.\n"));
+		ZERODEBUG(0,("api_pipe_bind_auth_resp: Failed to unmarshall RPC_AUTH_NTLMSSP_RESP.\n"));
 		return False;
 	}
 
@@ -622,7 +622,7 @@
 	 */
 
 	if(!smb_io_rpc_hdr("", &nak_hdr, &outgoing_rpc, 0)) {
-		DEBUG(0,("setup_bind_nak: marshalling of RPC_HDR failed.\n"));
+		ZERODEBUG(0,("setup_bind_nak: marshalling of RPC_HDR failed.\n"));
 		prs_mem_free(&outgoing_rpc);
 		return False;
 	}
@@ -689,19 +689,19 @@
 	 */
 
 	if(!smb_io_rpc_hdr("", &fault_hdr, &outgoing_pdu, 0)) {
-		DEBUG(0,("setup_fault_pdu: marshalling of RPC_HDR failed.\n"));
+		ZERODEBUG(0,("setup_fault_pdu: marshalling of RPC_HDR failed.\n"));
 		prs_mem_free(&outgoing_pdu);
 		return False;
 	}
 
 	if(!smb_io_rpc_hdr_resp("resp", &hdr_resp, &outgoing_pdu, 0)) {
-		DEBUG(0,("setup_fault_pdu: failed to marshall RPC_HDR_RESP.\n"));
+		ZERODEBUG(0,("setup_fault_pdu: failed to marshall RPC_HDR_RESP.\n"));
 		prs_mem_free(&outgoing_pdu);
 		return False;
 	}
 
 	if(!smb_io_rpc_hdr_fault("fault", &fault_resp, &outgoing_pdu, 0)) {
-		DEBUG(0,("setup_fault_pdu: failed to marshall RPC_HDR_FAULT.\n"));
+		ZERODEBUG(0,("setup_fault_pdu: failed to marshall RPC_HDR_FAULT.\n"));
 		prs_mem_free(&outgoing_pdu);
 		return False;
 	}
@@ -799,7 +799,7 @@
 
 	/* decode the bind request */
 	if(!smb_io_rpc_hdr_rb("", &hdr_rb, rpc_in_p, 0))  {
-		DEBUG(0,("api_pipe_bind_req: unable to unmarshall RPC_HDR_RB struct.\n"));
+		ZERODEBUG(0,("api_pipe_bind_req: unable to unmarshall RPC_HDR_RB struct.\n"));
 		return False;
 	}
 
@@ -816,7 +816,7 @@
 		 */
 
 		if(!smb_io_rpc_hdr_auth("", &auth_info, rpc_in_p, 0)) {
-			DEBUG(0,("api_pipe_bind_req: unable to unmarshall RPC_HDR_AUTH struct.\n"));
+			ZERODEBUG(0,("api_pipe_bind_req: unable to unmarshall RPC_HDR_AUTH struct.\n"));
 			return False;
 		}
 
@@ -825,29 +825,29 @@
 		 */
 
 		if(auth_info.auth_type != NTLMSSP_AUTH_TYPE) {
-			DEBUG(0,("api_pipe_bind_req: unknown auth type %x requested.\n",
+			ZERODEBUG(0,("api_pipe_bind_req: unknown auth type %x requested.\n",
 				auth_info.auth_type ));
 			return False;
 		}
 
 		if(!smb_io_rpc_auth_verifier("", &auth_verifier, rpc_in_p, 0)) {
-			DEBUG(0,("api_pipe_bind_req: unable to unmarshall RPC_HDR_AUTH struct.\n"));
+			ZERODEBUG(0,("api_pipe_bind_req: unable to unmarshall RPC_HDR_AUTH struct.\n"));
 			return False;
 		}
 
 		if(!strequal(auth_verifier.signature, "NTLMSSP")) {
-			DEBUG(0,("api_pipe_bind_req: auth_verifier.signature != NTLMSSP\n"));
+			ZERODEBUG(0,("api_pipe_bind_req: auth_verifier.signature != NTLMSSP\n"));
 			return False;
 		}
 
 		if(auth_verifier.msg_type != NTLMSSP_NEGOTIATE) {
-			DEBUG(0,("api_pipe_bind_req: auth_verifier.msg_type (%d) != NTLMSSP_NEGOTIATE\n",
+			ZERODEBUG(0,("api_pipe_bind_req: auth_verifier.msg_type (%d) != NTLMSSP_NEGOTIATE\n",
 				auth_verifier.msg_type));
 			return False;
 		}
 
 		if(!smb_io_rpc_auth_ntlmssp_neg("", &ntlmssp_neg, rpc_in_p, 0)) {
-			DEBUG(0,("api_pipe_bind_req: Failed to unmarshall RPC_AUTH_NTLMSSP_NEG.\n"));
+			ZERODEBUG(0,("api_pipe_bind_req: Failed to unmarshall RPC_AUTH_NTLMSSP_NEG.\n"));
 			return False;
 		}
 
@@ -891,13 +891,13 @@
 	 */
 
 	if(!prs_init(&out_hdr_ba, 1024, p->mem_ctx, MARSHALL)) {
-		DEBUG(0,("api_pipe_bind_req: malloc out_hdr_ba failed.\n"));
+		ZERODEBUG(0,("api_pipe_bind_req: malloc out_hdr_ba failed.\n"));
 		prs_mem_free(&outgoing_rpc);
 		return False;
 	}
 
 	if(!prs_init(&out_auth, 1024, p->mem_ctx, MARSHALL)) {
-		DEBUG(0,("pi_pipe_bind_req: malloc out_auth failed.\n"));
+		ZERODEBUG(0,("pi_pipe_bind_req: malloc out_auth failed.\n"));
 		prs_mem_free(&outgoing_rpc);
 		prs_mem_free(&out_hdr_ba);
 		return False;
@@ -941,7 +941,7 @@
 	 */
 
 	if(!smb_io_rpc_hdr_ba("", &hdr_ba, &out_hdr_ba, 0)) {
-		DEBUG(0,("api_pipe_bind_req: marshalling of RPC_HDR_BA failed.\n"));
+		ZERODEBUG(0,("api_pipe_bind_req: marshalling of RPC_HDR_BA failed.\n"));
 		goto err_exit;
 	}
 
@@ -959,7 +959,7 @@
 
 		init_rpc_hdr_auth(&auth_info, NTLMSSP_AUTH_TYPE, NTLMSSP_AUTH_LEVEL, RPC_HDR_AUTH_LEN, 1);
 		if(!smb_io_rpc_hdr_auth("", &auth_info, &out_auth, 0)) {
-			DEBUG(0,("api_pipe_bind_req: marshalling of RPC_HDR_AUTH failed.\n"));
+			ZERODEBUG(0,("api_pipe_bind_req: marshalling of RPC_HDR_AUTH failed.\n"));
 			goto err_exit;
 		}
 
@@ -967,7 +967,7 @@
 
 		init_rpc_auth_verifier(&auth_verifier, "NTLMSSP", NTLMSSP_CHALLENGE);
 		if(!smb_io_rpc_auth_verifier("", &auth_verifier, &out_auth, 0)) {
-			DEBUG(0,("api_pipe_bind_req: marshalling of RPC_AUTH_VERIFIER failed.\n"));
+			ZERODEBUG(0,("api_pipe_bind_req: marshalling of RPC_AUTH_VERIFIER failed.\n"));
 			goto err_exit;
 		}
 
@@ -975,7 +975,7 @@
 
 		init_rpc_auth_ntlmssp_chal(&ntlmssp_chal, p->ntlmssp_chal_flags, p->challenge);
 		if(!smb_io_rpc_auth_ntlmssp_chal("", &ntlmssp_chal, &out_auth, 0)) {
-			DEBUG(0,("api_pipe_bind_req: marshalling of RPC_AUTH_NTLMSSP_CHAL failed.\n"));
+			ZERODEBUG(0,("api_pipe_bind_req: marshalling of RPC_AUTH_NTLMSSP_CHAL failed.\n"));
 			goto err_exit;
 		}
 
@@ -997,7 +997,7 @@
 	 */
 
 	if(!smb_io_rpc_hdr("", &p->hdr, &outgoing_rpc, 0)) {
-		DEBUG(0,("pi_pipe_bind_req: marshalling of RPC_HDR failed.\n"));
+		ZERODEBUG(0,("pi_pipe_bind_req: marshalling of RPC_HDR failed.\n"));
 		goto err_exit;
 	}
 
@@ -1006,12 +1006,12 @@
 	 */
 
 	if(!prs_append_prs_data( &outgoing_rpc, &out_hdr_ba)) {
-		DEBUG(0,("api_pipe_bind_req: append of RPC_HDR_BA failed.\n"));
+		ZERODEBUG(0,("api_pipe_bind_req: append of RPC_HDR_BA failed.\n"));
 		goto err_exit;
 	}
 
 	if(p->ntlmssp_auth_requested && !prs_append_prs_data( &outgoing_rpc, &out_auth)) {
-		DEBUG(0,("api_pipe_bind_req: append of auth info failed.\n"));
+		ZERODEBUG(0,("api_pipe_bind_req: append of auth info failed.\n"));
 		goto err_exit;
 	}
 
@@ -1058,7 +1058,7 @@
 	auth_len = p->hdr.auth_len;
 
 	if ((auth_len != RPC_AUTH_NTLMSSP_CHK_LEN) && auth_verify) {
-		DEBUG(0,("api_pipe_auth_process: Incorrect auth_len %d.\n", auth_len ));
+		ZERODEBUG(0,("api_pipe_auth_process: Incorrect auth_len %d.\n", auth_len ));
 		return False;
 	}
 
@@ -1090,13 +1090,13 @@
 		RPC_HDR_AUTH auth_info;
 
 		if(!prs_set_offset(rpc_in, old_offset + data_len)) {
-			DEBUG(0,("api_pipe_auth_process: cannot move offset to %u.\n",
+			ZERODEBUG(0,("api_pipe_auth_process: cannot move offset to %u.\n",
 				(unsigned int)old_offset + data_len ));
 			return False;
 		}
 
 		if(!smb_io_rpc_hdr_auth("hdr_auth", &auth_info, rpc_in, 0)) {
-			DEBUG(0,("api_pipe_auth_process: failed to unmarshall RPC_HDR_AUTH.\n"));
+			ZERODEBUG(0,("api_pipe_auth_process: failed to unmarshall RPC_HDR_AUTH.\n"));
 			return False;
 		}
 	}
@@ -1112,19 +1112,19 @@
 		 * incoming buffer.
 		 */
 		if(prs_mem_get(rpc_in, RPC_AUTH_NTLMSSP_CHK_LEN - 4) == NULL) {
-			DEBUG(0,("api_pipe_auth_process: missing %d bytes in buffer.\n",
+			ZERODEBUG(0,("api_pipe_auth_process: missing %d bytes in buffer.\n",
 				RPC_AUTH_NTLMSSP_CHK_LEN - 4 ));
 			return False;
 		}
 
 		NTLMSSPcalc_p(p, (uchar*)req_data, RPC_AUTH_NTLMSSP_CHK_LEN - 4);
 		if(!smb_io_rpc_auth_ntlmssp_chk("auth_sign", &ntlmssp_chk, rpc_in, 0)) {
-			DEBUG(0,("api_pipe_auth_process: failed to unmarshall RPC_AUTH_NTLMSSP_CHK.\n"));
+			ZERODEBUG(0,("api_pipe_auth_process: failed to unmarshall RPC_AUTH_NTLMSSP_CHK.\n"));
 			return False;
 		}
 
 		if (!rpc_auth_ntlmssp_chk(&ntlmssp_chk, crc32, p->ntlmssp_seq_num)) {
-			DEBUG(0,("api_pipe_auth_process: NTLMSSP check failed.\n"));
+			ZERODEBUG(0,("api_pipe_auth_process: NTLMSSP check failed.\n"));
 			return False;
 		}
 	}
@@ -1134,7 +1134,7 @@
 	 */
 
 	if(!prs_set_offset(rpc_in, old_offset)) {
-		DEBUG(0,("api_pipe_auth_process: failed to set offset back to %u\n",
+		ZERODEBUG(0,("api_pipe_auth_process: failed to set offset back to %u\n",
 			(unsigned int)old_offset ));
 		return False;
 	}
@@ -1232,7 +1232,7 @@
 
 	/* do the actual command */
 	if(!api_rpc_cmds[fn_num].fn(p)) {
-		DEBUG(0,("api_rpcTNP: %s: %s failed.\n", rpc_name, api_rpc_cmds[fn_num].name));
+		ZERODEBUG(0,("api_rpcTNP: %s: %s failed.\n", rpc_name, api_rpc_cmds[fn_num].name));
 		prs_mem_free(&p->out_data.rdata);
 		return False;
 	}
diff -Naur samba-2.2.12-orig/source/rpc_server/srv_pipe_hnd.c samba-2.2.12/source/rpc_server/srv_pipe_hnd.c
--- samba-2.2.12-orig/source/rpc_server/srv_pipe_hnd.c	2004-08-12 20:24:26.000000000 +0200
+++ samba-2.2.12/source/rpc_server/srv_pipe_hnd.c	2009-03-11 09:59:37.000000000 +0100
@@ -120,7 +120,7 @@
 	 * we will use this as the raw data area for replying to rpc requests.
 	 */	
 	if(!prs_init(&o_data->rdata, MAX_PDU_FRAG_LEN, p->mem_ctx, MARSHALL)) {
-		DEBUG(0,("pipe_init_outgoing_data: malloc fail.\n"));
+		ZERODEBUG(0,("pipe_init_outgoing_data: malloc fail.\n"));
 		return False;
 	}
 
@@ -160,7 +160,7 @@
 	i = bitmap_find(bmap, next_pipe);
 
 	if (i == -1) {
-		DEBUG(0,("ERROR! Out of pipe structures\n"));
+		ZERODEBUG(0,("ERROR! Out of pipe structures\n"));
 		return NULL;
 	}
 
@@ -177,13 +177,13 @@
 	ZERO_STRUCTP(p);
 
 	if ((p->mem_ctx = talloc_init()) == NULL) {
-		DEBUG(0,("open_rpc_pipe_p: talloc_init failed.\n"));
+		ZERODEBUG(0,("open_rpc_pipe_p: talloc_init failed.\n"));
 		SAFE_FREE(p);
 		return NULL;
 	}
 
 	if (!init_pipe_handle_list(p, pipe_name)) {
-		DEBUG(0,("open_rpc_pipe_p: init_pipe_handles failed.\n"));
+		ZERODEBUG(0,("open_rpc_pipe_p: init_pipe_handles failed.\n"));
 		talloc_destroy(p->mem_ctx);
 		SAFE_FREE(p);
 		return NULL;
@@ -200,7 +200,7 @@
 	 */
 
 	if(!prs_init(&p->in_data.data, MAX_PDU_FRAG_LEN, p->mem_ctx, MARSHALL)) {
-		DEBUG(0,("open_rpc_pipe_p: malloc fail for in_data struct.\n"));
+		ZERODEBUG(0,("open_rpc_pipe_p: malloc fail for in_data struct.\n"));
 		return NULL;
 	}
 
@@ -319,7 +319,7 @@
 	prs_struct rpc_in;
 
 	if(p->in_data.pdu_received_len != RPC_HEADER_LEN) {
-		DEBUG(0,("unmarshall_rpc_header: assert on rpc header length failed.\n"));
+		ZERODEBUG(0,("unmarshall_rpc_header: assert on rpc header length failed.\n"));
 		set_incoming_fault(p);
 		return -1;
 	}
@@ -337,7 +337,7 @@
 	 */
 
 	if(!smb_io_rpc_hdr("", &p->hdr, &rpc_in, 0)) {
-		DEBUG(0,("unmarshall_rpc_header: failed to unmarshall RPC_HDR.\n"));
+		ZERODEBUG(0,("unmarshall_rpc_header: failed to unmarshall RPC_HDR.\n"));
 		set_incoming_fault(p);
 		prs_mem_free(&rpc_in);
 		return -1;
@@ -348,7 +348,7 @@
 	 */
 
 	if(p->hdr.major != 5 && p->hdr.minor != 0) {
-		DEBUG(0,("unmarshall_rpc_header: invalid major/minor numbers in RPC_HDR.\n"));
+		ZERODEBUG(0,("unmarshall_rpc_header: invalid major/minor numbers in RPC_HDR.\n"));
 		set_incoming_fault(p);
 		prs_mem_free(&rpc_in);
 		return -1;
@@ -370,7 +370,7 @@
 			 * a stream missmatch.
 			 */
 
-			DEBUG(0,("unmarshall_rpc_header: FIRST flag not set in first PDU !\n"));
+			ZERODEBUG(0,("unmarshall_rpc_header: FIRST flag not set in first PDU !\n"));
 			set_incoming_fault(p);
 			prs_mem_free(&rpc_in);
 			return -1;
@@ -395,7 +395,7 @@
 		 */
 
 		if (p->endian != rpc_in.bigendian_data) {
-			DEBUG(0,("unmarshall_rpc_header: FIRST endianness flag (%d) different in next PDU !\n", (int)p->endian));
+			ZERODEBUG(0,("unmarshall_rpc_header: FIRST endianness flag (%d) different in next PDU !\n", (int)p->endian));
 			set_incoming_fault(p);
 			prs_mem_free(&rpc_in);
 			return -1;
@@ -407,7 +407,7 @@
 	 */
 
 	if((p->hdr.frag_len < RPC_HEADER_LEN) || (p->hdr.frag_len > MAX_PDU_FRAG_LEN)) {
-		DEBUG(0,("unmarshall_rpc_header: assert on frag length failed.\n"));
+		ZERODEBUG(0,("unmarshall_rpc_header: assert on frag length failed.\n"));
 		set_incoming_fault(p);
 		prs_mem_free(&rpc_in);
 		return -1;
@@ -462,7 +462,7 @@
 				(auth_verify ? RPC_HDR_AUTH_LEN : 0) - p->hdr.auth_len;
 
 	if(!p->pipe_bound) {
-		DEBUG(0,("process_request_pdu: rpc request with no bind.\n"));
+		ZERODEBUG(0,("process_request_pdu: rpc request with no bind.\n"));
 		set_incoming_fault(p);
 		return False;
 	}
@@ -477,13 +477,13 @@
 	 */
 
 	if(!smb_io_rpc_hdr_req("req", &p->hdr_req, rpc_in_p, 0)) {
-		DEBUG(0,("process_request_pdu: failed to unmarshall RPC_HDR_REQ.\n"));
+		ZERODEBUG(0,("process_request_pdu: failed to unmarshall RPC_HDR_REQ.\n"));
 		set_incoming_fault(p);
 		return False;
 	}
 
 	if(p->ntlmssp_auth_validated && !api_pipe_auth_process(p, rpc_in_p)) {
-		DEBUG(0,("process_request_pdu: failed to do auth processing.\n"));
+		ZERODEBUG(0,("process_request_pdu: failed to do auth processing.\n"));
 		set_incoming_fault(p);
 		return False;
 	}
@@ -494,7 +494,7 @@
 		 * Authentication _was_ requested and it already failed.
 		 */
 
-		DEBUG(0,("process_request_pdu: RPC request received on pipe %s where \
+		ZERODEBUG(0,("process_request_pdu: RPC request received on pipe %s where \
 authentication failed. Denying the request.\n", p->name));
 		set_incoming_fault(p);
         return False;
@@ -508,7 +508,7 @@
 	 */
 	
 	if(prs_offset(&p->in_data.data) + data_len > 40*1024*1024) {
-		DEBUG(0,("process_request_pdu: rpc data buffer too large (%u) + (%u)\n",
+		ZERODEBUG(0,("process_request_pdu: rpc data buffer too large (%u) + (%u)\n",
 				(unsigned int)prs_data_size(&p->in_data.data), (unsigned int)data_len ));
 		set_incoming_fault(p);
 		return False;
@@ -522,7 +522,7 @@
 		char *data_from = prs_data_p(rpc_in_p) + prs_offset(rpc_in_p);
 
 		if(!prs_append_data(&p->in_data.data, data_from, data_len)) {
-			DEBUG(0,("process_request_pdu: Unable to append data size %u to parse buffer of size %u.\n",
+			ZERODEBUG(0,("process_request_pdu: Unable to append data size %u to parse buffer of size %u.\n",
 					(unsigned int)data_len, (unsigned int)prs_data_size(&p->in_data.data) ));
 			set_incoming_fault(p);
 			return False;
@@ -544,7 +544,7 @@
 
  		if(!prs_set_buffer_size(&p->in_data.data, prs_offset(&p->in_data.data)))
 		{
-			DEBUG(0,("process_request_pdu: Call to prs_set_buffer_size failed!\n"));
+			ZERODEBUG(0,("process_request_pdu: Call to prs_set_buffer_size failed!\n"));
 			set_incoming_fault(p);
 			return False;
 		}
@@ -639,7 +639,7 @@
 			reply = process_request_pdu(p, &rpc_in);
 			break;
 		default:
-			DEBUG(0,("process_complete_pdu: Unknown rpc type = %u received.\n", (unsigned int)p->hdr.pkt_type ));
+			ZERODEBUG(0,("process_complete_pdu: Unknown rpc type = %u received.\n", (unsigned int)p->hdr.pkt_type ));
 			break;
 	}
 
@@ -680,7 +680,7 @@
 		 * This is an error - data is being received and there is no
 		 * space in the PDU. Free the received data and go into the fault state.
 		 */
-		DEBUG(0,("process_incoming_data: No space in incoming pdu buffer. Current size = %u \
+		ZERODEBUG(0,("process_incoming_data: No space in incoming pdu buffer. Current size = %u \
 incoming data size = %u\n", (unsigned int)p->in_data.pdu_received_len, (unsigned int)n ));
 		set_incoming_fault(p);
 		return -1;
@@ -792,7 +792,7 @@
 	ssize_t data_returned = 0;
 
 	if (!p || !p->open) {
-		DEBUG(0,("read_from_pipe: pipe not open\n"));
+		ZERODEBUG(0,("read_from_pipe: pipe not open\n"));
 		return -1;		
 	}
 
@@ -861,7 +861,7 @@
 	 */
 
 	if(!create_next_pdu(p)) {
-		DEBUG(0,("read_from_pipe: %s: create_next_pdu failed.\n", p->name));
+		ZERODEBUG(0,("read_from_pipe: %s: create_next_pdu failed.\n", p->name));
 		return -1;
 	}
 
@@ -930,7 +930,7 @@
 BOOL close_rpc_pipe_hnd(pipes_struct *p, connection_struct *conn)
 {
 	if (!p) {
-		DEBUG(0,("Invalid pipe in close_rpc_pipe_hnd\n"));
+		ZERODEBUG(0,("Invalid pipe in close_rpc_pipe_hnd\n"));
 		return False;
 	}
 
diff -Naur samba-2.2.12-orig/source/rpc_server/srv_samr.c samba-2.2.12/source/rpc_server/srv_samr.c
--- samba-2.2.12-orig/source/rpc_server/srv_samr.c	2004-08-12 20:24:27.000000000 +0200
+++ samba-2.2.12/source/rpc_server/srv_samr.c	2009-03-11 09:59:37.000000000 +0100
@@ -47,7 +47,7 @@
 	ZERO_STRUCT(r_u);
 
 	if(!samr_io_q_close_hnd("", &q_u, data, 0)) {
-		DEBUG(0,("api_samr_close_hnd: unable to unmarshall SAMR_Q_CLOSE_HND.\n"));
+		ZERODEBUG(0,("api_samr_close_hnd: unable to unmarshall SAMR_Q_CLOSE_HND.\n"));
 		return False;
 	}
 
@@ -55,7 +55,7 @@
 
 	/* store the response in the SMB stream */
 	if(!samr_io_r_close_hnd("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_samr_close_hnd: unable to marshall SAMR_R_CLOSE_HND.\n"));
+		ZERODEBUG(0,("api_samr_close_hnd: unable to marshall SAMR_R_CLOSE_HND.\n"));
 		return False;
 	}
 
@@ -78,7 +78,7 @@
 	ZERO_STRUCT(r_u);
 
 	if(!samr_io_q_open_domain("", &q_u, data, 0)) {
-		DEBUG(0,("api_samr_open_domain: unable to unmarshall SAMR_Q_OPEN_DOMAIN.\n"));
+		ZERODEBUG(0,("api_samr_open_domain: unable to unmarshall SAMR_Q_OPEN_DOMAIN.\n"));
 		return False;
 	}
 
@@ -86,7 +86,7 @@
 
 	/* store the response in the SMB stream */
 	if(!samr_io_r_open_domain("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_samr_open_domain: unable to marshall SAMR_R_OPEN_DOMAIN.\n"));
+		ZERODEBUG(0,("api_samr_open_domain: unable to marshall SAMR_R_OPEN_DOMAIN.\n"));
 		return False;
 	}
 
@@ -322,7 +322,7 @@
 
 	/* unknown 38 command */
 	if (!samr_io_q_chgpasswd_user("", &q_u, data, 0)) {
-		DEBUG(0,("api_samr_chgpasswd_user: Failed to unmarshall SAMR_Q_CHGPASSWD_USER.\n"));
+		ZERODEBUG(0,("api_samr_chgpasswd_user: Failed to unmarshall SAMR_Q_CHGPASSWD_USER.\n"));
 		return False;
 	}
 
@@ -330,7 +330,7 @@
 
 	/* store the response in the SMB stream */
 	if(!samr_io_r_chgpasswd_user("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_samr_chgpasswd_user: Failed to marshall SAMR_R_CHGPASSWD_USER.\n" ));
+		ZERODEBUG(0,("api_samr_chgpasswd_user: Failed to marshall SAMR_R_CHGPASSWD_USER.\n" ));
 		return False;
 	}
 
@@ -494,7 +494,7 @@
 
 	/* grab the samr create user */
 	if (!samr_io_q_create_user("", &q_u, data, 0)) {
-		DEBUG(0,("api_samr_create_user: Unable to unmarshall SAMR_Q_CREATE_USER.\n"));
+		ZERODEBUG(0,("api_samr_create_user: Unable to unmarshall SAMR_Q_CREATE_USER.\n"));
 		return False;
 	}
 
@@ -502,7 +502,7 @@
 
 	/* store the response in the SMB stream */
 	if(!samr_io_r_create_user("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_samr_create_user: Unable to marshall SAMR_R_CREATE_USER.\n"));
+		ZERODEBUG(0,("api_samr_create_user: Unable to marshall SAMR_R_CREATE_USER.\n"));
 		return False;
 	}
 
@@ -578,14 +578,14 @@
 	ZERO_STRUCT(r_u);
 
 	if(!samr_io_q_lookup_domain("", &q_u, data, 0)) {
-		DEBUG(0,("api_samr_lookup_domain: Unable to unmarshall SAMR_Q_LOOKUP_DOMAIN.\n"));
+		ZERODEBUG(0,("api_samr_lookup_domain: Unable to unmarshall SAMR_Q_LOOKUP_DOMAIN.\n"));
 		return False;
 	}
 
 	r_u.status = _samr_lookup_domain(p, &q_u, &r_u);
 	
 	if(!samr_io_r_lookup_domain("", &r_u, rdata, 0)){
-		DEBUG(0,("api_samr_lookup_domain: Unable to marshall SAMR_R_LOOKUP_DOMAIN.\n"));
+		ZERODEBUG(0,("api_samr_lookup_domain: Unable to marshall SAMR_R_LOOKUP_DOMAIN.\n"));
 		return False;
 	}
 	
@@ -607,14 +607,14 @@
 	ZERO_STRUCT(r_u);
 
 	if(!samr_io_q_enum_domains("", &q_u, data, 0)) {
-		DEBUG(0,("api_samr_enum_domains: Unable to unmarshall SAMR_Q_ENUM_DOMAINS.\n"));
+		ZERODEBUG(0,("api_samr_enum_domains: Unable to unmarshall SAMR_Q_ENUM_DOMAINS.\n"));
 		return False;
 	}
 
 	r_u.status = _samr_enum_domains(p, &q_u, &r_u);
 
 	if(!samr_io_r_enum_domains("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_samr_enum_domains: Unable to marshall SAMR_R_ENUM_DOMAINS.\n"));
+		ZERODEBUG(0,("api_samr_enum_domains: Unable to marshall SAMR_R_ENUM_DOMAINS.\n"));
 		return False;
 	}
 	
@@ -637,7 +637,7 @@
 
 	/* grab the samr open policy */
 	if(!samr_io_q_open_alias("", &q_u, data, 0)) {
-		DEBUG(0,("api_samr_open_alias: Unable to unmarshall SAMR_Q_OPEN_ALIAS.\n"));
+		ZERODEBUG(0,("api_samr_open_alias: Unable to unmarshall SAMR_Q_OPEN_ALIAS.\n"));
 		return False;
 	}
 
@@ -645,7 +645,7 @@
 
 	/* store the response in the SMB stream */
 	if(!samr_io_r_open_alias("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_samr_open_alias: Unable to marshall SAMR_R_OPEN_ALIAS.\n"));
+		ZERODEBUG(0,("api_samr_open_alias: Unable to marshall SAMR_R_OPEN_ALIAS.\n"));
 		return False;
 	}
 	
@@ -667,7 +667,7 @@
 	ZERO_STRUCT(r_u);
 
 	if (!samr_io_q_set_userinfo("", &q_u, data, 0)) {
-		DEBUG(0,("api_samr_set_userinfo: Unable to unmarshall SAMR_Q_SET_USERINFO.\n"));
+		ZERODEBUG(0,("api_samr_set_userinfo: Unable to unmarshall SAMR_Q_SET_USERINFO.\n"));
 		/* Fix for W2K SP2 */
 		if (q_u.switch_value == 0x1a) {
 			setup_fault_pdu(p, NT_STATUS(0x1c000006));
@@ -679,7 +679,7 @@
 	r_u.status = _samr_set_userinfo(p, &q_u, &r_u);
 
 	if(!samr_io_r_set_userinfo("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_samr_set_userinfo: Unable to marshall SAMR_R_SET_USERINFO.\n"));
+		ZERODEBUG(0,("api_samr_set_userinfo: Unable to marshall SAMR_R_SET_USERINFO.\n"));
 		return False;
 	}
 
@@ -702,14 +702,14 @@
 	ZERO_STRUCT(r_u);
 
 	if (!samr_io_q_set_userinfo2("", &q_u, data, 0)) {
-		DEBUG(0,("api_samr_set_userinfo2: Unable to unmarshall SAMR_Q_SET_USERINFO2.\n"));
+		ZERODEBUG(0,("api_samr_set_userinfo2: Unable to unmarshall SAMR_Q_SET_USERINFO2.\n"));
 		return False;
 	}
 
 	r_u.status = _samr_set_userinfo2(p, &q_u, &r_u);
 
 	if(!samr_io_r_set_userinfo2("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_samr_set_userinfo2: Unable to marshall SAMR_R_SET_USERINFO2.\n"));
+		ZERODEBUG(0,("api_samr_set_userinfo2: Unable to marshall SAMR_R_SET_USERINFO2.\n"));
 		return False;
 	}
 
@@ -732,14 +732,14 @@
 	ZERO_STRUCT(r_u);
 
 	if (!samr_io_q_query_useraliases("", &q_u, data, 0)) {
-		DEBUG(0,("api_samr_query_useraliases:  Unable to unmarshall SAMR_Q_QUERY_USERALIASES.\n"));
+		ZERODEBUG(0,("api_samr_query_useraliases:  Unable to unmarshall SAMR_Q_QUERY_USERALIASES.\n"));
 		return False;
 	}
 
 	r_u.status = _samr_query_useraliases(p, &q_u, &r_u);
 
 	if (! samr_io_r_query_useraliases("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_samr_query_useraliases:  Unable to nmarshall SAMR_R_QUERY_USERALIASES.\n"));
+		ZERODEBUG(0,("api_samr_query_useraliases:  Unable to nmarshall SAMR_R_QUERY_USERALIASES.\n"));
 		return False;
 	}
 
diff -Naur samba-2.2.12-orig/source/rpc_server/srv_samr_nt.c samba-2.2.12/source/rpc_server/srv_samr_nt.c
--- samba-2.2.12-orig/source/rpc_server/srv_samr_nt.c	2004-08-12 20:24:27.000000000 +0200
+++ samba-2.2.12/source/rpc_server/srv_samr_nt.c	2009-03-11 09:59:37.000000000 +0100
@@ -159,7 +159,7 @@
 	}
 
 	if (!pdb_setsampwent(False)) {
-		DEBUG(0, ("load_sampwd_entries: Unable to open passdb.\n"));
+		ZERODEBUG(0, ("load_sampwd_entries: Unable to open passdb.\n"));
 		return NT_STATUS_ACCESS_DENIED;
 	}
 
@@ -318,7 +318,7 @@
 	pdb_init_sam(&pwd);
 
 	if (!pdb_setsampwent(False)) {
-		DEBUG(0, ("get_sampwd_entries: Unable to open passdb.\n"));
+		ZERODEBUG(0, ("get_sampwd_entries: Unable to open passdb.\n"));
 		pdb_free_sam(pwd);
 		return NT_STATUS_ACCESS_DENIED;
 	}
@@ -562,7 +562,7 @@
 	uni_name = (UNISTR2 *)talloc_zero(ctx, sizeof(UNISTR2)*num_sam_entries);
 
 	if (sam == NULL || uni_name == NULL) {
-		DEBUG(0, ("NULL pointers in SAMR_R_QUERY_DISPINFO\n"));
+		ZERODEBUG(0, ("NULL pointers in SAMR_R_QUERY_DISPINFO\n"));
 		return;
 	}
 
@@ -649,7 +649,7 @@
 	uni_name = (UNISTR2 *)talloc_zero(ctx, sizeof(UNISTR2)*num_sam_entries);
 
 	if (sam == NULL || uni_name == NULL) {
-		DEBUG(0, ("NULL pointers in SAMR_R_QUERY_DISPINFO\n"));
+		ZERODEBUG(0, ("NULL pointers in SAMR_R_QUERY_DISPINFO\n"));
 		return;
 	}
 
@@ -953,7 +953,7 @@
 			num_account = info->disp_info.num_group_account;
 			break;
 		default:
-			DEBUG(0,("_samr_query_dispinfo: Unknown info level (%u)\n", (unsigned int)q_u->switch_level ));
+			ZERODEBUG(0,("_samr_query_dispinfo: Unknown info level (%u)\n", (unsigned int)q_u->switch_level ));
 			return NT_STATUS_INVALID_INFO_CLASS;
 	}
 
@@ -1926,7 +1926,7 @@
 
 	/* add the user in the smbpasswd file or the Samba authority database */
 	if (!local_password_change(mach_acct, local_flags, NULL, err_str, sizeof(err_str), msg_str, sizeof(msg_str))) {
-		DEBUG(0, ("%s\n", err_str));
+		ZERODEBUG(0, ("%s\n", err_str));
 		pdb_free_sam(sam_pass);
 		return NT_STATUS_ACCESS_DENIED;
 	}
@@ -2477,7 +2477,7 @@
 	ret = pdb_getsampwuid(sam_pass, user.uid);
 	unbecome_root();
 	if(ret == False) {
-		DEBUG(0,("_samr_set_userinfo: Unable to get smbpasswd entry for uid %u\n", (unsigned int)user.uid ));
+		ZERODEBUG(0,("_samr_set_userinfo: Unable to get smbpasswd entry for uid %u\n", (unsigned int)user.uid ));
 		pdb_free_sam(sam_pass);
 		return NT_STATUS_ACCESS_DENIED;
 	}
@@ -2623,7 +2623,7 @@
 
 NTSTATUS _samr_query_aliasmem(pipes_struct *p, SAMR_Q_QUERY_ALIASMEM *q_u, SAMR_R_QUERY_ALIASMEM *r_u)
 {
-	DEBUG(0,("_samr_query_aliasmem: Not yet implemented.\n"));
+	ZERODEBUG(0,("_samr_query_aliasmem: Not yet implemented.\n"));
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -2633,7 +2633,7 @@
 
 NTSTATUS _samr_query_groupmem(pipes_struct *p, SAMR_Q_QUERY_GROUPMEM *q_u, SAMR_R_QUERY_GROUPMEM *r_u)
 {
-	DEBUG(0,("_samr_query_groupmem: Not yet implemented.\n"));
+	ZERODEBUG(0,("_samr_query_groupmem: Not yet implemented.\n"));
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -2643,7 +2643,7 @@
 
 NTSTATUS _samr_add_aliasmem(pipes_struct *p, SAMR_Q_ADD_ALIASMEM *q_u, SAMR_R_ADD_ALIASMEM *r_u)
 {
-	DEBUG(0,("_samr_add_aliasmem: Not yet implemented.\n"));
+	ZERODEBUG(0,("_samr_add_aliasmem: Not yet implemented.\n"));
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -2653,7 +2653,7 @@
 
 NTSTATUS _samr_del_aliasmem(pipes_struct *p, SAMR_Q_DEL_ALIASMEM *q_u, SAMR_R_DEL_ALIASMEM *r_u)
 {
-	DEBUG(0,("_samr_del_aliasmem: Not yet implemented.\n"));
+	ZERODEBUG(0,("_samr_del_aliasmem: Not yet implemented.\n"));
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -2663,7 +2663,7 @@
 
 NTSTATUS _samr_add_groupmem(pipes_struct *p, SAMR_Q_ADD_GROUPMEM *q_u, SAMR_R_ADD_GROUPMEM *r_u)
 {
-	DEBUG(0,("_samr_add_groupmem: Not yet implemented.\n"));
+	ZERODEBUG(0,("_samr_add_groupmem: Not yet implemented.\n"));
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -2673,7 +2673,7 @@
 
 NTSTATUS _samr_del_groupmem(pipes_struct *p, SAMR_Q_DEL_GROUPMEM *q_u, SAMR_R_DEL_GROUPMEM *r_u)
 {
-	DEBUG(0,("_samr_del_groupmem: Not yet implemented.\n"));
+	ZERODEBUG(0,("_samr_del_groupmem: Not yet implemented.\n"));
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -2683,7 +2683,7 @@
 
 NTSTATUS _samr_delete_dom_user(pipes_struct *p, SAMR_Q_DELETE_DOM_USER *q_u, SAMR_R_DELETE_DOM_USER *r_u )
 {
-	DEBUG(0,("_samr_delete_dom_user: Not yet implemented.\n"));
+	ZERODEBUG(0,("_samr_delete_dom_user: Not yet implemented.\n"));
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -2693,7 +2693,7 @@
 
 NTSTATUS _samr_delete_dom_group(pipes_struct *p, SAMR_Q_DELETE_DOM_GROUP *q_u, SAMR_R_DELETE_DOM_GROUP *r_u)
 {
-	DEBUG(0,("_samr_delete_dom_group: Not yet implemented.\n"));
+	ZERODEBUG(0,("_samr_delete_dom_group: Not yet implemented.\n"));
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -2703,7 +2703,7 @@
 
 NTSTATUS _samr_delete_dom_alias(pipes_struct *p, SAMR_Q_DELETE_DOM_ALIAS *q_u, SAMR_R_DELETE_DOM_ALIAS *r_u)
 {
-	DEBUG(0,("_samr_delete_dom_alias: Not yet implemented.\n"));
+	ZERODEBUG(0,("_samr_delete_dom_alias: Not yet implemented.\n"));
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -2713,7 +2713,7 @@
 
 NTSTATUS _samr_create_dom_group(pipes_struct *p, SAMR_Q_CREATE_DOM_GROUP *q_u, SAMR_R_CREATE_DOM_GROUP *r_u)
 {
-	DEBUG(0,("_samr_create_dom_group: Not yet implemented.\n"));
+	ZERODEBUG(0,("_samr_create_dom_group: Not yet implemented.\n"));
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -2723,7 +2723,7 @@
 
 NTSTATUS _samr_create_dom_alias(pipes_struct *p, SAMR_Q_CREATE_DOM_ALIAS *q_u, SAMR_R_CREATE_DOM_ALIAS *r_u)
 {
-	DEBUG(0,("_samr_create_dom_alias: Not yet implemented.\n"));
+	ZERODEBUG(0,("_samr_create_dom_alias: Not yet implemented.\n"));
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -2733,7 +2733,7 @@
 
 NTSTATUS _samr_query_groupinfo(pipes_struct *p, SAMR_Q_QUERY_GROUPINFO *q_u, SAMR_R_QUERY_GROUPINFO *r_u)
 {
-	DEBUG(0,("_samr_query_groupinfo: Not yet implemented.\n"));
+	ZERODEBUG(0,("_samr_query_groupinfo: Not yet implemented.\n"));
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -2743,7 +2743,7 @@
 
 NTSTATUS _samr_set_groupinfo(pipes_struct *p, SAMR_Q_SET_GROUPINFO *q_u, SAMR_R_SET_GROUPINFO *r_u)
 {
-	DEBUG(0,("_samr_set_groupinfo: Not yet implemented.\n"));
+	ZERODEBUG(0,("_samr_set_groupinfo: Not yet implemented.\n"));
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -2763,7 +2763,7 @@
 
 NTSTATUS _samr_open_group(pipes_struct *p, SAMR_Q_OPEN_GROUP *q_u, SAMR_R_OPEN_GROUP *r_u)
 {
-	DEBUG(0,("_samr_open_group: Not yet implemented.\n"));
+	ZERODEBUG(0,("_samr_open_group: Not yet implemented.\n"));
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
 
@@ -2773,6 +2773,6 @@
 
 NTSTATUS _samr_unknown_2d(pipes_struct *p, SAMR_Q_UNKNOWN_2D *q_u, SAMR_R_UNKNOWN_2D *r_u)
 {
-	DEBUG(0,("_samr_unknown_2d: Not yet implemented.\n"));
+	ZERODEBUG(0,("_samr_unknown_2d: Not yet implemented.\n"));
 	return NT_STATUS_NOT_IMPLEMENTED;
 }
diff -Naur samba-2.2.12-orig/source/rpc_server/srv_spoolss.c samba-2.2.12/source/rpc_server/srv_spoolss.c
--- samba-2.2.12-orig/source/rpc_server/srv_spoolss.c	2004-08-12 20:24:27.000000000 +0200
+++ samba-2.2.12/source/rpc_server/srv_spoolss.c	2009-03-11 09:59:37.000000000 +0100
@@ -38,14 +38,14 @@
 	ZERO_STRUCT(r_u);
 
 	if (!spoolss_io_q_open_printer("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_open_printer: unable to unmarshall SPOOL_Q_OPEN_PRINTER.\n"));
+		ZERODEBUG(0,("spoolss_io_q_open_printer: unable to unmarshall SPOOL_Q_OPEN_PRINTER.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_open_printer( p, &q_u, &r_u);
 	
 	if (!spoolss_io_r_open_printer("",&r_u,rdata,0)){
-		DEBUG(0,("spoolss_io_r_open_printer: unable to marshall SPOOL_R_OPEN_PRINTER.\n"));
+		ZERODEBUG(0,("spoolss_io_r_open_printer: unable to marshall SPOOL_R_OPEN_PRINTER.\n"));
 		return False;
 	}
 
@@ -68,14 +68,14 @@
 	ZERO_STRUCT(r_u);
 
 	if (!spoolss_io_q_open_printer_ex("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_open_printer_ex: unable to unmarshall SPOOL_Q_OPEN_PRINTER_EX.\n"));
+		ZERODEBUG(0,("spoolss_io_q_open_printer_ex: unable to unmarshall SPOOL_Q_OPEN_PRINTER_EX.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_open_printer_ex( p, &q_u, &r_u);
 
 	if (!spoolss_io_r_open_printer_ex("",&r_u,rdata,0)){
-		DEBUG(0,("spoolss_io_r_open_printer_ex: unable to marshall SPOOL_R_OPEN_PRINTER_EX.\n"));
+		ZERODEBUG(0,("spoolss_io_r_open_printer_ex: unable to marshall SPOOL_R_OPEN_PRINTER_EX.\n"));
 		return False;
 	}
 
@@ -100,14 +100,14 @@
 
 	/* read the stream and fill the struct */
 	if (!spoolss_io_q_getprinterdata("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_getprinterdata: unable to unmarshall SPOOL_Q_GETPRINTERDATA.\n"));
+		ZERODEBUG(0,("spoolss_io_q_getprinterdata: unable to unmarshall SPOOL_Q_GETPRINTERDATA.\n"));
 		return False;
 	}
 	
 	r_u.status = _spoolss_getprinterdata( p, &q_u, &r_u);
 
 	if (!spoolss_io_r_getprinterdata("", &r_u, rdata, 0)) {
-		DEBUG(0,("spoolss_io_r_getprinterdata: unable to marshall SPOOL_R_GETPRINTERDATA.\n"));
+		ZERODEBUG(0,("spoolss_io_r_getprinterdata: unable to marshall SPOOL_R_GETPRINTERDATA.\n"));
 		return False;
 	}
 
@@ -132,14 +132,14 @@
 
 	/* read the stream and fill the struct */
 	if (!spoolss_io_q_deleteprinterdata("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_deleteprinterdata: unable to unmarshall SPOOL_Q_DELETEPRINTERDATA.\n"));
+		ZERODEBUG(0,("spoolss_io_q_deleteprinterdata: unable to unmarshall SPOOL_Q_DELETEPRINTERDATA.\n"));
 		return False;
 	}
 	
 	r_u.status = _spoolss_deleteprinterdata( p, &q_u, &r_u);
 
 	if (!spoolss_io_r_deleteprinterdata("", &r_u, rdata, 0)) {
-		DEBUG(0,("spoolss_io_r_deleteprinterdata: unable to marshall SPOOL_R_DELETEPRINTERDATA.\n"));
+		ZERODEBUG(0,("spoolss_io_r_deleteprinterdata: unable to marshall SPOOL_R_DELETEPRINTERDATA.\n"));
 		return False;
 	}
 
@@ -163,14 +163,14 @@
 	ZERO_STRUCT(r_u);
 
 	if (!spoolss_io_q_closeprinter("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_closeprinter: unable to unmarshall SPOOL_Q_CLOSEPRINTER.\n"));
+		ZERODEBUG(0,("spoolss_io_q_closeprinter: unable to unmarshall SPOOL_Q_CLOSEPRINTER.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_closeprinter(p, &q_u, &r_u);
 
 	if (!spoolss_io_r_closeprinter("",&r_u,rdata,0)) {
-		DEBUG(0,("spoolss_io_r_closeprinter: unable to marshall SPOOL_R_CLOSEPRINTER.\n"));
+		ZERODEBUG(0,("spoolss_io_r_closeprinter: unable to marshall SPOOL_R_CLOSEPRINTER.\n"));
 		return False;
 	}
 
@@ -194,14 +194,14 @@
 	ZERO_STRUCT(r_u);
 
 	if (!spoolss_io_q_abortprinter("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_abortprinter: unable to unmarshall SPOOL_Q_ABORTPRINTER.\n"));
+		ZERODEBUG(0,("spoolss_io_q_abortprinter: unable to unmarshall SPOOL_Q_ABORTPRINTER.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_abortprinter(p, &q_u, &r_u);
 
 	if (!spoolss_io_r_abortprinter("",&r_u,rdata,0)) {
-		DEBUG(0,("spoolss_io_r_abortprinter: unable to marshall SPOOL_R_ABORTPRINTER.\n"));
+		ZERODEBUG(0,("spoolss_io_r_abortprinter: unable to marshall SPOOL_R_ABORTPRINTER.\n"));
 		return False;
 	}
 
@@ -225,14 +225,14 @@
 	ZERO_STRUCT(r_u);
 
 	if (!spoolss_io_q_deleteprinter("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_deleteprinter: unable to unmarshall SPOOL_Q_DELETEPRINTER.\n"));
+		ZERODEBUG(0,("spoolss_io_q_deleteprinter: unable to unmarshall SPOOL_Q_DELETEPRINTER.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_deleteprinter(p, &q_u, &r_u);
 
 	if (!spoolss_io_r_deleteprinter("",&r_u,rdata,0)) {
-		DEBUG(0,("spoolss_io_r_deleteprinter: unable to marshall SPOOL_R_DELETEPRINTER.\n"));
+		ZERODEBUG(0,("spoolss_io_r_deleteprinter: unable to marshall SPOOL_R_DELETEPRINTER.\n"));
 		return False;
 	}
 
@@ -257,14 +257,14 @@
 	ZERO_STRUCT(r_u);
 
 	if (!spoolss_io_q_deleteprinterdriver("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_deleteprinterdriver: unable to unmarshall SPOOL_Q_DELETEPRINTERDRIVER.\n"));
+		ZERODEBUG(0,("spoolss_io_q_deleteprinterdriver: unable to unmarshall SPOOL_Q_DELETEPRINTERDRIVER.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_deleteprinterdriver(p, &q_u, &r_u);
 
 	if (!spoolss_io_r_deleteprinterdriver("",&r_u,rdata,0)) {
-		DEBUG(0,("spoolss_io_r_deleteprinter: unable to marshall SPOOL_R_DELETEPRINTER.\n"));
+		ZERODEBUG(0,("spoolss_io_r_deleteprinter: unable to marshall SPOOL_R_DELETEPRINTER.\n"));
 		return False;
 	}
 
@@ -288,14 +288,14 @@
 	ZERO_STRUCT(r_u);
 
 	if (!spoolss_io_q_rffpcnex("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_rffpcnex: unable to unmarshall SPOOL_Q_RFFPCNEX.\n"));
+		ZERODEBUG(0,("spoolss_io_q_rffpcnex: unable to unmarshall SPOOL_Q_RFFPCNEX.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_rffpcnex(p, &q_u, &r_u);
 
 	if (!spoolss_io_r_rffpcnex("", &r_u, rdata, 0)) {
-		DEBUG(0,("spoolss_io_r_rffpcnex: unable to marshall SPOOL_R_RFFPCNEX.\n"));
+		ZERODEBUG(0,("spoolss_io_r_rffpcnex: unable to marshall SPOOL_R_RFFPCNEX.\n"));
 		return False;
 	}
 
@@ -325,7 +325,7 @@
 	ZERO_STRUCT(r_u);
 
 	if (!spoolss_io_q_rfnpcnex("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_rfnpcnex: unable to unmarshall SPOOL_Q_RFNPCNEX.\n"));
+		ZERODEBUG(0,("spoolss_io_q_rfnpcnex: unable to unmarshall SPOOL_Q_RFNPCNEX.\n"));
 		return False;
 	}
 
@@ -333,7 +333,7 @@
 
 	if (!spoolss_io_r_rfnpcnex("", &r_u, rdata, 0)) {
 		SAFE_FREE(r_u.info.data);
-		DEBUG(0,("spoolss_io_r_rfnpcnex: unable to marshall SPOOL_R_RFNPCNEX.\n"));
+		ZERODEBUG(0,("spoolss_io_r_rfnpcnex: unable to marshall SPOOL_R_RFNPCNEX.\n"));
 		return False;
 	}
 
@@ -360,14 +360,14 @@
 	ZERO_STRUCT(r_u);
 
 	if (!spoolss_io_q_enumprinters("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_enumprinters: unable to unmarshall SPOOL_Q_ENUMPRINTERS.\n"));
+		ZERODEBUG(0,("spoolss_io_q_enumprinters: unable to unmarshall SPOOL_Q_ENUMPRINTERS.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_enumprinters( p, &q_u, &r_u);
 
 	if (!spoolss_io_r_enumprinters("", &r_u, rdata, 0)) {
-		DEBUG(0,("spoolss_io_r_enumprinters: unable to marshall SPOOL_R_ENUMPRINTERS.\n"));
+		ZERODEBUG(0,("spoolss_io_r_enumprinters: unable to marshall SPOOL_R_ENUMPRINTERS.\n"));
 		return False;
 	}
 
@@ -391,14 +391,14 @@
 	ZERO_STRUCT(r_u);
 
 	if(!spoolss_io_q_getprinter("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_getprinter: unable to unmarshall SPOOL_Q_GETPRINTER.\n"));
+		ZERODEBUG(0,("spoolss_io_q_getprinter: unable to unmarshall SPOOL_Q_GETPRINTER.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_getprinter(p, &q_u, &r_u);
 
 	if(!spoolss_io_r_getprinter("",&r_u,rdata,0)) {
-		DEBUG(0,("spoolss_io_r_getprinter: unable to marshall SPOOL_R_GETPRINTER.\n"));
+		ZERODEBUG(0,("spoolss_io_r_getprinter: unable to marshall SPOOL_R_GETPRINTER.\n"));
 		return False;
 	}
 
@@ -422,14 +422,14 @@
 	ZERO_STRUCT(r_u);
 
 	if(!spoolss_io_q_getprinterdriver2("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_getprinterdriver2: unable to unmarshall SPOOL_Q_GETPRINTERDRIVER2.\n"));
+		ZERODEBUG(0,("spoolss_io_q_getprinterdriver2: unable to unmarshall SPOOL_Q_GETPRINTERDRIVER2.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_getprinterdriver2(p, &q_u, &r_u);
 	
 	if(!spoolss_io_r_getprinterdriver2("",&r_u,rdata,0)) {
-		DEBUG(0,("spoolss_io_r_getprinterdriver2: unable to marshall SPOOL_R_GETPRINTERDRIVER2.\n"));
+		ZERODEBUG(0,("spoolss_io_r_getprinterdriver2: unable to marshall SPOOL_R_GETPRINTERDRIVER2.\n"));
 		return False;
 	}
 	
@@ -453,14 +453,14 @@
 	ZERO_STRUCT(r_u);
 
 	if(!spoolss_io_q_startpageprinter("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_startpageprinter: unable to unmarshall SPOOL_Q_STARTPAGEPRINTER.\n"));
+		ZERODEBUG(0,("spoolss_io_q_startpageprinter: unable to unmarshall SPOOL_Q_STARTPAGEPRINTER.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_startpageprinter(p, &q_u, &r_u);
 
 	if(!spoolss_io_r_startpageprinter("",&r_u,rdata,0)) {
-		DEBUG(0,("spoolss_io_r_startpageprinter: unable to marshall SPOOL_R_STARTPAGEPRINTER.\n"));
+		ZERODEBUG(0,("spoolss_io_r_startpageprinter: unable to marshall SPOOL_R_STARTPAGEPRINTER.\n"));
 		return False;
 	}
 
@@ -484,14 +484,14 @@
 	ZERO_STRUCT(r_u);
 
 	if(!spoolss_io_q_endpageprinter("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_endpageprinter: unable to unmarshall SPOOL_Q_ENDPAGEPRINTER.\n"));
+		ZERODEBUG(0,("spoolss_io_q_endpageprinter: unable to unmarshall SPOOL_Q_ENDPAGEPRINTER.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_endpageprinter(p, &q_u, &r_u);
 
 	if(!spoolss_io_r_endpageprinter("",&r_u,rdata,0)) {
-		DEBUG(0,("spoolss_io_r_endpageprinter: unable to marshall SPOOL_R_ENDPAGEPRINTER.\n"));
+		ZERODEBUG(0,("spoolss_io_r_endpageprinter: unable to marshall SPOOL_R_ENDPAGEPRINTER.\n"));
 		return False;
 	}
 
@@ -512,14 +512,14 @@
 	ZERO_STRUCT(r_u);
 
 	if(!spoolss_io_q_startdocprinter("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_startdocprinter: unable to unmarshall SPOOL_Q_STARTDOCPRINTER.\n"));
+		ZERODEBUG(0,("spoolss_io_q_startdocprinter: unable to unmarshall SPOOL_Q_STARTDOCPRINTER.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_startdocprinter(p, &q_u, &r_u);
 
 	if(!spoolss_io_r_startdocprinter("",&r_u,rdata,0)) {
-		DEBUG(0,("spoolss_io_r_startdocprinter: unable to marshall SPOOL_R_STARTDOCPRINTER.\n"));
+		ZERODEBUG(0,("spoolss_io_r_startdocprinter: unable to marshall SPOOL_R_STARTDOCPRINTER.\n"));
 		return False;
 	}
 
@@ -540,14 +540,14 @@
 	ZERO_STRUCT(r_u);
 
 	if(!spoolss_io_q_enddocprinter("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_enddocprinter: unable to unmarshall SPOOL_Q_ENDDOCPRINTER.\n"));
+		ZERODEBUG(0,("spoolss_io_q_enddocprinter: unable to unmarshall SPOOL_Q_ENDDOCPRINTER.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_enddocprinter(p, &q_u, &r_u);
 
 	if(!spoolss_io_r_enddocprinter("",&r_u,rdata,0)) {
-		DEBUG(0,("spoolss_io_r_enddocprinter: unable to marshall SPOOL_R_ENDDOCPRINTER.\n"));
+		ZERODEBUG(0,("spoolss_io_r_enddocprinter: unable to marshall SPOOL_R_ENDDOCPRINTER.\n"));
 		return False;
 	}
 
@@ -568,14 +568,14 @@
 	ZERO_STRUCT(r_u);
 
 	if(!spoolss_io_q_writeprinter("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_writeprinter: unable to unmarshall SPOOL_Q_WRITEPRINTER.\n"));
+		ZERODEBUG(0,("spoolss_io_q_writeprinter: unable to unmarshall SPOOL_Q_WRITEPRINTER.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_writeprinter(p, &q_u, &r_u);
 
 	if(!spoolss_io_r_writeprinter("",&r_u,rdata,0)) {
-		DEBUG(0,("spoolss_io_r_writeprinter: unable to marshall SPOOL_R_WRITEPRINTER.\n"));
+		ZERODEBUG(0,("spoolss_io_r_writeprinter: unable to marshall SPOOL_R_WRITEPRINTER.\n"));
 		return False;
 	}
 
@@ -597,14 +597,14 @@
 	ZERO_STRUCT(r_u);
 
 	if(!spoolss_io_q_setprinter("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_setprinter: unable to unmarshall SPOOL_Q_SETPRINTER.\n"));
+		ZERODEBUG(0,("spoolss_io_q_setprinter: unable to unmarshall SPOOL_Q_SETPRINTER.\n"));
 		return False;
 	}
 	
 	r_u.status = _spoolss_setprinter(p, &q_u, &r_u);
 	
 	if(!spoolss_io_r_setprinter("",&r_u,rdata,0)) {
-		DEBUG(0,("spoolss_io_r_setprinter: unable to marshall SPOOL_R_SETPRINTER.\n"));
+		ZERODEBUG(0,("spoolss_io_r_setprinter: unable to marshall SPOOL_R_SETPRINTER.\n"));
 		return False;
 	}
 
@@ -625,14 +625,14 @@
 	ZERO_STRUCT(r_u);
 
 	if(!spoolss_io_q_fcpn("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_fcpn: unable to unmarshall SPOOL_Q_FCPN.\n"));
+		ZERODEBUG(0,("spoolss_io_q_fcpn: unable to unmarshall SPOOL_Q_FCPN.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_fcpn(p, &q_u, &r_u);
 
 	if(!spoolss_io_r_fcpn("",&r_u,rdata,0)) {
-		DEBUG(0,("spoolss_io_r_fcpn: unable to marshall SPOOL_R_FCPN.\n"));
+		ZERODEBUG(0,("spoolss_io_r_fcpn: unable to marshall SPOOL_R_FCPN.\n"));
 		return False;
 	}
 
@@ -653,14 +653,14 @@
 	ZERO_STRUCT(r_u);
 
 	if(!spoolss_io_q_addjob("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_addjob: unable to unmarshall SPOOL_Q_ADDJOB.\n"));
+		ZERODEBUG(0,("spoolss_io_q_addjob: unable to unmarshall SPOOL_Q_ADDJOB.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_addjob(p, &q_u, &r_u);
 		
 	if(!spoolss_io_r_addjob("",&r_u,rdata,0)) {
-		DEBUG(0,("spoolss_io_r_addjob: unable to marshall SPOOL_R_ADDJOB.\n"));
+		ZERODEBUG(0,("spoolss_io_r_addjob: unable to marshall SPOOL_R_ADDJOB.\n"));
 		return False;
 	}
 
@@ -681,14 +681,14 @@
 	ZERO_STRUCT(r_u);
 
 	if (!spoolss_io_q_enumjobs("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_enumjobs: unable to unmarshall SPOOL_Q_ENUMJOBS.\n"));
+		ZERODEBUG(0,("spoolss_io_q_enumjobs: unable to unmarshall SPOOL_Q_ENUMJOBS.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_enumjobs(p, &q_u, &r_u);
 
 	if (!spoolss_io_r_enumjobs("",&r_u,rdata,0)) {
-		DEBUG(0,("spoolss_io_r_enumjobs: unable to marshall SPOOL_R_ENUMJOBS.\n"));
+		ZERODEBUG(0,("spoolss_io_r_enumjobs: unable to marshall SPOOL_R_ENUMJOBS.\n"));
 		return False;
 	}
 
@@ -709,14 +709,14 @@
 	ZERO_STRUCT(r_u);
 
 	if(!spoolss_io_q_schedulejob("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_schedulejob: unable to unmarshall SPOOL_Q_SCHEDULEJOB.\n"));
+		ZERODEBUG(0,("spoolss_io_q_schedulejob: unable to unmarshall SPOOL_Q_SCHEDULEJOB.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_schedulejob(p, &q_u, &r_u);
 
 	if(!spoolss_io_r_schedulejob("",&r_u,rdata,0)) {
-		DEBUG(0,("spoolss_io_r_schedulejob: unable to marshall SPOOL_R_SCHEDULEJOB.\n"));
+		ZERODEBUG(0,("spoolss_io_r_schedulejob: unable to marshall SPOOL_R_SCHEDULEJOB.\n"));
 		return False;
 	}
 
@@ -737,14 +737,14 @@
 	ZERO_STRUCT(r_u);
 
 	if(!spoolss_io_q_setjob("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_setjob: unable to unmarshall SPOOL_Q_SETJOB.\n"));
+		ZERODEBUG(0,("spoolss_io_q_setjob: unable to unmarshall SPOOL_Q_SETJOB.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_setjob(p, &q_u, &r_u);
 
 	if(!spoolss_io_r_setjob("",&r_u,rdata,0)) {
-		DEBUG(0,("spoolss_io_r_setjob: unable to marshall SPOOL_R_SETJOB.\n"));
+		ZERODEBUG(0,("spoolss_io_r_setjob: unable to marshall SPOOL_R_SETJOB.\n"));
 		return False;
 	}
 
@@ -765,14 +765,14 @@
 	ZERO_STRUCT(r_u);
 
 	if (!spoolss_io_q_enumprinterdrivers("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_enumprinterdrivers: unable to unmarshall SPOOL_Q_ENUMPRINTERDRIVERS.\n"));
+		ZERODEBUG(0,("spoolss_io_q_enumprinterdrivers: unable to unmarshall SPOOL_Q_ENUMPRINTERDRIVERS.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_enumprinterdrivers(p, &q_u, &r_u);
 
 	if (!spoolss_io_r_enumprinterdrivers("",&r_u,rdata,0)) {
-		DEBUG(0,("spoolss_io_r_enumprinterdrivers: unable to marshall SPOOL_R_ENUMPRINTERDRIVERS.\n"));
+		ZERODEBUG(0,("spoolss_io_r_enumprinterdrivers: unable to marshall SPOOL_R_ENUMPRINTERDRIVERS.\n"));
 		return False;
 	}
 
@@ -793,14 +793,14 @@
 	ZERO_STRUCT(r_u);
 
 	if (!spoolss_io_q_getform("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_getform: unable to unmarshall SPOOL_Q_GETFORM.\n"));
+		ZERODEBUG(0,("spoolss_io_q_getform: unable to unmarshall SPOOL_Q_GETFORM.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_getform(p, &q_u, &r_u);
 
 	if (!spoolss_io_r_getform("",&r_u,rdata,0)) {
-		DEBUG(0,("spoolss_io_r_getform: unable to marshall SPOOL_R_GETFORM.\n"));
+		ZERODEBUG(0,("spoolss_io_r_getform: unable to marshall SPOOL_R_GETFORM.\n"));
 		return False;
 	}
 
@@ -821,14 +821,14 @@
 	ZERO_STRUCT(r_u);
 
 	if (!spoolss_io_q_enumforms("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_enumforms: unable to unmarshall SPOOL_Q_ENUMFORMS.\n"));
+		ZERODEBUG(0,("spoolss_io_q_enumforms: unable to unmarshall SPOOL_Q_ENUMFORMS.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_enumforms(p, &q_u, &r_u);
 
 	if (!spoolss_io_r_enumforms("",&r_u,rdata,0)) {
-		DEBUG(0,("spoolss_io_r_enumforms: unable to marshall SPOOL_R_ENUMFORMS.\n"));
+		ZERODEBUG(0,("spoolss_io_r_enumforms: unable to marshall SPOOL_R_ENUMFORMS.\n"));
 		return False;
 	}
 
@@ -849,14 +849,14 @@
 	ZERO_STRUCT(r_u);
 
 	if(!spoolss_io_q_enumports("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_enumports: unable to unmarshall SPOOL_Q_ENUMPORTS.\n"));
+		ZERODEBUG(0,("spoolss_io_q_enumports: unable to unmarshall SPOOL_Q_ENUMPORTS.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_enumports(p, &q_u, &r_u);
 
 	if (!spoolss_io_r_enumports("",&r_u,rdata,0)) {
-		DEBUG(0,("spoolss_io_r_enumports: unable to marshall SPOOL_R_ENUMPORTS.\n"));
+		ZERODEBUG(0,("spoolss_io_r_enumports: unable to marshall SPOOL_R_ENUMPORTS.\n"));
 		return False;
 	}
 
@@ -877,14 +877,14 @@
 	ZERO_STRUCT(r_u);
 	
 	if(!spoolss_io_q_addprinterex("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_addprinterex: unable to unmarshall SPOOL_Q_ADDPRINTEREX.\n"));
+		ZERODEBUG(0,("spoolss_io_q_addprinterex: unable to unmarshall SPOOL_Q_ADDPRINTEREX.\n"));
 		return False;
 	}
 	
 	r_u.status = _spoolss_addprinterex(p, &q_u, &r_u);
 				
 	if(!spoolss_io_r_addprinterex("", &r_u, rdata, 0)) {
-		DEBUG(0,("spoolss_io_r_addprinterex: unable to marshall SPOOL_R_ADDPRINTEREX.\n"));
+		ZERODEBUG(0,("spoolss_io_r_addprinterex: unable to marshall SPOOL_R_ADDPRINTEREX.\n"));
 		return False;
 	}
 	
@@ -905,14 +905,14 @@
 	ZERO_STRUCT(r_u);
 	
 	if(!spoolss_io_q_addprinterdriver("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_addprinterdriver: unable to unmarshall SPOOL_Q_ADDPRINTERDRIVER.\n"));
+		ZERODEBUG(0,("spoolss_io_q_addprinterdriver: unable to unmarshall SPOOL_Q_ADDPRINTERDRIVER.\n"));
 		return False;
 	}
 	
 	r_u.status = _spoolss_addprinterdriver(p, &q_u, &r_u);
 				
 	if(!spoolss_io_r_addprinterdriver("", &r_u, rdata, 0)) {
-		DEBUG(0,("spoolss_io_r_addprinterdriver: unable to marshall SPOOL_R_ADDPRINTERDRIVER.\n"));
+		ZERODEBUG(0,("spoolss_io_r_addprinterdriver: unable to marshall SPOOL_R_ADDPRINTERDRIVER.\n"));
 		return False;
 	}
 	
@@ -933,14 +933,14 @@
 	ZERO_STRUCT(r_u);
 
 	if(!spoolss_io_q_getprinterdriverdir("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_getprinterdriverdir: unable to unmarshall SPOOL_Q_GETPRINTERDRIVERDIR.\n"));
+		ZERODEBUG(0,("spoolss_io_q_getprinterdriverdir: unable to unmarshall SPOOL_Q_GETPRINTERDRIVERDIR.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_getprinterdriverdirectory(p, &q_u, &r_u);
 
 	if(!spoolss_io_r_getprinterdriverdir("", &r_u, rdata, 0)) {
-		DEBUG(0,("spoolss_io_r_getprinterdriverdir: unable to marshall SPOOL_R_GETPRINTERDRIVERDIR.\n"));
+		ZERODEBUG(0,("spoolss_io_r_getprinterdriverdir: unable to marshall SPOOL_R_GETPRINTERDRIVERDIR.\n"));
 		return False;
 	}
 
@@ -961,14 +961,14 @@
 	ZERO_STRUCT(r_u);
 	
 	if(!spoolss_io_q_enumprinterdata("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_enumprinterdata: unable to unmarshall SPOOL_Q_ENUMPRINTERDATA.\n"));
+		ZERODEBUG(0,("spoolss_io_q_enumprinterdata: unable to unmarshall SPOOL_Q_ENUMPRINTERDATA.\n"));
 		return False;
 	}
 	
 	r_u.status = _spoolss_enumprinterdata(p, &q_u, &r_u);
 				
 	if(!spoolss_io_r_enumprinterdata("", &r_u, rdata, 0)) {
-		DEBUG(0,("spoolss_io_r_enumprinterdata: unable to marshall SPOOL_R_ENUMPRINTERDATA.\n"));
+		ZERODEBUG(0,("spoolss_io_r_enumprinterdata: unable to marshall SPOOL_R_ENUMPRINTERDATA.\n"));
 		return False;
 	}
 
@@ -989,14 +989,14 @@
 	ZERO_STRUCT(r_u);
 	
 	if(!spoolss_io_q_setprinterdata("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_setprinterdata: unable to unmarshall SPOOL_Q_SETPRINTERDATA.\n"));
+		ZERODEBUG(0,("spoolss_io_q_setprinterdata: unable to unmarshall SPOOL_Q_SETPRINTERDATA.\n"));
 		return False;
 	}
 	
 	r_u.status = _spoolss_setprinterdata(p, &q_u, &r_u);
 				
 	if(!spoolss_io_r_setprinterdata("", &r_u, rdata, 0)) {
-		DEBUG(0,("spoolss_io_r_setprinterdata: unable to marshall SPOOL_R_SETPRINTERDATA.\n"));
+		ZERODEBUG(0,("spoolss_io_r_setprinterdata: unable to marshall SPOOL_R_SETPRINTERDATA.\n"));
 		return False;
 	}
 
@@ -1016,14 +1016,14 @@
 	ZERO_STRUCT(r_u);
 
 	if(!spoolss_io_q_resetprinter("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_setprinterdata: unable to unmarshall SPOOL_Q_SETPRINTERDATA.\n"));
+		ZERODEBUG(0,("spoolss_io_q_setprinterdata: unable to unmarshall SPOOL_Q_SETPRINTERDATA.\n"));
 		return False;
 	}
 	
 	r_u.status = _spoolss_resetprinter(p, &q_u, &r_u);
 				
 	if(!spoolss_io_r_resetprinter("", &r_u, rdata, 0)) {
-		DEBUG(0,("spoolss_io_r_setprinterdata: unable to marshall SPOOL_R_RESETPRINTER.\n"));
+		ZERODEBUG(0,("spoolss_io_r_setprinterdata: unable to marshall SPOOL_R_RESETPRINTER.\n"));
 		return False;
 	}
 
@@ -1043,14 +1043,14 @@
 	ZERO_STRUCT(r_u);
 	
 	if(!spoolss_io_q_addform("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_addform: unable to unmarshall SPOOL_Q_ADDFORM.\n"));
+		ZERODEBUG(0,("spoolss_io_q_addform: unable to unmarshall SPOOL_Q_ADDFORM.\n"));
 		return False;
 	}
 	
 	r_u.status = _spoolss_addform(p, &q_u, &r_u);
 	
 	if(!spoolss_io_r_addform("", &r_u, rdata, 0)) {
-		DEBUG(0,("spoolss_io_r_addform: unable to marshall SPOOL_R_ADDFORM.\n"));
+		ZERODEBUG(0,("spoolss_io_r_addform: unable to marshall SPOOL_R_ADDFORM.\n"));
 		return False;
 	}
 
@@ -1071,14 +1071,14 @@
 	ZERO_STRUCT(r_u);
 	
 	if(!spoolss_io_q_deleteform("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_deleteform: unable to unmarshall SPOOL_Q_DELETEFORM.\n"));
+		ZERODEBUG(0,("spoolss_io_q_deleteform: unable to unmarshall SPOOL_Q_DELETEFORM.\n"));
 		return False;
 	}
 	
 	r_u.status = _spoolss_deleteform(p, &q_u, &r_u);
 	
 	if(!spoolss_io_r_deleteform("", &r_u, rdata, 0)) {
-		DEBUG(0,("spoolss_io_r_deleteform: unable to marshall SPOOL_R_DELETEFORM.\n"));
+		ZERODEBUG(0,("spoolss_io_r_deleteform: unable to marshall SPOOL_R_DELETEFORM.\n"));
 		return False;
 	}
 
@@ -1099,14 +1099,14 @@
 	ZERO_STRUCT(r_u);
 	
 	if(!spoolss_io_q_setform("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_setform: unable to unmarshall SPOOL_Q_SETFORM.\n"));
+		ZERODEBUG(0,("spoolss_io_q_setform: unable to unmarshall SPOOL_Q_SETFORM.\n"));
 		return False;
 	}
 	
 	r_u.status = _spoolss_setform(p, &q_u, &r_u);
 				      
 	if(!spoolss_io_r_setform("", &r_u, rdata, 0)) {
-		DEBUG(0,("spoolss_io_r_setform: unable to marshall SPOOL_R_SETFORM.\n"));
+		ZERODEBUG(0,("spoolss_io_r_setform: unable to marshall SPOOL_R_SETFORM.\n"));
 		return False;
 	}
 
@@ -1127,14 +1127,14 @@
 	ZERO_STRUCT(r_u);
 	
 	if(!spoolss_io_q_enumprintprocessors("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_enumprintprocessors: unable to unmarshall SPOOL_Q_ENUMPRINTPROCESSORS.\n"));
+		ZERODEBUG(0,("spoolss_io_q_enumprintprocessors: unable to unmarshall SPOOL_Q_ENUMPRINTPROCESSORS.\n"));
 		return False;
 	}
 	
 	r_u.status = _spoolss_enumprintprocessors(p, &q_u, &r_u);
 
 	if(!spoolss_io_r_enumprintprocessors("", &r_u, rdata, 0)) {
-		DEBUG(0,("spoolss_io_r_enumprintprocessors: unable to marshall SPOOL_R_ENUMPRINTPROCESSORS.\n"));
+		ZERODEBUG(0,("spoolss_io_r_enumprintprocessors: unable to marshall SPOOL_R_ENUMPRINTPROCESSORS.\n"));
 		return False;
 	}
 	
@@ -1155,7 +1155,7 @@
 	ZERO_STRUCT(r_u);
 	
 	if(!spoolss_io_q_addprintprocessor("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_addprintprocessor: unable to unmarshall SPOOL_Q_ADDPRINTPROCESSOR.\n"));
+		ZERODEBUG(0,("spoolss_io_q_addprintprocessor: unable to unmarshall SPOOL_Q_ADDPRINTPROCESSOR.\n"));
 		return False;
 	}
 	
@@ -1166,7 +1166,7 @@
 	r_u.status = WERR_OK;
 
 	if(!spoolss_io_r_addprintprocessor("", &r_u, rdata, 0)) {
-		DEBUG(0,("spoolss_io_r_addprintprocessor: unable to marshall SPOOL_R_ADDPRINTPROCESSOR.\n"));
+		ZERODEBUG(0,("spoolss_io_r_addprintprocessor: unable to marshall SPOOL_R_ADDPRINTPROCESSOR.\n"));
 		return False;
 	}
 	
@@ -1187,14 +1187,14 @@
 	ZERO_STRUCT(r_u);
 	
 	if(!spoolss_io_q_enumprintprocdatatypes("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_enumprintprocdatatypes: unable to unmarshall SPOOL_Q_ENUMPRINTPROCDATATYPES.\n"));
+		ZERODEBUG(0,("spoolss_io_q_enumprintprocdatatypes: unable to unmarshall SPOOL_Q_ENUMPRINTPROCDATATYPES.\n"));
 		return False;
 	}
 	
 	r_u.status = _spoolss_enumprintprocdatatypes(p, &q_u, &r_u);
 
 	if(!spoolss_io_r_enumprintprocdatatypes("", &r_u, rdata, 0)) {
-		DEBUG(0,("spoolss_io_r_enumprintprocdatatypes: unable to marshall SPOOL_R_ENUMPRINTPROCDATATYPES.\n"));
+		ZERODEBUG(0,("spoolss_io_r_enumprintprocdatatypes: unable to marshall SPOOL_R_ENUMPRINTPROCDATATYPES.\n"));
 		return False;
 	}
 	
@@ -1215,14 +1215,14 @@
 	ZERO_STRUCT(r_u);
 	
 	if (!spoolss_io_q_enumprintmonitors("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_enumprintmonitors: unable to unmarshall SPOOL_Q_ENUMPRINTMONITORS.\n"));
+		ZERODEBUG(0,("spoolss_io_q_enumprintmonitors: unable to unmarshall SPOOL_Q_ENUMPRINTMONITORS.\n"));
 		return False;
 	}
 		
 	r_u.status = _spoolss_enumprintmonitors(p, &q_u, &r_u);
 
 	if (!spoolss_io_r_enumprintmonitors("", &r_u, rdata, 0)) {
-		DEBUG(0,("spoolss_io_r_enumprintmonitors: unable to marshall SPOOL_R_ENUMPRINTMONITORS.\n"));
+		ZERODEBUG(0,("spoolss_io_r_enumprintmonitors: unable to marshall SPOOL_R_ENUMPRINTMONITORS.\n"));
 		return False;
 	}
 	
@@ -1240,14 +1240,14 @@
 	prs_struct *rdata = &p->out_data.rdata;
 	
 	if(!spoolss_io_q_getjob("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_getjob: unable to unmarshall SPOOL_Q_GETJOB.\n"));
+		ZERODEBUG(0,("spoolss_io_q_getjob: unable to unmarshall SPOOL_Q_GETJOB.\n"));
 		return False;
 	}
 
 	r_u.status = _spoolss_getjob(p, &q_u, &r_u);
 	
 	if(!spoolss_io_r_getjob("",&r_u,rdata,0)) {
-		DEBUG(0,("spoolss_io_r_getjob: unable to marshall SPOOL_R_GETJOB.\n"));
+		ZERODEBUG(0,("spoolss_io_r_getjob: unable to marshall SPOOL_R_GETJOB.\n"));
 		return False;
 	}
 		
@@ -1272,14 +1272,14 @@
 
 	/* read the stream and fill the struct */
 	if (!spoolss_io_q_getprinterdataex("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_getprinterdataex: unable to unmarshall SPOOL_Q_GETPRINTERDATAEX.\n"));
+		ZERODEBUG(0,("spoolss_io_q_getprinterdataex: unable to unmarshall SPOOL_Q_GETPRINTERDATAEX.\n"));
 		return False;
 	}
 	
 	r_u.status = _spoolss_getprinterdataex( p, &q_u, &r_u);
 
 	if (!spoolss_io_r_getprinterdataex("", &r_u, rdata, 0)) {
-		DEBUG(0,("spoolss_io_r_getprinterdataex: unable to marshall SPOOL_R_GETPRINTERDATAEX.\n"));
+		ZERODEBUG(0,("spoolss_io_r_getprinterdataex: unable to marshall SPOOL_R_GETPRINTERDATAEX.\n"));
 		return False;
 	}
 
@@ -1300,14 +1300,14 @@
 	ZERO_STRUCT(r_u);
 	
 	if(!spoolss_io_q_setprinterdataex("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_setprinterdataex: unable to unmarshall SPOOL_Q_SETPRINTERDATAEX.\n"));
+		ZERODEBUG(0,("spoolss_io_q_setprinterdataex: unable to unmarshall SPOOL_Q_SETPRINTERDATAEX.\n"));
 		return False;
 	}
 	
 	r_u.status = _spoolss_setprinterdataex(p, &q_u, &r_u);
 				
 	if(!spoolss_io_r_setprinterdataex("", &r_u, rdata, 0)) {
-		DEBUG(0,("spoolss_io_r_setprinterdataex: unable to marshall SPOOL_R_SETPRINTERDATAEX.\n"));
+		ZERODEBUG(0,("spoolss_io_r_setprinterdataex: unable to marshall SPOOL_R_SETPRINTERDATAEX.\n"));
 		return False;
 	}
 
@@ -1329,14 +1329,14 @@
 	ZERO_STRUCT(r_u);
 	
 	if(!spoolss_io_q_enumprinterkey("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_setprinterkey: unable to unmarshall SPOOL_Q_ENUMPRINTERKEY.\n"));
+		ZERODEBUG(0,("spoolss_io_q_setprinterkey: unable to unmarshall SPOOL_Q_ENUMPRINTERKEY.\n"));
 		return False;
 	}
 	
 	r_u.status = _spoolss_enumprinterkey(p, &q_u, &r_u);
 				
 	if(!spoolss_io_r_enumprinterkey("", &r_u, rdata, 0)) {
-		DEBUG(0,("spoolss_io_r_enumprinterkey: unable to marshall SPOOL_R_ENUMPRINTERKEY.\n"));
+		ZERODEBUG(0,("spoolss_io_r_enumprinterkey: unable to marshall SPOOL_R_ENUMPRINTERKEY.\n"));
 		return False;
 	}
 
@@ -1357,14 +1357,14 @@
 	ZERO_STRUCT(r_u);
 	
 	if(!spoolss_io_q_enumprinterdataex("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_enumprinterdataex: unable to unmarshall SPOOL_Q_ENUMPRINTERDATAEX.\n"));
+		ZERODEBUG(0,("spoolss_io_q_enumprinterdataex: unable to unmarshall SPOOL_Q_ENUMPRINTERDATAEX.\n"));
 		return False;
 	}
 	
 	r_u.status = _spoolss_enumprinterdataex(p, &q_u, &r_u);
 				
 	if(!spoolss_io_r_enumprinterdataex("", &r_u, rdata, 0)) {
-		DEBUG(0,("spoolss_io_r_enumprinterdataex: unable to marshall SPOOL_R_ENUMPRINTERDATAEX.\n"));
+		ZERODEBUG(0,("spoolss_io_r_enumprinterdataex: unable to marshall SPOOL_R_ENUMPRINTERDATAEX.\n"));
 		return False;
 	}
 
@@ -1385,14 +1385,14 @@
 	ZERO_STRUCT(r_u);
 	
 	if(!spoolss_io_q_getprintprocessordirectory("", &q_u, data, 0)) {
-		DEBUG(0,("spoolss_io_q_getprintprocessordirectory: unable to unmarshall SPOOL_Q_GETPRINTPROCESSORDIRECTORY.\n"));
+		ZERODEBUG(0,("spoolss_io_q_getprintprocessordirectory: unable to unmarshall SPOOL_Q_GETPRINTPROCESSORDIRECTORY.\n"));
 		return False;
 	}
 	
 	r_u.status = _spoolss_getprintprocessordirectory(p, &q_u, &r_u);
 				
 	if(!spoolss_io_r_getprintprocessordirectory("", &r_u, rdata, 0)) {
-		DEBUG(0,("spoolss_io_r_getprintprocessordirectory: unable to marshall SPOOL_R_GETPRINTPROCESSORDIRECTORY.\n"));
+		ZERODEBUG(0,("spoolss_io_r_getprintprocessordirectory: unable to marshall SPOOL_R_GETPRINTPROCESSORDIRECTORY.\n"));
 		return False;
 	}
 	
diff -Naur samba-2.2.12-orig/source/rpc_server/srv_spoolss_nt.c samba-2.2.12/source/rpc_server/srv_spoolss_nt.c
--- samba-2.2.12-orig/source/rpc_server/srv_spoolss_nt.c	2004-08-12 20:31:57.000000000 +0200
+++ samba-2.2.12/source/rpc_server/srv_spoolss_nt.c	2009-03-11 09:59:37.000000000 +0100
@@ -176,14 +176,14 @@
 
 	/* weird if the test succeds !!! */
 	if (smb_connections==0) {
-		DEBUG(0,("srv_spoolss_replycloseprinter:Trying to close non-existant notify backchannel !\n"));
+		ZERODEBUG(0,("srv_spoolss_replycloseprinter:Trying to close non-existant notify backchannel !\n"));
 		return;
 	}
 
 	result = cli_spoolss_reply_close_printer(&cli, cli.mem_ctx, handle);
 	
 	if (!W_ERROR_IS_OK(result))
-		DEBUG(0,("srv_spoolss_replycloseprinter: reply_close_printer failed [%s].\n",
+		ZERODEBUG(0,("srv_spoolss_replycloseprinter: reply_close_printer failed [%s].\n",
 			dos_errstr(result)));
 
 	/* if it's the last connection, deconnect the IPC$ share */
@@ -652,7 +652,7 @@
 	NT_PRINTER_INFO_LEVEL *printer = NULL;
 	
 	if (!msg) {
-		DEBUG(0,("send_spoolss_event_notification: NULL msg pointer!\n"));
+		ZERODEBUG(0,("send_spoolss_event_notification: NULL msg pointer!\n"));
 		return;
 	}
 	
@@ -1066,7 +1066,7 @@
 	
 	Printer=find_printer_index_by_hnd(p, handle);
 	if (!Printer) {
-		DEBUG(0,(" _spoolss_open_printer_ex: logic error. \
+		ZERODEBUG(0,(" _spoolss_open_printer_ex: logic error. \
 Can't find printer handle we created for printer %s\n", name ));
 		close_printer_handle(p,handle);
 		return WERR_INVALID_PRINTER_NAME;
@@ -5220,7 +5220,7 @@
 	result = WERR_OK;
 
 	if (level!=2) {
-		DEBUG(0,("update_printer: Send a mail to samba@samba.org\n"));
+		ZERODEBUG(0,("update_printer: Send a mail to samba@samba.org\n"));
 		DEBUGADD(0,("with the following message: update_printer: level!=2\n"));
 		result = WERR_UNKNOWN_LEVEL;
 		goto done;
@@ -5784,7 +5784,7 @@
 
 		if(ndrivers != 0) {
 			if((tdi1=(DRIVER_INFO_1 *)Realloc(driver_info_1, (*returned+ndrivers) * sizeof(DRIVER_INFO_1))) == NULL) {
-				DEBUG(0,("enumprinterdrivers_level1: failed to enlarge driver info buffer!\n"));
+				ZERODEBUG(0,("enumprinterdrivers_level1: failed to enlarge driver info buffer!\n"));
 				SAFE_FREE(driver_info_1);
 				SAFE_FREE(list);
 				return WERR_NOMEM;
@@ -5865,7 +5865,7 @@
 
 		if(ndrivers != 0) {
 			if((tdi2=(DRIVER_INFO_2 *)Realloc(driver_info_2, (*returned+ndrivers) * sizeof(DRIVER_INFO_2))) == NULL) {
-				DEBUG(0,("enumprinterdrivers_level2: failed to enlarge driver info buffer!\n"));
+				ZERODEBUG(0,("enumprinterdrivers_level2: failed to enlarge driver info buffer!\n"));
 				SAFE_FREE(driver_info_2);
 				SAFE_FREE(list);
 				return WERR_NOMEM;
@@ -5947,7 +5947,7 @@
 
 		if(ndrivers != 0) {
 			if((tdi3=(DRIVER_INFO_3 *)Realloc(driver_info_3, (*returned+ndrivers) * sizeof(DRIVER_INFO_3))) == NULL) {
-				DEBUG(0,("enumprinterdrivers_level3: failed to enlarge driver info buffer!\n"));
+				ZERODEBUG(0,("enumprinterdrivers_level3: failed to enlarge driver info buffer!\n"));
 				SAFE_FREE(driver_info_3);
 				SAFE_FREE(list);
 				return WERR_NOMEM;
@@ -6505,7 +6505,7 @@
 	WERROR err = WERR_OK;
 
 	if ((printer = (NT_PRINTER_INFO_LEVEL *)malloc(sizeof(NT_PRINTER_INFO_LEVEL))) == NULL) {
-		DEBUG(0,("spoolss_addprinterex_level_2: malloc fail.\n"));
+		ZERODEBUG(0,("spoolss_addprinterex_level_2: malloc fail.\n"));
 		return WERR_NOMEM;
 	}
 
@@ -6691,7 +6691,7 @@
 	 */
 	 
 	if (!srv_spoolss_drv_upgrade_printer(driver_name)) {
-		DEBUG(0,("_spoolss_addprinterdriver: Failed to send message about upgrading driver [%s]!\n",
+		ZERODEBUG(0,("_spoolss_addprinterdriver: Failed to send message about upgrading driver [%s]!\n",
 			driver_name));
 	}
 
@@ -6754,7 +6754,7 @@
 			break;
 
 		default:
-			DEBUG(0,("_spoolss_addprinterdriver: invalid level=%d\n", level));
+			ZERODEBUG(0,("_spoolss_addprinterdriver: invalid level=%d\n", level));
 			break;
  	}
 
@@ -8010,7 +8010,7 @@
 
 		if ((ptr=talloc_realloc(p->mem_ctx, enum_values, (num_entries+1) * sizeof(PRINTER_ENUM_VALUES))) == NULL)
 		{
-			DEBUG(0,("talloc_realloc failed to allocate more memory!\n"));
+			ZERODEBUG(0,("talloc_realloc failed to allocate more memory!\n"));
 			result = WERR_NOMEM;
 			goto done;
 		}
@@ -8027,7 +8027,7 @@
 		if ( data_len )
 		{
 			if ( !(enum_values[num_entries].data = talloc_zero(p->mem_ctx, data_len)) ) {
-				DEBUG(0,("talloc_realloc failed to allocate more memory [data_len=%d] for data!\n", data_len ));
+				ZERODEBUG(0,("talloc_realloc failed to allocate more memory [data_len=%d] for data!\n", data_len ));
 				result = WERR_NOMEM;
 				goto done;
 			}
diff -Naur samba-2.2.12-orig/source/rpc_server/srv_srvsvc.c samba-2.2.12/source/rpc_server/srv_srvsvc.c
--- samba-2.2.12-orig/source/rpc_server/srv_srvsvc.c	2004-08-12 20:24:26.000000000 +0200
+++ samba-2.2.12/source/rpc_server/srv_srvsvc.c	2009-03-11 09:59:37.000000000 +0100
@@ -178,14 +178,14 @@
 
 	/* Unmarshall the net server get enum. */
 	if(!srv_io_q_net_share_enum("", &q_u, data, 0)) {
-		DEBUG(0,("api_srv_net_share_enum_all: Failed to unmarshall SRV_Q_NET_SHARE_ENUM.\n"));
+		ZERODEBUG(0,("api_srv_net_share_enum_all: Failed to unmarshall SRV_Q_NET_SHARE_ENUM.\n"));
 		return False;
 	}
 
 	r_u.status = _srv_net_share_enum_all(p, &q_u, &r_u);
 
 	if (!srv_io_r_net_share_enum("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_srv_net_share_enum_all: Failed to marshall SRV_R_NET_SHARE_ENUM.\n"));
+		ZERODEBUG(0,("api_srv_net_share_enum_all: Failed to marshall SRV_R_NET_SHARE_ENUM.\n"));
 		return False;
 	}
 
@@ -208,14 +208,14 @@
 
 	/* Unmarshall the net server get enum. */
 	if(!srv_io_q_net_share_enum("", &q_u, data, 0)) {
-		DEBUG(0,("api_srv_net_share_enum: Failed to unmarshall SRV_Q_NET_SHARE_ENUM.\n"));
+		ZERODEBUG(0,("api_srv_net_share_enum: Failed to unmarshall SRV_Q_NET_SHARE_ENUM.\n"));
 		return False;
 	}
 
 	r_u.status = _srv_net_share_enum(p, &q_u, &r_u);
 
 	if (!srv_io_r_net_share_enum("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_srv_net_share_enum: Failed to marshall SRV_R_NET_SHARE_ENUM.\n"));
+		ZERODEBUG(0,("api_srv_net_share_enum: Failed to marshall SRV_R_NET_SHARE_ENUM.\n"));
 		return False;
 	}
 
@@ -238,14 +238,14 @@
 
 	/* Unmarshall the net server get info. */
 	if(!srv_io_q_net_share_get_info("", &q_u, data, 0)) {
-		DEBUG(0,("api_srv_net_share_get_info: Failed to unmarshall SRV_Q_NET_SHARE_GET_INFO.\n"));
+		ZERODEBUG(0,("api_srv_net_share_get_info: Failed to unmarshall SRV_Q_NET_SHARE_GET_INFO.\n"));
 		return False;
 	}
 
 	r_u.status = _srv_net_share_get_info(p, &q_u, &r_u);
 
 	if(!srv_io_r_net_share_get_info("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_srv_net_share_get_info: Failed to marshall SRV_R_NET_SHARE_GET_INFO.\n"));
+		ZERODEBUG(0,("api_srv_net_share_get_info: Failed to marshall SRV_R_NET_SHARE_GET_INFO.\n"));
 		return False;
 	}
 
@@ -268,14 +268,14 @@
 
 	/* Unmarshall the net server set info. */
 	if(!srv_io_q_net_share_set_info("", &q_u, data, 0)) {
-		DEBUG(0,("api_srv_net_share_set_info: Failed to unmarshall SRV_Q_NET_SHARE_SET_INFO.\n"));
+		ZERODEBUG(0,("api_srv_net_share_set_info: Failed to unmarshall SRV_Q_NET_SHARE_SET_INFO.\n"));
 		return False;
 	}
 
 	r_u.status = _srv_net_share_set_info(p, &q_u, &r_u);
 
 	if(!srv_io_r_net_share_set_info("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_srv_net_share_set_info: Failed to marshall SRV_R_NET_SHARE_SET_INFO.\n"));
+		ZERODEBUG(0,("api_srv_net_share_set_info: Failed to marshall SRV_R_NET_SHARE_SET_INFO.\n"));
 		return False;
 	}
 
@@ -298,14 +298,14 @@
 
 	/* Unmarshall the net server add info. */
 	if(!srv_io_q_net_share_add("", &q_u, data, 0)) {
-		DEBUG(0,("api_srv_net_share_add: Failed to unmarshall SRV_Q_NET_SHARE_ADD.\n"));
+		ZERODEBUG(0,("api_srv_net_share_add: Failed to unmarshall SRV_Q_NET_SHARE_ADD.\n"));
 		return False;
 	}
 
 	r_u.status = _srv_net_share_add(p, &q_u, &r_u);
 
 	if(!srv_io_r_net_share_add("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_srv_net_share_add: Failed to marshall SRV_R_NET_SHARE_ADD.\n"));
+		ZERODEBUG(0,("api_srv_net_share_add: Failed to marshall SRV_R_NET_SHARE_ADD.\n"));
 		return False;
 	}
 
@@ -328,14 +328,14 @@
 
 	/* Unmarshall the net server del info. */
 	if(!srv_io_q_net_share_del("", &q_u, data, 0)) {
-		DEBUG(0,("api_srv_net_share_del: Failed to unmarshall SRV_Q_NET_SHARE_DEL.\n"));
+		ZERODEBUG(0,("api_srv_net_share_del: Failed to unmarshall SRV_Q_NET_SHARE_DEL.\n"));
 		return False;
 	}
 
 	r_u.status = _srv_net_share_del(p, &q_u, &r_u);
 
 	if(!srv_io_r_net_share_del("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_srv_net_share_del: Failed to marshall SRV_R_NET_SHARE_DEL.\n"));
+		ZERODEBUG(0,("api_srv_net_share_del: Failed to marshall SRV_R_NET_SHARE_DEL.\n"));
 		return False;
 	}
 
@@ -385,14 +385,14 @@
 
 	/* Unmarshall the net server disk enum. */
 	if(!srv_io_q_net_disk_enum("", &q_u, data, 0)) {
-		DEBUG(0,("api_srv_net_disk_enum: Failed to unmarshall SRV_Q_NET_DISK_ENUM.\n"));
+		ZERODEBUG(0,("api_srv_net_disk_enum: Failed to unmarshall SRV_Q_NET_DISK_ENUM.\n"));
 		return False;
 	}
 
 	r_u.status = _srv_net_disk_enum(p, &q_u, &r_u);
 
 	if(!srv_io_r_net_disk_enum("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_srv_net_disk_enum: Failed to marshall SRV_R_NET_DISK_ENUM.\n"));
+		ZERODEBUG(0,("api_srv_net_disk_enum: Failed to marshall SRV_R_NET_DISK_ENUM.\n"));
 		return False;
 	}
 
@@ -415,14 +415,14 @@
   
 	/* Unmarshall the net server disk enum. */
 	if(!srv_io_q_net_name_validate("", &q_u, data, 0)) {
-		DEBUG(0,("api_srv_net_name_validate: Failed to unmarshall SRV_Q_NET_NAME_VALIDATE.\n"));
+		ZERODEBUG(0,("api_srv_net_name_validate: Failed to unmarshall SRV_Q_NET_NAME_VALIDATE.\n"));
 		return False;
 	}
 
 	r_u.status = _srv_net_name_validate(p, &q_u, &r_u);
 
 	if(!srv_io_r_net_name_validate("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_srv_net_name_validate: Failed to marshall SRV_R_NET_NAME_VALIDATE.\n"));
+		ZERODEBUG(0,("api_srv_net_name_validate: Failed to marshall SRV_R_NET_NAME_VALIDATE.\n"));
 		return False;
 	}
 
@@ -445,14 +445,14 @@
 
 	/* Unmarshall the net file get info from Win9x */
 	if(!srv_io_q_net_file_query_secdesc("", &q_u, data, 0)) {
-		DEBUG(0,("api_srv_net_file_query_secdesc: Failed to unmarshall SRV_Q_NET_FILE_QUERY_SECDESC.\n"));
+		ZERODEBUG(0,("api_srv_net_file_query_secdesc: Failed to unmarshall SRV_Q_NET_FILE_QUERY_SECDESC.\n"));
 		return False;
 	}
 
 	r_u.status = _srv_net_file_query_secdesc(p, &q_u, &r_u);
 
 	if(!srv_io_r_net_file_query_secdesc("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_srv_net_file_query_secdesc: Failed to marshall SRV_R_NET_FILE_QUERY_SECDESC.\n"));
+		ZERODEBUG(0,("api_srv_net_file_query_secdesc: Failed to marshall SRV_R_NET_FILE_QUERY_SECDESC.\n"));
 		return False;
 	}
 
@@ -475,14 +475,14 @@
 
 	/* Unmarshall the net file set info from Win9x */
 	if(!srv_io_q_net_file_set_secdesc("", &q_u, data, 0)) {
-		DEBUG(0,("api_srv_net_file_set_secdesc: Failed to unmarshall SRV_Q_NET_FILE_SET_SECDESC.\n"));
+		ZERODEBUG(0,("api_srv_net_file_set_secdesc: Failed to unmarshall SRV_Q_NET_FILE_SET_SECDESC.\n"));
 		return False;
 	}
 
 	r_u.status = _srv_net_file_set_secdesc(p, &q_u, &r_u);
 
 	if(!srv_io_r_net_file_set_secdesc("", &r_u, rdata, 0)) {
-		DEBUG(0,("api_srv_net_file_set_secdesc: Failed to marshall SRV_R_NET_FILE_SET_SECDESC.\n"));
+		ZERODEBUG(0,("api_srv_net_file_set_secdesc: Failed to marshall SRV_R_NET_FILE_SET_SECDESC.\n"));
 		return False;
 	}
 
diff -Naur samba-2.2.12-orig/source/rpc_server/srv_srvsvc_nt.c samba-2.2.12/source/rpc_server/srv_srvsvc_nt.c
--- samba-2.2.12-orig/source/rpc_server/srv_srvsvc_nt.c	2004-08-12 20:24:26.000000000 +0200
+++ samba-2.2.12/source/rpc_server/srv_srvsvc_nt.c	2009-03-11 09:59:37.000000000 +0100
@@ -129,7 +129,7 @@
 		return True;
 	share_tdb = tdb_open_log(lock_path("share_info.tdb"), 0, TDB_DEFAULT, O_RDWR|O_CREAT, 0600);
 	if (!share_tdb) {
-		DEBUG(0,("Failed to open share info database %s (%s)\n",
+		ZERODEBUG(0,("Failed to open share info database %s (%s)\n",
 			lock_path("share_info.tdb"), strerror(errno) ));
 		return False;
 	}
@@ -182,7 +182,7 @@
 	}
 
 	if (!psd) {
-		DEBUG(0,("get_share_security: Failed to make SEC_DESC.\n"));
+		ZERODEBUG(0,("get_share_security: Failed to make SEC_DESC.\n"));
 		return NULL;
 	}
 
@@ -273,7 +273,7 @@
 	kbuf.dsize = strlen(key)+1;
 
 	if (tdb_delete(share_tdb, kbuf) != 0) {
-		DEBUG(0,("delete_share_security: Failed to delete entry for share %s\n",
+		ZERODEBUG(0,("delete_share_security: Failed to delete entry for share %s\n",
 				lp_servicename(snum) ));
 		return False;
 	}
@@ -1388,7 +1388,7 @@
 
 		DEBUG(10,("_srv_net_share_set_info: Running [%s]\n", command ));
 		if ((ret = smbrun(command, NULL)) != 0) {
-			DEBUG(0,("_srv_net_share_set_info: Running [%s] returned (%d)\n", command, ret ));
+			ZERODEBUG(0,("_srv_net_share_set_info: Running [%s] returned (%d)\n", command, ret ));
 			return WERR_ACCESS_DENIED;
 		}
 
@@ -1408,7 +1408,7 @@
 
 		if (old_sd && !sec_desc_equal(old_sd, psd)) {
 			if (!set_share_security(p->mem_ctx, share_name, psd))
-				DEBUG(0,("_srv_net_share_set_info: Failed to change security info in share %s.\n",
+				ZERODEBUG(0,("_srv_net_share_set_info: Failed to change security info in share %s.\n",
 					share_name ));
 		}
 	}
@@ -1504,13 +1504,13 @@
 
 	DEBUG(10,("_srv_net_share_add: Running [%s]\n", command ));
 	if ((ret = smbrun(command, NULL)) != 0) {
-		DEBUG(0,("_srv_net_share_add: Running [%s] returned (%d)\n", command, ret ));
+		ZERODEBUG(0,("_srv_net_share_add: Running [%s] returned (%d)\n", command, ret ));
 		return WERR_ACCESS_DENIED;
 	}
 
 	if (psd) {
 		if (!set_share_security(p->mem_ctx, share_name, psd))
-			DEBUG(0,("_srv_net_share_add: Failed to add security info to share %s.\n",
+			ZERODEBUG(0,("_srv_net_share_add: Failed to add security info to share %s.\n",
 				share_name ));
 	}
 
@@ -1570,7 +1570,7 @@
 
 	DEBUG(10,("_srv_net_share_del: Running [%s]\n", command ));
 	if ((ret = smbrun(command, NULL)) != 0) {
-		DEBUG(0,("_srv_net_share_del: Running [%s] returned (%d)\n", command, ret ));
+		ZERODEBUG(0,("_srv_net_share_del: Running [%s] returned (%d)\n", command, ret ));
 		return WERR_ACCESS_DENIED;
 	}
 
@@ -1677,7 +1677,7 @@
 	}
 
 	if (!become_user(conn, conn->vuid)) {
-		DEBUG(0,("_srv_net_file_query_secdesc: Can't become connected user!\n"));
+		ZERODEBUG(0,("_srv_net_file_query_secdesc: Can't become connected user!\n"));
 		r_u->status = WERR_ACCESS_DENIED;
 		goto error_exit;
 	}
@@ -1784,7 +1784,7 @@
 	}
 
 	if (!become_user(conn, conn->vuid)) {
-		DEBUG(0,("_srv_net_file_set_secdesc: Can't become connected user!\n"));
+		ZERODEBUG(0,("_srv_net_file_set_secdesc: Can't become connected user!\n"));
 		r_u->status = WERR_ACCESS_DENIED;
 		goto error_exit;
 	}
diff -Naur samba-2.2.12-orig/source/rpc_server/srv_util.c samba-2.2.12/source/rpc_server/srv_util.c
--- samba-2.2.12-orig/source/rpc_server/srv_util.c	2004-08-12 20:24:26.000000000 +0200
+++ samba-2.2.12/source/rpc_server/srv_util.c	2009-03-11 09:59:37.000000000 +0100
@@ -100,7 +100,7 @@
   gids = (DOM_GID *)talloc(ctx, sizeof(DOM_GID) * count );
   if(!gids)
   {
-    DEBUG(0,("make_dom_gids: talloc fail !\n"));
+    ZERODEBUG(0,("make_dom_gids: talloc fail !\n"));
     return 0;
   }
 
diff -Naur samba-2.2.12-orig/source/smbd/blocking.c samba-2.2.12/source/smbd/blocking.c
--- samba-2.2.12-orig/source/smbd/blocking.c	2004-08-12 20:24:20.000000000 +0200
+++ samba-2.2.12/source/smbd/blocking.c	2009-03-11 09:59:37.000000000 +0100
@@ -65,7 +65,7 @@
   case SMBlockingX:
     return file_fsp(inbuf,smb_vwv2);
   default:
-    DEBUG(0,("get_fsp_from_pkt: PANIC - unknown type on blocking lock queue - exiting.!\n"));
+    ZERODEBUG(0,("get_fsp_from_pkt: PANIC - unknown type on blocking lock queue - exiting.!\n"));
     exit_server("PANIC - unknown type on blocking lock queue");
   }
   return NULL; /* Keep compiler happy. */
@@ -94,7 +94,7 @@
   NTSTATUS status;
 
   if(in_chained_smb() ) {
-    DEBUG(0,("push_blocking_lock_request: cannot queue a chained request (currently).\n"));
+    ZERODEBUG(0,("push_blocking_lock_request: cannot queue a chained request (currently).\n"));
     return False;
   }
 
@@ -104,12 +104,12 @@
    */
 
   if((blr = (blocking_lock_record *)malloc(sizeof(blocking_lock_record))) == NULL) {
-    DEBUG(0,("push_blocking_lock_request: Malloc fail !\n" ));
+    ZERODEBUG(0,("push_blocking_lock_request: Malloc fail !\n" ));
     return False;
   }
 
   if((blr->inbuf = (char *)malloc(length)) == NULL) {
-    DEBUG(0,("push_blocking_lock_request: Malloc fail (2)!\n" ));
+    ZERODEBUG(0,("push_blocking_lock_request: Malloc fail (2)!\n" ));
     SAFE_FREE(blr);
     return False;
   }
@@ -131,7 +131,7 @@
 		PENDING_LOCK);
 
   if (!NT_STATUS_IS_OK(status)) {
-	DEBUG(0,("push_blocking_lock_request: failed to add PENDING_LOCK record.\n"));
+	ZERODEBUG(0,("push_blocking_lock_request: failed to add PENDING_LOCK record.\n"));
 	free_blocking_lock_record(blr);
 	return False;
   }
@@ -278,7 +278,7 @@
 		reply_lockingX_error(blr, status);
 		break;
 	default:
-		DEBUG(0,("blocking_lock_reply_error: PANIC - unknown type on blocking lock queue - exiting.!\n"));
+		ZERODEBUG(0,("blocking_lock_reply_error: PANIC - unknown type on blocking lock queue - exiting.!\n"));
 		exit_server("PANIC - unknown type on blocking lock queue");
 	}
 }
@@ -500,7 +500,7 @@
   case SMBlockingX:
     return process_lockingX(blr);
   default:
-    DEBUG(0,("blocking_lock_record_process: PANIC - unknown type on blocking lock queue - exiting.!\n"));
+    ZERODEBUG(0,("blocking_lock_record_process: PANIC - unknown type on blocking lock queue - exiting.!\n"));
     exit_server("PANIC - unknown type on blocking lock queue");
   }
   return False; /* Keep compiler happy. */
@@ -660,7 +660,7 @@
     }
 
     if(!change_to_user(conn,vuid)) {
-      DEBUG(0,("process_blocking_lock_queue: Unable to become user vuid=%d.\n",
+      ZERODEBUG(0,("process_blocking_lock_queue: Unable to become user vuid=%d.\n",
             vuid ));
       /*
        * Remove the entry and return an error to the client.
@@ -677,7 +677,7 @@
     }
 
     if(!set_current_service(conn,True)) {
-      DEBUG(0,("process_blocking_lock_queue: Unable to become service Error was %s.\n", strerror(errno) ));
+      ZERODEBUG(0,("process_blocking_lock_queue: Unable to become service Error was %s.\n", strerror(errno) ));
       /*
        * Remove the entry and return an error to the client.
        */
diff -Naur samba-2.2.12-orig/source/smbd/chgpasswd.c samba-2.2.12/source/smbd/chgpasswd.c
--- samba-2.2.12-orig/source/smbd/chgpasswd.c	2004-08-12 20:24:20.000000000 +0200
+++ samba-2.2.12/source/smbd/chgpasswd.c	2009-03-11 09:59:37.000000000 +0100
@@ -69,7 +69,7 @@
 		*slave = (char *)ptsname(master);
 		if (*slave == NULL)
 		{
-			DEBUG(0,
+			ZERODEBUG(0,
 			      ("findpty: Unable to create master/slave pty pair.\n"));
 			/* Stop fd leak on error. */
 			close(master);
@@ -123,7 +123,7 @@
 
 	if (pass == NULL)
 	{
-		DEBUG(0,
+		ZERODEBUG(0,
 		      ("dochild: user name %s doesn't exist in the UNIX password database.\n",
 		       name));
 		return False;
@@ -439,7 +439,7 @@
 		 * The child should never return from dochild() ....
 		 */
 
-		DEBUG(0,
+		ZERODEBUG(0,
 		      ("chat_with_program: Error: dochild() returned %d\n",
 		       chstat));
 		exit(1);
@@ -471,7 +471,7 @@
 	/* Minimum password length */
 	if (strlen(newpass) < lp_min_passwd_length()) {
 		/* too short, must be at least MINPASSWDLENGTH */
-		DEBUG(0, ("Password Change: user %s, New password is shorter than minimum password length = %d\n",
+		ZERODEBUG(0, ("Password Change: user %s, New password is shorter than minimum password length = %d\n",
 		       name, lp_min_passwd_length()));
 		return (False);	/* inform the user */
 	}
@@ -491,7 +491,7 @@
 	len = strlen(oldpass);
 	for (i = 0; i < len; i++) {
 		if (iscntrl((int)oldpass[i])) {
-			DEBUG(0,
+			ZERODEBUG(0,
 			      ("chat_with_program: oldpass contains control characters (disallowed).\n"));
 			return False;
 		}
@@ -500,7 +500,7 @@
 	len = strlen(newpass);
 	for (i = 0; i < len; i++) {
 		if (iscntrl((int)newpass[i])) {
-			DEBUG(0,
+			ZERODEBUG(0,
 			      ("chat_with_program: newpass contains control characters (disallowed).\n"));
 			return False;
 		}
@@ -538,7 +538,7 @@
 	if (as_root) {
 		/* The password program *must* contain the user name to work. Fail if not. */
 		if (strstr(passwordprogram, "%u") == NULL) {
-			DEBUG(0,("chgpasswd: Running as root the 'passwd program' parameter *MUST* contain \
+			ZERODEBUG(0,("chgpasswd: Running as root the 'passwd program' parameter *MUST* contain \
 the string %%u, and the given string %s does not.\n", passwordprogram ));
 			return False;
 		}
@@ -560,7 +560,7 @@
 
 BOOL chgpasswd(char *name, const char *oldpass, const char *newpass, BOOL as_root)
 {
-	DEBUG(0, ("Password changing not compiled in (user=%s)\n", name));
+	ZERODEBUG(0, ("Password changing not compiled in (user=%s)\n", name));
 	return (False);
 }
 #endif /* ALLOW_CHANGE_PASSWORD */
@@ -585,7 +585,7 @@
 	unbecome_root();
 
 	if (ret == False) {
-		DEBUG(0,("check_lanman_password: getsampwnam returned NULL\n"));
+		ZERODEBUG(0,("check_lanman_password: getsampwnam returned NULL\n"));
 		pdb_free_sam(sampass);
 		return False;
 	}
@@ -594,7 +594,7 @@
 	lanman_pw = pdb_get_lanman_passwd (sampass);
 
 	if (acct_ctrl & ACB_DISABLED) {
-		DEBUG(0,("check_lanman_password: account %s disabled.\n", user));
+		ZERODEBUG(0,("check_lanman_password: account %s disabled.\n", user));
 		pdb_free_sam(sampass);
 		return False;
 	}
@@ -609,7 +609,7 @@
 		}
 	}
 	else if (lanman_pw == NULL) {
-		DEBUG(0, ("check_lanman_password: no lanman password !\n"));
+		ZERODEBUG(0, ("check_lanman_password: no lanman password !\n"));
 		pdb_free_sam(sampass);
 		return False;
 	}
@@ -622,7 +622,7 @@
 
 	/* Check that the two old passwords match. */
 	if (memcmp(lanman_pw, unenc_old_pw, 16)) {
-		DEBUG(0,("check_lanman_password: old password doesn't match.\n"));
+		ZERODEBUG(0,("check_lanman_password: old password doesn't match.\n"));
 		pdb_free_sam(sampass);
 		return False;
 	}
@@ -649,7 +649,7 @@
 	uint8 *pwd;
 
 	if (sampass == NULL) {
-		DEBUG(0,("change_lanman_password: no smb password entry.\n"));
+		ZERODEBUG(0,("change_lanman_password: no smb password entry.\n"));
 		return False;
 	}
 	
@@ -657,7 +657,7 @@
 	pwd = pdb_get_lanman_passwd(sampass);
 
 	if (acct_ctrl & ACB_DISABLED) {
-		DEBUG(0,("change_lanman_password: account %s disabled.\n",
+		ZERODEBUG(0,("change_lanman_password: account %s disabled.\n",
 		       pdb_get_username(sampass)));
 		return False;
 	}
@@ -670,7 +670,7 @@
 			return False;
 	}
 	else if (pwd == NULL) {
-		DEBUG(0,("change_lanman_password: no lanman password !\n"));
+		ZERODEBUG(0,("change_lanman_password: no lanman password !\n"));
 		return False;
 	}
 
@@ -761,7 +761,7 @@
 	unbecome_root();
 
 	if (ret == False) {
-		DEBUG(0, ("check_oem_password: getsmbpwnam returned NULL\n"));
+		ZERODEBUG(0, ("check_oem_password: getsmbpwnam returned NULL\n"));
 		pdb_free_sam(sampass);
 		return False;
 	}
@@ -769,7 +769,7 @@
 	acct_ctrl = pdb_get_acct_ctrl(sampass);
 	
 	if (acct_ctrl & ACB_DISABLED) {
-		DEBUG(0,("check_lanman_password: account %s disabled.\n", user));
+		ZERODEBUG(0,("check_lanman_password: account %s disabled.\n", user));
 		pdb_free_sam(sampass);
 		return False;
 	}
@@ -796,7 +796,7 @@
 				return False;
 			}
 		} else {
-			DEBUG(0,("check_oem_password: no lanman password !\n"));
+			ZERODEBUG(0,("check_oem_password: no lanman password !\n"));
 			pdb_free_sam(sampass);
 			return False;
 		}
@@ -811,7 +811,7 @@
 				return False;
 			}
 		} else {
-			DEBUG(0,("check_oem_password: no ntlm password !\n"));
+			ZERODEBUG(0,("check_oem_password: no ntlm password !\n"));
 			pdb_free_sam(sampass);
 			return False;
 		}
@@ -829,7 +829,7 @@
 
 	new_pw_len = IVAL(lmdata, 512);
 	if (new_pw_len < 0 || new_pw_len > new_passwd_size - 1) {
-		DEBUG(0,("check_oem_password: incorrect password length (%d).\n", new_pw_len));
+		ZERODEBUG(0,("check_oem_password: incorrect password length (%d).\n", new_pw_len));
 		pdb_free_sam(sampass);
 		return False;
 	}
@@ -863,7 +863,7 @@
 		D_P16(new_p16, lmhash, unenc_old_pw);
 
 		if (memcmp(lanman_pw, unenc_old_pw, 16)) {
-			DEBUG(0,("check_oem_password: old lm password doesn't match.\n"));
+			ZERODEBUG(0,("check_oem_password: old lm password doesn't match.\n"));
 			pdb_free_sam(sampass);
 			return False;
 		}
@@ -884,13 +884,13 @@
 	D_P16(new_ntp16, nthash, unenc_old_ntpw);
 
 	if (memcmp(lanman_pw, unenc_old_pw, 16)) {
-		DEBUG(0,("check_oem_password: old lm password doesn't match.\n"));
+		ZERODEBUG(0,("check_oem_password: old lm password doesn't match.\n"));
 		pdb_free_sam(sampass);
 		return False;
 	}
 
 	if (memcmp(nt_pw, unenc_old_ntpw, 16)) {
-		DEBUG(0,("check_oem_password: old nt password doesn't match.\n"));
+		ZERODEBUG(0,("check_oem_password: old nt password doesn't match.\n"));
 		pdb_free_sam(sampass);
 		return False;
 	}
@@ -952,13 +952,13 @@
 	unbecome_root();
 
 	if (ret == False) {
-		DEBUG(0,("check_plaintext_password: getsmbpwnam returned NULL\n"));
+		ZERODEBUG(0,("check_plaintext_password: getsmbpwnam returned NULL\n"));
 		pdb_free_sam(sampass);
 		return False;
 	}
 
 	if (pdb_get_acct_ctrl(sampass) & ACB_DISABLED) {
-		DEBUG(0,("check_plaintext_password: account %s disabled.\n", user));
+		ZERODEBUG(0,("check_plaintext_password: account %s disabled.\n", user));
 		pdb_free_sam(sampass);
 		return (False);
 	}
diff -Naur samba-2.2.12-orig/source/smbd/close.c samba-2.2.12/source/smbd/close.c
--- samba-2.2.12-orig/source/smbd/close.c	2004-08-12 20:24:20.000000000 +0200
+++ samba-2.2.12/source/smbd/close.c	2009-03-11 09:59:38.000000000 +0100
@@ -159,7 +159,7 @@
 
 		NTSTATUS status =set_delete_on_close_over_all(fsp, fsp->delete_on_close);
 		if (NT_STATUS_V(status) !=  NT_STATUS_V(NT_STATUS_OK))
-			DEBUG(0,("close_normal_file: failed to change delete on close flag for file %s\n",
+			ZERODEBUG(0,("close_normal_file: failed to change delete on close flag for file %s\n",
 				fsp->fsp_name ));
 	}
 
diff -Naur samba-2.2.12-orig/source/smbd/connection.c samba-2.2.12/source/smbd/connection.c
--- samba-2.2.12-orig/source/smbd/connection.c	2004-08-12 20:24:21.000000000 +0200
+++ samba-2.2.12/source/smbd/connection.c	2009-03-11 09:59:38.000000000 +0100
@@ -96,7 +96,7 @@
 		DEBUG(2,("pid %u doesn't exist - deleting connections %d [%s]\n",
 			(unsigned int)crec.pid, crec.cnum, crec.name));
 		if (tdb_delete(the_tdb, kbuf) != 0)
-			DEBUG(0,("count_fn: tdb_delete failed with error %s\n", tdb_errorstr(tdb) ));
+			ZERODEBUG(0,("count_fn: tdb_delete failed with error %s\n", tdb_errorstr(tdb) ));
 		return 0;
 	}
 
@@ -141,7 +141,7 @@
 		 */
 
 		if (tdb_traverse(tdb, count_fn, &cs) == -1) {
-			DEBUG(0,("claim_connection: traverse of connections.tdb failed with error %s.\n",
+			ZERODEBUG(0,("claim_connection: traverse of connections.tdb failed with error %s.\n",
 				tdb_errorstr(tdb) ));
 			return False;
 		}
@@ -184,7 +184,7 @@
 	dbuf.dsize = sizeof(crec);
 
 	if (tdb_store(tdb, kbuf, dbuf, TDB_REPLACE) != 0) {
-		DEBUG(0,("claim_connection: tdb_store failed with error %s.\n",
+		ZERODEBUG(0,("claim_connection: tdb_store failed with error %s.\n",
 			tdb_errorstr(tdb) ));
 		return False;
 	}
diff -Naur samba-2.2.12-orig/source/smbd/dfree.c samba-2.2.12/source/smbd/dfree.c
--- samba-2.2.12-orig/source/smbd/dfree.c	2004-08-12 20:24:21.000000000 +0200
+++ samba-2.2.12/source/smbd/dfree.c	2009-03-11 10:04:14.000000000 +0100
@@ -115,7 +115,7 @@
 			if (!*dfree)
 				*dfree = 1024;
 		} else {
-			DEBUG (0, ("disk_free: sys_popen() failed for command %s. Error was : %s\n",
+			ZERODEBUG (0, ("disk_free: sys_popen() failed for command %s. Error was : %s\n",
 				syscmd, strerror(errno) ));
 			sys_fsusage(path, dfree, dsize);
 		}
@@ -137,7 +137,7 @@
 	if ((*dsize)<1) {
 		static int done;
 		if (!done) {
-			DEBUG(0,("WARNING: dfree is broken on this system\n"));
+			ZERODEBUG(0,("WARNING: dfree is broken on this system\n"));
 			done=1;
 		}
 		*dsize = 20*1024*1024/(*bsize);
diff -Naur samba-2.2.12-orig/source/smbd/dir.c samba-2.2.12/source/smbd/dir.c
--- samba-2.2.12-orig/source/smbd/dir.c	2004-08-12 20:24:21.000000000 +0200
+++ samba-2.2.12/source/smbd/dir.c	2009-03-11 09:59:38.000000000 +0100
@@ -92,7 +92,7 @@
     ;
 
   if(!dptr) {
-    DEBUG(0,("No dptrs available to idle ?\n"));
+    ZERODEBUG(0,("No dptrs available to idle ?\n"));
     return;
   }
 
@@ -232,7 +232,7 @@
    */
 
   if(bitmap_query( dptr_bmap, dptr->dnum - 1) != True) {
-    DEBUG(0,("dptr_close_internal : Error - closing dnum = %d and bitmap not set !\n",
+    ZERODEBUG(0,("dptr_close_internal : Error - closing dnum = %d and bitmap not set !\n",
 			dptr->dnum ));
   }
 
@@ -274,7 +274,7 @@
   dptr = dptr_get(*key, True);
 
   if (!dptr) {
-    DEBUG(0,("Invalid key %d given to dptr_close\n", *key));
+    ZERODEBUG(0,("Invalid key %d given to dptr_close\n", *key));
     return;
   }
 
@@ -369,7 +369,7 @@
     ;
 
   if(!dptr) {
-    DEBUG(0,("No old dptrs available to close oldest ?\n"));
+    ZERODEBUG(0,("No old dptrs available to close oldest ?\n"));
     return;
   }
 
@@ -409,7 +409,7 @@
 
   dptr = (dptr_struct *)malloc(sizeof(dptr_struct));
   if(!dptr) {
-    DEBUG(0,("malloc fail in dptr_create.\n"));
+    ZERODEBUG(0,("malloc fail in dptr_create.\n"));
     return -1;
   }
 
@@ -438,7 +438,7 @@
       dptr->dnum = bitmap_find(dptr_bmap, 0);
 
       if(dptr->dnum == -1 || dptr->dnum > 254) {
-        DEBUG(0,("dptr_create: returned %d: Error - all old dirptrs in use ?\n", dptr->dnum));
+        ZERODEBUG(0,("dptr_create: returned %d: Error - all old dirptrs in use ?\n", dptr->dnum));
         SAFE_FREE(dptr);
         return -1;
       }
@@ -467,7 +467,7 @@
       dptr->dnum = bitmap_find(dptr_bmap, 255);
 
       if(dptr->dnum == -1 || dptr->dnum < 255) {
-        DEBUG(0,("dptr_create: returned %d: Error - all new dirptrs in use ?\n", dptr->dnum));
+        ZERODEBUG(0,("dptr_create: returned %d: Error - all new dirptrs in use ?\n", dptr->dnum));
         SAFE_FREE(dptr);
         return -1;
       }
@@ -754,7 +754,7 @@
 		return(NULL);
 	dirp = (Dir *)malloc(sizeof(Dir));
 	if (!dirp) {
-		DEBUG(0,("Out of memory in OpenDir\n"));
+		ZERODEBUG(0,("Out of memory in OpenDir\n"));
 		conn->vfs_ops.closedir(conn,p);
 		return(NULL);
 	}
@@ -808,7 +808,7 @@
 			char *r;
 			r = (char *)Realloc(dirp->data,s);
 			if (!r) {
-				DEBUG(0,("Out of memory in OpenDir\n"));
+				ZERODEBUG(0,("Out of memory in OpenDir\n"));
 				break;
 											}
 			dirp->data = r;
diff -Naur samba-2.2.12-orig/source/smbd/fileio.c samba-2.2.12/source/smbd/fileio.c
--- samba-2.2.12-orig/source/smbd/fileio.c	2004-08-12 20:24:21.000000000 +0200
+++ samba-2.2.12/source/smbd/fileio.c	2009-03-11 09:59:38.000000000 +0100
@@ -39,7 +39,7 @@
 	seek_ret = fsp->conn->vfs_ops.lseek(fsp,fsp->fd,pos+offset,SEEK_SET);
 
 	if(seek_ret == -1) {
-		DEBUG(0,("seek_file: (%s) sys_lseek failed. Error was %s\n",
+		ZERODEBUG(0,("seek_file: (%s) sys_lseek failed. Error was %s\n",
 			fsp->fsp_name, strerror(errno) ));
 		fsp->pos = -1;
 		return -1;
@@ -661,7 +661,7 @@
 		return False;
 
 	if((wcp = (write_cache *)malloc(sizeof(write_cache))) == NULL) {
-		DEBUG(0,("setup_write_cache: malloc fail.\n"));
+		ZERODEBUG(0,("setup_write_cache: malloc fail.\n"));
 		return False;
 	}
 
@@ -670,7 +670,7 @@
 	wcp->alloc_size = alloc_size;
 	wcp->data_size = 0;
 	if((wcp->data = malloc(wcp->alloc_size)) == NULL) {
-		DEBUG(0,("setup_write_cache: malloc fail for buffer size %u.\n",
+		ZERODEBUG(0,("setup_write_cache: malloc fail for buffer size %u.\n",
 			(unsigned int)wcp->alloc_size ));
 		SAFE_FREE(wcp);
 		return False;
diff -Naur samba-2.2.12-orig/source/smbd/files.c samba-2.2.12/source/smbd/files.c
--- samba-2.2.12-orig/source/smbd/files.c	2004-08-12 20:24:21.000000000 +0200
+++ samba-2.2.12/source/smbd/files.c	2009-03-11 09:59:38.000000000 +0100
@@ -88,7 +88,7 @@
 			}
 		}
 
-		DEBUG(0,("ERROR! Out of file structures\n"));
+		ZERODEBUG(0,("ERROR! Out of file structures\n"));
 		unix_ERR_class = ERRSRV;
 		unix_ERR_code = ERRnofids;
 		return NULL;
diff -Naur samba-2.2.12-orig/source/smbd/groupname.c samba-2.2.12/source/smbd/groupname.c
--- samba-2.2.12-orig/source/smbd/groupname.c	2004-08-12 20:24:21.000000000 +0200
+++ samba-2.2.12/source/smbd/groupname.c	2009-03-11 09:59:38.000000000 +0100
@@ -81,7 +81,7 @@
     return;
 
   if(sys_stat(groupname_map_file, &st) != 0) {
-    DEBUG(0, ("load_groupname_map: Unable to stat file %s. Error was %s\n",
+    ZERODEBUG(0, ("load_groupname_map: Unable to stat file %s. Error was %s\n",
                groupname_map_file, strerror(errno) ));
     return;
   }
@@ -100,7 +100,7 @@
 
   lines = file_lines_load(groupname_map_file,NULL,False);
   if (!lines) {
-    DEBUG(0,("load_groupname_map: can't open groupname map %s. Error was %s\n",
+    ZERODEBUG(0,("load_groupname_map: can't open groupname map %s. Error was %s\n",
           groupname_map_file, strerror(errno)));
     return;
   }
@@ -148,7 +148,7 @@
      */
 
 	if ((gid = nametogid(unixname)) == (gid_t)-1)
-      DEBUG(0,("load_groupname_map: nametogid for group %s failed.\
+      ZERODEBUG(0,("load_groupname_map: nametogid for group %s failed.\
 Error was %s.\n", unixname, strerror(errno) ));
       continue;
     }
@@ -172,7 +172,7 @@
      */
 
     if((new_ep = (groupname_map_entry *)malloc( sizeof(groupname_map_entry) ))== NULL) {
-      DEBUG(0,("load_groupname_map: malloc fail for groupname_map_entry.\n"));
+      ZERODEBUG(0,("load_groupname_map: malloc fail for groupname_map_entry.\n"));
       fclose(fp);
       return;
     } 
@@ -183,7 +183,7 @@
     new_ep->unix_name = strdup( unixname );
 
     if(new_ep->windows_name == NULL || new_ep->unix_name == NULL) {
-      DEBUG(0,("load_groupname_map: malloc fail for names in groupname_map_entry.\n"));
+      ZERODEBUG(0,("load_groupname_map: malloc fail for names in groupname_map_entry.\n"));
       fclose(fp);
       SAFE_FREE(new_ep->windows_name);
       SAFE_FREE(new_ep->unix_name);
diff -Naur samba-2.2.12-orig/source/smbd/ipc.c samba-2.2.12/source/smbd/ipc.c
--- samba-2.2.12-orig/source/smbd/ipc.c	2004-08-12 20:24:20.000000000 +0200
+++ samba-2.2.12/source/smbd/ipc.c	2009-03-11 09:59:38.000000000 +0100
@@ -178,7 +178,7 @@
 	int data_len;
 
 	if(rdata == NULL) {
-		DEBUG(0,("api_rpc_trans_reply: malloc fail.\n"));
+		ZERODEBUG(0,("api_rpc_trans_reply: malloc fail.\n"));
 		return False;
 	}
 
@@ -276,7 +276,7 @@
 
 	/* First find out the name of this file. */
 	if (suwcnt != 2) {
-		DEBUG(0,("Unexpected named pipe transaction.\n"));
+		ZERODEBUG(0,("Unexpected named pipe transaction.\n"));
 		return(-1);
 	}
 
@@ -390,7 +390,7 @@
   
 	if (tdscnt)  {
 		if((data = (char *)malloc(tdscnt)) == NULL) {
-			DEBUG(0,("reply_trans: data malloc fail for %u bytes !\n", tdscnt));
+			ZERODEBUG(0,("reply_trans: data malloc fail for %u bytes !\n", tdscnt));
 			END_PROFILE(SMBtrans);
 			return(ERROR_DOS(ERRDOS,ERRnomem));
 		} 
@@ -404,7 +404,7 @@
 
 	if (tpscnt) {
 		if((params = (char *)malloc(tpscnt)) == NULL) {
-			DEBUG(0,("reply_trans: param malloc fail for %u bytes !\n", tpscnt));
+			ZERODEBUG(0,("reply_trans: param malloc fail for %u bytes !\n", tpscnt));
 			SAFE_FREE(data);
 			END_PROFILE(SMBtrans);
 			return(ERROR_DOS(ERRDOS,ERRnomem));
@@ -420,7 +420,7 @@
 	if (suwcnt) {
 		int i;
 		if((setup = (uint16 *)malloc(suwcnt*sizeof(uint16))) == NULL) {
-			DEBUG(0,("reply_trans: setup malloc fail for %u bytes !\n", (unsigned int)(suwcnt * sizeof(uint16))));
+			ZERODEBUG(0,("reply_trans: setup malloc fail for %u bytes !\n", (unsigned int)(suwcnt * sizeof(uint16))));
 			SAFE_FREE(data);
 			SAFE_FREE(params);
 			END_PROFILE(SMBtrans);
@@ -454,9 +454,9 @@
 
 		if ((ret && (CVAL(inbuf, smb_com) != SMBtranss)) || !ret) {
 			if(ret) {
-				DEBUG(0,("reply_trans: Invalid secondary trans packet\n"));
+				ZERODEBUG(0,("reply_trans: Invalid secondary trans packet\n"));
 			} else {
-				DEBUG(0,("reply_trans: %s in getting secondary trans response.\n",
+				ZERODEBUG(0,("reply_trans: %s in getting secondary trans response.\n",
 					 (smb_read_error == READ_ERROR) ? "error" : "timeout" ));
 			}
 			SAFE_FREE(params);
@@ -569,7 +569,7 @@
 
   bad_param:
 
-	DEBUG(0,("reply_trans: invalid trans parameters\n"));
+	ZERODEBUG(0,("reply_trans: invalid trans parameters\n"));
 	SAFE_FREE(data);
 	SAFE_FREE(params);
 	SAFE_FREE(setup);
diff -Naur samba-2.2.12-orig/source/smbd/lanman.c samba-2.2.12/source/smbd/lanman.c
--- samba-2.2.12-orig/source/smbd/lanman.c	2004-08-12 20:24:21.000000000 +0200
+++ samba-2.2.12/source/smbd/lanman.c	2009-03-11 09:59:38.000000000 +0100
@@ -1010,17 +1010,17 @@
       queuecnt++;
   if (uLevel > 0) {
     if((queue = (print_queue_struct**)malloc(queuecnt*sizeof(print_queue_struct*))) == NULL) {
-      DEBUG(0,("api_DosPrintQEnum: malloc fail !\n"));
+      ZERODEBUG(0,("api_DosPrintQEnum: malloc fail !\n"));
       return False;
     }
     memset(queue,0,queuecnt*sizeof(print_queue_struct*));
     if((status = (print_status_struct*)malloc(queuecnt*sizeof(print_status_struct))) == NULL) {
-      DEBUG(0,("api_DosPrintQEnum: malloc fail !\n"));
+      ZERODEBUG(0,("api_DosPrintQEnum: malloc fail !\n"));
       return False;
     }
     memset(status,0,queuecnt*sizeof(print_status_struct));
     if((subcntarr = (int*)malloc(queuecnt*sizeof(int))) == NULL) {
-      DEBUG(0,("api_DosPrintQEnum: malloc fail !\n"));
+      ZERODEBUG(0,("api_DosPrintQEnum: malloc fail !\n"));
       return False;
     }
     subcnt = 0;
@@ -1138,7 +1138,7 @@
       ts = (struct srv_info_struct *)
 	Realloc(*servers,sizeof(**servers)*alloced);
       if (!ts) {
-        DEBUG(0,("get_server_info: failed to enlarge servers info struct!\n"));
+        ZERODEBUG(0,("get_server_info: failed to enlarge servers info struct!\n"));
         return(0);
       }
       else *servers = ts;
@@ -1862,13 +1862,13 @@
    * Check the parameter definition is correct.
    */
   if(!strequal(param + 2, "zsT")) {
-    DEBUG(0,("api_SamOEMChangePassword: Invalid parameter string %s\n", param + 2));
+    ZERODEBUG(0,("api_SamOEMChangePassword: Invalid parameter string %s\n", param + 2));
     return False;
   }
   p = skip_string(p, 1);
 
   if(!strequal(p, "B516B16")) {
-    DEBUG(0,("api_SamOEMChangePassword: Invalid data parameter string %s\n", p));
+    ZERODEBUG(0,("api_SamOEMChangePassword: Invalid data parameter string %s\n", p));
     return False;
   }
   p = skip_string(p,1);
@@ -3333,7 +3333,7 @@
   int i;
 
   if (!params) {
-	  DEBUG(0,("ERROR: NULL params in api_reply()\n"));
+	  ZERODEBUG(0,("ERROR: NULL params in api_reply()\n"));
 	  return 0;
   }
 
@@ -3361,7 +3361,7 @@
     memset(rparam,'\0',1024);
 
   if(!rdata || !rparam) {
-    DEBUG(0,("api_reply: malloc fail !\n"));
+    ZERODEBUG(0,("api_reply: malloc fail !\n"));
     return -1;
   }
 
diff -Naur samba-2.2.12-orig/source/smbd/mangle.c samba-2.2.12/source/smbd/mangle.c
--- samba-2.2.12-orig/source/smbd/mangle.c	2004-08-12 20:25:49.000000000 +0200
+++ samba-2.2.12/source/smbd/mangle.c	2009-03-11 09:59:38.000000000 +0100
@@ -54,7 +54,7 @@
 	}
 
 	if (!mangle_fns) {
-		DEBUG(0,("Failed to initialise mangling system '%s'\n", method));
+		ZERODEBUG(0,("Failed to initialise mangling system '%s'\n", method));
 		exit_server("mangling init failed");
 	}
 }
diff -Naur samba-2.2.12-orig/source/smbd/negprot.c samba-2.2.12/source/smbd/negprot.c
--- samba-2.2.12-orig/source/smbd/negprot.c	2004-08-12 20:24:20.000000000 +0200
+++ samba-2.2.12/source/smbd/negprot.c	2009-03-11 09:59:38.000000000 +0100
@@ -426,7 +426,7 @@
     DEBUG(3,("Selected protocol %s\n",supported_protocols[protocol].proto_name));
   }
   else {
-    DEBUG(0,("No protocol supported !\n"));
+    ZERODEBUG(0,("No protocol supported !\n"));
   }
   SSVAL(outbuf,smb_vwv0,choice);
   
diff -Naur samba-2.2.12-orig/source/smbd/notify.c samba-2.2.12/source/smbd/notify.c
--- samba-2.2.12-orig/source/smbd/notify.c	2004-08-12 20:24:21.000000000 +0200
+++ samba-2.2.12/source/smbd/notify.c	2009-03-11 09:59:38.000000000 +0100
@@ -179,7 +179,7 @@
 	struct change_notify *cnbp;
 
 	if((cnbp = (struct change_notify *)malloc(sizeof(*cnbp))) == NULL) {
-		DEBUG(0,("call_nt_transact_notify_change: malloc fail !\n" ));
+		ZERODEBUG(0,("call_nt_transact_notify_change: malloc fail !\n" ));
 		return -1;
 	}
 
@@ -213,7 +213,7 @@
 	if (!cnotify) cnotify = hash_notify_init();
 	
 	if (!cnotify) {
-		DEBUG(0,("Failed to init change notify system\n"));
+		ZERODEBUG(0,("Failed to init change notify system\n"));
 		return False;
 	}
 
diff -Naur samba-2.2.12-orig/source/smbd/notify_kernel.c samba-2.2.12/source/smbd/notify_kernel.c
--- samba-2.2.12-orig/source/smbd/notify_kernel.c	2004-08-12 20:24:21.000000000 +0200
+++ samba-2.2.12/source/smbd/notify_kernel.c	2009-03-11 09:59:38.000000000 +0100
@@ -219,7 +219,7 @@
         act.sa_sigaction = signal_handler;
         act.sa_flags = SA_SIGINFO;
         if (sigaction(RT_SIGNAL_NOTIFY, &act, NULL) != 0) {
-		DEBUG(0,("Failed to setup RT_SIGNAL_NOTIFY handler\n"));
+		ZERODEBUG(0,("Failed to setup RT_SIGNAL_NOTIFY handler\n"));
 		return NULL;
         }
 
diff -Naur samba-2.2.12-orig/source/smbd/nttrans.c samba-2.2.12/source/smbd/nttrans.c
--- samba-2.2.12-orig/source/smbd/nttrans.c	2004-08-12 20:24:20.000000000 +0200
+++ samba-2.2.12/source/smbd/nttrans.c	2009-03-11 09:59:38.000000000 +0100
@@ -236,7 +236,7 @@
      */
 
     if(params_to_send < 0 || data_to_send < 0) {
-      DEBUG(0,("send_nt_replies failed sanity check pts = %d, dts = %d\n!!!",
+      ZERODEBUG(0,("send_nt_replies failed sanity check pts = %d, dts = %d\n!!!",
             params_to_send, data_to_send));
       return -1;
     }
@@ -390,7 +390,7 @@
 			ret = (FILE_FAIL_IF_NOT_EXIST|FILE_EXISTS_TRUNCATE);
 			break;
 		default:
-			DEBUG(0,("map_create_disposition: Incorrect value for create_disposition = %d\n",
+			ZERODEBUG(0,("map_create_disposition: Incorrect value for create_disposition = %d\n",
 				create_disposition ));
 			return -1;
 	}
@@ -463,7 +463,7 @@
 			smb_open_mode = DOS_OPEN_RDONLY;
 
 		} else {
-			DEBUG(0,("map_share_mode: Incorrect value 0x%lx for desired_access to file %s\n",
+			ZERODEBUG(0,("map_share_mode: Incorrect value 0x%lx for desired_access to file %s\n",
 				(unsigned long)*desired_access, fname));
 			return -1;
 		}
@@ -1021,7 +1021,7 @@
 	 */
 
 	if(total_parameter_count < 54) {
-		DEBUG(0,("do_nt_transact_create_pipe - insufficient parameters (%u)\n", (unsigned int)total_parameter_count));
+		ZERODEBUG(0,("do_nt_transact_create_pipe - insufficient parameters (%u)\n", (unsigned int)total_parameter_count));
 		return ERROR_DOS(ERRDOS,ERRnoaccess);
 	}
 
@@ -1089,7 +1089,7 @@
 	 */
 
 	if ((mem_ctx = talloc_init()) == NULL) {
-		DEBUG(0,("set_sd: talloc_init failed.\n"));
+		ZERODEBUG(0,("set_sd: talloc_init failed.\n"));
 		*pdef_class = ERRDOS;
 		*pdef_code = ERRnomem;
 		return False;
@@ -1109,7 +1109,7 @@
 	 */
 
 	if(!sec_io_desc( "sd data", &psd, &pd, 1)) {
-		DEBUG(0,("set_sd: Error in unmarshalling security descriptor.\n"));
+		ZERODEBUG(0,("set_sd: Error in unmarshalling security descriptor.\n"));
 		/*
 		 * Return access denied for want of a better error message..
 		 */ 
@@ -1204,7 +1204,7 @@
 	 */
 
 	if(total_parameter_count < 54) {
-		DEBUG(0,("call_nt_transact_create - insufficient parameters (%u)\n", (unsigned int)total_parameter_count));
+		ZERODEBUG(0,("call_nt_transact_create - insufficient parameters (%u)\n", (unsigned int)total_parameter_count));
 		return ERROR_DOS(ERRDOS,ERRnoaccess);
 	}
 
@@ -1626,7 +1626,7 @@
 
 	*ppsd = make_standard_sec_desc( mem_ctx, &global_sid_World, &global_sid_World, NULL, &sd_size);
 	if(!*ppsd) {
-		DEBUG(0,("get_null_nt_acl: Unable to malloc space for security descriptor.\n"));
+		ZERODEBUG(0,("get_null_nt_acl: Unable to malloc space for security descriptor.\n"));
 		sd_size = 0;
 	}
  
@@ -1666,7 +1666,7 @@
   *ppparams = params;
 
   if ((mem_ctx = talloc_init()) == NULL) {
-    DEBUG(0,("call_nt_transact_query_security_desc: talloc_init failed.\n"));
+    ZERODEBUG(0,("call_nt_transact_query_security_desc: talloc_init failed.\n"));
     return ERROR_DOS(ERRDOS,ERRnomem);
   }
 
@@ -1728,7 +1728,7 @@
    */
 
   if(!sec_io_desc( "sd data", &psd, &pd, 1)) {
-    DEBUG(0,("call_nt_transact_query_security_desc: Error in marshalling \
+    ZERODEBUG(0,("call_nt_transact_query_security_desc: Error in marshalling \
 security descriptor.\n"));
     /*
      * Return access denied for want of a better error message..
@@ -1907,7 +1907,7 @@
 		SAFE_FREE(setup);
 		SAFE_FREE(params);
 		SAFE_FREE(data);
-		DEBUG(0,("reply_nttrans : Out of memory\n"));
+		ZERODEBUG(0,("reply_nttrans : Out of memory\n"));
 		END_PROFILE(SMBnttrans);
 		return ERROR_DOS(ERRDOS,ERRnomem);
 	}
@@ -1969,9 +1969,9 @@
 			if((ret && (CVAL(inbuf, smb_com) != SMBnttranss)) || !ret) {
 				outsize = set_message(outbuf,0,0,True);
 				if(ret) {
-					DEBUG(0,("reply_nttrans: Invalid secondary nttrans packet\n"));
+					ZERODEBUG(0,("reply_nttrans: Invalid secondary nttrans packet\n"));
 				} else {
-					DEBUG(0,("reply_nttrans: %s in getting secondary nttrans response.\n",
+					ZERODEBUG(0,("reply_nttrans: %s in getting secondary nttrans response.\n",
 						(smb_read_error == READ_ERROR) ? "error" : "timeout" ));
 				}
 				goto bad_param;
@@ -1994,7 +1994,7 @@
 			num_data_sofar += data_count;
 
 			if (num_params_sofar > total_parameter_count || num_data_sofar > total_data_count) {
-				DEBUG(0,("reply_nttrans2: data overflow in secondary nttrans packet"));
+				ZERODEBUG(0,("reply_nttrans2: data overflow in secondary nttrans packet"));
 				goto bad_param;
 			}
 
@@ -2079,7 +2079,7 @@
 			break;
 		default:
 			/* Error in request */
-			DEBUG(0,("reply_nttrans: Unknown request %d in nttrans call\n", function_code));
+			ZERODEBUG(0,("reply_nttrans: Unknown request %d in nttrans call\n", function_code));
 			SAFE_FREE(setup);
 			SAFE_FREE(params);
 			SAFE_FREE(data);
diff -Naur samba-2.2.12-orig/source/smbd/open.c samba-2.2.12/source/smbd/open.c
--- samba-2.2.12-orig/source/smbd/open.c	2004-08-12 20:24:20.000000000 +0200
+++ samba-2.2.12/source/smbd/open.c	2009-03-11 09:59:38.000000000 +0100
@@ -189,7 +189,7 @@
 			ret = vfs_fstat(fsp,fsp->fd,psbuf);
 			/* If we have an fd, this stat should succeed. */
 			if (ret == -1)
-				DEBUG(0,("Error doing fstat on open file %s (%s)\n", fname,strerror(errno) ));
+				ZERODEBUG(0,("Error doing fstat on open file %s (%s)\n", fname,strerror(errno) ));
 		}
 
 		/* For a non-io open, this stat failing means file not found. JRA */
@@ -603,7 +603,7 @@
 				lock_share_entry(conn, dev, inode);
 
 				if(opb_ret == False) {
-					DEBUG(0,("open_mode_check: FAILED when breaking oplock (%x) on file %s, \
+					ZERODEBUG(0,("open_mode_check: FAILED when breaking oplock (%x) on file %s, \
 dev = %x, inode = %.0f\n", old_shares[i].op_type, fname, (unsigned int)dev, (double)inode));
 					SAFE_FREE(old_shares);
 					errno = EACCES;
@@ -648,11 +648,11 @@
 					 * as exlusive.... The process *must* be dead.... 
 					 */
 
-					DEBUG(0,("open_mode_check: exlusive oplock left by process %d after break ! For file %s, \
+					ZERODEBUG(0,("open_mode_check: exlusive oplock left by process %d after break ! For file %s, \
 dev = %x, inode = %.0f. Deleting it to continue...\n", (int)broken_entry.pid, fname, (unsigned int)dev, (double)inode));
 
 					if (process_exists(broken_entry.pid)) {
-						DEBUG(0,("open_mode_check: Existent process %u left active oplock.\n",
+						ZERODEBUG(0,("open_mode_check: Existent process %u left active oplock.\n",
 								(unsigned int)broken_entry.pid ));
 					}
 
@@ -1236,7 +1236,7 @@
 		if (got_stat) {
 
 			if(!S_ISDIR(psbuf->st_mode)) {
-				DEBUG(0,("open_directory: %s is not a directory !\n", fname ));
+				ZERODEBUG(0,("open_directory: %s is not a directory !\n", fname ));
 				file_free(fsp);
 				errno = EACCES;
 				return NULL;
@@ -1278,14 +1278,14 @@
 		 */
 
 		if(!got_stat) {
-			DEBUG(0,("open_directory: unable to stat name = %s. Error was %s\n",
+			ZERODEBUG(0,("open_directory: unable to stat name = %s. Error was %s\n",
 				 fname, strerror(errno) ));
 			file_free(fsp);
 			return NULL;
 		}
 
 		if(!S_ISDIR(psbuf->st_mode)) {
-			DEBUG(0,("open_directory: %s is not a directory !\n", fname ));
+			ZERODEBUG(0,("open_directory: %s is not a directory !\n", fname ));
 			file_free(fsp);
 			return NULL;
 		}
diff -Naur samba-2.2.12-orig/source/smbd/oplock.c samba-2.2.12/source/smbd/oplock.c
--- samba-2.2.12-orig/source/smbd/oplock.c	2004-08-12 20:24:20.000000000 +0200
+++ samba-2.2.12/source/smbd/oplock.c	2009-03-11 13:38:47.000000000 +0100
@@ -171,20 +171,20 @@
 				buffer_len - OPBRK_CMD_HEADER_LEN, 0, (struct sockaddr *)&from, &fromlen);
 
 	if(msg_len < 0) {
-		DEBUG(0,("receive_local_message. Error in recvfrom. (%s).\n",strerror(errno)));
+		ZERODEBUG(0,("receive_local_message. Error in recvfrom. (%s).\n",strerror(errno)));
 		return False;
 	}
 
 	/* Validate message length. */
 	if(msg_len > (buffer_len - OPBRK_CMD_HEADER_LEN)) {
-		DEBUG(0,("receive_local_message: invalid msg_len (%d) max can be %d\n", msg_len,
+		ZERODEBUG(0,("receive_local_message: invalid msg_len (%d) max can be %d\n", msg_len,
 			buffer_len  - OPBRK_CMD_HEADER_LEN));
 		return False;
 	}
 
 	/* Validate message from address (must be localhost). */
 	if(from.sin_addr.s_addr != htonl(INADDR_LOOPBACK)) {
-		DEBUG(0,("receive_local_message: invalid 'from' address \
+		ZERODEBUG(0,("receive_local_message: invalid 'from' address \
 (was %lx should be 127.0.0.1)\n", (long)from.sin_addr.s_addr));
 		return False;
 	}
@@ -269,7 +269,7 @@
 
 	/* Remove the oplock flag from the sharemode. */
 	if (lock_share_entry_fsp(fsp) == False) {
-		DEBUG(0,("remove_oplock: failed to lock share entry for file %s\n",
+		ZERODEBUG(0,("remove_oplock: failed to lock share entry for file %s\n",
 			 fsp->fsp_name ));
 		ret = False;
 	}
@@ -280,7 +280,7 @@
 		 */
 
 		if(remove_share_oplock(fsp)==False) {
-			DEBUG(0,("remove_oplock: failed to remove share oplock for file %s fnum %d, \
+			ZERODEBUG(0,("remove_oplock: failed to remove share oplock for file %s fnum %d, \
 dev = %x, inode = %.0f\n", fsp->fsp_name, fsp->fnum, (unsigned int)dev, (double)inode));
 			ret = False;
 		}
@@ -291,7 +291,7 @@
 		 * Deal with a reply when a break-to-level II was sent.
 		 */
 		if(downgrade_share_oplock(fsp)==False) {
-			DEBUG(0,("remove_oplock: failed to downgrade share oplock for file %s fnum %d, \
+			ZERODEBUG(0,("remove_oplock: failed to downgrade share oplock for file %s fnum %d, \
 dev = %x, inode = %.0f\n", fsp->fsp_name, fsp->fnum, (unsigned int)dev, (double)inode));
 			ret = False;
 		}
@@ -359,11 +359,11 @@
 	switch(break_cmd_type) {
 		case KERNEL_OPLOCK_BREAK_CMD:
 			if (!koplocks) {
-				DEBUG(0,("unexpected kernel oplock break!\n"));
+				ZERODEBUG(0,("unexpected kernel oplock break!\n"));
 				break;
 			} 
 			if (!koplocks->parse_message(msg_start, msg_len, &inode, &dev, &file_id)) {
-				DEBUG(0,("kernel oplock break parse failure!\n"));
+				ZERODEBUG(0,("kernel oplock break parse failure!\n"));
 			}
 			break;
 
@@ -373,7 +373,7 @@
 
 			/* Ensure that the msg length is correct. */
 			if(msg_len != OPLOCK_BREAK_MSG_LEN) {
-				DEBUG(0,("process_local_message: incorrect length for OPLOCK_BREAK_CMD (was %d, should be %d).\n",
+				ZERODEBUG(0,("process_local_message: incorrect length for OPLOCK_BREAK_CMD (was %d, should be %d).\n",
 					(int)msg_len, (int)OPLOCK_BREAK_MSG_LEN));
 				return False;
 			}
@@ -393,11 +393,11 @@
 		 * Keep this as a debug case - eventually we can remove it.
 		 */
 		case 0x8001:
-			DEBUG(0,("process_local_message: Received unsolicited break \
+			ZERODEBUG(0,("process_local_message: Received unsolicited break \
 reply - dumping info.\n"));
 
 			if(msg_len != OPLOCK_BREAK_MSG_LEN) {
-				DEBUG(0,("process_local_message: ubr: incorrect length for reply \
+				ZERODEBUG(0,("process_local_message: ubr: incorrect length for reply \
 (was %d, should be %d).\n", (int)msg_len, (int)OPLOCK_BREAK_MSG_LEN));
 				return False;
 			}
@@ -407,14 +407,14 @@
 			memcpy((char *)&dev, msg_start+OPLOCK_BREAK_DEV_OFFSET,sizeof(dev));
 			memcpy((char *)&file_id, msg_start+OPLOCK_BREAK_FILEID_OFFSET,sizeof(file_id));
 
-			DEBUG(0,("process_local_message: unsolicited oplock break reply from \
+			ZERODEBUG(0,("process_local_message: unsolicited oplock break reply from \
 pid %d, port %d, dev = %x, inode = %.0f, file_id = %lu\n",
 				(int)remotepid, from_port, (unsigned int)dev, (double)inode, file_id));
 
 			return False;
 
 		default:
-			DEBUG(0,("process_local_message: unknown UDP message command code (%x) - ignoring.\n",
+			ZERODEBUG(0,("process_local_message: unknown UDP message command code (%x) - ignoring.\n",
 				(unsigned int)SVAL(msg_start,0)));
 			return False;
 	}
@@ -425,7 +425,7 @@
 
 	if((exclusive_oplocks_open + level_II_oplocks_open) != 0) {
 		if (oplock_break(dev, inode, file_id, False) == False) {
-			DEBUG(0,("process_local_message: oplock break failed.\n"));
+			ZERODEBUG(0,("process_local_message: oplock break failed.\n"));
 			return False;
 		}
 	} else {
@@ -456,7 +456,7 @@
 
 		if(sys_sendto( oplock_sock, msg_start, OPLOCK_BREAK_MSG_LEN, 0,
 				(struct sockaddr *)&toaddr, sizeof(toaddr)) < 0) {
-			DEBUG(0,("process_local_message: sendto process %d failed. Errno was %s\n",
+			ZERODEBUG(0,("process_local_message: sendto process %d failed. Errno was %s\n",
 				(int)remotepid, strerror(errno)));
 			return False;
 		}
@@ -618,13 +618,13 @@
 	 */
 
 	if(!local_request && lock_share_entry_fsp(fsp) == False) {
-		DEBUG(0,("oplock_break_level2: unable to lock share entry for file %s\n", fsp->fsp_name ));
+		ZERODEBUG(0,("oplock_break_level2: unable to lock share entry for file %s\n", fsp->fsp_name ));
 	} else {
 		got_lock = True;
 	}
 
 	if(remove_share_oplock(fsp)==False) {
-		DEBUG(0,("oplock_break_level2: unable to remove level II oplock for file %s\n", fsp->fsp_name ));
+		ZERODEBUG(0,("oplock_break_level2: unable to remove level II oplock for file %s\n", fsp->fsp_name ));
 	}
 
 	if (!local_request && got_lock)
@@ -634,7 +634,7 @@
 	level_II_oplocks_open--;
 
 	if(level_II_oplocks_open < 0) {
-		DEBUG(0,("oplock_break_level2: level_II_oplocks_open < 0 (%d). PANIC ERROR\n",
+		ZERODEBUG(0,("oplock_break_level2: level_II_oplocks_open < 0 (%d). PANIC ERROR\n",
 			level_II_oplocks_open));
 		abort();
 	}
@@ -682,7 +682,7 @@
 
 	/* Mark the oplock break as sent - we don't want to send twice! */
 	if (fsp->sent_oplock_break) {
-		if( DEBUGLVL( 0 ) ) {
+		if( ZERODEBUGLVL( 0 ) ) {
 			dbgtext( "oplock_break: ERROR: oplock_break already sent for " );
 			dbgtext( "file %s ", fsp->fsp_name);
 			dbgtext( "(dev = %x, inode = %.0f, file_id = %lu)\n", (unsigned int)dev, (double)inode, fsp->file_id );
@@ -697,7 +697,7 @@
 	}
 
 	if(global_oplock_break) {
-		DEBUG(0,("ABORT : ABORT : recursion in oplock_break !!!!!\n"));
+		ZERODEBUG(0,("ABORT : ABORT : recursion in oplock_break !!!!!\n"));
 		abort();
 	}
 
@@ -710,12 +710,12 @@
 	 */
 
 	if((inbuf = (char *)malloc(BUFFER_SIZE + LARGE_WRITEX_HDR_SIZE + SAFETY_MARGIN))==NULL) {
-		DEBUG(0,("oplock_break: malloc fail for input buffer.\n"));
+		ZERODEBUG(0,("oplock_break: malloc fail for input buffer.\n"));
 		return False;
 	}
 
 	if((outbuf = (char *)malloc(BUFFER_SIZE + LARGE_WRITEX_HDR_SIZE + SAFETY_MARGIN))==NULL) {
-		DEBUG(0,("oplock_break: malloc fail for output buffer.\n"));
+		ZERODEBUG(0,("oplock_break: malloc fail for output buffer.\n"));
 		SAFE_FREE(inbuf);
 		return False;
 	}
@@ -788,18 +788,18 @@
 			 */
 
 			if (smb_read_error == READ_EOF) {
-				DEBUG( 0, ( "oplock_break: end of file from client\n" ) );
+				ZERODEBUG( 0, ( "oplock_break: end of file from client\n" ) );
 				shutdown_server = True;
 			} else if (smb_read_error == READ_ERROR) {
-				DEBUG( 0, ("oplock_break: receive_smb error (%s)\n", strerror(errno)) );
+				ZERODEBUG( 0, ("oplock_break: receive_smb error (%s)\n", strerror(errno)) );
 				shutdown_server = True;
 			} else if (smb_read_error == READ_TIMEOUT) {
-				DEBUG( 0, ( "oplock_break: receive_smb timed out after %d seconds.\n", OPLOCK_BREAK_TIMEOUT ) );
+				ZERODEBUG( 0, ( "oplock_break: receive_smb timed out after %d seconds.\n", OPLOCK_BREAK_TIMEOUT ) );
 				oplock_timeout = True;
 			}
 
-			DEBUGADD( 0, ( "oplock_break failed for file %s ", file_name ) );
-			DEBUGADD( 0, ( "(dev = %x, inode = %.0f, file_id = %lu).\n",
+			ZERODEBUGADD( 0, ( "oplock_break failed for file %s ", file_name ) );
+			ZERODEBUGADD( 0, ( "(dev = %x, inode = %.0f, file_id = %lu).\n",
 				(unsigned int)dev, (double)inode, file_id));
 
 			break;
@@ -821,7 +821,7 @@
 		 */
 
 		if((time(NULL) - start_time) > OPLOCK_BREAK_TIMEOUT) {
-			if( DEBUGLVL( 0 ) ) {
+			if( ZERODEBUGLVL( 0 ) ) {
 				dbgtext( "oplock_break: no break received from client " );
 				dbgtext( "within %d seconds.\n", OPLOCK_BREAK_TIMEOUT );
 				dbgtext( "oplock_break failed for file %s ", fsp->fsp_name );
@@ -838,8 +838,8 @@
 	 * break.
 	 */
 	if((saved_user_conn != NULL) && (saved_vuid != UID_FIELD_INVALID) && !change_to_user(saved_user_conn, saved_vuid)) {
-		DEBUG( 0, ( "oplock_break: unable to re-become user!" ) );
-		DEBUGADD( 0, ( "Shutting down server\n" ) );
+		ZERODEBUG( 0, ( "oplock_break: unable to re-become user!" ) );
+		ZERODEBUGADD( 0, ( "Shutting down server\n" ) );
 		close(oplock_sock);
 		exit_server("unable to re-become user");
 	}
@@ -866,7 +866,7 @@
 
 	if(oplock_timeout && (fsp = initial_break_processing(dev, inode, file_id)) &&
 			OPEN_FSP(fsp) && EXCLUSIVE_OPLOCK_TYPE(fsp->oplock_type)) {
-		DEBUG(0,("oplock_break: client failure in oplock break in file %s\n", fsp->fsp_name));
+		ZERODEBUG(0,("oplock_break: client failure in oplock break in file %s\n", fsp->fsp_name));
 		remove_oplock(fsp,True);
 		global_client_failed_oplock_break = True; /* Never grant this client an oplock again. */
 	}
@@ -876,15 +876,15 @@
 	 */
 
 	if(shutdown_server) {
-		DEBUG( 0, ( "oplock_break: client failure in break - " ) );
-		DEBUGADD( 0, ( "shutting down this smbd.\n" ) );
+		ZERODEBUG( 0, ( "oplock_break: client failure in break - " ) );
+		ZERODEBUGADD( 0, ( "shutting down this smbd.\n" ) );
 		close(oplock_sock);
 		exit_server("oplock break failure");
 	}
 
 	/* Santity check - remove this later. JRA */
 	if(exclusive_oplocks_open < 0) {
-		DEBUG(0,("oplock_break: exclusive_oplocks_open < 0 (%d). PANIC ERROR\n", exclusive_oplocks_open));
+		ZERODEBUG(0,("oplock_break: exclusive_oplocks_open < 0 (%d). PANIC ERROR\n", exclusive_oplocks_open));
 		abort();
 	}
 
@@ -917,7 +917,7 @@
 	if(pid == share_entry->pid) {
 		/* We are breaking our own oplock, make sure it's us. */
 		if(share_entry->op_port != global_oplock_port) {
-			DEBUG(0,("request_oplock_break: corrupt share mode entry - pid = %d, port = %d \
+			ZERODEBUG(0,("request_oplock_break: corrupt share mode entry - pid = %d, port = %d \
 should be %d\n", (int)pid, share_entry->op_port, global_oplock_port));
 			return False;
 		}
@@ -928,7 +928,7 @@
 		{
 			files_struct *fsp = file_find_dif(dev, inode, file_id);
 			if (!fsp) {
-				DEBUG(0,("request_oplock_break: PANIC : breaking our own oplock requested for \
+				ZERODEBUG(0,("request_oplock_break: PANIC : breaking our own oplock requested for \
 dev = %x, inode = %.0f, file_id = %lu and no fsp found !\n",
             (unsigned int)dev, (double)inode, file_id ));
 				smb_panic("request_oplock_break: no fsp found for our own oplock\n");
@@ -969,7 +969,7 @@
 
 	if(sys_sendto(oplock_sock,op_break_msg,OPLOCK_BREAK_MSG_LEN,0,
 			(struct sockaddr *)&addr_out,sizeof(addr_out)) < 0) {
-		if( DEBUGLVL( 0 ) ) {
+		if( ZERODEBUGLVL( 0 ) ) {
 			dbgtext( "request_oplock_break: failed when sending a oplock " );
 			dbgtext( "break message to pid %d ", (int)share_entry->pid );
 			dbgtext( "on port %d ", share_entry->op_port );
@@ -1008,7 +1008,7 @@
 		if(receive_local_message(op_break_reply, sizeof(op_break_reply),
 				time_left ? time_left * 1000 : 1) == False) {
 			if(smb_read_error == READ_TIMEOUT) {
-				if( DEBUGLVL( 0 ) ) {
+				if( ZERODEBUGLVL( 0 ) ) {
 					dbgtext( "request_oplock_break: no response received to oplock " );
 					dbgtext( "break request to pid %d ", (int)share_entry->pid );
 					dbgtext( "on port %d ", share_entry->op_port );
@@ -1025,7 +1025,7 @@
 				 */
 				break;
 			} else {
-				if( DEBUGLVL( 0 ) ) {
+				if( ZERODEBUGLVL( 0 ) ) {
 					dbgtext( "request_oplock_break: error in response received " );
 					dbgtext( "to oplock break request to pid %d ", (int)share_entry->pid );
 					dbgtext( "on port %d ", share_entry->op_port );
@@ -1127,7 +1127,7 @@
 		return;
 
 	if (lock_share_entry_fsp(fsp) == False) {
-		DEBUG(0,("release_level_2_oplocks_on_change: failed to lock share mode entry for file %s.\n", fsp->fsp_name ));
+		ZERODEBUG(0,("release_level_2_oplocks_on_change: failed to lock share mode entry for file %s.\n", fsp->fsp_name ));
 	}
 
 	num_share_modes = get_share_modes(fsp->conn, fsp->dev, fsp->inode, &share_list);
@@ -1155,7 +1155,7 @@
 
 		/* Paranoia .... */
 		if (EXCLUSIVE_OPLOCK_TYPE(share_entry->op_type)) {
-			DEBUG(0,("release_level_2_oplocks_on_change: PANIC. share mode entry %d is an exlusive oplock !\n", i ));
+			ZERODEBUG(0,("release_level_2_oplocks_on_change: PANIC. share mode entry %d is an exlusive oplock !\n", i ));
 			unlock_share_entry(fsp->conn, fsp->dev, fsp->inode);
 			abort();
 		}
@@ -1171,7 +1171,7 @@
 
 			/* Paranoia check... */
 			if(new_fsp == NULL) {
-				DEBUG(0,("release_level_2_oplocks_on_change: PANIC. share mode entry %d is not a local file !\n", i ));
+				ZERODEBUG(0,("release_level_2_oplocks_on_change: PANIC. share mode entry %d is not a local file !\n", i ));
 				unlock_share_entry(fsp->conn, fsp->dev, fsp->inode);
 				abort();
 			}
@@ -1197,7 +1197,7 @@
 
 	/* Paranoia check... */
 	if (LEVEL_II_OPLOCK_TYPE(fsp->oplock_type)) {
-		DEBUG(0,("release_level_2_oplocks_on_change: PANIC. File %s still has a level II oplock.\n", fsp->fsp_name));
+		ZERODEBUG(0,("release_level_2_oplocks_on_change: PANIC. File %s still has a level II oplock.\n", fsp->fsp_name));
 		smb_panic("release_level_2_oplocks_on_change");
 	}
 }
@@ -1216,7 +1216,7 @@
 	/* Open a lookback UDP socket on a random port. */
 	oplock_sock = open_socket_in(SOCK_DGRAM, 0, 0, htonl(INADDR_LOOPBACK),False);
 	if (oplock_sock == -1) {
-		DEBUG(0,("open_oplock_ipc: Failed to get local UDP socket for \
+		ZERODEBUG(0,("open_oplock_ipc: Failed to get local UDP socket for \
 address %lx. Error was %s\n", (long)htonl(INADDR_LOOPBACK), strerror(errno)));
 		global_oplock_port = 0;
 		return(False);
@@ -1224,7 +1224,7 @@
 
 	/* Find out the transient UDP port we have been allocated. */
 	if(getsockname(oplock_sock, (struct sockaddr *)&sock_name, &len)<0) {
-		DEBUG(0,("open_oplock_ipc: Failed to get local UDP port. Error was %s\n",
+		ZERODEBUG(0,("open_oplock_ipc: Failed to get local UDP port. Error was %s\n",
 			 strerror(errno)));
 		close(oplock_sock);
 		oplock_sock = -1;
diff -Naur samba-2.2.12-orig/source/smbd/oplock_irix.c samba-2.2.12/source/smbd/oplock_irix.c
--- samba-2.2.12-orig/source/smbd/oplock_irix.c	2004-08-12 20:24:21.000000000 +0200
+++ samba-2.2.12/source/smbd/oplock_irix.c	2009-03-11 13:35:08.000000000 +0100
@@ -41,13 +41,13 @@
 	slprintf(tmpname,sizeof(tmpname)-1, "%s/koplock.%d", lp_lockdir(), (int)sys_getpid());
 
 	if(pipe(pfd) != 0) {
-		DEBUG(0,("check_kernel_oplocks: Unable to create pipe. Error was %s\n",
+		ZERODEBUG(0,("check_kernel_oplocks: Unable to create pipe. Error was %s\n",
 			 strerror(errno) ));
 		return False;
 	}
 
 	if((fd = sys_open(tmpname, O_RDWR|O_CREAT|O_EXCL|O_TRUNC, 0600)) < 0) {
-		DEBUG(0,("check_kernel_oplocks: Unable to open temp test file %s. Error was %s\n",
+		ZERODEBUG(0,("check_kernel_oplocks: Unable to open temp test file %s. Error was %s\n",
 			 tmpname, strerror(errno) ));
 		unlink( tmpname );
 		close(pfd[0]);
@@ -58,7 +58,7 @@
 	unlink(tmpname);
 
 	if(sys_fcntl_long(fd, F_OPLKREG, pfd[1]) == -1) {
-		DEBUG(0,("check_kernel_oplocks: Kernel oplocks are not available on this machine. \
+		ZERODEBUG(0,("check_kernel_oplocks: Kernel oplocks are not available on this machine. \
 Disabling kernel oplock support.\n" ));
 		close(pfd[0]);
 		close(pfd[1]);
@@ -67,7 +67,7 @@
 	}
 
 	if(sys_fcntl_long(fd, F_OPLKACK, OP_REVOKE) < 0 ) {
-		DEBUG(0,("check_kernel_oplocks: Error when removing kernel oplock. Error was %s. \
+		ZERODEBUG(0,("check_kernel_oplocks: Error when removing kernel oplock. Error was %s. \
 Disabling kernel oplock support.\n", strerror(errno) ));
 		close(pfd[0]);
 		close(pfd[1]);
@@ -100,7 +100,7 @@
 	 */
 
 	if(read(oplock_pipe_read, &dummy, 1) != 1) {
-		DEBUG(0,("irix_oplock_receive_message: read of kernel notification failed. \
+		ZERODEBUG(0,("irix_oplock_receive_message: read of kernel notification failed. \
 Error was %s.\n", strerror(errno) ));
 		smb_read_error = READ_ERROR;
 		return False;
@@ -113,7 +113,7 @@
 	 */
 
 	if(sys_fcntl_ptr(oplock_pipe_read, F_OPLKSTAT, &os) < 0) {
-		DEBUG(0,("irix_oplock_receive_message: fcntl of kernel notification failed. \
+		ZERODEBUG(0,("irix_oplock_receive_message: fcntl of kernel notification failed. \
 Error was %s.\n", strerror(errno) ));
 		if(errno == EAGAIN) {
 			/*
@@ -132,7 +132,7 @@
 	 */
 
 	if ((fsp = file_find_di_first((SMB_DEV_T)os.os_dev, (SMB_INO_T)os.os_ino)) == NULL) {
-		DEBUG(0,("irix_oplock_receive_message: unable to find open file with dev = %x, inode = %.0f\n",
+		ZERODEBUG(0,("irix_oplock_receive_message: unable to find open file with dev = %x, inode = %.0f\n",
 			(unsigned int)os.os_dev, (double)os.os_ino ));
 		return False;
 	}
@@ -167,7 +167,7 @@
 {
 	if (sys_fcntl_long(fsp->fd, F_OPLKREG, oplock_pipe_write) == -1) {
 		if(errno != EAGAIN) {
-			DEBUG(0,("irix_set_kernel_oplock: Unable to get kernel oplock on file %s, dev = %x, \
+			ZERODEBUG(0,("irix_set_kernel_oplock: Unable to get kernel oplock on file %s, dev = %x, \
 inode = %.0f, file_id = %ul. Error was %s\n", 
 				 fsp->fsp_name, (unsigned int)fsp->dev, (double)fsp->inode, fsp->file_id,
 				 strerror(errno) ));
@@ -206,7 +206,7 @@
 	 * Remove the kernel oplock on this file.
 	 */
 	if(sys_fcntl_long(fsp->fd, F_OPLKACK, OP_REVOKE) < 0) {
-		if( DEBUGLVL( 0 )) {
+		if( ZERODEBUGLVL( 0 )) {
 			dbgtext("irix_release_kernel_oplock: Error when removing kernel oplock on file " );
 			dbgtext("%s, dev = %x, inode = %.0f, file_id = %ul. Error was %s\n",
 				fsp->fsp_name, (unsigned int)fsp->dev, 
@@ -224,7 +224,7 @@
 {
 	/* Ensure that the msg length is correct. */
 	if(msg_len != KERNEL_OPLOCK_BREAK_MSG_LEN) {
-		DEBUG(0,("incorrect length for KERNEL_OPLOCK_BREAK_CMD (was %d, should be %d).\n", 
+		ZERODEBUG(0,("incorrect length for KERNEL_OPLOCK_BREAK_CMD (was %d, should be %d).\n", 
 			 msg_len, KERNEL_OPLOCK_BREAK_MSG_LEN));
 		return False;
 	}
@@ -264,7 +264,7 @@
 		return NULL;
 
 	if(pipe(pfd) != 0) {
-		DEBUG(0,("setup_kernel_oplock_pipe: Unable to create pipe. Error was %s\n",
+		ZERODEBUG(0,("setup_kernel_oplock_pipe: Unable to create pipe. Error was %s\n",
 			 strerror(errno) ));
 		return False;
 	}
diff -Naur samba-2.2.12-orig/source/smbd/oplock_linux.c samba-2.2.12/source/smbd/oplock_linux.c
--- samba-2.2.12-orig/source/smbd/oplock_linux.c	2004-08-12 20:24:20.000000000 +0200
+++ samba-2.2.12/source/smbd/oplock_linux.c	2009-03-11 13:30:57.000000000 +0100
@@ -141,7 +141,7 @@
 	BlockSignals(False, RT_SIGNAL_LEASE);
 
 	if (fsp == NULL) {
-		DEBUG(0,("Invalid file descriptor %d in kernel oplock break!\n", (int)fd));
+		ZERODEBUG(0,("Invalid file descriptor %d in kernel oplock break!\n", (int)fd));
 		return False;
 	}
 
@@ -209,7 +209,7 @@
 	 * Remove the kernel oplock on this file.
 	 */
 	if (linux_setlease(fsp->fd, F_UNLCK) == -1) {
-		if (DEBUGLVL(0)) {
+		if (ZERODEBUGLVL(0)) {
 			dbgtext("linux_release_kernel_oplock: Error when removing kernel oplock on file " );
 			dbgtext("%s, dev = %x, inode = %.0f, file_id = %lu. Error was %s\n",
 				fsp->fsp_name, (unsigned int)fsp->dev, 
@@ -227,7 +227,7 @@
 {
 	/* Ensure that the msg length is correct. */
 	if (msg_len != KERNEL_OPLOCK_BREAK_MSG_LEN) {
-		DEBUG(0,("incorrect length for KERNEL_OPLOCK_BREAK_CMD (was %d, should be %d).\n", 
+		ZERODEBUG(0,("incorrect length for KERNEL_OPLOCK_BREAK_CMD (was %d, should be %d).\n", 
 			 msg_len, KERNEL_OPLOCK_BREAK_MSG_LEN));
 		return False;
 	}
@@ -284,7 +284,7 @@
 	act.sa_sigaction = signal_handler;
 	act.sa_flags = SA_SIGINFO;
 	if (sigaction(RT_SIGNAL_LEASE, &act, NULL) != 0) {
-		DEBUG(0,("Failed to setup RT_SIGNAL_LEASE handler\n"));
+		ZERODEBUG(0,("Failed to setup RT_SIGNAL_LEASE handler\n"));
 		return NULL;
 	}
 
diff -Naur samba-2.2.12-orig/source/smbd/password.c samba-2.2.12/source/smbd/password.c
--- samba-2.2.12-orig/source/smbd/password.c	2004-08-12 20:24:20.000000000 +0200
+++ samba-2.2.12/source/smbd/password.c	2009-03-11 10:04:14.000000000 +0100
@@ -278,7 +278,7 @@
 		return UID_FIELD_INVALID;
 
 	if((vuser = (user_struct *)malloc( sizeof(user_struct) )) == NULL) {
-		DEBUG(0,("Failed to malloc users struct!\n"));
+		ZERODEBUG(0,("Failed to malloc users struct!\n"));
 		return UID_FIELD_INVALID;
 	}
 
@@ -388,7 +388,7 @@
 	unbecome_root();
 
 	if(!ret) {
-		DEBUG(0,("update_smbpassword_file: pdb_getsampwnam failed to locate %s\n", user));
+		ZERODEBUG(0,("update_smbpassword_file: pdb_getsampwnam failed to locate %s\n", user));
 		return False;
 	}
 
@@ -599,7 +599,7 @@
 		uchar challenge[8];
 
 		if (!last_challenge(challenge)) {
-			DEBUG(0,("Error: challenge not done for user=%s\n", user));
+			ZERODEBUG(0,("Error: challenge not done for user=%s\n", user));
 			return False;
 		}
 
@@ -854,13 +854,13 @@
 			DEBUG(3,("authorise_login: ACCEPTED: guest account and guest ok (%s)\n",
 					user));
 		} else {
-			DEBUG(0,("authorise_login: Invalid guest account %s??\n",guestname));
+			ZERODEBUG(0,("authorise_login: Invalid guest account %s??\n",guestname));
 		}
 		*guest = True;
 	}
 
 	if (ok && !user_ok(user,snum)) {
-		DEBUG(0,("authorise_login: rejected invalid user %s\n",user));
+		ZERODEBUG(0,("authorise_login: rejected invalid user %s\n",user));
 		ok = False;
 	}
 
@@ -1052,7 +1052,7 @@
 	SAFE_FREE(pserver);
 
 	if (!connected_ok) {
-		DEBUG(0,("password server not available\n"));
+		ZERODEBUG(0,("password server not available\n"));
 		cli_shutdown(cli);
 		return NULL;
 	}
@@ -1137,9 +1137,9 @@
 			tested_password_server = True;
 
 			if ((SVAL(cli->inbuf,smb_vwv2) & 1) == 0) {
-				DEBUG(0,("server_validate: password server %s allows users as non-guest \
+				ZERODEBUG(0,("server_validate: password server %s allows users as non-guest \
 with a bad password.\n", cli->desthost));
-				DEBUG(0,("server_validate: This is broken (and insecure) behaviour. Please do not \
+				ZERODEBUG(0,("server_validate: This is broken (and insecure) behaviour. Please do not \
 use this machine as the password server.\n"));
 				cli_ulogoff(cli);
 
@@ -1159,9 +1159,9 @@
 		 */
 
 		if(bad_password_server) {
-			DEBUG(0,("server_validate: [1] password server %s allows users as non-guest \
+			ZERODEBUG(0,("server_validate: [1] password server %s allows users as non-guest \
 with a bad password.\n", cli->desthost));
-			DEBUG(0,("server_validate: [1] This is broken (and insecure) behaviour. Please do not \
+			ZERODEBUG(0,("server_validate: [1] This is broken (and insecure) behaviour. Please do not \
 use this machine as the password server.\n"));
 			return False;
 		}
@@ -1195,7 +1195,7 @@
 {
 	mutex_server_name = strdup(name);
 	if (!mutex_server_name) {
-		DEBUG(0,("grab_server_mutex: malloc failed for %s\n", name));
+		ZERODEBUG(0,("grab_server_mutex: malloc failed for %s\n", name));
 		return False;
 	}
 	if (!secrets_named_mutex(name, 10)) {
@@ -1230,7 +1230,7 @@
 	*ppcli = NULL;
 
 	if(!(pcli = cli_initialise(NULL))) {
-		DEBUG(0,("connect_to_domain_password_server: unable to initialize client connection.\n"));
+		ZERODEBUG(0,("connect_to_domain_password_server: unable to initialize client connection.\n"));
 		return False;
 	}
 
@@ -1239,7 +1239,7 @@
 
 		/* we shouldn't have 255.255.255.255 forthe IP address of a password server anyways */
 		if ((to_ip.s_addr=inet_addr(server)) == 0xFFFFFFFF) {
-			DEBUG (0,("connect_to_domain_password_server: inet_addr(%s) returned 0xFFFFFFFF!\n", server));
+			ZERODEBUG (0,("connect_to_domain_password_server: inet_addr(%s) returned 0xFFFFFFFF!\n", server));
 			cli_shutdown(pcli);
 			return False;
 		}
@@ -1279,7 +1279,7 @@
 	}
 
 	if (!cli_connect(pcli, remote_machine, &dest_ip)) {
-		DEBUG(0,("connect_to_domain_password_server: unable to connect to SMB server on \
+		ZERODEBUG(0,("connect_to_domain_password_server: unable to connect to SMB server on \
 machine %s. Error was : %s.\n", remote_machine, cli_errstr(pcli) ));
 		cli_shutdown(pcli);
 		release_server_mutex();
@@ -1287,7 +1287,7 @@
 	}
   
 	if (!attempt_netbios_session_request(pcli, global_myname, remote_machine, &dest_ip)) {
-		DEBUG(0,("connect_to_password_server: machine %s rejected the NetBIOS \
+		ZERODEBUG(0,("connect_to_password_server: machine %s rejected the NetBIOS \
 session request. Error was : %s.\n", remote_machine, cli_errstr(pcli) ));
 		cli_shutdown(pcli);
 		release_server_mutex();
@@ -1297,7 +1297,7 @@
 	pcli->protocol = PROTOCOL_NT1;
 
 	if (!cli_negprot(pcli)) {
-		DEBUG(0,("connect_to_domain_password_server: machine %s rejected the negotiate protocol. \
+		ZERODEBUG(0,("connect_to_domain_password_server: machine %s rejected the negotiate protocol. \
 Error was : %s.\n", remote_machine, cli_errstr(pcli) ));
 		cli_shutdown(pcli);
 		release_server_mutex();
@@ -1305,7 +1305,7 @@
 	}
 
 	if (pcli->protocol != PROTOCOL_NT1) {
-		DEBUG(0,("connect_to_domain_password_server: machine %s didn't negotiate NT protocol.\n",
+		ZERODEBUG(0,("connect_to_domain_password_server: machine %s didn't negotiate NT protocol.\n",
 			remote_machine));
 		cli_shutdown(pcli);
 		release_server_mutex();
@@ -1317,7 +1317,7 @@
 	 */
 
 	if (!cli_session_setup(pcli, "", "", 0, "", 0, "")) {
-		DEBUG(0,("connect_to_domain_password_server: machine %s rejected the session setup. \
+		ZERODEBUG(0,("connect_to_domain_password_server: machine %s rejected the session setup. \
 Error was : %s.\n", remote_machine, cli_errstr(pcli) ));
 		cli_shutdown(pcli);
 		release_server_mutex();
@@ -1333,7 +1333,7 @@
 	}
 
 	if (!cli_send_tconX(pcli, "IPC$", "IPC", "", 1)) {
-		DEBUG(0,("connect_to_domain_password_server: machine %s rejected the tconX on the IPC$ share. \
+		ZERODEBUG(0,("connect_to_domain_password_server: machine %s rejected the tconX on the IPC$ share. \
 Error was : %s.\n", remote_machine, cli_errstr(pcli) ));
 		cli_shutdown(pcli);
 		release_server_mutex();
@@ -1354,7 +1354,7 @@
 	 */
 
 	if(cli_nt_session_open(pcli, PIPE_NETLOGON) == False) {
-		DEBUG(0,("connect_to_domain_password_server: unable to open the domain client session to \
+		ZERODEBUG(0,("connect_to_domain_password_server: unable to open the domain client session to \
 machine %s. Error was : %s.\n", remote_machine, cli_errstr(pcli)));
 		cli_nt_session_close(pcli);
 		cli_ulogoff(pcli);
@@ -1364,7 +1364,7 @@
 	}
 
 	if (!NT_STATUS_IS_OK(cli_nt_setup_creds(pcli, trust_passwd))) {
-		DEBUG(0,("connect_to_domain_password_server: unable to setup the PDC credentials to machine \
+		ZERODEBUG(0,("connect_to_domain_password_server: unable to setup the PDC credentials to machine \
 %s. Error was : %s.\n", remote_machine, cli_errstr(pcli)));
 		cli_nt_session_close(pcli);
 		cli_ulogoff(pcli);
@@ -1545,7 +1545,7 @@
 		 */
 
 		if (!last_challenge(local_challenge)) {
-			DEBUG(0,("domain_client_validate: no challenge done - password failed\n"));
+			ZERODEBUG(0,("domain_client_validate: no challenge done - password failed\n"));
 			return False;
 		}
 	}
@@ -1555,7 +1555,7 @@
 	 */
 
 	if (!secrets_fetch_trust_account_password(global_myworkgroup, trust_passwd, &last_change_time)) {
-		DEBUG(0, ("domain_client_validate: could not fetch trust account password for domain %s\n", global_myworkgroup));
+		ZERODEBUG(0, ("domain_client_validate: could not fetch trust account password for domain %s\n", global_myworkgroup));
 		return False;
 	}
 
@@ -1598,7 +1598,7 @@
 	}
 
 	if (!connected_ok) {
-		DEBUG(0,("domain_client_validate: Domain password server not available.\n"));
+		ZERODEBUG(0,("domain_client_validate: Domain password server not available.\n"));
 		if (pcli)
 			cli_shutdown(pcli);
 		release_server_mutex();
@@ -1617,7 +1617,7 @@
 
 	if (!NT_STATUS_IS_OK(status)) {
 
-		DEBUG(0,("domain_client_validate: unable to validate password for user %s in domain \
+		ZERODEBUG(0,("domain_client_validate: unable to validate password for user %s in domain \
 %s to Domain controller %s. Error was %s.\n", user, domain, remote_machine, get_nt_error_msg(status) ));
 		cli_nt_session_close(pcli);
 		cli_ulogoff(pcli);
@@ -1646,14 +1646,14 @@
 		*pptoken = NULL;
  
 		if ((ptok = (NT_USER_TOKEN *)malloc( sizeof(NT_USER_TOKEN) ) ) == NULL) {
-			DEBUG(0, ("domain_client_validate: Out of memory allocating NT_USER_TOKEN\n"));
+			ZERODEBUG(0, ("domain_client_validate: Out of memory allocating NT_USER_TOKEN\n"));
 			release_server_mutex();
 			return False;
 		}
  
 		ptok->num_sids = (size_t)info3.num_groups2 + info3.num_other_sids;
 		if ((ptok->user_sids = (DOM_SID *)malloc( sizeof(DOM_SID) * ptok->num_sids )) == NULL) {
-			DEBUG(0, ("domain_client_validate: Out of memory allocating group SIDS\n"));
+			ZERODEBUG(0, ("domain_client_validate: Out of memory allocating group SIDS\n"));
 			SAFE_FREE(ptok);
 			release_server_mutex();
 			return False;
@@ -1686,7 +1686,7 @@
 	 */
 
 	if(cli_nt_logoff(pcli, &ctr) == False) {
-		DEBUG(0,("domain_client_validate: unable to log off user %s in domain \
+		ZERODEBUG(0,("domain_client_validate: unable to log off user %s in domain \
 %s to Domain controller %s. Error was %s.\n", user, domain, remote_machine, cli_errstr(pcli)));        
 		cli_nt_session_close(pcli);
 		cli_ulogoff(pcli);
diff -Naur samba-2.2.12-orig/source/smbd/pipes.c samba-2.2.12/source/smbd/pipes.c
--- samba-2.2.12-orig/source/smbd/pipes.c	2004-08-12 20:24:21.000000000 +0200
+++ samba-2.2.12/source/smbd/pipes.c	2009-03-11 09:59:39.000000000 +0100
@@ -175,7 +175,7 @@
 			 * them (we don't trust the client. JRA.
 			 */
 	        if(numtowrite < 2) {
-				DEBUG(0,("reply_pipe_write_and_X: start of message set and not enough data sent.(%u)\n",
+				ZERODEBUG(0,("reply_pipe_write_and_X: start of message set and not enough data sent.(%u)\n",
 					(unsigned int)numtowrite ));
 				return (UNIXERROR(ERRDOS,ERRnoaccess));
 			}
diff -Naur samba-2.2.12-orig/source/smbd/posix_acls.c samba-2.2.12/source/smbd/posix_acls.c
--- samba-2.2.12-orig/source/smbd/posix_acls.c	2004-08-12 20:24:20.000000000 +0200
+++ samba-2.2.12/source/smbd/posix_acls.c	2009-03-11 09:59:39.000000000 +0100
@@ -449,7 +449,7 @@
 	*pgrp = (gid_t)-1;
 
 	if(security_info_sent == 0) {
-		DEBUG(0,("unpack_nt_owners: no security info sent !\n"));
+		ZERODEBUG(0,("unpack_nt_owners: no security info sent !\n"));
 		return True;
 	}
 
@@ -704,7 +704,7 @@
 
 	if (!got_user) {
 		if ((pace = (canon_ace *)malloc(sizeof(canon_ace))) == NULL) {
-			DEBUG(0,("ensure_canon_entry_valid: malloc fail.\n"));
+			ZERODEBUG(0,("ensure_canon_entry_valid: malloc fail.\n"));
 			return False;
 		}
 
@@ -739,7 +739,7 @@
 
 	if (!got_grp) {
 		if ((pace = (canon_ace *)malloc(sizeof(canon_ace))) == NULL) {
-			DEBUG(0,("ensure_canon_entry_valid: malloc fail.\n"));
+			ZERODEBUG(0,("ensure_canon_entry_valid: malloc fail.\n"));
 			return False;
 		}
 
@@ -769,7 +769,7 @@
 
 	if (!got_other) {
 		if ((pace = (canon_ace *)malloc(sizeof(canon_ace))) == NULL) {
-			DEBUG(0,("ensure_canon_entry_valid: malloc fail.\n"));
+			ZERODEBUG(0,("ensure_canon_entry_valid: malloc fail.\n"));
 			return False;
 		}
 
@@ -959,7 +959,7 @@
 		if ((current_ace = (canon_ace *)malloc(sizeof(canon_ace))) == NULL) {
 			free_canon_ace_list(file_ace);
 			free_canon_ace_list(dir_ace);
-			DEBUG(0,("create_canon_ace_lists: malloc fail.\n"));
+			ZERODEBUG(0,("create_canon_ace_lists: malloc fail.\n"));
 			return False;
 		}
 
@@ -1014,7 +1014,7 @@
 
 			free_canon_ace_list(file_ace);
 			free_canon_ace_list(dir_ace);
-			DEBUG(0,("create_canon_ace_lists: unable to map SID %s to uid or gid.\n",
+			ZERODEBUG(0,("create_canon_ace_lists: unable to map SID %s to uid or gid.\n",
 				sid_to_string(str, &current_ace->trustee) ));
 			SAFE_FREE(current_ace);
 			return False;
@@ -1055,7 +1055,7 @@
 					got_dir_allow = True;
 
 				if ((current_ace->attr == DENY_ACE) && got_dir_allow) {
-					DEBUG(0,("create_canon_ace_lists: malformed ACL in inheritable ACL ! \
+					ZERODEBUG(0,("create_canon_ace_lists: malformed ACL in inheritable ACL ! \
 Deny entry after Allow entry. Failing to set on file %s.\n", fsp->fsp_name ));
 					free_canon_ace_list(file_ace);
 					free_canon_ace_list(dir_ace);
@@ -1077,7 +1077,7 @@
 					canon_ace *dup_ace = dup_canon_ace(current_ace);
 
 					if (!dup_ace) {
-						DEBUG(0,("create_canon_ace_lists: malloc fail !\n"));
+						ZERODEBUG(0,("create_canon_ace_lists: malloc fail !\n"));
 						free_canon_ace_list(file_ace);
 						free_canon_ace_list(dir_ace);
 						return False;
@@ -1114,7 +1114,7 @@
 				got_file_allow = True;
 
 			if ((current_ace->attr == DENY_ACE) && got_file_allow) {
-				DEBUG(0,("create_canon_ace_lists: malformed ACL in file ACL ! \
+				ZERODEBUG(0,("create_canon_ace_lists: malformed ACL in file ACL ! \
 Deny entry after Allow entry. Failing to set on file %s.\n", fsp->fsp_name ));
 				free_canon_ace_list(file_ace);
 				free_canon_ace_list(dir_ace);
@@ -1488,7 +1488,7 @@
 	*ppdir_ace = NULL;
 
 	if(security_info_sent == 0) {
-		DEBUG(0,("unpack_canon_ace: no security info sent !\n"));
+		ZERODEBUG(0,("unpack_canon_ace: no security info sent !\n"));
 		return False;
 	}
 
@@ -1618,7 +1618,7 @@
 	}
 		
 	if (!owner_ace || !other_ace) {
-		DEBUG(0,("arrange_posix_perms: Invalid POSIX permissions for file %s, missing owner or other.\n",
+		ZERODEBUG(0,("arrange_posix_perms: Invalid POSIX permissions for file %s, missing owner or other.\n",
 			filename ));
 		return;
 	}
@@ -1688,7 +1688,7 @@
 				{
 					uid_t *puid = (uid_t *)conn->vfs_ops.sys_acl_get_qualifier(conn, entry);
 					if (puid == NULL) {
-						DEBUG(0,("canonicalise_acl: Failed to get uid.\n"));
+						ZERODEBUG(0,("canonicalise_acl: Failed to get uid.\n"));
 						continue;
 					}
 					/*
@@ -1716,7 +1716,7 @@
 				{
 					gid_t *pgid = (gid_t *)conn->vfs_ops.sys_acl_get_qualifier(conn, entry);
 					if (pgid == NULL) {
-						DEBUG(0,("canonicalise_acl: Failed to get gid.\n"));
+						ZERODEBUG(0,("canonicalise_acl: Failed to get gid.\n"));
 						continue;
 					}
 					gid_to_sid( &sid, *pgid);
@@ -1735,7 +1735,7 @@
 				owner_type = WORLD_ACE;
 				break;
 			default:
-				DEBUG(0,("canonicalise_acl: Unknown tagtype %u\n", (unsigned int)tagtype));
+				ZERODEBUG(0,("canonicalise_acl: Unknown tagtype %u\n", (unsigned int)tagtype));
 				continue;
 		}
 
@@ -1829,7 +1829,7 @@
 			 * Only print this error message if we have some kind of ACL
 			 * support that's not working. Otherwise we would always get this.
 			 */
-			DEBUG(0,("set_canon_ace_list: Unable to init %s ACL. (%s)\n",
+			ZERODEBUG(0,("set_canon_ace_list: Unable to init %s ACL. (%s)\n",
 				default_ace ? "default" : "file", strerror(errno) ));
 		}
 		*pacl_set_support = False;
@@ -1866,7 +1866,7 @@
 		 */
 
 		if (conn->vfs_ops.sys_acl_create_entry(conn, &the_acl, &the_entry) == -1) {
-			DEBUG(0,("set_canon_ace_list: Failed to create entry %d. (%s)\n",
+			ZERODEBUG(0,("set_canon_ace_list: Failed to create entry %d. (%s)\n",
 				i, strerror(errno) ));
 			goto done;
 		}
@@ -1892,7 +1892,7 @@
 		 */
 
 		if (conn->vfs_ops.sys_acl_set_tag_type(conn, the_entry, p_ace->type) == -1) {
-			DEBUG(0,("set_canon_ace_list: Failed to set tag type on entry %d. (%s)\n",
+			ZERODEBUG(0,("set_canon_ace_list: Failed to set tag type on entry %d. (%s)\n",
 				i, strerror(errno) ));
 			goto done;
 		}
@@ -1904,7 +1904,7 @@
 
 		if ((p_ace->type == SMB_ACL_USER) || (p_ace->type == SMB_ACL_GROUP)) {
 			if (conn->vfs_ops.sys_acl_set_qualifier(conn, the_entry,(void *)&p_ace->unix_ug.uid) == -1) {
-				DEBUG(0,("set_canon_ace_list: Failed to set qualifier on entry %d. (%s)\n",
+				ZERODEBUG(0,("set_canon_ace_list: Failed to set qualifier on entry %d. (%s)\n",
 					i, strerror(errno) ));
 				goto done;
 			}
@@ -1915,13 +1915,13 @@
 		 */
 
 		if (conn->vfs_ops.sys_acl_get_permset(conn, the_entry, &the_permset) == -1) {
-			DEBUG(0,("set_canon_ace_list: Failed to get permset on entry %d. (%s)\n",
+			ZERODEBUG(0,("set_canon_ace_list: Failed to get permset on entry %d. (%s)\n",
 				i, strerror(errno) ));
 			goto done;
 		}
 
 		if (map_acl_perms_to_permset(conn, p_ace->perms, &the_permset) == -1) {
-			DEBUG(0,("set_canon_ace_list: Failed to create permset for mode (%u) on entry %d. (%s)\n",
+			ZERODEBUG(0,("set_canon_ace_list: Failed to create permset for mode (%u) on entry %d. (%s)\n",
 				(unsigned int)p_ace->perms, i, strerror(errno) ));
 			goto done;
 		}
@@ -1931,7 +1931,7 @@
 		 */
 
 		if (conn->vfs_ops.sys_acl_set_permset(conn, the_entry, the_permset) == -1) {
-			DEBUG(0,("set_canon_ace_list: Failed to add permset on entry %d. (%s)\n",
+			ZERODEBUG(0,("set_canon_ace_list: Failed to add permset on entry %d. (%s)\n",
 				i, strerror(errno) ));
 			goto done;
 		}
@@ -1942,27 +1942,27 @@
 
 	if (needs_mask && !got_mask_entry) {
 		if (conn->vfs_ops.sys_acl_create_entry(conn, &the_acl, &mask_entry) == -1) {
-			DEBUG(0,("set_canon_ace_list: Failed to create mask entry. (%s)\n", strerror(errno) ));
+			ZERODEBUG(0,("set_canon_ace_list: Failed to create mask entry. (%s)\n", strerror(errno) ));
 			goto done;
 		}
 
 		if (conn->vfs_ops.sys_acl_set_tag_type(conn, mask_entry, SMB_ACL_MASK) == -1) {
-			DEBUG(0,("set_canon_ace_list: Failed to set tag type on mask entry. (%s)\n",strerror(errno) ));
+			ZERODEBUG(0,("set_canon_ace_list: Failed to set tag type on mask entry. (%s)\n",strerror(errno) ));
 			goto done;
 		}
 
 		if (conn->vfs_ops.sys_acl_get_permset(conn, mask_entry, &mask_permset) == -1) {
-			DEBUG(0,("set_canon_ace_list: Failed to get mask permset. (%s)\n", strerror(errno) ));
+			ZERODEBUG(0,("set_canon_ace_list: Failed to get mask permset. (%s)\n", strerror(errno) ));
 			goto done;
 		}
 
 		if (map_acl_perms_to_permset(conn, S_IRUSR|S_IWUSR|S_IXUSR, &mask_permset) == -1) {
-			DEBUG(0,("set_canon_ace_list: Failed to create mask permset. (%s)\n", strerror(errno) ));
+			ZERODEBUG(0,("set_canon_ace_list: Failed to create mask permset. (%s)\n", strerror(errno) ));
 			goto done;
 		}
 
 		if (conn->vfs_ops.sys_acl_set_permset(conn, mask_entry, mask_permset) == -1) {
-			DEBUG(0,("set_canon_ace_list: Failed to add mask permset. (%s)\n", strerror(errno) ));
+			ZERODEBUG(0,("set_canon_ace_list: Failed to add mask permset. (%s)\n", strerror(errno) ));
 			goto done;
 		}
 	}
@@ -1972,7 +1972,7 @@
 	 */
 
 	if (conn->vfs_ops.sys_acl_valid(conn, the_acl) == -1) {
-		DEBUG(0,("set_canon_ace_list: ACL type (%s) is invalid for set (%s).\n",
+		ZERODEBUG(0,("set_canon_ace_list: ACL type (%s) is invalid for set (%s).\n",
 				the_acl_type == SMB_ACL_TYPE_DEFAULT ? "directory default" : "file",
 				strerror(errno) ));
 		goto done;
@@ -2286,7 +2286,7 @@
 	/* We must have *some* ACLS. */
 
 	if (count_canon_ace_list(file_ace) == 0) {
-		DEBUG(0,("get_nt_acl : No ACLs on file (%s) !\n", fsp->fsp_name ));
+		ZERODEBUG(0,("get_nt_acl : No ACLs on file (%s) !\n", fsp->fsp_name ));
 		return 0;
 	}
 
@@ -2388,7 +2388,7 @@
 
 		/* Allocate the ace list. */
 		if ((nt_ace_list = (SEC_ACE *)malloc((num_acls + num_profile_acls + num_dir_acls)* sizeof(SEC_ACE))) == NULL) {
-			DEBUG(0,("get_nt_acl: Unable to malloc space for nt_ace_list.\n"));
+			ZERODEBUG(0,("get_nt_acl: Unable to malloc space for nt_ace_list.\n"));
 			goto done;
 		}
 
@@ -2453,7 +2453,7 @@
 
 	if (num_aces) {
 		if((psa = make_sec_acl( main_loop_talloc_get(), ACL_REVISION, num_aces, nt_ace_list)) == NULL) {
-			DEBUG(0,("get_nt_acl: Unable to malloc space for acl.\n"));
+			ZERODEBUG(0,("get_nt_acl: Unable to malloc space for acl.\n"));
 			goto done;
 		}
 	}
@@ -2461,7 +2461,7 @@
 	*ppdesc = make_standard_sec_desc( main_loop_talloc_get(), &owner_sid, &group_sid, psa, &sd_size);
 
 	if(!*ppdesc) {
-		DEBUG(0,("get_nt_acl: Unable to malloc space for security descriptor.\n"));
+		ZERODEBUG(0,("get_nt_acl: Unable to malloc space for security descriptor.\n"));
 		sd_size = 0;
 	} else {
 		/*
diff -Naur samba-2.2.12-orig/source/smbd/process.c samba-2.2.12/source/smbd/process.c
--- samba-2.2.12-orig/source/smbd/process.c	2004-08-12 20:24:20.000000000 +0200
+++ samba-2.2.12/source/smbd/process.c	2009-03-11 09:59:39.000000000 +0100
@@ -78,14 +78,14 @@
 
   if(msg == NULL)
   {
-    DEBUG(0,("push_message: malloc fail (1)\n"));
+    ZERODEBUG(0,("push_message: malloc fail (1)\n"));
     return False;
   }
 
   msg->msg_buf = (char *)malloc(msg_len);
   if(msg->msg_buf == NULL)
   {
-    DEBUG(0,("push_message: malloc fail (2)\n"));
+    ZERODEBUG(0,("push_message: malloc fail (2)\n"));
     SAFE_FREE(msg);
     return False;
   }
@@ -309,7 +309,7 @@
    */
 
   if(get_number_of_exclusive_open_oplocks()) {
-    DEBUG(0,("respond_to_all_remaining_local_messages: PANIC : we have %d exclusive oplocks.\n",
+    ZERODEBUG(0,("respond_to_all_remaining_local_messages: PANIC : we have %d exclusive oplocks.\n",
           get_number_of_exclusive_open_oplocks() ));
     return;
   }
@@ -632,9 +632,9 @@
 	if (fd != -1) {
 		ssize_t ret = write(fd, data, len);
 		if (ret != len)
-			DEBUG(0,("smb_dump: problem: write returned %d\n", (int)ret ));
+			ZERODEBUG(0,("smb_dump: problem: write returned %d\n", (int)ret ));
 		close(fd);
-		DEBUG(0,("created %s len %d\n", fname, len));
+		ZERODEBUG(0,("created %s len %d\n", fname, len));
 	}
 }
 
@@ -659,7 +659,7 @@
 
   /* make sure this is an SMB packet. smb_size contains NetBIOS header so subtract 4 from it. */
   if ((strncmp(smb_base(inbuf),"\377SMB",4) != 0) || (size < (smb_size-4))) {
-    DEBUG(0,("Non-SMB packet of length %d. Terminating server\n",smb_len(inbuf)));
+    ZERODEBUG(0,("Non-SMB packet of length %d. Terminating server\n",smb_len(inbuf)));
     exit_server("Non-SMB packet");
     return(-1);
   }
@@ -670,7 +670,7 @@
 
   if (smb_messages[type].fn == NULL)
   {
-    DEBUG(0,("Unknown message type %d!\n",type));
+    ZERODEBUG(0,("Unknown message type %d!\n",type));
     smb_dump("Unknown", 1, inbuf, size);
     outsize = reply_unknown(inbuf,outbuf);
   }
@@ -871,7 +871,7 @@
 	
     if (nread != smb_len(outbuf) + 4) 
     {
-      DEBUG(0,("ERROR: Invalid message response size! %d %d\n",
+      ZERODEBUG(0,("ERROR: Invalid message response size! %d %d\n",
                  nread, smb_len(outbuf)));
     }
     else
@@ -1141,13 +1141,13 @@
      */
 
     if (secrets_lock_trust_account_password(global_myworkgroup, True) == False) {
-      DEBUG(0,("process: unable to lock the machine account password for \
+      ZERODEBUG(0,("process: unable to lock the machine account password for \
 machine %s in domain %s.\n", global_myname, global_myworkgroup ));
       return True;
     }
 
     if(!secrets_fetch_trust_account_password(global_myworkgroup, trust_passwd_hash, &lct)) {
-      DEBUG(0,("process: unable to read the machine account password for \
+      ZERODEBUG(0,("process: unable to read the machine account password for \
 machine %s in domain %s.\n", global_myname, global_myworkgroup ));
       secrets_lock_trust_account_password(global_myworkgroup, False);
       return True;
diff -Naur samba-2.2.12-orig/source/smbd/reply.c samba-2.2.12/source/smbd/reply.c
--- samba-2.2.12-orig/source/smbd/reply.c	2004-08-12 20:25:49.000000000 +0200
+++ samba-2.2.12/source/smbd/reply.c	2009-03-11 13:35:08.000000000 +0100
@@ -47,7 +47,7 @@
 
 static void overflow_attack(int len)
 {
-	if( DEBUGLVL( 0 ) ) {
+	if( ZERODEBUGLVL( 0 ) ) {
 		dbgtext( "ERROR: Invalid password length %d.\n", len );
 		dbgtext( "Your machine may be under attack by someone " );
 		dbgtext( "attempting to exploit an old bug.\n" );
@@ -83,7 +83,7 @@
 		SCVAL(outbuf,3,0);
 		if (name_len(inbuf+4) > 50 || 
 		    name_len(inbuf+4 + name_len(inbuf + 4)) > 50) {
-			DEBUG(0,("Invalid name length in session request\n"));
+			ZERODEBUG(0,("Invalid name length in session request\n"));
 			return(0);
 		}
 		name_extract(inbuf,4,name1);
@@ -140,7 +140,7 @@
 	case 0x82: /* positive session response */
 	case 0x83: /* negative session response */
 	case 0x84: /* retarget session response */
-		DEBUG(0,("Unexpected session response\n"));
+		ZERODEBUG(0,("Unexpected session response\n"));
 		break;
 		
 	case 0x85: /* session keepalive */
@@ -411,7 +411,7 @@
 	int type;
 	type = CVAL(inbuf,smb_com);
   
-	DEBUG(0,("unknown command type (%s): type=%d (0x%X)\n",
+	ZERODEBUG(0,("unknown command type (%s): type=%d (0x%X)\n",
 		 smb_fn_name(type), type, type));
   
 	return(ERROR_DOS(ERRSRV,ERRunknownsmb));
@@ -478,36 +478,36 @@
 		pdb_init_sam(&sam_trust_acct);
 		pdb_getsampwnam(sam_trust_acct, user);
 	} else {
-		DEBUG(0,("session_trust_account: Trust account %s only supported with security = user\n", user));
+		ZERODEBUG(0,("session_trust_account: Trust account %s only supported with security = user\n", user));
 		return(ERROR_BOTH(NT_STATUS_LOGON_FAILURE,ERRSRV,ERRbadpw));
 	}
 
 	if (sam_trust_acct == NULL) {
 		/* lkclXXXX: workstation entry doesn't exist */
-		DEBUG(0,("session_trust_account: Trust account %s user doesn't exist\n",user));
+		ZERODEBUG(0,("session_trust_account: Trust account %s user doesn't exist\n",user));
 		return(ERROR_BOTH(NT_STATUS_NO_SUCH_USER,ERRDOS,1317));
 	} else {
 		if ((smb_passlen != 24) || (smb_nt_passlen != 24)) {
-			DEBUG(0,("session_trust_account: Trust account %s - password length wrong.\n", user));
+			ZERODEBUG(0,("session_trust_account: Trust account %s - password length wrong.\n", user));
 			pdb_free_sam(sam_trust_acct);
 			return(ERROR_BOTH(NT_STATUS_LOGON_FAILURE,ERRSRV,ERRbadpw));
 		}
 
 		if (!smb_password_ok(sam_trust_acct, NULL, (unsigned char *)smb_passwd, (unsigned char *)smb_nt_passwd)) {
-			DEBUG(0,("session_trust_account: Trust Account %s - password failed\n", user));
+			ZERODEBUG(0,("session_trust_account: Trust Account %s - password failed\n", user));
 			pdb_free_sam(sam_trust_acct);
 			return(ERROR_BOTH(NT_STATUS_LOGON_FAILURE,ERRSRV,ERRbadpw));
 		}
 
 		acct_ctrl = pdb_get_acct_ctrl(sam_trust_acct);
 		if (acct_ctrl & ACB_DOMTRUST) {
-			DEBUG(0,("session_trust_account: Domain trust account %s denied by server\n",user));
+			ZERODEBUG(0,("session_trust_account: Domain trust account %s denied by server\n",user));
 			pdb_free_sam(sam_trust_acct);
 			return(ERROR_BOTH(NT_STATUS_NOLOGON_INTERDOMAIN_TRUST_ACCOUNT,ERRDOS,1807));
 		}
 
 		if (acct_ctrl & ACB_SVRTRUST) {
-			DEBUG(0,("session_trust_account: Server trust account %s denied by server\n",user));
+			ZERODEBUG(0,("session_trust_account: Server trust account %s denied by server\n",user));
 			pdb_free_sam(sam_trust_acct);
 			return(ERROR_BOTH(NT_STATUS_NOLOGON_SERVER_TRUST_ACCOUNT,ERRDOS,1809));
 		}
@@ -558,7 +558,7 @@
 	 */
 
 	if (StrCaseCmp("root", unix_user) == 0) {
-		DEBUG(0,("smb_delete_user: Will not delete the [%s] user account!\n", unix_user));
+		ZERODEBUG(0,("smb_delete_user: Will not delete the [%s] user account!\n", unix_user));
 		return -1;
 	}
 
@@ -824,9 +824,9 @@
       dump_data(100, p, 0x70);
       DEBUG(9, ("passlen1=%d, passlen2=%d\n", passlen1, passlen2));
       if (ra_type == RA_WIN95 && !passlen1 && !passlen2 && p[0] == 0 && p[1] == 0) {
-        DEBUG(0, ("restrict anonymous parameter used in a win95 environment!\n"));
-        DEBUG(0, ("client is win95 and broken passlen1 offset -- attempting fix\n"));
-        DEBUG(0, ("if win95 cilents are having difficulty browsing, you will be unable to use restrict anonymous\n"));
+        ZERODEBUG(0, ("restrict anonymous parameter used in a win95 environment!\n"));
+        ZERODEBUG(0, ("client is win95 and broken passlen1 offset -- attempting fix\n"));
+        ZERODEBUG(0, ("if win95 cilents are having difficulty browsing, you will be unable to use restrict anonymous\n"));
         passlen1 = 1;
       }
     }
@@ -909,7 +909,7 @@
      * anonymous connection. AAB
      */
     if (!*user && !*smb_apasswd && !*domain) {
-      DEBUG(0, ("restrict anonymous is True and anonymous connection attempted. Denying access.\n"));
+      ZERODEBUG(0, ("restrict anonymous is True and anonymous connection attempted. Denying access.\n"));
       END_PROFILE(SMBsesssetupX);
       return(ERROR_DOS(ERRDOS,ERRnoaccess));
     }
@@ -1843,7 +1843,7 @@
   unix_convert(fname,conn,0,&bad_path,&sbuf);
 
   if (createmode & aVOLID) {
-      DEBUG(0,("Attempt to create file (%s) with volid set - please report this\n",fname));
+      ZERODEBUG(0,("Attempt to create file (%s) with volid set - please report this\n",fname));
   }
   
   unixmode = unix_mode(conn,createmode,fname);
@@ -2235,7 +2235,7 @@
 			if (errno == ENOSYS)
 				goto normal_read;
 
-			DEBUG(0,("send_file_readbraw: sendfile failed for file %s (%s). Terminating\n",
+			ZERODEBUG(0,("send_file_readbraw: sendfile failed for file %s (%s). Terminating\n",
 				fsp->fsp_name, strerror(errno) ));
 			exit_server("send_file_readbraw sendfile failed");
 		}
@@ -2318,7 +2318,7 @@
 		 */
 
 		if(IVAL(inbuf,smb_vwv8) != 0) {
-			DEBUG(0,("readbraw - large offset (%x << 32) used and we don't support \
+			ZERODEBUG(0,("readbraw - large offset (%x << 32) used and we don't support \
 64 bit offsets.\n", (unsigned int)IVAL(inbuf,smb_vwv8) ));
 			_smb_setlen(header,0);
 			if (write_data(smbd_server_fd(),header,4) != 4)
@@ -2330,7 +2330,7 @@
 #endif /* LARGE_SMB_OFF_T */
 
 		if(startpos < 0) {
-			DEBUG(0,("readbraw - negative 64 bit readraw offset (%.0f) !\n", (double)startpos ));
+			ZERODEBUG(0,("readbraw - negative 64 bit readraw offset (%.0f) !\n", (double)startpos ));
 			_smb_setlen(header,0);
 			if (write_data(smbd_server_fd(),header,4) != 4)
 				fail_readraw();
@@ -2553,7 +2553,7 @@
 			if (errno == ENOSYS)
 				goto normal_read;
 
-			DEBUG(0,("send_file_readX: sendfile failed for file %s (%s). Terminating\n",
+			ZERODEBUG(0,("send_file_readX: sendfile failed for file %s (%s). Terminating\n",
 				fsp->fsp_name, strerror(errno) ));
 			exit_server("send_file_readX sendfile failed");
 		}
@@ -2626,7 +2626,7 @@
 		 */
 
 		if(IVAL(inbuf,smb_vwv10) != 0) {
-			DEBUG(0,("reply_read_and_X - large offset (%x << 32) used and we don't support \
+			ZERODEBUG(0,("reply_read_and_X - large offset (%x << 32) used and we don't support \
 64 bit offsets.\n", (unsigned int)IVAL(inbuf,smb_vwv10) ));
 			END_PROFILE(SMBreadX);
 			return ERROR_DOS(ERRDOS,ERRbadaccess);
@@ -2728,7 +2728,7 @@
 	if (numtowrite != 0) {
 
 		if (numtowrite > BUFFER_SIZE) {
-			DEBUG(0,("reply_writebraw: Oversize secondary write raw requested (%u). Terminating\n",
+			ZERODEBUG(0,("reply_writebraw: Oversize secondary write raw requested (%u). Terminating\n",
 				(unsigned int)numtowrite ));
 			exit_server("secondary writebraw failed");
 		}
@@ -2739,7 +2739,7 @@
 		}
 
 		if (read_data( smbd_server_fd(), inbuf+4, numtowrite) != numtowrite ) {
-			DEBUG(0,("reply_writebraw: Oversize secondary write raw read failed (%s). Terminating\n",
+			ZERODEBUG(0,("reply_writebraw: Oversize secondary write raw read failed (%s). Terminating\n",
 				strerror(errno) ));
 			exit_server("secondary writebraw failed");
 		}
@@ -2967,7 +2967,7 @@
      */
 
     if(IVAL(inbuf,smb_vwv12) != 0) {
-      DEBUG(0,("reply_write_and_X - large offset (%x << 32) used and we don't support \
+      ZERODEBUG(0,("reply_write_and_X - large offset (%x << 32) used and we don't support \
 64 bit offsets.\n", (unsigned int)IVAL(inbuf,smb_vwv12) ));
       END_PROFILE(SMBwriteX);
       return ERROR_DOS(ERRDOS,ERRbadaccess);
@@ -3397,7 +3397,7 @@
 		memcpy(smb_buf(outbuf),smb_buf(inbuf),data_len);
 
 	if (smb_reverb > 100) {
-		DEBUG(0,("large reverb (%d)?? Setting to 100\n",smb_reverb));
+		ZERODEBUG(0,("large reverb (%d)?? Setting to 100\n",smb_reverb));
 		smb_reverb = 100;
 	}
 
@@ -4234,7 +4234,7 @@
 
 	if ((ofun&3) == 1) {
 		if(conn->vfs_ops.lseek(fsp2,fsp2->fd,0,SEEK_END) == -1) {
-			DEBUG(0,("copy_file: error - vfs lseek returned error %s\n", strerror(errno) ));
+			ZERODEBUG(0,("copy_file: error - vfs lseek returned error %s\n", strerror(errno) ));
 			/*
 			 * Stop the copy from occurring.
 			 */
@@ -4651,7 +4651,7 @@
 		 */
 
 		if(!EXCLUSIVE_OPLOCK_TYPE(fsp->oplock_type)) {
-			DEBUG(0,("reply_lockingX: Error : oplock break from client for fnum = %d and \
+			ZERODEBUG(0,("reply_lockingX: Error : oplock break from client for fnum = %d and \
 no oplock granted on this file (%s).\n", fsp->fnum, fsp->fsp_name));
 
 			/* if this is a pure oplock break request then don't send a reply */
@@ -4665,7 +4665,7 @@
 		}
 
 		if (remove_oplock(fsp, break_to_none) == False) {
-			DEBUG(0,("reply_lockingX: error in removing oplock on file %s\n",
+			ZERODEBUG(0,("reply_lockingX: error in removing oplock on file %s\n",
 				fsp->fsp_name ));
 		}
 
@@ -4674,7 +4674,7 @@
 			/* Sanity check - ensure a pure oplock break is not a
 				chained request. */
 			if(CVAL(inbuf,smb_vwv0) != 0xff)
-				DEBUG(0,("reply_lockingX: Error : pure oplock break is a chained %d request !\n",
+				ZERODEBUG(0,("reply_lockingX: Error : pure oplock break is a chained %d request !\n",
 					(unsigned int)CVAL(inbuf,smb_vwv0) ));
 			END_PROFILE(SMBlockingX);
 			return -1;
@@ -4993,7 +4993,7 @@
 			wbms = (write_bmpx_struct *)malloc(sizeof(write_bmpx_struct));
 
 		if(!wbms) {
-			DEBUG(0,("Out of memory in reply_readmpx\n"));
+			ZERODEBUG(0,("Out of memory in reply_readmpx\n"));
 			END_PROFILE(SMBwriteBmpx);
 			return(ERROR_DOS(ERRSRV,ERRnoresource));
 		}
diff -Naur samba-2.2.12-orig/source/smbd/sec_ctx.c samba-2.2.12/source/smbd/sec_ctx.c
--- samba-2.2.12-orig/source/smbd/sec_ctx.c	2004-08-12 20:24:21.000000000 +0200
+++ samba-2.2.12/source/smbd/sec_ctx.c	2009-03-11 09:59:39.000000000 +0100
@@ -112,7 +112,7 @@
 		set_effective_uid(0);
 
 		if (geteuid() != 0) {
-			DEBUG(0,
+			ZERODEBUG(0,
 			      ("Warning: You appear to have a trapdoor "
 			       "uid system\n"));
 		}
@@ -122,7 +122,7 @@
 		set_effective_gid(0);
 
 		if (getegid() != 0) {
-			DEBUG(0,
+			ZERODEBUG(0,
 			      ("Warning: You appear to have a trapdoor "
 			       "gid system\n"));
 		}
@@ -156,7 +156,7 @@
 	}
 
 	if((groups = (gid_t *)malloc(sizeof(gid_t)*(ngroups+1))) == NULL) {
-		DEBUG(0,("setup_groups malloc fail !\n"));
+		ZERODEBUG(0,("setup_groups malloc fail !\n"));
 		goto fail;
 	}
 
@@ -241,10 +241,10 @@
 	/* Call initgroups() to get user groups */
 
 	if (winbind_initgroups(user,gid) == -1) {
-		DEBUG(0,("Unable to initgroups. Error was %s\n", strerror(errno) ));
+		ZERODEBUG(0,("Unable to initgroups. Error was %s\n", strerror(errno) ));
 		if (getuid() == 0) {
 			if (gid < 0 || gid > 32767 || uid < 0 || uid > 32767) {
-				DEBUG(0,("This is probably a problem with the account %s\n", user));
+				ZERODEBUG(0,("This is probably a problem with the account %s\n", user));
 			}
 		}
 		result = False;
@@ -280,7 +280,7 @@
 	/* Check we don't overflow our stack */
 
 	if (sec_ctx_stack_ndx == MAX_SEC_CTX_DEPTH) {
-		DEBUG(0, ("Security context stack overflow!\n"));
+		ZERODEBUG(0, ("Security context stack overflow!\n"));
 		smb_panic("Security context stack overflow!\n");
 	}
 
@@ -302,7 +302,7 @@
 
 	if (ctx_p->ngroups != 0) {
 		if (!(ctx_p->groups = malloc(ctx_p->ngroups * sizeof(gid_t)))) {
-			DEBUG(0, ("Out of memory in push_sec_ctx()\n"));
+			ZERODEBUG(0, ("Out of memory in push_sec_ctx()\n"));
 			delete_nt_token(&ctx_p->token);
 			return False;
 		}
@@ -394,7 +394,7 @@
 	/* Check for stack underflow */
 
 	if (sec_ctx_stack_ndx == 0) {
-		DEBUG(0, ("Security context stack underflow!\n"));
+		ZERODEBUG(0, ("Security context stack underflow!\n"));
 		smb_panic("Security context stack underflow!\n");
 	}
 
diff -Naur samba-2.2.12-orig/source/smbd/server.c samba-2.2.12/source/smbd/server.c
--- samba-2.2.12-orig/source/smbd/server.c	2004-08-12 20:24:21.000000000 +0200
+++ samba-2.2.12/source/smbd/server.c	2009-03-11 13:48:39.000000000 +0100
@@ -129,18 +129,18 @@
 		TDB_CONTEXT *tdb = conn_tdb_ctx();
 		int32 val;
 		if (!tdb) {
-			DEBUG(0,("allowable_number_of_smbd_processes: can't open connection tdb.\n" ));
+			ZERODEBUG(0,("allowable_number_of_smbd_processes: can't open connection tdb.\n" ));
 			return False;
 		}
 
 		val = tdb_fetch_int32(tdb, "INFO/total_smbds");
 		if (val == -1 && (tdb_error(tdb) != TDB_ERR_NOEXIST)) {
-			DEBUG(0,("allowable_number_of_smbd_processes: can't fetch INFO/total_smbds. Error %s\n",
+			ZERODEBUG(0,("allowable_number_of_smbd_processes: can't fetch INFO/total_smbds. Error %s\n",
 				tdb_errorstr(tdb) ));
 			return False;
 		}
 		if (val > max_processes) {
-			DEBUG(0,("allowable_number_of_smbd_processes: number of processes (%d) is over allowed limit (%d)\n",
+			ZERODEBUG(0,("allowable_number_of_smbd_processes: number of processes (%d) is over allowed limit (%d)\n",
 				val, max_processes ));
 			return False;
 		}
@@ -188,7 +188,7 @@
 		*/
 		
 		if(num_interfaces > FD_SETSIZE) {
-			DEBUG(0,("open_sockets: Too many interfaces specified to bind to. Number was %d \
+			ZERODEBUG(0,("open_sockets: Too many interfaces specified to bind to. Number was %d \
 max can be %d\n", 
 				 num_interfaces, FD_SETSIZE));
 			return False;
@@ -200,7 +200,7 @@
 			struct in_addr *ifip = iface_n_ip(i);
 			
 			if(ifip == NULL) {
-				DEBUG(0,("open_sockets: interface %d has NULL IP address !\n", i));
+				ZERODEBUG(0,("open_sockets: interface %d has NULL IP address !\n", i));
 				continue;
 			}
 			s = fd_listenset[i] = open_socket_in(SOCK_STREAM, port, 0, ifip->s_addr, True);
@@ -212,7 +212,7 @@
 			set_socket_options(s,user_socket_options);
 
 			if (listen(s, 5) == -1) {
-				DEBUG(0,("listen: %s\n",strerror(errno)));
+				ZERODEBUG(0,("listen: %s\n",strerror(errno)));
 				close(s);
 				return False;
 			}
@@ -234,7 +234,7 @@
 		set_socket_options(s,user_socket_options);
 
 		if (listen(s, 5) == -1) {
-			DEBUG(0,("open_sockets: listen: %s\n",
+			ZERODEBUG(0,("open_sockets: listen: %s\n",
 				 strerror(errno)));
 			close(s);
 			return False;
@@ -269,7 +269,7 @@
 
 			/* check for sighup processing */
 			if (reload_after_sighup) {
-				DEBUG(0,("Got SIGHUP\n"));
+				ZERODEBUG(0,("Got SIGHUP\n"));
 				change_to_root_user();
 				DEBUG(1,("Reloading services after SIGHUP\n"));
 				reload_services(False);
@@ -305,7 +305,7 @@
 				continue;
 			
 			if (smbd_server_fd() == -1) {
-				DEBUG(0,("open_sockets: accept: %s\n",
+				ZERODEBUG(0,("open_sockets: accept: %s\n",
 					 strerror(errno)));
 				continue;
 			}
@@ -458,7 +458,7 @@
 #endif
 
 
-	DEBUG(0,("Dumping core in %s\n",dname));
+	ZERODEBUG(0,("Dumping core in %s\n",dname));
 	abort();
 	return(True);
 }
@@ -529,12 +529,12 @@
 
 	if (!reason) {   
 		int oldlevel = DEBUGLEVEL;
-		DEBUGLEVEL = 10;
-		DEBUG(0,("Last message was %s\n",smb_fn_name(last_message)));
+		DEBUGLEVEL = 0;
+		ZERODEBUG(0,("Last message was %s\n",smb_fn_name(last_message)));
 		if (last_inbuf)
 			show_msg(last_inbuf);
 		DEBUGLEVEL = oldlevel;
-		DEBUG(0,("===============================================================\n"));
+		ZERODEBUG(0,("===============================================================\n"));
 #if DUMP_CORE
 		if (dump_core()) return;
 #endif
@@ -596,7 +596,7 @@
 		 */
 
 		if (!conn_tdb_ctx()) {
-			DEBUG(0,("smbd_process_limit: max smbd processes parameter set with status parameter not \
+			ZERODEBUG(0,("smbd_process_limit: max smbd processes parameter set with status parameter not \
 set. Ignoring max smbd restriction.\n"));
 			return False;
 		}
@@ -616,7 +616,7 @@
 static void usage(char *pname)
 {
 
-	printf("Usage: %s [-DaioPh?V] [-d debuglevel] [-l log basename] [-p port]\n", pname);
+	printf("Usage: %s [-DaioPh?V] [-l log basename] [-p port]\n", pname);
 	printf("       [-O socket options] [-s services file]\n");
 	printf("\t-D                    Become a daemon (default)\n");
 	printf("\t-a                    Append to log file (default)\n");
@@ -625,7 +625,6 @@
 	printf("\t-h                    Print usage\n");
 	printf("\t-?                    Print usage\n");
 	printf("\t-V                    Print version\n");
-	printf("\t-d debuglevel         Set the debuglevel\n");
 	printf("\t-l log basename.      Basename for log/debug files\n");
 	printf("\t-p port               Listen on the specified port\n");
 	printf("\t-O socket options     Socket options\n");
@@ -694,9 +693,9 @@
 
 		case 'd':
 			if (*optarg == 'A')
-				DEBUGLEVEL = 10000;
+				DEBUGLEVEL = 0;
 			else
-				DEBUGLEVEL = atoi(optarg);
+				DEBUGLEVEL = 0;
 			AllowDebugChange = False;
 			break;
 
@@ -715,7 +714,7 @@
 			exit(0);
 			break;
 		default:
-			DEBUG(0,("Incorrect program usage - are you sure the command line is correct?\n"));
+			ZERODEBUG(0,("Incorrect program usage - are you sure the command line is correct?\n"));
 			usage(argv[0]);
 			exit(1);
 		}
@@ -788,14 +787,14 @@
 
 	reopen_logs();
 
-	DEBUG(0,( "smbd version %s started.\n", VERSION));
-	DEBUGADD(0,( "Copyright Andrew Tridgell and the Samba Team 1992-2002\n"));
+	ZERODEBUG(0,( "smbd version %s started.\n", VERSION));
+	ZERODEBUGADD(0,( "Copyright Andrew Tridgell and the Samba Team 1992-2002\n"));
 
 	DEBUG(2,("uid=%d gid=%d euid=%d egid=%d\n",
 		 (int)getuid(),(int)getgid(),(int)geteuid(),(int)getegid()));
 
 	if (sizeof(uint16) < 2 || sizeof(uint32) < 4) {
-		DEBUG(0,("ERROR: Samba is not configured correctly for the word size on your machine\n"));
+		ZERODEBUG(0,("ERROR: Samba is not configured correctly for the word size on your machine\n"));
 		exit(1);
 	}
 
@@ -810,7 +809,7 @@
 	
 #ifdef WITH_PROFILE
 	if (!profile_setup(False)) {
-		DEBUG(0,("ERROR: failed to setup profiling shared memory\n"));
+		ZERODEBUG(0,("ERROR: failed to setup profiling shared memory\n"));
 		return -1;
 	}
 #endif /* WITH_PROFILE */
@@ -832,7 +831,7 @@
 
 	if (!is_daemon && !is_a_socket(0)) {
 		if (!interactive)
-			DEBUG(0,("standard input is not a socket, assuming -D option\n"));
+			ZERODEBUG(0,("standard input is not a socket, assuming -D option\n"));
 
 		/*
 		 * Setting is_daemon here prevents us from eventually calling
@@ -871,10 +870,10 @@
 
 	/* Attempt to migrate from an old 2.0.x machine account file. */
 	if (!migrate_from_old_password_file(global_myworkgroup))
-		DEBUG(0,("Failed to migrate from old MAC file.\n"));
+		ZERODEBUG(0,("Failed to migrate from old MAC file.\n"));
 
 	if(!pdb_generate_sam_sid()) {
-		DEBUG(0,("ERROR: Samba cannot create a SAM SID.\n"));
+		ZERODEBUG(0,("ERROR: Samba cannot create a SAM SID.\n"));
 		exit(1);
 	}
 
diff -Naur samba-2.2.12-orig/source/smbd/service.c samba-2.2.12/source/smbd/service.c
--- samba-2.2.12-orig/source/smbd/service.c	2004-08-12 20:24:20.000000000 +0200
+++ samba-2.2.12/source/smbd/service.c	2009-03-11 09:59:39.000000000 +0100
@@ -56,7 +56,7 @@
 	if (do_chdir &&
 	    vfs_ChDir(conn,conn->connectpath) != 0 &&
 	    vfs_ChDir(conn,conn->origpath) != 0) {
-		DEBUG(0,("chdir (%s) failed\n",
+		ZERODEBUG(0,("chdir (%s) failed\n",
 			 conn->connectpath));
 		return(False);
 	}
@@ -161,7 +161,7 @@
             lp_add_printer(service,iPrinterService);
             iService = lp_servicenumber(service);
             if (iService < 0)
-               DEBUG(0,("failed to add %s as a printer service!\n", service));
+               ZERODEBUG(0,("failed to add %s as a printer service!\n", service));
          }
          else
             DEBUG(3,("%s is not a valid printer name\n", service));
@@ -201,7 +201,7 @@
    if (iService >= 0)
      if (!VALID_SNUM(iService))
      {
-       DEBUG(0,("Invalid snum %d for %s\n",iService,service));
+       ZERODEBUG(0,("Invalid snum %d for %s\n",iService,service));
        iService = -1;
      }
 
@@ -234,7 +234,7 @@
 	/* This must ONLY BE CALLED AS ROOT. As it exits this function as root. */
 
 	if (!non_root_mode() && ((euid = geteuid()) != 0)) {
-		DEBUG(0,("make_connection: PANIC ERROR. Called as nonroot (%u)\n", (unsigned int)euid ));
+		ZERODEBUG(0,("make_connection: PANIC ERROR. Called as nonroot (%u)\n", (unsigned int)euid ));
 		smb_panic("make_connection: PANIC ERROR. Called as nonroot\n");
 	}
 
@@ -248,7 +248,7 @@
 			return NULL;
 		}
 
-		DEBUG(0,("%s (%s) couldn't find service %s\n",
+		ZERODEBUG(0,("%s (%s) couldn't find service %s\n",
 			 remote_machine, client_addr(), service));
 		*ecode = ERRnosuchshare;
 		return NULL;
@@ -337,7 +337,7 @@
 		
 	conn = conn_new();
 	if (!conn) {
-		DEBUG(0,("Couldn't find free connection.\n"));
+		ZERODEBUG(0,("Couldn't find free connection.\n"));
 		*ecode = ERRnoresource;
 		return NULL;
 	}
@@ -346,7 +346,7 @@
 	pass = smb_getpwnam(user,True);
 
 	if (pass == NULL) {
-		DEBUG(0,( "Couldn't find account %s\n",user));
+		ZERODEBUG(0,( "Couldn't find account %s\n",user));
 		*ecode = ERRbaduid;
 		conn_free(conn);
 		return NULL;
@@ -378,7 +378,7 @@
 	
 	if (user_in_list(user,lp_admin_users(snum)) ) {
 		conn->admin_user = True;
-		DEBUG(0,("make_connection: %s logged in as admin user (root privileges)\n",user));
+		ZERODEBUG(0,("make_connection: %s logged in as admin user (root privileges)\n",user));
 	} else
 		conn->admin_user = False;
     
@@ -524,7 +524,7 @@
 			if (!share_access_check(conn, snum, vuid, FILE_READ_DATA)) {
 				/* No access, read or write. */
 				*ecode = ERRaccess;
-				DEBUG(0,( "make_connection: connection to %s denied due to security descriptor.\n",
+				ZERODEBUG(0,( "make_connection: connection to %s denied due to security descriptor.\n",
 					service ));
 				yield_connection(conn, lp_servicename(SNUM(conn)));
 				conn_free(conn);
@@ -537,7 +537,7 @@
 	/* Initialise VFS function pointers */
 
 	if (!smbd_vfs_init(conn)) {
-		DEBUG(0, ("smbd_vfs_init failed for service %s\n", lp_servicename(SNUM(conn))));
+		ZERODEBUG(0, ("smbd_vfs_init failed for service %s\n", lp_servicename(SNUM(conn))));
 		yield_connection(conn, lp_servicename(SNUM(conn)));
 		conn_free(conn);
 		return NULL;
@@ -560,7 +560,7 @@
 	}
 	
 	if (!change_to_user(conn, conn->vuid)) {
-		DEBUG(0,("Can't become connected user!\n"));
+		ZERODEBUG(0,("Can't become connected user!\n"));
 		yield_connection(conn, lp_servicename(SNUM(conn)));
 		conn_free(conn);
 		*ecode = ERRbadpw;
@@ -594,7 +594,7 @@
 	   check during individual operations. To match this behaviour
 	   I have disabled this chdir check (tridge) */
 	if (vfs_ChDir(conn,conn->connectpath) != 0) {
-		DEBUG(0,("%s (%s) Can't change directory to %s (%s)\n",
+		ZERODEBUG(0,("%s (%s) Can't change directory to %s (%s)\n",
 			 remote_machine, conn->client_address,
 			 conn->connectpath,strerror(errno)));
 		change_to_root_user();
@@ -606,7 +606,7 @@
 #else
 	/* the alternative is just to check the directory exists */
 	if (stat(conn->connectpath, &st) != 0 || !S_ISDIR(st.st_mode)) {
-		DEBUG(0,("%s is not a directory\n", conn->connectpath));
+		ZERODEBUG(0,("%s is not a directory\n", conn->connectpath));
 		change_to_root_user();
 		yield_connection(conn, lp_servicename(SNUM(conn)));
 		conn_free(conn);
diff -Naur samba-2.2.12-orig/source/smbd/ssl.c samba-2.2.12/source/smbd/ssl.c
--- samba-2.2.12-orig/source/smbd/ssl.c	2004-08-12 20:24:20.000000000 +0200
+++ samba-2.2.12/source/smbd/ssl.c	2009-03-11 10:01:01.000000000 +0100
@@ -45,28 +45,28 @@
     X509_NAME_oneline(X509_get_issuer_name(ctx->current_cert),
             buffer, sizeof(buffer));
     if(ok){
-        DEBUG(0, ("SSL: Certificate OK: %s\n", buffer));
+        ZERODEBUG(0, ("SSL: Certificate OK: %s\n", buffer));
     }else{
         switch (ctx->error){
         case X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT:
-            DEBUG(0, ("SSL: Cert error: CA not known: %s\n", buffer));
+            ZERODEBUG(0, ("SSL: Cert error: CA not known: %s\n", buffer));
             break;
         case X509_V_ERR_CERT_NOT_YET_VALID:
-            DEBUG(0, ("SSL: Cert error: Cert not yet valid: %s\n", buffer));
+            ZERODEBUG(0, ("SSL: Cert error: Cert not yet valid: %s\n", buffer));
             break;
         case X509_V_ERR_ERROR_IN_CERT_NOT_BEFORE_FIELD:
-            DEBUG(0, ("SSL: Cert error: illegal \'not before\' field: %s\n",
+            ZERODEBUG(0, ("SSL: Cert error: illegal \'not before\' field: %s\n",
                     buffer));
             break;
         case X509_V_ERR_CERT_HAS_EXPIRED:
-            DEBUG(0, ("SSL: Cert error: Cert expired: %s\n", buffer));
+            ZERODEBUG(0, ("SSL: Cert error: Cert expired: %s\n", buffer));
             break;
         case X509_V_ERR_ERROR_IN_CERT_NOT_AFTER_FIELD:
-            DEBUG(0, ("SSL: Cert error: invalid \'not after\' field: %s\n",
+            ZERODEBUG(0, ("SSL: Cert error: invalid \'not after\' field: %s\n",
                     buffer));
             break;
         default:
-            DEBUG(0, ("SSL: Cert error: unknown error %d in %s\n", ctx->error,
+            ZERODEBUG(0, ("SSL: Cert error: unknown error %d in %s\n", ctx->error,
                     buffer));
             break;
         }
@@ -189,12 +189,12 @@
 int     err;
 
     if(ssl != NULL){
-        DEBUG(0, ("SSL: internal error: more than one SSL connection (server)\n"));
+        ZERODEBUG(0, ("SSL: internal error: more than one SSL connection (server)\n"));
         return -1;
     }
     if((ssl = SSL_new(sslContext)) == NULL){
         err = ERR_get_error();
-        DEBUG(0, ("SSL: Error allocating handle: %s\n",
+        ZERODEBUG(0, ("SSL: Error allocating handle: %s\n",
             ERR_error_string(err, NULL)));
         return -1;
     }
@@ -202,11 +202,11 @@
     sslFd = fd;
     if(SSL_accept(ssl) <= 0){
         err = ERR_get_error();
-        DEBUG(0, ("SSL: Error accepting on socket: %s\n",
+        ZERODEBUG(0, ("SSL: Error accepting on socket: %s\n",
             ERR_error_string(err, NULL)));
         return -1;
     }
-    DEBUG(0, ("SSL: negotiated cipher: %s\n", SSL_get_cipher(ssl)));
+    ZERODEBUG(0, ("SSL: negotiated cipher: %s\n", SSL_get_cipher(ssl)));
     return 0;
 }
 
@@ -220,12 +220,12 @@
 int     err;
 
     if(ssl != NULL){
-        DEBUG(0, ("SSL: internal error: more than one SSL connection (client)\n"));
+        ZERODEBUG(0, ("SSL: internal error: more than one SSL connection (client)\n"));
         return -1;
     }
     if((ssl = SSL_new(sslContext)) == NULL){
         err = ERR_get_error();
-        DEBUG(0, ("SSL: Error allocating handle: %s\n",
+        ZERODEBUG(0, ("SSL: Error allocating handle: %s\n",
             ERR_error_string(err, NULL)));
         return -1;
     }
@@ -233,11 +233,11 @@
     sslFd = fd;
     if(SSL_connect(ssl) <= 0){
         err = ERR_get_error();
-        DEBUG(0, ("SSL: Error conencting socket: %s\n",
+        ZERODEBUG(0, ("SSL: Error conencting socket: %s\n",
             ERR_error_string(err, NULL)));
         return -1;
     }
-    DEBUG(0, ("SSL: negotiated cipher: %s\n", SSL_get_cipher(ssl)));
+    ZERODEBUG(0, ("SSL: negotiated cipher: %s\n", SSL_get_cipher(ssl)));
     return 0;
 }
 
@@ -263,19 +263,19 @@
         return 0;
     }
     if(msg_type != 0x81){ /* first packet must be a session request */
-        DEBUG( 0, ( "Client %s did not use session setup; access denied\n",
+        ZERODEBUG( 0, ( "Client %s did not use session setup; access denied\n",
                      client_addr() ) );
         if (!send_smb(fd, (char *)buf))
-          DEBUG(0, ("sslutil_negotiate_ssl: send_smb failed.\n"));
+          ZERODEBUG(0, ("sslutil_negotiate_ssl: send_smb failed.\n"));
         return -1;
     }
     buf[4] = 0x8e;  /* negative session response: use SSL */
     if (!send_smb(fd, (char *)buf)) {
-        DEBUG(0,("sslutil_negotiate_ssl: send_smb failed.\n"));
+        ZERODEBUG(0,("sslutil_negotiate_ssl: send_smb failed.\n"));
         return -1;
     }
     if(sslutil_accept(fd) != 0){
-        DEBUG( 0, ( "Client %s failed SSL negotiation!\n", client_addr() ) );
+        ZERODEBUG( 0, ( "Client %s failed SSL negotiation!\n", client_addr() ) );
         return -1;
     }
     return 1;
diff -Naur samba-2.2.12-orig/source/smbd/statcache.c samba-2.2.12/source/smbd/statcache.c
--- samba-2.2.12-orig/source/smbd/statcache.c	2004-08-12 20:24:21.000000000 +0200
+++ samba-2.2.12/source/smbd/statcache.c	2009-03-11 09:59:39.000000000 +0100
@@ -104,7 +104,7 @@
     } else {
       hash_remove(&stat_cache, hash_elem);
       if((scp = (stat_cache_entry *)malloc(sizeof(stat_cache_entry)+2*namelen)) == NULL) {
-        DEBUG(0,("stat_cache_add: Out of memory !\n"));
+        ZERODEBUG(0,("stat_cache_add: Out of memory !\n"));
         return;
       }
       pstrcpy(scp->names, orig_name);
@@ -120,7 +120,7 @@
      */
 
     if((scp = (stat_cache_entry *)malloc(sizeof(stat_cache_entry)+2*namelen)) == NULL) {
-      DEBUG(0,("stat_cache_add: Out of memory !\n"));
+      ZERODEBUG(0,("stat_cache_add: Out of memory !\n"));
       return;
     }
     pstrcpy(scp->names, orig_name);
diff -Naur samba-2.2.12-orig/source/smbd/trans2.c samba-2.2.12/source/smbd/trans2.c
--- samba-2.2.12-orig/source/smbd/trans2.c	2004-08-12 20:24:21.000000000 +0200
+++ samba-2.2.12/source/smbd/trans2.c	2009-03-11 09:59:39.000000000 +0100
@@ -189,7 +189,7 @@
 		/* Sanity check */
 
 		if(params_to_send < 0 || data_to_send < 0) {
-			DEBUG(0,("send_trans2_replies failed sanity check pts = %d, dts = %d\n!!!",
+			ZERODEBUG(0,("send_trans2_replies failed sanity check pts = %d, dts = %d\n!!!",
 				params_to_send, data_to_send));
 			return -1;
 		}
@@ -359,7 +359,7 @@
 		return UNIX_TYPE_SOCKET;
 #endif
 
-	DEBUG(0,("unix_filetype: unknown filetype %u", (unsigned)mode));
+	ZERODEBUG(0,("unix_filetype: unknown filetype %u", (unsigned)mode));
 	return UNIX_TYPE_UNKNOWN;
 }
 
@@ -2210,7 +2210,7 @@
 		return NT_STATUS_ACCESS_DENIED;
 
 	if (!modify_delete_flag(fsp->dev, fsp->inode, delete_on_close)) {
-		DEBUG(0,("set_delete_on_close_internal: failed to change delete on close flag for file %s\n",
+		ZERODEBUG(0,("set_delete_on_close_internal: failed to change delete on close flag for file %s\n",
 			fsp->fsp_name ));
 		unlock_share_entry_fsp(fsp);
 		return NT_STATUS_ACCESS_DENIED;
@@ -3290,9 +3290,9 @@
 			     (CVAL(inbuf, smb_com) != SMBtranss2)) || !ret) {
 				outsize = set_message(outbuf,0,0,True);
 				if(ret)
-					DEBUG(0,("reply_trans2: Invalid secondary trans2 packet\n"));
+					ZERODEBUG(0,("reply_trans2: Invalid secondary trans2 packet\n"));
 				else
-					DEBUG(0,("reply_trans2: %s in getting secondary trans2 response.\n",
+					ZERODEBUG(0,("reply_trans2: %s in getting secondary trans2 response.\n",
 						 (smb_read_error == READ_ERROR) ? "error" : "timeout" ));
 				goto bad_param;
 			}
diff -Naur samba-2.2.12-orig/source/smbd/uid.c samba-2.2.12/source/smbd/uid.c
--- samba-2.2.12-orig/source/smbd/uid.c	2004-08-12 20:24:21.000000000 +0200
+++ samba-2.2.12/source/smbd/uid.c	2009-03-11 09:59:39.000000000 +0100
@@ -272,7 +272,7 @@
 	/* Check we don't overflow our stack */
  
 	if (conn_ctx_stack_ndx == MAX_SEC_CTX_DEPTH) {
-		DEBUG(0, ("Connection context stack overflow!\n"));
+		ZERODEBUG(0, ("Connection context stack overflow!\n"));
 		smb_panic("Connection context stack overflow!\n");
 	}
  
@@ -295,7 +295,7 @@
 	/* Check for stack underflow. */
 
 	if (conn_ctx_stack_ndx == 0) {
-		DEBUG(0, ("Connection context stack underflow!\n"));
+		ZERODEBUG(0, ("Connection context stack underflow!\n"));
 		smb_panic("Connection context stack underflow!\n");
 	}
 
@@ -387,7 +387,7 @@
 
 	new_tok = dup_nt_token(ptok);
 	if (!new_tok) {
-		DEBUG(0,("add_supplementary_nt_login_groups: Failed to malloc new token\n"));
+		ZERODEBUG(0,("add_supplementary_nt_login_groups: Failed to malloc new token\n"));
 		return;
 	}
 	/* Leave the allocated space but empty the number of SIDs. */
@@ -397,7 +397,7 @@
  
 	final_groups = (gid_t *)malloc(total_groups * sizeof(gid_t));
 	if (!final_groups) {
-		DEBUG(0,("add_supplementary_nt_login_groups: Failed to malloc new groups.\n"));
+		ZERODEBUG(0,("add_supplementary_nt_login_groups: Failed to malloc new groups.\n"));
 		delete_nt_token(&new_tok);
 		return;
 	}
diff -Naur samba-2.2.12-orig/source/smbd/vfs.c samba-2.2.12/source/smbd/vfs.c
--- samba-2.2.12-orig/source/smbd/vfs.c	2004-09-29 19:37:44.000000000 +0200
+++ samba-2.2.12/source/smbd/vfs.c	2009-03-11 09:59:39.000000000 +0100
@@ -140,7 +140,7 @@
 	/* Open object file */
 
 	if ((conn->dl_handle = sys_dlopen(lp_vfsobj(SNUM(conn)), RTLD_NOW | RTLD_GLOBAL)) == NULL) {
-		DEBUG(0, ("Error opening %s: %s\n", lp_vfsobj(SNUM(conn)), sys_dlerror()));
+		ZERODEBUG(0, ("Error opening %s: %s\n", lp_vfsobj(SNUM(conn)), sys_dlerror()));
 		return False;
 	}
 
@@ -149,7 +149,7 @@
 	init_fptr = (struct vfs_ops *(*)(int *, struct vfs_ops *))sys_dlsym(conn->dl_handle, "vfs_init");
 
 	if (init_fptr == NULL) {
-		DEBUG(0, ("No vfs_init() symbol found in %s\n", lp_vfsobj(SNUM(conn))));
+		ZERODEBUG(0, ("No vfs_init() symbol found in %s\n", lp_vfsobj(SNUM(conn))));
 		return False;
 	}
 
@@ -158,12 +158,12 @@
 	conn->vfs_ops = default_vfs_ops;
 
 	if ((ops = init_fptr(&vfs_version, &default_vfs_ops)) == NULL) {
-		DEBUG(0, ("vfs_init function from %s failed\n", lp_vfsobj(SNUM(conn))));
+		ZERODEBUG(0, ("vfs_init function from %s failed\n", lp_vfsobj(SNUM(conn))));
 		return False;
 	}
 
 	if (vfs_version != SMB_VFS_INTERFACE_VERSION) {
-		DEBUG(0, ("vfs_init returned wrong interface version info (was %d, should be %d)\n",
+		ZERODEBUG(0, ("vfs_init returned wrong interface version info (was %d, should be %d)\n",
 			vfs_version, SMB_VFS_INTERFACE_VERSION ));
 		return False;
 	}
@@ -185,7 +185,7 @@
 		/* Loadable object file */
  
 		if (!vfs_init_custom(conn)) {
-			DEBUG(0, ("smbd_vfs_init: vfs_init_custom failed\n"));
+			ZERODEBUG(0, ("smbd_vfs_init: vfs_init_custom failed\n"));
 			return False;
 		}
 
@@ -364,7 +364,7 @@
 	DEBUG(10,("vfs_allocate_file_space: file %s, len %.0f\n", fsp->fsp_name, (double)len ));
 
 	if (((SMB_OFF_T)len) < 0) {
-		DEBUG(0,("vfs_allocate_file_space: %s negative len requested.\n", fsp->fsp_name ));
+		ZERODEBUG(0,("vfs_allocate_file_space: %s negative len requested.\n", fsp->fsp_name ));
 		return -1;
 	}
 
@@ -645,7 +645,7 @@
 		in trouble :-) */
 
 	if (vfs_stat(conn, ".",&st) == -1) {
-		DEBUG(0,("Very strange, couldn't stat \".\" path=%s\n", path));
+		ZERODEBUG(0,("Very strange, couldn't stat \".\" path=%s\n", path));
 		return(vfs_getwd(conn,path));
 	}
 
@@ -684,7 +684,7 @@
 		not quite so bad getwd. */
 
 	if (!vfs_getwd(conn,s)) {
-		DEBUG(0,("vfs_GetWd: vfs_getwd call failed, errno %s\n",strerror(errno)));
+		ZERODEBUG(0,("vfs_GetWd: vfs_getwd call failed, errno %s\n",strerror(errno)));
 		return (NULL);
 	}
 
@@ -719,17 +719,17 @@
 	size_t reallen;
 
 	if (!vfs_GetWd(conn, savedir)) {
-		DEBUG(0,("couldn't vfs_GetWd for %s %s\n", name, dir));
+		ZERODEBUG(0,("couldn't vfs_GetWd for %s %s\n", name, dir));
 		return False;
 	}
 
 	if (vfs_ChDir(conn, dir) != 0) {
-		DEBUG(0,("couldn't vfs_ChDir to %s\n", dir));
+		ZERODEBUG(0,("couldn't vfs_ChDir to %s\n", dir));
 		return False;
 	}
 
 	if (!vfs_GetWd(conn, realdir)) {
-		DEBUG(0,("couldn't vfs_GetWd for %s\n", dir));
+		ZERODEBUG(0,("couldn't vfs_GetWd for %s\n", dir));
 		vfs_ChDir(conn, savedir);
 		return(False);
 	}
@@ -808,17 +808,17 @@
 		return readlink_check(conn, dir, s);
 
 	if (!vfs_GetWd(conn,wd)) {
-		DEBUG(0,("couldn't vfs_GetWd for %s %s\n",s,dir));
+		ZERODEBUG(0,("couldn't vfs_GetWd for %s %s\n",s,dir));
 		return(False);
 	}
 
 	if (vfs_ChDir(conn,dir) != 0) {
-		DEBUG(0,("couldn't vfs_ChDir to %s\n",dir));
+		ZERODEBUG(0,("couldn't vfs_ChDir to %s\n",dir));
 		return(False);
 	}
 
 	if (!vfs_GetWd(conn,dir2)) {
-		DEBUG(0,("couldn't vfs_GetWd for %s\n",dir));
+		ZERODEBUG(0,("couldn't vfs_GetWd for %s\n",dir));
 		vfs_ChDir(conn,wd);
 		return(False);
 	}
diff -Naur samba-2.2.12-orig/source/smbwrapper/shared.c samba-2.2.12/source/smbwrapper/shared.c
--- samba-2.2.12-orig/source/smbwrapper/shared.c	2004-08-12 20:24:19.000000000 +0200
+++ samba-2.2.12/source/smbwrapper/shared.c	2009-03-11 09:59:39.000000000 +0100
@@ -72,14 +72,14 @@
 	if (shared_fd == 0) {
 		char *p = getenv("SMBW_HANDLE");
 		if (!p) {
-			DEBUG(0,("ERROR: can't get smbw shared handle\n"));
+			ZERODEBUG(0,("ERROR: can't get smbw shared handle\n"));
 			exit(1);
 		}
 		shared_fd = atoi(p);
 	}
 	if (locked==0 && 
 	    fcntl_lock(shared_fd,SMB_F_SETLKW,0,1,F_WRLCK)==False) {
-		DEBUG(0,("ERROR: can't get smbw shared lock (%s)\n", strerror(errno)));
+		ZERODEBUG(0,("ERROR: can't get smbw shared lock (%s)\n", strerror(errno)));
 		exit(1);
 	}
 	locked++;
@@ -143,7 +143,7 @@
 	return NULL;
 
  failed:
-	DEBUG(0,("smbw: shared variables corrupt (%s)\n", strerror(errno)));
+	ZERODEBUG(0,("smbw: shared variables corrupt (%s)\n", strerror(errno)));
 	exit(1);
 	return NULL;
 }
@@ -168,7 +168,7 @@
 	variables = (char *)Realloc(variables, shared_size + l1+l2+4);
 
 	if (!variables) {
-		DEBUG(0,("out of memory in smbw_setshared\n"));
+		ZERODEBUG(0,("out of memory in smbw_setshared\n"));
 		exit(1);
 	}
 
@@ -182,7 +182,7 @@
 
 	lseek(shared_fd, 0, SEEK_SET);
 	if (write(shared_fd, variables, shared_size) != shared_size) {
-		DEBUG(0,("smbw_setshared failed (%s)\n", strerror(errno)));
+		ZERODEBUG(0,("smbw_setshared failed (%s)\n", strerror(errno)));
 		exit(1);
 	}
 
diff -Naur samba-2.2.12-orig/source/smbwrapper/smbsh.c samba-2.2.12/source/smbwrapper/smbsh.c
--- samba-2.2.12-orig/source/smbwrapper/smbsh.c	2004-08-12 20:24:20.000000000 +0200
+++ samba-2.2.12/source/smbwrapper/smbsh.c	2009-03-11 13:51:50.000000000 +0100
@@ -57,7 +57,7 @@
 
 	smbw_setup_shared();
 
-	while ((opt = getopt(argc, argv, "W:U:R:d:P:l:hL:")) != EOF) {
+	while ((opt = getopt(argc, argv, "W:U:R:P:l:hL:")) != EOF) {
 		switch (opt) {
 		case 'L':
 			libd = optarg;
@@ -73,7 +73,7 @@
 			break;
 		case 'd':
 			smbw_setshared("DEBUG", optarg);
-			DEBUGLEVEL = atoi(optarg);
+			DEBUGLEVEL = 0;
 			break;
 		case 'U':
 			p = strchr(optarg,'%');
diff -Naur samba-2.2.12-orig/source/smbwrapper/smbw.c samba-2.2.12/source/smbwrapper/smbw.c
--- samba-2.2.12-orig/source/smbwrapper/smbw.c	2004-08-12 20:24:19.000000000 +0200
+++ samba-2.2.12/source/smbwrapper/smbw.c	2009-03-11 13:48:39.000000000 +0100
@@ -90,7 +90,7 @@
 	get_myname(global_myname);
 
 	if ((p=smbw_getshared("DEBUG"))) {
-		DEBUGLEVEL = atoi(p);
+		DEBUGLEVEL = 0;
 	}
 
 	if ((p=smbw_getshared("RESOLVE_ORDER"))) {
@@ -702,7 +702,7 @@
 	}
 
 	if (bitmap_query(smbw_file_bmap, file->fd)) {
-		DEBUG(0,("ERROR: fd used in smbw_open\n"));
+		ZERODEBUG(0,("ERROR: fd used in smbw_open\n"));
 		errno = EIO;
 		goto failed;
 	}
@@ -1291,7 +1291,7 @@
 	}
 
 	if (bitmap_query(smbw_file_bmap, fd2)) {
-		DEBUG(0,("ERROR: fd already open in dup!\n"));
+		ZERODEBUG(0,("ERROR: fd already open in dup!\n"));
 		errno = EIO;
 		goto failed;
 	}
@@ -1339,7 +1339,7 @@
 	}
 
 	if (bitmap_query(smbw_file_bmap, fd2)) {
-		DEBUG(0,("ERROR: fd already open in dup2!\n"));
+		ZERODEBUG(0,("ERROR: fd already open in dup2!\n"));
 		errno = EIO;
 		goto failed;
 	}
diff -Naur samba-2.2.12-orig/source/smbwrapper/smbw_dir.c samba-2.2.12/source/smbwrapper/smbw_dir.c
--- samba-2.2.12-orig/source/smbwrapper/smbw_dir.c	2004-08-12 20:24:19.000000000 +0200
+++ samba-2.2.12/source/smbwrapper/smbw_dir.c	2009-03-11 09:59:39.000000000 +0100
@@ -249,7 +249,7 @@
 	}
 
 	if (bitmap_query(smbw_file_bmap, fd)) {
-		DEBUG(0,("ERROR: fd used in smbw_dir_open\n"));
+		ZERODEBUG(0,("ERROR: fd used in smbw_dir_open\n"));
 		errno = EIO;
 		goto failed;
 	}
diff -Naur samba-2.2.12-orig/source/tdb/tdbutil.c samba-2.2.12/source/tdb/tdbutil.c
--- samba-2.2.12-orig/source/tdb/tdbutil.c	2004-08-12 20:24:35.000000000 +0200
+++ samba-2.2.12/source/tdb/tdbutil.c	2009-03-11 09:59:39.000000000 +0100
@@ -394,7 +394,7 @@
 			}
 			break;
 		default:
-			DEBUG(0,("Unknown tdb_pack format %c in %s\n", 
+			ZERODEBUG(0,("Unknown tdb_pack format %c in %s\n", 
 				 c, fmt));
 			len = 0;
 			break;
@@ -490,7 +490,7 @@
 			memcpy(*b, buf+4, *i);
 			break;
 		default:
-			DEBUG(0,("Unknown tdb_unpack format %c in %s\n", 
+			ZERODEBUG(0,("Unknown tdb_unpack format %c in %s\n", 
 				 c, fmt));
 
 			len = 0;
diff -Naur samba-2.2.12-orig/source/utils/locktest2.c samba-2.2.12/source/utils/locktest2.c
--- samba-2.2.12-orig/source/utils/locktest2.c	2004-08-12 20:24:34.000000000 +0200
+++ samba-2.2.12/source/utils/locktest2.c	2009-03-11 09:59:40.000000000 +0100
@@ -181,12 +181,12 @@
 	/* have to open a new connection */
 	if (!(c=cli_initialise(NULL)) || (cli_set_port(c, 139) == 0) ||
 	    !cli_connect(c, server_n, &ip)) {
-		DEBUG(0,("Connection to %s failed\n", server_n));
+		ZERODEBUG(0,("Connection to %s failed\n", server_n));
 		return NULL;
 	}
 
 	if (!cli_session_request(c, &calling, &called)) {
-		DEBUG(0,("session request to %s failed\n", called.name));
+		ZERODEBUG(0,("session request to %s failed\n", called.name));
 		cli_shutdown(c);
 		if (strcmp(called.name, "*SMBSERVER")) {
 			make_nmb_name(&called , "*SMBSERVER", 0x20);
@@ -198,7 +198,7 @@
 	DEBUG(4,(" session request ok\n"));
 
 	if (!cli_negprot(c)) {
-		DEBUG(0,("protocol negotiation failed\n"));
+		ZERODEBUG(0,("protocol negotiation failed\n"));
 		cli_shutdown(c);
 		return NULL;
 	}
@@ -214,7 +214,7 @@
 			       password, strlen(password),
 			       password, strlen(password),
 			       lp_workgroup())) {
-		DEBUG(0,("session setup failed: %s\n", cli_errstr(c)));
+		ZERODEBUG(0,("session setup failed: %s\n", cli_errstr(c)));
 		return NULL;
 	}
 
@@ -234,7 +234,7 @@
 
 	if (!cli_send_tconX(c, share, "?????",
 			    password, strlen(password)+1)) {
-		DEBUG(0,("tree connect failed: %s\n", cli_errstr(c)));
+		ZERODEBUG(0,("tree connect failed: %s\n", cli_errstr(c)));
 		cli_shutdown(c);
 		return NULL;
 	}
@@ -272,7 +272,7 @@
 		}
 		cli[server][conn] = connect_one(share[server]);
 		if (!cli[server][conn]) {
-			DEBUG(0,("Failed to connect to %s\n", share[server]));
+			ZERODEBUG(0,("Failed to connect to %s\n", share[server]));
 			exit(1);
 		}
 	}
@@ -615,7 +615,7 @@
 	argc -= optind;
 	argv += optind;
 
-	DEBUG(0,("seed=%u\n", seed));
+	ZERODEBUG(0,("seed=%u\n", seed));
 	srandom(seed);
 
 	locking_init(1);
diff -Naur samba-2.2.12-orig/source/utils/locktest.c samba-2.2.12/source/utils/locktest.c
--- samba-2.2.12-orig/source/utils/locktest.c	2004-08-12 20:24:35.000000000 +0200
+++ samba-2.2.12/source/utils/locktest.c	2009-03-11 09:59:40.000000000 +0100
@@ -139,12 +139,12 @@
 	/* have to open a new connection */
 	if (!(c=cli_initialise(NULL)) || (cli_set_port(c, 139) == 0) ||
 	    !cli_connect(c, server_n, &ip)) {
-		DEBUG(0,("Connection to %s failed\n", server_n));
+		ZERODEBUG(0,("Connection to %s failed\n", server_n));
 		return NULL;
 	}
 
 	if (!cli_session_request(c, &calling, &called)) {
-		DEBUG(0,("session request to %s failed\n", called.name));
+		ZERODEBUG(0,("session request to %s failed\n", called.name));
 		cli_shutdown(c);
 		if (strcmp(called.name, "*SMBSERVER")) {
 			make_nmb_name(&called , "*SMBSERVER", 0x20);
@@ -156,7 +156,7 @@
 	DEBUG(4,(" session request ok\n"));
 
 	if (!cli_negprot(c)) {
-		DEBUG(0,("protocol negotiation failed\n"));
+		ZERODEBUG(0,("protocol negotiation failed\n"));
 		cli_shutdown(c);
 		return NULL;
 	}
@@ -172,7 +172,7 @@
 			       password, strlen(password),
 			       password, strlen(password),
 			       lp_workgroup())) {
-		DEBUG(0,("session setup failed: %s\n", cli_errstr(c)));
+		ZERODEBUG(0,("session setup failed: %s\n", cli_errstr(c)));
 		return NULL;
 	}
 
@@ -192,7 +192,7 @@
 
 	if (!cli_send_tconX(c, share, "?????",
 			    password, strlen(password)+1)) {
-		DEBUG(0,("tree connect failed: %s\n", cli_errstr(c)));
+		ZERODEBUG(0,("tree connect failed: %s\n", cli_errstr(c)));
 		cli_shutdown(c);
 		return NULL;
 	}
@@ -223,7 +223,7 @@
 		}
 		cli[server][conn] = connect_one(share[server]);
 		if (!cli[server][conn]) {
-			DEBUG(0,("Failed to connect to %s\n", share[server]));
+			ZERODEBUG(0,("Failed to connect to %s\n", share[server]));
 			exit(1);
 		}
 	}
@@ -561,7 +561,7 @@
 	argc -= optind;
 	argv += optind;
 
-	DEBUG(0,("seed=%u\n", seed));
+	ZERODEBUG(0,("seed=%u\n", seed));
 	srandom(seed);
 
 	locking_init(1);
diff -Naur samba-2.2.12-orig/source/utils/masktest.c samba-2.2.12/source/utils/masktest.c
--- samba-2.2.12-orig/source/utils/masktest.c	2004-08-12 20:24:35.000000000 +0200
+++ samba-2.2.12/source/utils/masktest.c	2009-03-11 13:48:39.000000000 +0100
@@ -186,14 +186,14 @@
 	/* have to open a new connection */
 	if (!(c=cli_initialise(NULL)) || (cli_set_port(c, 139) == 0) ||
 	    !cli_connect(c, server_n, &ip)) {
-		DEBUG(0,("Connection to %s failed\n", server_n));
+		ZERODEBUG(0,("Connection to %s failed\n", server_n));
 		return NULL;
 	}
 
 	c->protocol = max_protocol;
 
 	if (!cli_session_request(c, &calling, &called)) {
-		DEBUG(0,("session request to %s failed\n", called.name));
+		ZERODEBUG(0,("session request to %s failed\n", called.name));
 		cli_shutdown(c);
 		if (strcmp(called.name, "*SMBSERVER")) {
 			make_nmb_name(&called , "*SMBSERVER", 0x20);
@@ -205,7 +205,7 @@
 	DEBUG(4,(" session request ok\n"));
 
 	if (!cli_negprot(c)) {
-		DEBUG(0,("protocol negotiation failed\n"));
+		ZERODEBUG(0,("protocol negotiation failed\n"));
 		cli_shutdown(c);
 		return NULL;
 	}
@@ -221,7 +221,7 @@
 			       password, strlen(password),
 			       password, strlen(password),
 			       lp_workgroup())) {
-		DEBUG(0,("session setup failed: %s\n", cli_errstr(c)));
+		ZERODEBUG(0,("session setup failed: %s\n", cli_errstr(c)));
 		return NULL;
 	}
 
@@ -241,7 +241,7 @@
 
 	if (!cli_send_tconX(c, share, "?????",
 			    password, strlen(password)+1)) {
-		DEBUG(0,("tree connect failed: %s\n", cli_errstr(c)));
+		ZERODEBUG(0,("tree connect failed: %s\n", cli_errstr(c)));
 		cli_shutdown(c);
 		return NULL;
 	}
@@ -309,7 +309,7 @@
 
 	fnum = cli_open(cli, file, O_CREAT|O_TRUNC|O_RDWR, 0);
 	if (fnum == -1) {
-		DEBUG(0,("Can't create %s\n", file));
+		ZERODEBUG(0,("Can't create %s\n", file));
 		return;
 	}
 	cli_close(cli, fnum);
@@ -325,14 +325,14 @@
 	res2 = reg_test(mask, long_name, short_name);
 
 	if (showall || strcmp(res1, res2)) {
-		DEBUG(0,("%s %s %d mask=[%s] file=[%s] rfile=[%s/%s]\n",
+		ZERODEBUG(0,("%s %s %d mask=[%s] file=[%s] rfile=[%s/%s]\n",
 			 res1, res2, count, mask, file, long_name, short_name));
 		if (die_on_error) exit(1);
 	}
 
 	cli_unlink(cli, file);
 
-	if (count % 100 == 0) DEBUG(0,("%d\n", count));
+	if (count % 100 == 0) ZERODEBUG(0,("%d\n", count));
 }
 
 static void test_mask(int argc, char *argv[], 
@@ -463,13 +463,13 @@
 
 	seed = time(NULL);
 
-	while ((opt = getopt(argc, argv, "n:d:U:s:hm:f:aoW:M:vE")) != EOF) {
+	while ((opt = getopt(argc, argv, "n:U:s:hm:f:aoW:M:vE")) != EOF) {
 		switch (opt) {
 		case 'n':
 			NumLoops = atoi(optarg);
 			break;
 		case 'd':
-			DEBUGLEVEL = atoi(optarg);
+			DEBUGLEVEL = 0;
 			break;
 		case 'E':
 			die_on_error = 1;
@@ -522,13 +522,13 @@
 
 	cli = connect_one(share);
 	if (!cli) {
-		DEBUG(0,("Failed to connect to %s\n", share));
+		ZERODEBUG(0,("Failed to connect to %s\n", share));
 		exit(1);
 	}
 	Protocol = cli->protocol;
 
 	/* need to init seed after connect as clientgen uses random numbers */
-	DEBUG(0,("seed=%d\n", seed));
+	ZERODEBUG(0,("seed=%d\n", seed));
 	srandom(seed);
 
 	test_mask(argc, argv, cli);
diff -Naur samba-2.2.12-orig/source/utils/nmblookup.c samba-2.2.12/source/utils/nmblookup.c
--- samba-2.2.12-orig/source/utils/nmblookup.c	2004-08-12 20:24:34.000000000 +0200
+++ samba-2.2.12/source/utils/nmblookup.c	2009-03-11 13:48:39.000000000 +0100
@@ -61,9 +61,8 @@
 ****************************************************************************/
 static void usage(void)
 {
-  printf("Usage: nmblookup [-M] [-B bcast address] [-d debuglevel] name\n");
+  printf("Usage: nmblookup [-M] [-B bcast address] name\n");
   printf("Version %s\n",VERSION);
-  printf("\t-d debuglevel         set the debuglevel\n");
   printf("\t-B broadcast address  the address to use for broadcasts\n");
   printf("\t-f                    lists flags returned from a name query\n");
   printf("\t-U unicast   address  the address to use for unicast\n");
@@ -219,7 +218,7 @@
   static pstring servicesf = CONFIGFILE;
   BOOL lookup_by_ip = False;
 
-  DEBUGLEVEL = 1;
+  DEBUGLEVEL = 0;
   /* Prevent smb.conf setting from overridding */
   AllowDebugChange = False;
 
@@ -267,7 +266,7 @@
 	recursion_desired = True;
 	break;
       case 'd':
-	DEBUGLEVEL = atoi(optarg);
+	DEBUGLEVEL = 0;
 	break;
       case 's':
 	pstrcpy(servicesf, optarg);
diff -Naur samba-2.2.12-orig/source/utils/pdbedit.c samba-2.2.12/source/utils/pdbedit.c
--- samba-2.2.12-orig/source/utils/pdbedit.c	2004-08-12 20:24:34.000000000 +0200
+++ samba-2.2.12/source/utils/pdbedit.c	2009-03-11 13:51:50.000000000 +0100
@@ -702,7 +702,7 @@
 	
 	codepage_initialise(lp_client_code_page());
 
-	while ((ch = getopt(argc, argv, "abd:f:h:i:lmp:s:u:vwxD:")) != EOF) {
+	while ((ch = getopt(argc, argv, "abf:h:i:lmp:s:u:vwxD:")) != EOF) {
 		switch(ch) {
 		case 'a':
 			add_user = True;
@@ -753,7 +753,7 @@
 			smbpasswd = optarg;
 			break;
 		case 'D':
-                        DEBUGLEVEL = atoi(optarg);
+                        DEBUGLEVEL = 0;
                         break;
 		default:
 			usage();
diff -Naur samba-2.2.12-orig/source/utils/rpctorture.c samba-2.2.12/source/utils/rpctorture.c
--- samba-2.2.12-orig/source/utils/rpctorture.c	2004-08-12 20:24:34.000000000 +0200
+++ samba-2.2.12/source/utils/rpctorture.c	2009-03-11 13:51:50.000000000 +0100
@@ -73,7 +73,7 @@
 	                          info->share, info->svc_type,
 	                          False, True))
 	{
-		DEBUG(0,("rpcclient_connect: connection failed\n"));
+		ZERODEBUG(0,("rpcclient_connect: connection failed\n"));
 		cli_shutdown(smb_cli);
 		return False;
 	}
@@ -195,11 +195,10 @@
 ****************************************************************************/
 static void usage(char *pname)
 {
-  fprintf(out_hnd, "Usage: %s service <password> [-d debuglevel] [-l log] ",
+  fprintf(out_hnd, "Usage: %s service <password> [-l log] ",
 	   pname);
 
   fprintf(out_hnd, "\nVersion %s\n",VERSION);
-  fprintf(out_hnd, "\t-d debuglevel         set the debuglevel\n");
   fprintf(out_hnd, "\t-l log basename.      Basename for log/debug files\n");
   fprintf(out_hnd, "\t-n netbios name.      Use this name as my netbios name\n");
   fprintf(out_hnd, "\t-m max protocol       set the max protocol level\n");
@@ -352,7 +351,7 @@
 		cli_action = CLIENT_SVC;
 	}
 
-	while ((opt = getopt(argc, argv,"s:O:M:S:i:N:o:n:d:l:hI:EB:U:L:t:m:W:T:D:c:")) != EOF)
+	while ((opt = getopt(argc, argv,"s:O:M:S:i:N:o:n:l:hI:EB:U:L:t:m:W:T:D:c:")) != EOF)
 	{
 		switch (opt)
 		{
@@ -443,9 +442,9 @@
 			case 'd':
 			{
 				if (*optarg == 'A')
-					DEBUGLEVEL = 10000;
+					DEBUGLEVEL = 0;
 				else
-					DEBUGLEVEL = atoi(optarg);
+					DEBUGLEVEL = 0;
 				break;
 			}
 
diff -Naur samba-2.2.12-orig/source/utils/smbcacls.c samba-2.2.12/source/utils/smbcacls.c
--- samba-2.2.12-orig/source/utils/smbcacls.c	2004-08-12 20:24:35.000000000 +0200
+++ samba-2.2.12/source/utils/smbcacls.c	2009-03-11 13:48:38.000000000 +0100
@@ -733,13 +733,13 @@
 
 	/* have to open a new connection */
 	if (!(c=cli_initialise(NULL)) || !cli_connect(c, server, &ip)) {
-		DEBUG(0,("Connection to %s failed\n", server));
+		ZERODEBUG(0,("Connection to %s failed\n", server));
 		cli_shutdown(c);
 		return NULL;
 	}
 
 	if (!cli_session_request(c, &calling, &called)) {
-		DEBUG(0,("session request to %s failed\n", called.name));
+		ZERODEBUG(0,("session request to %s failed\n", called.name));
 		cli_shutdown(c);
 		if (strcmp(called.name, "*SMBSERVER")) {
 			make_nmb_name(&called , "*SMBSERVER", 0x20);
@@ -751,7 +751,7 @@
 	DEBUG(4,(" session request ok\n"));
 
 	if (!cli_negprot(c)) {
-		DEBUG(0,("protocol negotiation failed\n"));
+		ZERODEBUG(0,("protocol negotiation failed\n"));
 		cli_shutdown(c);
 		return NULL;
 	}
@@ -767,7 +767,7 @@
 			       password, strlen(password),
 			       password, strlen(password),
 			       (workgroup[0] ? workgroup : lp_workgroup()))) {
-		DEBUG(0,("session setup failed: %s\n", cli_errstr(c)));
+		ZERODEBUG(0,("session setup failed: %s\n", cli_errstr(c)));
 		cli_shutdown(c);
 		return NULL;
 	}
@@ -776,7 +776,7 @@
 
 	if (!cli_send_tconX(c, share, "?????",
 			    password, strlen(password)+1)) {
-		DEBUG(0,("tree connect failed: %s\n", cli_errstr(c)));
+		ZERODEBUG(0,("tree connect failed: %s\n", cli_errstr(c)));
 		cli_shutdown(c);
 		return NULL;
 	}
@@ -931,7 +931,7 @@
 			exit(EXIT_PARSE_ERROR);
 
 		case 'd':
-			DEBUGLEVEL = atoi(optarg);
+			DEBUGLEVEL = 0;
 			break;
 
 		default:
diff -Naur samba-2.2.12-orig/source/utils/smbcontrol.c samba-2.2.12/source/utils/smbcontrol.c
--- samba-2.2.12-orig/source/utils/smbcontrol.c	2004-08-12 20:24:34.000000000 +0200
+++ samba-2.2.12/source/utils/smbcontrol.c	2009-03-11 13:48:38.000000000 +0100
@@ -46,8 +46,8 @@
 {
 	int i;
 	if (doexit) {
-		printf("Usage: smbcontrol [-d debuglevel] [-s configfile] [-i]\n");
-		printf("       smbcontrol [-d debuglevel] [-s configfile] <destination> <message-type> <parameters>\n\n");
+		printf("Usage: smbcontrol [-s configfile] [-i]\n");
+		printf("       smbcontrol [-s configfile] <destination> <message-type> <parameters>\n\n");
 	} else {
 		printf("<destination> <message-type> <parameters>\n\n");
 	}
@@ -358,10 +358,10 @@
 
 	if (argc < 2) usage(True);
 
-	while ((opt = getopt(argc, argv,"is:d:")) != EOF) {
+	while ((opt = getopt(argc, argv,"is:")) != EOF) {
 		switch (opt) {
 		case 'd':
-			DEBUGLEVEL = atoi(optarg);
+			DEBUGLEVEL = 0;
 			break;
 		case 'i':
 			interactive = True;
diff -Naur samba-2.2.12-orig/source/utils/smbfilter.c samba-2.2.12/source/utils/smbfilter.c
--- samba-2.2.12-orig/source/utils/smbfilter.c	2004-08-12 20:24:35.000000000 +0200
+++ samba-2.2.12/source/utils/smbfilter.c	2009-03-11 09:59:40.000000000 +0100
@@ -75,7 +75,7 @@
 			/* session request */
 			name_extract(buf,4,name1);
 			name_extract(buf,4 + name_len(buf + 4),name2);
-			DEBUG(0,("sesion_request: %s -> %s\n",
+			ZERODEBUG(0,("sesion_request: %s -> %s\n",
 				 name1, name2));
 			if (netbiosname) {
 				/* replace the destination netbios name */
@@ -106,7 +106,7 @@
 	s = open_socket_out(SOCK_STREAM, &dest_ip, 139, LONG_CONNECT_TIMEOUT);
 
 	if (s == -1) {
-		DEBUG(0,("Unable to connect to %s\n", inet_ntoa(dest_ip)));
+		ZERODEBUG(0,("Unable to connect to %s\n", inet_ntoa(dest_ip)));
 		exit(1);
 	}
 
@@ -123,28 +123,28 @@
 		
 		if (c != -1 && FD_ISSET(c, &fds)) {
 			if (!receive_smb(c, packet, 0)) {
-				DEBUG(0,("client closed connection\n"));
+				ZERODEBUG(0,("client closed connection\n"));
 				exit(0);
 			}
 			filter_request(packet);
 			if (!send_smb(s, packet)) {
-				DEBUG(0,("server is dead\n"));
+				ZERODEBUG(0,("server is dead\n"));
 				exit(1);
 			}			
 		}
 		if (s != -1 && FD_ISSET(s, &fds)) {
 			if (!receive_smb(s, packet, 0)) {
-				DEBUG(0,("server closed connection\n"));
+				ZERODEBUG(0,("server closed connection\n"));
 				exit(0);
 			}
 			filter_reply(packet);
 			if (!send_smb(c, packet)) {
-				DEBUG(0,("client is dead\n"));
+				ZERODEBUG(0,("client is dead\n"));
 				exit(1);
 			}			
 		}
 	}
-	DEBUG(0,("Connection closed\n"));
+	ZERODEBUG(0,("Connection closed\n"));
 	exit(0);
 }
 
@@ -160,16 +160,16 @@
 	s = open_socket_in(SOCK_STREAM, 139, 0, 0, True);
 	
 	if (s == -1) {
-		DEBUG(0,("bind failed\n"));
+		ZERODEBUG(0,("bind failed\n"));
 		exit(1);
 	}
 
 	if (listen(s, 5) == -1) {
-		DEBUG(0,("listen failed\n"));
+		ZERODEBUG(0,("listen failed\n"));
 	}
 
 	if (!resolve_name(desthost, &dest_ip, 0x20)) {
-		DEBUG(0,("Unable to resolve host %s\n", desthost));
+		ZERODEBUG(0,("Unable to resolve host %s\n", desthost));
 		exit(1);
 	}
 
@@ -223,7 +223,7 @@
 	}
 
 	if (!lp_load(configfile,True,False,False)) {
-		DEBUG(0,("Unable to load config file\n"));
+		ZERODEBUG(0,("Unable to load config file\n"));
 	}
 
 	start_filter(desthost);
diff -Naur samba-2.2.12-orig/source/utils/smbpasswd.c samba-2.2.12/source/utils/smbpasswd.c
--- samba-2.2.12-orig/source/utils/smbpasswd.c	2004-08-12 20:24:34.000000000 +0200
+++ samba-2.2.12/source/utils/smbpasswd.c	2009-03-11 13:48:38.000000000 +0100
@@ -196,7 +196,7 @@
 			lp_set_name_resolve_order(optarg);
 			break;
 		case 'D':
-			DEBUGLEVEL = atoi(optarg);
+			DEBUGLEVEL = 0;
 			break;
 		case 'U': {
 			char *lp;
@@ -330,13 +330,13 @@
 
 #define CHECK_RPC_ERR(rpc, msg) \
         if (!NT_STATUS_IS_OK(result = rpc)) { \
-                DEBUG(0, (msg ": %s\n", get_nt_error_msg(result))); \
+                ZERODEBUG(0, (msg ": %s\n", get_nt_error_msg(result))); \
                 goto done; \
         }
 
 #define CHECK_RPC_ERR_DEBUG(rpc, debug_args) \
         if (!NT_STATUS_IS_OK(result = rpc)) { \
-                DEBUG(0, debug_args); \
+                ZERODEBUG(0, debug_args); \
                 goto done; \
         }
 
@@ -382,12 +382,12 @@
 	ZERO_STRUCT(dest_ip); /* Make sure no nasty surprises */
 
 	if (!(mem_ctx = talloc_init())) {
-		DEBUG(0, ("Could not initialise talloc context\n"));
+		ZERODEBUG(0, ("Could not initialise talloc context\n"));
 		goto done;
 	}
 
 	if (!cli_initialise(&cli)) {
-		DEBUG(0, ("Could not initialise client structure\n"));
+		ZERODEBUG(0, ("Could not initialise client structure\n"));
 		goto done;
 	}
 
@@ -423,9 +423,9 @@
 	if (!cli_establish_connection(&cli, pdc_name, &dest_ip, &calling, 
 				      &called, "IPC$", "IPC", False, True)) {
 		if (!NT_STATUS_IS_OK(cli_nt_error(&cli))) {
-			DEBUG(0, ("Error connecting to %s - %s\n", pdc_name,cli_errstr(&cli)));
+			ZERODEBUG(0, ("Error connecting to %s - %s\n", pdc_name,cli_errstr(&cli)));
 		} else {
-			DEBUG(0, ("Error connecting to %s\n", pdc_name));
+			ZERODEBUG(0, ("Error connecting to %s\n", pdc_name));
 		}
 		goto done;
 	}
@@ -433,7 +433,7 @@
 	/* Fetch domain sid */
 
 	if (!cli_nt_session_open(&cli, PIPE_LSARPC)) {
-		DEBUG(0, ("Error connecting to SAM pipe\n"));
+		ZERODEBUG(0, ("Error connecting to SAM pipe\n"));
 		goto done;
 	}
 
@@ -454,7 +454,7 @@
 	/* Create domain user */
 
 	if (!cli_nt_session_open(&cli, PIPE_SAMR)) {
-		DEBUG(0, ("Error connecting to SAM pipe\n"));
+		ZERODEBUG(0, ("Error connecting to SAM pipe\n"));
 		goto done;
 	}
 
@@ -512,7 +512,7 @@
 			 acct_name, get_nt_error_msg(result)));
 
 		if (name_types[0] != SID_NAME_USER) {
-			DEBUG(0, ("%s is not a user account\n", acct_name));
+			ZERODEBUG(0, ("%s is not a user account\n", acct_name));
 			goto done;
 		}
 
@@ -528,7 +528,7 @@
 			 acct_name, get_nt_error_msg(result)));
 		
 	} else if (!NT_STATUS_IS_OK(result)) {
-		DEBUG(0, ("error creating domain user: %s\n",
+		ZERODEBUG(0, ("error creating domain user: %s\n",
 			  get_nt_error_msg(result)));
 		goto done;
 	}
@@ -600,7 +600,7 @@
 
 	if (!secrets_store_domain_sid(domain, &domain_sid) ||
 	    !secrets_store_trust_account_password(domain, ntpw)) {
-		DEBUG(0, ("error storing domain secrets\n"));
+		ZERODEBUG(0, ("error storing domain secrets\n"));
 		goto done;
 	}
 
@@ -890,7 +890,7 @@
 		printf("Setting stored password for \"%s\" in secrets.tdb\n", 
 			lp_ldap_admin_dn());
 		if (!store_ldap_admin_pw(ldap_secret))
-			DEBUG(0,("ERROR: Failed to store the ldap admin password!\n"));
+			ZERODEBUG(0,("ERROR: Failed to store the ldap admin password!\n"));
 		goto done;
 	}
 #endif
@@ -920,7 +920,7 @@
 		/* smb.conf must specify both security = domain and encrypt passwords = yes */
 
 		if (!lp_encrypted_passwords() || lp_security() != SEC_DOMAIN) {
-			DEBUG(0,("ERROR: Must have both SECURITY = DOMAIN and ENCRYPT PASSWORDS = YES!\n"));
+			ZERODEBUG(0,("ERROR: Must have both SECURITY = DOMAIN and ENCRYPT PASSWORDS = YES!\n"));
 			return 1;
 		} 
 
diff -Naur samba-2.2.12-orig/source/utils/smbw_sample.c samba-2.2.12/source/utils/smbw_sample.c
--- samba-2.2.12-orig/source/utils/smbw_sample.c	2004-08-12 20:24:34.000000000 +0200
+++ samba-2.2.12/source/utils/smbw_sample.c	2009-03-11 13:51:50.000000000 +0100
@@ -41,7 +41,7 @@
 	codepage_initialise(lp_client_code_page());
 	smbw_setup_shared();
 
-	while ((opt = getopt(argc, argv, "W:U:R:d:P:l:hL:")) != EOF) {
+	while ((opt = getopt(argc, argv, "W:U:R:P:l:hL:")) != EOF) {
 		switch (opt) {
 		case 'W':
 			smbw_setshared("WORKGROUP", optarg);
diff -Naur samba-2.2.12-orig/source/utils/testparm.c samba-2.2.12/source/utils/testparm.c
--- samba-2.2.12-orig/source/utils/testparm.c	2004-08-12 20:24:34.000000000 +0200
+++ samba-2.2.12/source/utils/testparm.c	2009-03-11 13:48:38.000000000 +0100
@@ -240,7 +240,7 @@
     pstrcpy(configfile,argv[optind]);
 
   dbf = stdout;
-  DEBUGLEVEL = 2;
+  DEBUGLEVEL = 0;
   AllowDebugChange = False;
 
   printf("Load smb config files from %s\n",configfile);
diff -Naur samba-2.2.12-orig/source/utils/testprns.c samba-2.2.12/source/utils/testprns.c
--- samba-2.2.12-orig/source/utils/testprns.c	2004-08-12 20:24:34.000000000 +0200
+++ samba-2.2.12/source/utils/testprns.c	2009-03-11 13:48:38.000000000 +0100
@@ -55,7 +55,7 @@
       if (dbf == NULL) {
          printf("Unable to open logfile.\n");
       } else {
-         DEBUGLEVEL = 3;
+         DEBUGLEVEL = 0;
          pszTemp = (argc < 3) ? PRINTCAP_NAME : argv[2];
          printf("Looking for printer %s in printcap file %s\n", 
                  argv[1], pszTemp);
diff -Naur samba-2.2.12-orig/source/utils/torture.c samba-2.2.12/source/utils/torture.c
--- samba-2.2.12-orig/source/utils/torture.c	2004-08-12 20:24:34.000000000 +0200
+++ samba-2.2.12/source/utils/torture.c	2009-03-11 13:51:50.000000000 +0100
@@ -4844,7 +4844,7 @@
 
 	fstrcpy(workgroup, lp_workgroup());
 
-  while ((opt = getopt(argc, argv, "hW:U:u:n:N:O:o:m:Ld:")) != EOF) {
+  while ((opt = getopt(argc, argv, "hW:U:u:n:N:O:o:m:L")) != EOF) {
 		switch (opt) {
 		case 'W':
 			fstrcpy(workgroup,optarg);
@@ -4859,7 +4859,7 @@
 			numops = atoi(optarg);
 			break;
 		case 'd':
-			DEBUGLEVEL = atoi(optarg);
+			DEBUGLEVEL = 0;
 			break;
 		case 'O':
 			sockops = optarg;
